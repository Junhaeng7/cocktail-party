{"ast":null,"code":"import { createMuiTheme, ThemeProvider as ThemeProvider$1 } from '@material-ui/core/styles';\nimport merge from 'deepmerge';\nimport React, { useRef, useState, useEffect, useCallback, createContext, useMemo, useContext, useImperativeHandle } from 'react';\nimport { DndContext, useDrop, useDrag, useDragLayer, DndProvider } from 'react-dnd';\nimport { HTML5Backend, getEmptyImage } from 'react-dnd-html5-backend';\nimport { useIntl, IntlProvider } from 'react-intl';\nimport { createUseStyles, ThemeProvider } from 'react-jss';\nimport { useSelector, useDispatch, useStore, Provider } from 'react-redux';\nimport shortid from 'shortid';\nimport { createSelector, createSlice, configureStore } from '@reduxjs/toolkit';\nimport sort from 'fast-sort';\nimport FuzzySearch from 'fuzzy-search';\nimport watch from 'redux-watch';\nimport filesize from 'filesize';\nimport ExactTrie from 'exact-trie';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport classnames from 'classnames';\nimport Box from '@material-ui/core/Box';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport hotkeys from 'hotkeys-js';\nimport Breadcrumbs from '@material-ui/core/Breadcrumbs';\nimport Button from '@material-ui/core/Button';\nimport Menu from '@material-ui/core/Menu';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Typography from '@material-ui/core/Typography';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport TextField from '@material-ui/core/TextField';\nimport AutoSizer from 'react-virtualized-auto-sizer';\nimport { VariableSizeGrid, FixedSizeList } from 'react-window';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nvar useDebounce = function useDebounce(value, delay) {\n  var _useState = useState(value),\n    debouncedValue = _useState[0],\n    setDebouncedValue = _useState[1];\n  useEffect(function () {\n    var handler = setTimeout(function () {\n      setDebouncedValue(value);\n    }, delay);\n    return function () {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n  return [debouncedValue, setDebouncedValue];\n};\nvar UNINITIALIZED_SENTINEL = {};\nvar useStaticValue = function useStaticValue(factory) {\n  var valueRef = useRef(UNINITIALIZED_SENTINEL);\n  if (valueRef.current === UNINITIALIZED_SENTINEL) valueRef.current = factory();\n  return valueRef.current;\n};\nvar useInstanceVariable = function useInstanceVariable(value) {\n  var ref = useRef(value);\n  useEffect(function () {\n    ref.current = value;\n  }, [ref, value]);\n  return ref;\n};\nvar Logger = /*#__PURE__*/function () {\n  function Logger() {}\n  Logger.error = function error() {\n    var _console;\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    // eslint-disable-next-line no-console\n    (_console = console).error.apply(_console, ['[Chonky runtime error]'].concat(args));\n  };\n  Logger.warn = function warn() {\n    var _console2;\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    // eslint-disable-next-line no-console\n    (_console2 = console).warn.apply(_console2, ['[Chonky runtime warning]'].concat(args));\n  };\n  Logger.debug = function debug() {\n    var _console3;\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    // eslint-disable-next-line no-console\n    (_console3 = console).debug.apply(_console3, ['[Chonky runtime debug]'].concat(args));\n  };\n  Logger.formatBullets = function formatBullets(bullets) {\n    return \"\\n- \" + bullets.join('\\n- ');\n  };\n  return Logger;\n}();\nvar FileHelper = /*#__PURE__*/function () {\n  function FileHelper() {}\n  FileHelper.isDirectory = function isDirectory(file) {\n    // Not a directory by default\n    return !!file && file.isDir === true;\n  };\n  FileHelper.isHidden = function isHidden(file) {\n    // Not hidden by default\n    return !!file && file.isHidden === true;\n  };\n  FileHelper.isSymlink = function isSymlink(file) {\n    // Not a symlink by default\n    return !!file && file.isSymlink === true;\n  };\n  FileHelper.isEncrypted = function isEncrypted(file) {\n    // Not encrypted by default\n    return !!file && file.isEncrypted === true;\n  };\n  FileHelper.isClickable = function isClickable(file) {\n    // Clickable by default\n    return !!file;\n  };\n  FileHelper.isOpenable = function isOpenable(file) {\n    // Openable by default\n    return !!file && file.openable !== false;\n  };\n  FileHelper.isSelectable = function isSelectable(file) {\n    // Selectable by default\n    return !!file && file.selectable !== false;\n  };\n  FileHelper.isDraggable = function isDraggable(file) {\n    // File & folders are draggable by default, `null` is not\n    return !!file && file.draggable !== false;\n  };\n  FileHelper.isDroppable = function isDroppable(file) {\n    // Folders are droppable by default, files are not\n    if (!file) return false;\n    if (file.isDir && file.droppable !== false) return true;\n    return file.droppable === true;\n  };\n  FileHelper.isDndOpenable = function isDndOpenable(file) {\n    // Folders are DnD openable by default, files are not\n    if (!FileHelper.isOpenable(file)) return false;\n    if (file.isDir && file.dndOpenable !== false) return true;\n    return file.dndOpenable === true;\n  };\n  FileHelper.getModDate = function getModDate(file) {\n    if (!file || file.modDate === null || file.modDate === undefined) return null;\n    return FileHelper.parseDate(file.modDate);\n  };\n  FileHelper.parseDate = function parseDate(maybeDate) {\n    if (typeof maybeDate === 'string' || typeof maybeDate === 'number') {\n      // We allow users to provide string and numerical representations of dates.\n      try {\n        return new Date(maybeDate);\n      } catch (error) {\n        Logger.error(\"Could not convert provided string/number into a date: \" + error.message + \" \", 'Invalid value:', maybeDate);\n      }\n    }\n    if (maybeDate instanceof Date && !isNaN(maybeDate.getTime())) {\n      // We only allow valid dates objects\n      return maybeDate;\n    } // If we have an invalid date representation, we just return null.\n\n    Logger.warn('Unsupported date representation:', maybeDate);\n    return null;\n  };\n  FileHelper.getChildrenCount = function getChildrenCount(file) {\n    if (!file || typeof file.childrenCount !== 'number') return null;\n    return file.childrenCount;\n  };\n  return FileHelper;\n}();\nvar sanitizeInputArray = function sanitizeInputArray(mode, rawArray) {\n  var sanitizedFiles = [];\n  var errorMessages = [];\n  if ((mode === 'folderChain' || mode === 'fileActions') && !rawArray) ;else if (!Array.isArray(rawArray)) {\n    errorMessages.push(\"Expected \\\"\" + mode + \"\\\" prop to be an array, got \\\"\" + typeof rawArray + \"\\\" instead.\");\n  } else {\n    var nonObjectFileCount = 0;\n    var missingFieldFileCount = 0;\n    var seenIds = new Set();\n    var duplicateIds = new Set();\n    for (var i = 0; i < rawArray.length; ++i) {\n      var item = rawArray[i];\n      if (!item) {\n        if (mode === 'fileActions') nonObjectFileCount++;else sanitizedFiles.push(null);\n      } else if (typeof item !== 'object') {\n        nonObjectFileCount++;\n      } else {\n        if (!item.id || mode !== 'fileActions' && !item.name) {\n          missingFieldFileCount++;\n        } else if (seenIds.has(item.id)) {\n          duplicateIds.add(item.id);\n        } else {\n          seenIds.add(item.id);\n          sanitizedFiles.push(item);\n        }\n      }\n    }\n    if (nonObjectFileCount) {\n      errorMessages.push(\"Detected \" + nonObjectFileCount + \" file(s) of invalid type. Remember \" + \"that \\\"files\\\" array should contain either objects or nulls.\");\n    }\n    if (missingFieldFileCount) {\n      errorMessages.push(\"Detected \" + missingFieldFileCount + \" file(s) that are missing the \" + \"required fields. Remember that file object should define an \" + \"\\\"id\\\" and a \\\"name\\\".\");\n    }\n    if (duplicateIds.size > 0) {\n      var repeatedIdsString = '\"' + Array.from(duplicateIds).join('\", \"') + '\"';\n      errorMessages.push(\"Detected \" + duplicateIds.size + \" file IDs that are used multiple \" + \"times. Remember that each file should have a unique IDs. The \" + (\"following IDs were seen multiple times: \" + repeatedIdsString));\n    }\n  }\n  if (errorMessages.length > 0) {\n    var errorMessageString = '\\n- ' + errorMessages.join('\\n- ');\n    var arrayString;\n    var itemString;\n    if (mode === 'folderChain') {\n      arrayString = 'folder chain';\n      itemString = 'files';\n    } else if (mode === 'fileActions') {\n      arrayString = 'file actions';\n      itemString = 'file actions';\n    } else {\n      // mode === 'files'\n      arrayString = 'files';\n      itemString = 'files';\n    }\n    Logger.error(\"Errors were detected when sanitizing the \" + arrayString + \" array. \" + (\"Offending \" + itemString + \" were removed from the array. Summary of \") + (\"validation errors: \" + errorMessageString));\n  }\n  return {\n    sanitizedArray: sanitizedFiles,\n    errorMessages: errorMessages\n  };\n};\n\n/**\r\n * We have option IDs in a separate file to avoid circular deps...\r\n */\nvar OptionIds = {\n  ShowHiddenFiles: 'show_hidden_files',\n  ShowFoldersFirst: 'show_folders_first',\n  DarkMode: 'dark_mode'\n};\nvar SortOrder;\n(function (SortOrder) {\n  SortOrder[\"ASC\"] = \"asc\";\n  SortOrder[\"DESC\"] = \"desc\";\n})(SortOrder || (SortOrder = {}));\nvar selectInstanceId = function selectInstanceId(state) {\n  return state.instanceId;\n};\nvar selectExternalFileActionHandler = function selectExternalFileActionHandler(state) {\n  return state.externalFileActionHandler;\n};\nvar selectFileActionMap = function selectFileActionMap(state) {\n  return state.fileActionMap;\n};\nvar selectFileActionIds = function selectFileActionIds(state) {\n  return state.fileActionIds;\n};\nvar selectFileActionData = function selectFileActionData(fileActionId) {\n  return function (state) {\n    return selectFileActionMap(state)[fileActionId];\n  };\n};\nvar selectToolbarItems = function selectToolbarItems(state) {\n  return state.toolbarItems;\n};\nvar selectContextMenuItems = function selectContextMenuItems(state) {\n  return state.contextMenuItems;\n};\nvar selectFolderChain = function selectFolderChain(state) {\n  return state.folderChain;\n};\nvar selectCurrentFolder = function selectCurrentFolder(state) {\n  var folderChain = selectFolderChain(state);\n  var currentFolder = folderChain.length > 0 ? folderChain[folderChain.length - 1] : null;\n  return currentFolder;\n};\nvar selectParentFolder = function selectParentFolder(state) {\n  var folderChain = selectFolderChain(state);\n  var parentFolder = folderChain.length > 1 ? folderChain[folderChain.length - 2] : null;\n  return parentFolder;\n};\nvar selectRawFiles = function selectRawFiles(state) {\n  return state.rawFiles;\n};\nvar selectFileMap = function selectFileMap(state) {\n  return state.fileMap;\n};\nvar selectCleanFileIds = function selectCleanFileIds(state) {\n  return state.cleanFileIds;\n};\nvar selectFileData = function selectFileData(fileId) {\n  return function (state) {\n    return fileId ? selectFileMap(state)[fileId] : null;\n  };\n};\nvar selectHiddenFileIdMap = function selectHiddenFileIdMap(state) {\n  return state.hiddenFileIdMap;\n};\nvar selectHiddenFileCount = function selectHiddenFileCount(state) {\n  return Object.keys(selectHiddenFileIdMap(state)).length;\n};\nvar selectFocusSearchInput = function selectFocusSearchInput(state) {\n  return state.focusSearchInput;\n};\nvar selectSearchString = function selectSearchString(state) {\n  return state.searchString;\n};\nvar selectSelectionMap = function selectSelectionMap(state) {\n  return state.selectionMap;\n};\nvar selectSelectedFileIds = function selectSelectedFileIds(state) {\n  return Object.keys(selectSelectionMap(state));\n};\nvar selectSelectionSize = function selectSelectionSize(state) {\n  return selectSelectedFileIds(state).length;\n};\nvar selectIsFileSelected = function selectIsFileSelected(fileId) {\n  return function (state) {\n    return !!fileId && !!selectSelectionMap(state)[fileId];\n  };\n};\nvar selectSelectedFiles = function selectSelectedFiles(state) {\n  var fileMap = selectFileMap(state);\n  return Object.keys(selectSelectionMap(state)).map(function (id) {\n    return fileMap[id];\n  });\n};\nvar selectSelectedFilesForAction = function selectSelectedFilesForAction(fileActionId) {\n  return function (state) {\n    var fileActionMap = state.fileActionMap;\n    var action = fileActionMap[fileActionId];\n    if (!action || !action.requiresSelection) return undefined;\n    return getSelectedFiles(state, action.fileFilter);\n  };\n};\nvar selectSelectedFilesForActionCount = function selectSelectedFilesForActionCount(fileActionId) {\n  return function (state) {\n    var _getSelectedFilesForA;\n    return (_getSelectedFilesForA = getSelectedFilesForAction(state, fileActionId)) == null ? void 0 : _getSelectedFilesForA.length;\n  };\n};\nvar selectDisableSelection = function selectDisableSelection(state) {\n  return state.disableSelection;\n};\nvar selectFileViewConfig = function selectFileViewConfig(state) {\n  return state.fileViewConfig;\n};\nvar selectSortActionId = function selectSortActionId(state) {\n  return state.sortActionId;\n};\nvar selectSortOrder = function selectSortOrder(state) {\n  return state.sortOrder;\n};\nvar selectOptionMap = function selectOptionMap(state) {\n  return state.optionMap;\n};\nvar selectOptionValue = function selectOptionValue(optionId) {\n  return function (state) {\n    return selectOptionMap(state)[optionId];\n  };\n};\nvar selectThumbnailGenerator = function selectThumbnailGenerator(state) {\n  return state.thumbnailGenerator;\n};\nvar selectDoubleClickDelay = function selectDoubleClickDelay(state) {\n  return state.doubleClickDelay;\n};\nvar selectIsDnDDisabled = function selectIsDnDDisabled(state) {\n  return state.disableDragAndDrop;\n};\nvar selectClearSelectionOnOutsideClick = function selectClearSelectionOnOutsideClick(state) {\n  return state.clearSelectionOnOutsideClick;\n};\nvar selectContextMenuMounted = function selectContextMenuMounted(state) {\n  return state.contextMenuMounted;\n};\nvar selectContextMenuConfig = function selectContextMenuConfig(state) {\n  return state.contextMenuConfig;\n};\nvar selectContextMenuTriggerFile = function selectContextMenuTriggerFile(state) {\n  var _fileMap$config$trigg;\n  var config = selectContextMenuConfig(state);\n  if (!config || !config.triggerFileId) return null;\n  var fileMap = selectFileMap(state);\n  return (_fileMap$config$trigg = fileMap[config.triggerFileId]) != null ? _fileMap$config$trigg : null;\n}; // Raw selectors\n\nvar getFileActionMap = function getFileActionMap(state) {\n  return state.fileActionMap;\n};\nvar getOptionMap = function getOptionMap(state) {\n  return state.optionMap;\n};\nvar getFileMap = function getFileMap(state) {\n  return state.fileMap;\n};\nvar getFileIds = function getFileIds(state) {\n  return state.fileIds;\n};\nvar getCleanFileIds = function getCleanFileIds(state) {\n  return state.cleanFileIds;\n};\nvar getSortActionId = function getSortActionId(state) {\n  return state.sortActionId;\n};\nvar getSortOrder = function getSortOrder(state) {\n  return state.sortOrder;\n};\nvar getSearchString = function getSearchString(state) {\n  return state.searchString;\n};\nvar _getLastClick = function _getLastClick(state) {\n  return state.lastClick;\n}; // Memoized selectors\n\nvar makeGetAction = function makeGetAction(fileActionSelector) {\n  return createSelector([getFileActionMap, fileActionSelector], function (fileActionMap, fileActionId) {\n    return fileActionId && fileActionMap[fileActionId] ? fileActionMap[fileActionId] : null;\n  });\n};\nvar makeGetOptionValue = function makeGetOptionValue(optionId, defaultValue) {\n  if (defaultValue === void 0) {\n    defaultValue = undefined;\n  }\n  return createSelector([getOptionMap], function (optionMap) {\n    var value = optionMap[optionId];\n    if (value === undefined) {\n      return defaultValue;\n    }\n    return value;\n  });\n};\nvar makeGetFiles = function makeGetFiles(fileIdsSelector) {\n  return createSelector([getFileMap, fileIdsSelector], function (fileMap, fileIds) {\n    return fileIds.map(function (fileId) {\n      return fileId && fileMap[fileId] ? fileMap[fileId] : null;\n    });\n  });\n};\nvar getSortedFileIds = /*#__PURE__*/createSelector([getFileIds, getSortOrder, /*#__PURE__*/makeGetFiles(getFileIds), /*#__PURE__*/makeGetAction(getSortActionId), /*#__PURE__*/makeGetOptionValue(OptionIds.ShowFoldersFirst, false)], function (fileIds, sortOrder, files, sortAction, showFolderFirst) {\n  if (!sortAction) {\n    // We allow users to set the sort action ID to `null` if they want to use their\n    // own sorting mechanisms instead of relying on Chonky built-in sort.\n    return fileIds;\n  }\n  var prepareSortKeySelector = function prepareSortKeySelector(selector) {\n    return function (file) {\n      return selector(file);\n    };\n  };\n  var sortFunctions = [];\n  if (showFolderFirst) {\n    // If option is undefined (relevant actions is not enabled), we don't show\n    // folders first.\n    sortFunctions.push({\n      desc: prepareSortKeySelector(FileHelper.isDirectory)\n    });\n  }\n  if (sortAction.sortKeySelector) {\n    var _sortFunctions$push;\n    var configKeyName = sortOrder === SortOrder.ASC ? 'asc' : 'desc';\n    sortFunctions.push((_sortFunctions$push = {}, _sortFunctions$push[configKeyName] = prepareSortKeySelector(sortAction.sortKeySelector), _sortFunctions$push));\n  }\n  if (sortFunctions.length === 0) return fileIds; // We copy the array because `fast-sort` mutates it\n\n  var sortedFileIds = sort([].concat(files)).by(sortFunctions).map(function (file) {\n    return file ? file.id : null;\n  });\n  return sortedFileIds;\n});\nvar getSearcher = /*#__PURE__*/createSelector([/*#__PURE__*/makeGetFiles(getCleanFileIds)], function (cleanFiles) {\n  return new FuzzySearch(cleanFiles, ['name'], {\n    caseSensitive: false\n  });\n});\nvar getSearchFilteredFileIds = /*#__PURE__*/createSelector([getCleanFileIds, getSearchString, getSearcher], function (cleanFileIds, searchString, searcher) {\n  return searchString ? searcher.search(searchString).map(function (f) {\n    return f.id;\n  }) : cleanFileIds;\n});\nvar getHiddenFileIdMap = /*#__PURE__*/createSelector([getSearchFilteredFileIds, /*#__PURE__*/makeGetFiles(getCleanFileIds), /*#__PURE__*/makeGetOptionValue(OptionIds.ShowHiddenFiles)], function (searchFilteredFileIds, cleanFiles, showHiddenFiles) {\n  var searchFilteredFileIdsSet = new Set(searchFilteredFileIds);\n  var hiddenFileIdMap = {};\n  cleanFiles.forEach(function (file) {\n    if (!file) return;else if (!searchFilteredFileIdsSet.has(file.id)) {\n      // Hidden by seach\n      hiddenFileIdMap[file.id] = true;\n    } else if (!showHiddenFiles && FileHelper.isHidden(file)) {\n      // Hidden by options\n      hiddenFileIdMap[file.id] = true;\n    }\n  });\n  return hiddenFileIdMap;\n});\nvar getDisplayFileIds = /*#__PURE__*/createSelector([getSortedFileIds, getHiddenFileIdMap], /** Returns files that will actually be shown to the user. */\nfunction (sortedFileIds, hiddenFileIdMap) {\n  return sortedFileIds.filter(function (id) {\n    return !id || !hiddenFileIdMap[id];\n  });\n});\nvar getLastClickIndex = /*#__PURE__*/createSelector([_getLastClick, getSortedFileIds], /** Returns the last click index after ensuring it is actually still valid. */\nfunction (lastClick, displayFileIds) {\n  if (!lastClick || lastClick.index > displayFileIds.length - 1 || lastClick.fileId != displayFileIds[lastClick.index]) {\n    return null;\n  }\n  return lastClick.index;\n});\nvar selectors = {\n  // Raw selectors\n  getFileActionMap: getFileActionMap,\n  getOptionMap: getOptionMap,\n  getFileMap: getFileMap,\n  getFileIds: getFileIds,\n  getCleanFileIds: getCleanFileIds,\n  getSortActionId: getSortActionId,\n  getSortOrder: getSortOrder,\n  getSearchString: getSearchString,\n  _getLastClick: _getLastClick,\n  // Memoized selectors\n  getSortedFileIds: getSortedFileIds,\n  getSearcher: getSearcher,\n  getSearchFilteredFileIds: getSearchFilteredFileIds,\n  getHiddenFileIdMap: getHiddenFileIdMap,\n  getDisplayFileIds: getDisplayFileIds,\n  getLastClickIndex: getLastClickIndex,\n  // Parametrized selectors\n  makeGetAction: makeGetAction,\n  makeGetOptionValue: makeGetOptionValue,\n  makeGetFiles: makeGetFiles\n}; // Selectors meant to be used outside of Redux code\n\nvar getFileData = function getFileData(state, fileId) {\n  return fileId ? selectFileMap(state)[fileId] : null;\n};\nvar getIsFileSelected = function getIsFileSelected(state, file) {\n  // !!! We deliberately don't use `FileHelper.isSelectable` here as we want to\n  //     reflect the state of Redux store accurately.\n  return !!selectSelectionMap(state)[file.id];\n};\nvar getSelectedFiles = function getSelectedFiles(state) {\n  var fileMap = state.fileMap,\n    selectionMap = state.selectionMap;\n  var selectedFiles = Object.keys(selectionMap).map(function (id) {\n    return fileMap[id];\n  });\n  for (var _len = arguments.length, filters = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    filters[_key - 1] = arguments[_key];\n  }\n  var filteredSelectedFiles = filters.reduce(function (prevFiles, filter) {\n    return filter ? prevFiles.filter(filter) : prevFiles;\n  }, selectedFiles);\n  return filteredSelectedFiles;\n};\nvar getSelectedFilesForAction = function getSelectedFilesForAction(state, fileActionId) {\n  return selectSelectedFilesForAction(fileActionId)(state);\n};\n\n/**\r\n * Merges multiple file action arrays into one while removing duplicates\r\n */\n\nvar mergeFileActionsArrays = function mergeFileActionsArrays() {\n  var _Array;\n  var seenActionIds = new Set();\n  var addToSeen = function addToSeen(a) {\n    return !!seenActionIds.add(a.id);\n  };\n  var wasNotSeen = function wasNotSeen(a) {\n    return !seenActionIds.has(a.id);\n  };\n  for (var _len = arguments.length, fileActionArrays = new Array(_len), _key = 0; _key < _len; _key++) {\n    fileActionArrays[_key] = arguments[_key];\n  }\n  var duplicateFreeArrays = fileActionArrays.map(function (arr) {\n    var duplicateFreeArray = arr.filter(wasNotSeen);\n    duplicateFreeArray.map(addToSeen);\n    return duplicateFreeArray;\n  });\n  return (_Array = new Array()).concat.apply(_Array, duplicateFreeArrays);\n};\nvar thunkUpdateRawFileActions = function thunkUpdateRawFileActions(rawFileActions, disableDefaultFileActions) {\n  return function (dispatch) {\n    var _sanitizeInputArray = sanitizeInputArray('fileActions', rawFileActions),\n      sanitizedArray = _sanitizeInputArray.sanitizedArray,\n      errorMessages = _sanitizeInputArray.errorMessages; // Add default actions unless user disabled them\n\n    var defaultActionsToAdd;\n    if (Array.isArray(disableDefaultFileActions)) {\n      var disabledActionIds = new Set(disableDefaultFileActions);\n      defaultActionsToAdd = DefaultFileActions.filter(function (action) {\n        return !disabledActionIds.has(action.id);\n      });\n    } else if (disableDefaultFileActions) {\n      defaultActionsToAdd = [];\n    } else {\n      defaultActionsToAdd = DefaultFileActions;\n    }\n    var fileActions = mergeFileActionsArrays(sanitizedArray, EssentialFileActions, defaultActionsToAdd);\n    var optionDefaults = {};\n    fileActions.map(function (a) {\n      return a.option ? optionDefaults[a.option.id] = a.option.defaultValue : null;\n    });\n    dispatch(reduxActions.setRawFileActions(rawFileActions));\n    dispatch(reduxActions.setFileActionsErrorMessages(errorMessages));\n    dispatch(reduxActions.setFileActions(fileActions));\n    dispatch(reduxActions.setOptionDefaults(optionDefaults));\n    dispatch(thunkUpdateToolbarNContextMenuItems(fileActions));\n  };\n};\nvar thunkUpdateToolbarNContextMenuItems = function thunkUpdateToolbarNContextMenuItems(fileActions) {\n  return function (dispatch) {\n    var excludedToolbarFileActionIds = new Set([\n    // TODO: Move decision to exclude actions somewhere else, as users' custom\n    //  components might not give these actions special treatment like Chonky does.\n    ChonkyActions.OpenParentFolder.id]);\n    var toolbarItems = [];\n    var seenToolbarGroups = {};\n    var contextMenuItems = [];\n    var seenContextMenuGroups = {};\n    var getGroup = function getGroup(itemArray, seenMap, groupName) {\n      if (seenMap[groupName]) return seenMap[groupName];\n      var group = {\n        name: groupName,\n        fileActionIds: []\n      };\n      itemArray.push(group);\n      seenMap[groupName] = group;\n      return group;\n    };\n    for (var _iterator = _createForOfIteratorHelperLoose(fileActions), _step; !(_step = _iterator()).done;) {\n      var action = _step.value;\n      var button = action.button;\n      if (!button) continue;\n      if (button.toolbar && !excludedToolbarFileActionIds.has(action.id)) {\n        if (button.group) {\n          var group = getGroup(toolbarItems, seenToolbarGroups, button.group);\n          group.fileActionIds.push(action.id);\n        } else {\n          toolbarItems.push(action.id);\n        }\n      }\n      if (button.contextMenu) {\n        if (button.group) {\n          var _group = getGroup(contextMenuItems, seenContextMenuGroups, button.group);\n          _group.fileActionIds.push(action.id);\n        } else {\n          contextMenuItems.push(action.id);\n        }\n      }\n    }\n    dispatch(reduxActions.updateFileActionMenuItems([toolbarItems, contextMenuItems]));\n  };\n};\nvar thunkUpdateDefaultFileViewActionId = function thunkUpdateDefaultFileViewActionId(fileActionId) {\n  return function (dispatch, getState) {\n    var _getState = getState(),\n      fileActionMap = _getState.fileActionMap;\n    var action = fileActionId ? fileActionMap[fileActionId] : null;\n    if (action && action.fileViewConfig) {\n      dispatch(reduxActions.setFileViewConfig(action.fileViewConfig));\n    }\n  };\n};\nvar thunkActivateSortAction = function thunkActivateSortAction(fileActionId) {\n  return function (dispatch, getState) {\n    if (!fileActionId) return;\n    var _getState2 = getState(),\n      oldActionId = _getState2.sortActionId,\n      oldOrder = _getState2.sortOrder,\n      fileActionMap = _getState2.fileActionMap;\n    var action = fileActionMap[fileActionId];\n    if (!action || !action.sortKeySelector) return;\n    var order = oldOrder === SortOrder.ASC ? SortOrder.DESC : SortOrder.ASC;\n    if (oldActionId !== fileActionId) {\n      order = SortOrder.ASC;\n    }\n    dispatch(reduxActions.setSort({\n      actionId: fileActionId,\n      order: order\n    }));\n  };\n};\nvar thunkApplySelectionTransform = function thunkApplySelectionTransform(action) {\n  return function (dispatch, getState) {\n    var selectionTransform = action.selectionTransform;\n    if (!selectionTransform) return;\n    var state = getState();\n    var prevSelection = new Set(Object.keys(selectSelectionMap(state)));\n    var hiddenFileIds = new Set(Object.keys(selectHiddenFileIdMap(state)));\n    var newSelection = selectionTransform({\n      prevSelection: prevSelection,\n      fileIds: selectCleanFileIds(state),\n      fileMap: selectFileMap(state),\n      hiddenFileIds: hiddenFileIds\n    });\n    if (!newSelection) return;\n    if (newSelection.size === 0) {\n      dispatch(reduxActions.clearSelection());\n    } else {\n      dispatch(reduxActions.selectFiles({\n        fileIds: Array.from(newSelection),\n        reset: true\n      }));\n    }\n  };\n};\n\n/**\r\n * Thunk that dispatches actions to the external (user-provided) action handler.\r\n */\n\nvar thunkDispatchFileAction = function thunkDispatchFileAction(data) {\n  return function (_dispatch, getState) {\n    Logger.debug(\"FILE ACTION DISPATCH: [\" + data.id + \"]\", 'data:', data);\n    var state = getState();\n    var action = selectFileActionMap(state)[data.id];\n    var externalFileActionHandler = selectExternalFileActionHandler(state);\n    if (action) {\n      if (externalFileActionHandler) {\n        Promise.resolve(externalFileActionHandler(data))[\"catch\"](function (error) {\n          return Logger.error(\"User-defined file action handler threw an error: \" + error.message);\n        });\n      }\n    } else {\n      Logger.warn(\"Internal components dispatched the \\\"\" + data.id + \"\\\" file action, but such \" + \"action was not registered.\");\n    }\n  };\n};\n/**\r\n * Thunk that is used by internal components (and potentially the user) to \"request\"\r\n * actions. When action is requested, Chonky \"prepares\" the action data by extracting it\r\n * from Redux state. Once action data is ready, Chonky executes some side effect and/or\r\n * dispatches the action to the external action handler.\r\n */\n\nvar thunkRequestFileAction = function thunkRequestFileAction(action, payload) {\n  return function (dispatch, getState) {\n    Logger.debug(\"FILE ACTION REQUEST: [\" + action.id + \"]\", 'action:', action, 'payload:', payload);\n    var state = getState();\n    var instanceId = selectInstanceId(state);\n    if (!selectFileActionMap(state)[action.id]) {\n      Logger.warn(\"The action \\\"\" + action.id + \"\\\" was requested, but it is not registered. The \" + \"action will still be dispatched, but this might indicate a bug in \" + \"the code. Please register your actions by passing them to \" + \"\\\"fileActions\\\" prop.\");\n    } // Determine files for the action if action requires selection\n\n    var selectedFiles = selectSelectedFiles(state);\n    var selectedFilesForAction = action.fileFilter ? selectedFiles.filter(action.fileFilter) : selectedFiles;\n    if (action.requiresSelection && selectedFilesForAction.length === 0) {\n      Logger.warn(\"Internal components requested the \\\"\" + action.id + \"\\\" file \" + \"action, but the selection for this action was empty. This \" + \"might a bug in the code of the presentational components.\");\n      return;\n    }\n    var contextMenuTriggerFile = selectContextMenuTriggerFile(state);\n    var actionState = {\n      instanceId: instanceId,\n      selectedFiles: selectedFiles,\n      selectedFilesForAction: selectedFilesForAction,\n      contextMenuTriggerFile: contextMenuTriggerFile\n    }; // === Update sort state if necessary\n\n    var sortKeySelector = action.sortKeySelector;\n    if (sortKeySelector) dispatch(thunkActivateSortAction(action.id)); // === Update file view state if necessary\n\n    var fileViewConfig = action.fileViewConfig;\n    if (fileViewConfig) dispatch(reduxActions.setFileViewConfig(fileViewConfig)); // === Update option state if necessary\n\n    var option = action.option;\n    if (option) dispatch(reduxActions.toggleOption(option.id)); // === Apply selection transform if necessary\n\n    var selectionTransform = action.selectionTransform;\n    if (selectionTransform) dispatch(thunkApplySelectionTransform(action)); // Apply the effect\n\n    var effect = action.effect;\n    var maybeEffectPromise = undefined;\n    if (effect) {\n      try {\n        maybeEffectPromise = effect({\n          action: action,\n          payload: payload,\n          state: actionState,\n          reduxDispatch: dispatch,\n          getReduxState: getState\n        });\n      } catch (error) {\n        Logger.error(\"User-defined effect function for action \" + action.id + \" threw an \" + (\"error: \" + error.message));\n      }\n    } // Dispatch the action to user code. Deliberately call it after all other\n    // operations are over.\n\n    return Promise.resolve(maybeEffectPromise).then(function (effectResult) {\n      var data = {\n        id: action.id,\n        action: action,\n        payload: payload,\n        state: actionState\n      };\n      triggerDispatchAfterEffect(dispatch, data, effectResult);\n    })[\"catch\"](function (error) {\n      Logger.error(\"User-defined effect function for action \" + action.id + \" returned a \" + (\"promise that was rejected: \" + error.message));\n      var data = {\n        id: action.id,\n        action: action,\n        payload: payload,\n        state: actionState\n      };\n      triggerDispatchAfterEffect(dispatch, data, undefined);\n    });\n  };\n};\nvar triggerDispatchAfterEffect = function triggerDispatchAfterEffect(dispatch, data, effectResult) {\n  var preventDispatch = effectResult === true;\n  if (!preventDispatch) dispatch(thunkDispatchFileAction(data));\n};\nvar FileViewMode;\n(function (FileViewMode) {\n  FileViewMode[\"List\"] = \"list\";\n  FileViewMode[\"Compact\"] = \"compact\";\n  FileViewMode[\"Grid\"] = \"grid\";\n})(FileViewMode || (FileViewMode = {}));\nvar ChonkyIconName;\n(function (ChonkyIconName) {\n  // Misc\n  ChonkyIconName[\"loading\"] = \"loading\";\n  ChonkyIconName[\"dropdown\"] = \"dropdown\";\n  ChonkyIconName[\"placeholder\"] = \"placeholder\"; // File Actions: Drag & drop\n\n  ChonkyIconName[\"dndDragging\"] = \"dndDragging\";\n  ChonkyIconName[\"dndCanDrop\"] = \"dndCanDrop\";\n  ChonkyIconName[\"dndCannotDrop\"] = \"dndCannotDrop\"; // File Actions: File operations\n\n  ChonkyIconName[\"openFiles\"] = \"openFiles\";\n  ChonkyIconName[\"openParentFolder\"] = \"openParentFolder\";\n  ChonkyIconName[\"copy\"] = \"copy\";\n  ChonkyIconName[\"paste\"] = \"paste\";\n  ChonkyIconName[\"share\"] = \"share\";\n  ChonkyIconName[\"search\"] = \"search\";\n  ChonkyIconName[\"selectAllFiles\"] = \"selectAllFiles\";\n  ChonkyIconName[\"clearSelection\"] = \"clearSelection\"; // File Actions: Sorting & options\n\n  ChonkyIconName[\"sortAsc\"] = \"sortAsc\";\n  ChonkyIconName[\"sortDesc\"] = \"sortDesc\";\n  ChonkyIconName[\"toggleOn\"] = \"toggleOn\";\n  ChonkyIconName[\"toggleOff\"] = \"toggleOff\"; // File Actions: File Views\n\n  ChonkyIconName[\"list\"] = \"list\";\n  ChonkyIconName[\"compact\"] = \"compact\";\n  ChonkyIconName[\"smallThumbnail\"] = \"smallThumbnail\";\n  ChonkyIconName[\"largeThumbnail\"] = \"largeThumbnail\"; // File Actions: Unsorted\n\n  ChonkyIconName[\"folder\"] = \"folder\";\n  ChonkyIconName[\"folderCreate\"] = \"folderCreate\";\n  ChonkyIconName[\"folderOpen\"] = \"folderOpen\";\n  ChonkyIconName[\"folderChainSeparator\"] = \"folderChainSeparator\";\n  ChonkyIconName[\"download\"] = \"download\";\n  ChonkyIconName[\"upload\"] = \"upload\";\n  ChonkyIconName[\"trash\"] = \"trash\";\n  ChonkyIconName[\"fallbackIcon\"] = \"fallbackIcon\"; // File modifiers\n\n  ChonkyIconName[\"symlink\"] = \"symlink\";\n  ChonkyIconName[\"hidden\"] = \"hidden\"; // Generic file types\n\n  ChonkyIconName[\"file\"] = \"file\";\n  ChonkyIconName[\"license\"] = \"license\";\n  ChonkyIconName[\"code\"] = \"code\";\n  ChonkyIconName[\"config\"] = \"config\";\n  ChonkyIconName[\"model\"] = \"model\";\n  ChonkyIconName[\"database\"] = \"database\";\n  ChonkyIconName[\"text\"] = \"text\";\n  ChonkyIconName[\"archive\"] = \"archive\";\n  ChonkyIconName[\"image\"] = \"image\";\n  ChonkyIconName[\"video\"] = \"video\";\n  ChonkyIconName[\"info\"] = \"info\";\n  ChonkyIconName[\"key\"] = \"key\";\n  ChonkyIconName[\"lock\"] = \"lock\";\n  ChonkyIconName[\"music\"] = \"music\";\n  ChonkyIconName[\"terminal\"] = \"terminal\";\n  ChonkyIconName[\"users\"] = \"users\"; // OS file types\n\n  ChonkyIconName[\"linux\"] = \"linux\";\n  ChonkyIconName[\"ubuntu\"] = \"ubuntu\";\n  ChonkyIconName[\"windows\"] = \"windows\"; // Programming language file types\n\n  ChonkyIconName[\"rust\"] = \"rust\";\n  ChonkyIconName[\"python\"] = \"python\";\n  ChonkyIconName[\"nodejs\"] = \"nodejs\";\n  ChonkyIconName[\"php\"] = \"php\"; // Development tools file types\n\n  ChonkyIconName[\"git\"] = \"git\"; // Brands file types\n\n  ChonkyIconName[\"adobe\"] = \"adobe\"; // Other program file types\n\n  ChonkyIconName[\"pdf\"] = \"pdf\";\n  ChonkyIconName[\"excel\"] = \"excel\";\n  ChonkyIconName[\"word\"] = \"word\";\n  ChonkyIconName[\"flash\"] = \"flash\";\n})(ChonkyIconName || (ChonkyIconName = {}));\nvar defineFileAction = function defineFileAction(action, effect) {\n  if (action.__payloadType !== undefined && (action.hotkeys || action.button)) {\n    var errorMessage = \"Invalid definition was provided for file action \\\"\" + action.id + \"\\\". Actions \" + \"that specify hotkeys or buttons cannot define a payload type. If \" + \"your application requires this functionality, define two actions \" + \"and chain them using effects.\";\n    Logger.error(errorMessage);\n    throw new Error(errorMessage);\n  }\n  action.effect = effect;\n  return action;\n};\n/**\r\n * Recursively check the current element and the parent elements, going bottom-up.\r\n * Returns the first element to match the predicate, otherwise returns null if such\r\n * element is not found.\r\n */\n\nvar findElementAmongAncestors = function findElementAmongAncestors(maybeElement, predicate) {\n  if (!maybeElement) return maybeElement;\n  if (predicate(maybeElement)) return maybeElement;\n  if (maybeElement.parentElement) {\n    return findElementAmongAncestors(maybeElement.parentElement, predicate);\n  }\n  return null;\n};\nvar elementIsInsideButton = function elementIsInsideButton(buttonCandidate) {\n  return !!findElementAmongAncestors(buttonCandidate, function (element) {\n    return element.tagName && element.tagName.toLowerCase() === 'button';\n  });\n};\nvar getValueOrFallback = function getValueOrFallback(value, fallback, desiredType) {\n  if (desiredType) {\n    return typeof value === desiredType ? value : fallback;\n  }\n  return value !== undefined ? value : fallback;\n};\nvar reduxThunks = {\n  selectRange: function selectRange(params) {\n    return function (dispatch, getState) {\n      var state = getState();\n      if (state.disableSelection) return;\n      var displayFileIds = selectors.getDisplayFileIds(state);\n      var fileIdsToSelect = displayFileIds.slice(params.rangeStart, params.rangeEnd + 1).filter(function (id) {\n        return id && FileHelper.isSelectable(state.fileMap[id]);\n      });\n      dispatch(reduxActions.selectFiles({\n        fileIds: fileIdsToSelect,\n        reset: !!params.reset\n      }));\n    };\n  }\n};\nvar EssentialActions = {\n  /**\r\n   * Action that is dispatched when the user clicks on a file entry using their mouse.\r\n   * Both single clicks and double clicks trigger this action.\r\n   */\n  MouseClickFile: /*#__PURE__*/defineFileAction({\n    id: 'mouse_click_file',\n    __payloadType: {}\n  }, function (_ref) {\n    var payload = _ref.payload,\n      reduxDispatch = _ref.reduxDispatch,\n      getReduxState = _ref.getReduxState;\n    if (payload.clickType === 'double') {\n      if (FileHelper.isOpenable(payload.file)) {\n        reduxDispatch(thunkRequestFileAction(ChonkyActions.OpenFiles, {\n          targetFile: payload.file,\n          // To simulate Windows Explorer and Nautilus behaviour,\n          // a double click on a file only opens that file even if\n          // there is a selection.\n          files: [payload.file]\n        }));\n      }\n    } else {\n      // We're dealing with a single click\n      var disableSelection = selectDisableSelection(getReduxState());\n      if (FileHelper.isSelectable(payload.file) && !disableSelection) {\n        if (payload.ctrlKey) {\n          // Multiple selection\n          reduxDispatch(reduxActions.toggleSelection({\n            fileId: payload.file.id,\n            exclusive: false\n          }));\n          reduxDispatch(reduxActions.setLastClickIndex({\n            index: payload.fileDisplayIndex,\n            fileId: payload.file.id\n          }));\n        } else if (payload.shiftKey) {\n          // Range selection\n          var lastClickIndex = selectors.getLastClickIndex(getReduxState());\n          if (typeof lastClickIndex === 'number') {\n            // We have the index of the previous click\n            var rangeStart = lastClickIndex;\n            var rangeEnd = payload.fileDisplayIndex;\n            if (rangeStart > rangeEnd) {\n              var _ref2 = [rangeEnd, rangeStart];\n              rangeStart = _ref2[0];\n              rangeEnd = _ref2[1];\n            }\n            reduxDispatch(reduxThunks.selectRange({\n              rangeStart: rangeStart,\n              rangeEnd: rangeEnd\n            }));\n          } else {\n            // Since we can't do a range selection, do a\n            // multiple selection\n            reduxDispatch(reduxActions.toggleSelection({\n              fileId: payload.file.id,\n              exclusive: false\n            }));\n            reduxDispatch(reduxActions.setLastClickIndex({\n              index: payload.fileDisplayIndex,\n              fileId: payload.file.id\n            }));\n          }\n        } else {\n          // Exclusive selection\n          reduxDispatch(reduxActions.toggleSelection({\n            fileId: payload.file.id,\n            exclusive: true\n          }));\n          reduxDispatch(reduxActions.setLastClickIndex({\n            index: payload.fileDisplayIndex,\n            fileId: payload.file.id\n          }));\n        }\n      } else {\n        if (!payload.ctrlKey && !disableSelection) {\n          reduxDispatch(reduxActions.clearSelection());\n        }\n        reduxDispatch(reduxActions.setLastClickIndex({\n          index: payload.fileDisplayIndex,\n          fileId: payload.file.id\n        }));\n      }\n    }\n  }),\n  /**\r\n   * Action that is dispatched when the user \"clicks\" on a file using their keyboard.\r\n   * Using Space and Enter keys counts as clicking.\r\n   */\n  KeyboardClickFile: /*#__PURE__*/defineFileAction({\n    id: 'keyboard_click_file',\n    __payloadType: {}\n  }, function (_ref3) {\n    var payload = _ref3.payload,\n      reduxDispatch = _ref3.reduxDispatch,\n      getReduxState = _ref3.getReduxState;\n    reduxDispatch(reduxActions.setLastClickIndex({\n      index: payload.fileDisplayIndex,\n      fileId: payload.file.id\n    }));\n    if (payload.enterKey) {\n      // We only dispatch the Open Files action here when the selection is\n      // empty. Otherwise, `Enter` key presses are handled by the\n      // hotkey manager for the Open Files action.\n      if (selectSelectionSize(getReduxState()) === 0) {\n        reduxDispatch(thunkRequestFileAction(ChonkyActions.OpenFiles, {\n          targetFile: payload.file,\n          files: [payload.file]\n        }));\n      }\n    } else if (payload.spaceKey && FileHelper.isSelectable(payload.file)) {\n      reduxDispatch(reduxActions.toggleSelection({\n        fileId: payload.file.id,\n        exclusive: payload.ctrlKey\n      }));\n    }\n  }),\n  /**\r\n   * Action that is dispatched when user starts dragging some file.\r\n   */\n  StartDragNDrop: /*#__PURE__*/defineFileAction({\n    id: 'start_drag_n_drop',\n    __payloadType: {}\n  }, function (_ref4) {\n    var payload = _ref4.payload,\n      reduxDispatch = _ref4.reduxDispatch,\n      getReduxState = _ref4.getReduxState;\n    var file = payload.draggedFile;\n    if (!getIsFileSelected(getReduxState(), file)) {\n      if (FileHelper.isSelectable(file)) {\n        reduxDispatch(reduxActions.selectFiles({\n          fileIds: [file.id],\n          reset: true\n        }));\n      }\n    }\n  }),\n  /**\r\n   * Action that is dispatched when user either cancels the drag & drop interaction,\r\n   * or drops a file somewhere.\r\n   */\n  EndDragNDrop: /*#__PURE__*/defineFileAction({\n    id: 'end_drag_n_drop',\n    __payloadType: {}\n  }, function (_ref5) {\n    var payload = _ref5.payload,\n      reduxDispatch = _ref5.reduxDispatch,\n      getReduxState = _ref5.getReduxState;\n    if (getIsFileSelected(getReduxState(), payload.destination)) {\n      // Can't drop a selection into itself\n      return;\n    }\n    var draggedFile = payload.draggedFile,\n      selectedFiles = payload.selectedFiles;\n    var droppedFiles = selectedFiles.length > 0 ? selectedFiles : [draggedFile];\n    reduxDispatch(thunkRequestFileAction(ChonkyActions.MoveFiles, _extends({}, payload, {\n      files: droppedFiles\n    })));\n  }),\n  /**\r\n   * Action that is dispatched when user moves files from one folder to another,\r\n   * usually by dragging & dropping some files into the folder.\r\n   */\n  MoveFiles: /*#__PURE__*/defineFileAction({\n    id: 'move_files',\n    __payloadType: {}\n  }),\n  /**\r\n   * Action that is dispatched when the selection changes for any reason.\r\n   */\n  ChangeSelection: /*#__PURE__*/defineFileAction({\n    id: 'change_selection',\n    __payloadType: {}\n  }),\n  /**\r\n   * Action that is dispatched when user wants to open some files. This action is\r\n   * often triggered by other actions.\r\n   */\n  OpenFiles: /*#__PURE__*/defineFileAction({\n    id: 'open_files',\n    __payloadType: {}\n  }),\n  /**\r\n   * Action that is triggered when user wants to go up a directory.\r\n   */\n  OpenParentFolder: /*#__PURE__*/defineFileAction({\n    id: 'open_parent_folder',\n    hotkeys: ['backspace'],\n    button: {\n      name: 'Go up a directory',\n      toolbar: true,\n      contextMenu: false,\n      icon: ChonkyIconName.openParentFolder,\n      iconOnly: true\n    }\n  }, function (_ref6) {\n    var reduxDispatch = _ref6.reduxDispatch,\n      getReduxState = _ref6.getReduxState;\n    var parentFolder = selectParentFolder(getReduxState());\n    if (FileHelper.isOpenable(parentFolder)) {\n      reduxDispatch(thunkRequestFileAction(ChonkyActions.OpenFiles, {\n        targetFile: parentFolder,\n        files: [parentFolder]\n      }));\n    } else {\n      Logger.warn('Open parent folder effect was triggered  even though the parent folder' + ' is not openable. This indicates a bug in presentation components.');\n    }\n  }),\n  /**\r\n   * Action that is dispatched when user opens the context menu, either by right click\r\n   * on something or using the context menu button on their keyboard.\r\n   */\n  OpenFileContextMenu: /*#__PURE__*/defineFileAction({\n    id: 'open_file_context_menu',\n    __payloadType: {}\n  }, function (_ref7) {\n    var payload = _ref7.payload,\n      reduxDispatch = _ref7.reduxDispatch,\n      getReduxState = _ref7.getReduxState;\n    // TODO: Check if the context menu component is actually enabled. There is a\n    //  chance it doesn't matter if it is enabled or not - if it is not mounted,\n    //  the action will simply have no effect. It also allows users to provide\n    //  their own components - however, users could also flip the \"context menu\n    //  component mounted\" switch...\n    var triggerFile = getFileData(getReduxState(), payload.triggerFileId);\n    if (triggerFile) {\n      var fileSelected = getIsFileSelected(getReduxState(), triggerFile);\n      if (!fileSelected) {\n        // If file is selected, we leave the selection as is. If it is not\n        // selected, it means user right clicked the file with no selection.\n        // We simulate the Windows Explorer/Nautilus behaviour of moving\n        // selection to this file.\n        if (FileHelper.isSelectable(triggerFile)) {\n          reduxDispatch(reduxActions.selectFiles({\n            fileIds: [payload.triggerFileId],\n            reset: true\n          }));\n        } else {\n          reduxDispatch(reduxActions.clearSelection());\n        }\n      }\n    }\n    reduxDispatch(reduxActions.showContextMenu({\n      triggerFileId: payload.triggerFileId,\n      mouseX: payload.clientX - 2,\n      mouseY: payload.clientY - 4\n    }));\n  })\n};\nvar DefaultActions = {\n  /**\r\n   * Action that can be used to open currently selected files.\r\n   */\n  OpenSelection: /*#__PURE__*/defineFileAction({\n    id: 'open_selection',\n    hotkeys: ['enter'],\n    requiresSelection: true,\n    fileFilter: FileHelper.isOpenable,\n    button: {\n      name: 'Open selection',\n      toolbar: true,\n      contextMenu: true,\n      group: 'Actions',\n      icon: ChonkyIconName.openFiles\n    }\n  }, function (_ref) {\n    var state = _ref.state,\n      reduxDispatch = _ref.reduxDispatch;\n    reduxDispatch(thunkRequestFileAction(EssentialActions.OpenFiles, {\n      files: state.selectedFilesForAction\n    }));\n    return undefined;\n  }),\n  /**\r\n   * Action that selects all files.\r\n   */\n  SelectAllFiles: /*#__PURE__*/defineFileAction({\n    id: 'select_all_files',\n    hotkeys: ['ctrl+a'],\n    button: {\n      name: 'Select all files',\n      toolbar: true,\n      contextMenu: true,\n      group: 'Actions',\n      icon: ChonkyIconName.selectAllFiles\n    },\n    selectionTransform: function selectionTransform(_ref2) {\n      var fileIds = _ref2.fileIds,\n        hiddenFileIds = _ref2.hiddenFileIds;\n      var newSelection = new Set();\n      fileIds.map(function (fileId) {\n        // We don't need to check if file is selectable because Chonky does\n        // it own checks internally.\n        if (!hiddenFileIds.has(fileId)) newSelection.add(fileId);\n      });\n      return newSelection;\n    }\n  }),\n  /**\r\n   * Action that clear the file selection.\r\n   */\n  ClearSelection: /*#__PURE__*/defineFileAction({\n    id: 'clear_selection',\n    hotkeys: ['escape'],\n    button: {\n      name: 'Clear selection',\n      toolbar: true,\n      contextMenu: true,\n      group: 'Actions',\n      icon: ChonkyIconName.clearSelection\n    },\n    selectionTransform: function selectionTransform(_ref3) {\n      var prevSelection = _ref3.prevSelection;\n      if (prevSelection.size === 0) return null;\n      return new Set();\n    }\n  }),\n  /**\r\n   * Action that enables List view.\r\n   */\n  EnableListView: /*#__PURE__*/defineFileAction({\n    id: 'enable_list_view',\n    fileViewConfig: {\n      mode: FileViewMode.List,\n      entryHeight: 30\n    },\n    button: {\n      name: 'Switch to List view',\n      toolbar: true,\n      icon: ChonkyIconName.list,\n      iconOnly: true\n    }\n  }),\n  /**\r\n   * Action that enables Compact view. Note that compact view is still\r\n   * experimental and should not be used in production.\r\n   */\n  EnableCompactView: /*#__PURE__*/defineFileAction({\n    // TODO: Don't enable until compact view is fully supported\n    id: 'enable_compact_view',\n    fileViewConfig: {\n      mode: FileViewMode.Compact,\n      entryHeight: 40,\n      entryWidth: 220\n    },\n    button: {\n      name: 'Switch to Compact view',\n      toolbar: true,\n      icon: ChonkyIconName.compact,\n      iconOnly: true\n    }\n  }),\n  /**\r\n   * Action that enables Grid view.\r\n   */\n  EnableGridView: /*#__PURE__*/defineFileAction({\n    id: 'enable_grid_view',\n    fileViewConfig: {\n      mode: FileViewMode.Grid,\n      entryWidth: 165,\n      entryHeight: 130\n    },\n    button: {\n      name: 'Switch to Grid view',\n      toolbar: true,\n      icon: ChonkyIconName.smallThumbnail,\n      iconOnly: true\n    }\n  }),\n  /**\r\n   * Action that sorts files by `file.name`.\r\n   */\n  SortFilesByName: /*#__PURE__*/defineFileAction({\n    id: 'sort_files_by_name',\n    sortKeySelector: function sortKeySelector(file) {\n      return file ? file.name.toLowerCase() : undefined;\n    },\n    button: {\n      name: 'Sort by name',\n      toolbar: true,\n      group: 'Options'\n    }\n  }),\n  /**\r\n   * Action that sorts files by `file.size`.\r\n   */\n  SortFilesBySize: /*#__PURE__*/defineFileAction({\n    id: 'sort_files_by_size',\n    sortKeySelector: function sortKeySelector(file) {\n      return file ? file.size : undefined;\n    },\n    button: {\n      name: 'Sort by size',\n      toolbar: true,\n      group: 'Options'\n    }\n  }),\n  /**\r\n   * Action that sorts files by `file.modDate`.\r\n   */\n  SortFilesByDate: /*#__PURE__*/defineFileAction({\n    id: 'sort_files_by_date',\n    sortKeySelector: function sortKeySelector(file) {\n      return file ? file.modDate : undefined;\n    },\n    button: {\n      name: 'Sort by date',\n      toolbar: true,\n      group: 'Options'\n    }\n  }),\n  /**\r\n   * Action that toggles whether hidden files are shown to the user or not.\r\n   */\n  ToggleHiddenFiles: /*#__PURE__*/defineFileAction({\n    id: 'toggle_hidden_files',\n    hotkeys: ['ctrl+h'],\n    option: {\n      id: OptionIds.ShowHiddenFiles,\n      defaultValue: true\n    },\n    button: {\n      name: 'Show hidden files',\n      toolbar: true,\n      group: 'Options'\n    }\n  }),\n  /**\r\n   * Action that toggles whether folders should appear before files regardless of\r\n   * current sort function.\r\n   */\n  ToggleShowFoldersFirst: /*#__PURE__*/defineFileAction({\n    id: 'toggle_show_folders_first',\n    option: {\n      id: OptionIds.ShowFoldersFirst,\n      defaultValue: true\n    },\n    button: {\n      name: 'Show folders first',\n      toolbar: true,\n      group: 'Options'\n    }\n  }),\n  /**\r\n   * Action that focuses the search input when it is dispatched.\r\n   */\n  FocusSearchInput: /*#__PURE__*/defineFileAction({\n    id: 'focus_search_input',\n    hotkeys: ['ctrl+f']\n  }, function (_ref4) {\n    var getReduxState = _ref4.getReduxState;\n    var focusSearchInput = selectFocusSearchInput(getReduxState());\n    if (focusSearchInput) focusSearchInput();\n  }),\n  /**\r\n   * Action that enables List view.\r\n   */\n  ToggleDarkMode: /*#__PURE__*/defineFileAction({\n    id: 'enable_dark_mode',\n    option: {\n      id: OptionIds.DarkMode,\n      defaultValue: false\n    },\n    button: {\n      name: 'Enable dark mode',\n      toolbar: true,\n      icon: ChonkyIconName.list,\n      iconOnly: true\n    }\n  })\n};\nvar ExtraActions = {\n  /**\r\n   * Action that adds a button and shortcut to copy files.\r\n   */\n  CopyFiles: /*#__PURE__*/defineFileAction({\n    id: 'copy_files',\n    requiresSelection: true,\n    hotkeys: ['ctrl+c'],\n    button: {\n      name: 'Copy selection',\n      toolbar: true,\n      contextMenu: true,\n      group: 'Actions',\n      icon: ChonkyIconName.copy\n    }\n  }),\n  /**\r\n   * Action that adds a button to create a new folder.\r\n   */\n  CreateFolder: /*#__PURE__*/defineFileAction({\n    id: 'create_folder',\n    button: {\n      name: 'Create folder',\n      toolbar: true,\n      tooltip: 'Create a folder',\n      icon: ChonkyIconName.folderCreate\n    }\n  }),\n  /**\r\n   * Action that adds a button to upload files.\r\n   */\n  UploadFiles: /*#__PURE__*/defineFileAction({\n    id: 'upload_files',\n    button: {\n      name: 'Upload files',\n      toolbar: true,\n      tooltip: 'Upload files',\n      icon: ChonkyIconName.upload\n    }\n  }),\n  /**\r\n   * Action that adds a button to download files.\r\n   */\n  DownloadFiles: /*#__PURE__*/defineFileAction({\n    id: 'download_files',\n    requiresSelection: true,\n    button: {\n      name: 'Download files',\n      toolbar: true,\n      contextMenu: true,\n      group: 'Actions',\n      icon: ChonkyIconName.download\n    }\n  }),\n  /**\r\n   * Action that adds a button and shortcut to delete files.\r\n   */\n  DeleteFiles: /*#__PURE__*/defineFileAction({\n    id: 'delete_files',\n    requiresSelection: true,\n    hotkeys: ['delete'],\n    button: {\n      name: 'Delete files',\n      toolbar: true,\n      contextMenu: true,\n      group: 'Actions',\n      icon: ChonkyIconName.trash\n    }\n  })\n};\nvar ChonkyActions = /*#__PURE__*/_extends({}, EssentialActions, DefaultActions, ExtraActions);\nvar EssentialFileActions = [ChonkyActions.MouseClickFile, ChonkyActions.KeyboardClickFile, ChonkyActions.StartDragNDrop, ChonkyActions.EndDragNDrop, ChonkyActions.MoveFiles, ChonkyActions.ChangeSelection, ChonkyActions.OpenFiles, ChonkyActions.OpenParentFolder, ChonkyActions.OpenFileContextMenu];\nvar DefaultFileActions = [ChonkyActions.OpenSelection, ChonkyActions.SelectAllFiles, ChonkyActions.ClearSelection, ChonkyActions.EnableListView,\n// TODO: Don't enable until compact view is fully supported\n// ChonkyActions.EnableCompactView,\nChonkyActions.EnableGridView, ChonkyActions.SortFilesByName, ChonkyActions.SortFilesBySize, ChonkyActions.SortFilesByDate, ChonkyActions.ToggleHiddenFiles, ChonkyActions.ToggleShowFoldersFirst, ChonkyActions.FocusSearchInput];\nvar initialRootState = {\n  instanceId: 'CHONKY_INVALID_ID',\n  externalFileActionHandler: null,\n  rawFileActions: [],\n  fileActionsErrorMessages: [],\n  fileActionMap: {},\n  fileActionIds: [],\n  toolbarItems: [],\n  contextMenuItems: [],\n  rawFolderChain: null,\n  folderChainErrorMessages: [],\n  folderChain: [],\n  rawFiles: [],\n  filesErrorMessages: [],\n  fileMap: {},\n  fileIds: [],\n  cleanFileIds: [],\n  sortedFileIds: [],\n  hiddenFileIdMap: {},\n  focusSearchInput: null,\n  searchString: '',\n  searchMode: 'currentFolder',\n  selectionMap: {},\n  disableSelection: false,\n  fileViewConfig: ChonkyActions.EnableGridView.fileViewConfig,\n  sortActionId: null,\n  sortOrder: SortOrder.ASC,\n  optionMap: {},\n  thumbnailGenerator: null,\n  doubleClickDelay: 300,\n  disableDragAndDrop: false,\n  clearSelectionOnOutsideClick: true,\n  lastClick: null,\n  contextMenuMounted: false,\n  contextMenuConfig: null\n};\nvar reducers = {\n  setExternalFileActionHandler: function setExternalFileActionHandler(state, action) {\n    var _action$payload;\n    state.externalFileActionHandler = (_action$payload = action.payload) != null ? _action$payload : null;\n  },\n  setRawFileActions: function setRawFileActions(state, action) {\n    state.rawFileActions = action.payload;\n  },\n  setFileActionsErrorMessages: function setFileActionsErrorMessages(state, action) {\n    state.fileActionsErrorMessages = action.payload;\n  },\n  setFileActions: function setFileActions(state, action) {\n    var fileActionMap = {};\n    action.payload.map(function (a) {\n      return fileActionMap[a.id] = a;\n    });\n    var fileIds = action.payload.map(function (a) {\n      return a.id;\n    });\n    state.fileActionMap = fileActionMap;\n    state.fileActionIds = fileIds;\n  },\n  updateFileActionMenuItems: function updateFileActionMenuItems(state, action) {\n    var _action$payload2 = action.payload;\n    state.toolbarItems = _action$payload2[0];\n    state.contextMenuItems = _action$payload2[1];\n  },\n  setRawFolderChain: function setRawFolderChain(state, action) {\n    var rawFolderChain = action.payload;\n    var _sanitizeInputArray = sanitizeInputArray('folderChain', rawFolderChain),\n      folderChain = _sanitizeInputArray.sanitizedArray,\n      errorMessages = _sanitizeInputArray.errorMessages;\n    state.rawFolderChain = rawFolderChain;\n    state.folderChain = folderChain;\n    state.folderChainErrorMessages = errorMessages;\n  },\n  setRawFiles: function setRawFiles(state, action) {\n    var rawFiles = action.payload;\n    var _sanitizeInputArray2 = sanitizeInputArray('files', rawFiles),\n      files = _sanitizeInputArray2.sanitizedArray,\n      errorMessages = _sanitizeInputArray2.errorMessages;\n    state.rawFiles = rawFiles;\n    state.filesErrorMessages = errorMessages;\n    var fileMap = {};\n    files.forEach(function (f) {\n      if (f) fileMap[f.id] = f;\n    });\n    var fileIds = files.map(function (f) {\n      return f ? f.id : null;\n    });\n    var cleanFileIds = fileIds.filter(function (f) {\n      return !!f;\n    });\n    state.fileMap = fileMap;\n    state.fileIds = fileIds;\n    state.cleanFileIds = cleanFileIds; // Cleanup selection\n\n    for (var _i = 0, _Object$keys = Object.keys(state.selectionMap); _i < _Object$keys.length; _i++) {\n      var selectedFileId = _Object$keys[_i];\n      if (!fileMap[selectedFileId]) {\n        delete state.selectionMap[selectedFileId];\n      }\n    }\n  },\n  setSortedFileIds: function setSortedFileIds(state, action) {\n    state.sortedFileIds = action.payload;\n  },\n  setHiddenFileIds: function setHiddenFileIds(state, action) {\n    state.hiddenFileIdMap = action.payload; // Cleanup selection\n\n    for (var _i2 = 0, _Object$keys2 = Object.keys(state.selectionMap); _i2 < _Object$keys2.length; _i2++) {\n      var selectedFileId = _Object$keys2[_i2];\n      if (state.hiddenFileIdMap[selectedFileId]) {\n        delete state.selectionMap[selectedFileId];\n      }\n    }\n  },\n  setFocusSearchInput: function setFocusSearchInput(state, action) {\n    state.focusSearchInput = action.payload;\n  },\n  setSearchString: function setSearchString(state, action) {\n    state.searchString = action.payload;\n  },\n  selectAllFiles: function selectAllFiles(state) {\n    state.fileIds.filter(function (id) {\n      return id && FileHelper.isSelectable(state.fileMap[id]);\n    }).map(function (id) {\n      return id ? state.selectionMap[id] = true : null;\n    });\n  },\n  selectFiles: function selectFiles(state, action) {\n    if (state.disableSelection) return;\n    if (action.payload.reset) state.selectionMap = {};\n    action.payload.fileIds.filter(function (id) {\n      return id && FileHelper.isSelectable(state.fileMap[id]);\n    }).map(function (id) {\n      return state.selectionMap[id] = true;\n    });\n  },\n  toggleSelection: function toggleSelection(state, action) {\n    if (state.disableSelection) return;\n    var oldValue = !!state.selectionMap[action.payload.fileId];\n    if (action.payload.exclusive) state.selectionMap = {};\n    if (oldValue) delete state.selectionMap[action.payload.fileId];else if (FileHelper.isSelectable(state.fileMap[action.payload.fileId])) {\n      state.selectionMap[action.payload.fileId] = true;\n    }\n  },\n  clearSelection: function clearSelection(state) {\n    if (state.disableSelection) return;\n    if (Object.keys(state.selectionMap).length !== 0) state.selectionMap = {};\n  },\n  setSelectionDisabled: function setSelectionDisabled(state, action) {\n    state.disableSelection = action.payload;\n    if (Object.keys(state.selectionMap).length !== 0) state.selectionMap = {};\n  },\n  setFileViewConfig: function setFileViewConfig(state, action) {\n    state.fileViewConfig = action.payload;\n  },\n  setSort: function setSort(state, action) {\n    state.sortActionId = action.payload.actionId;\n    state.sortOrder = action.payload.order;\n  },\n  setOptionDefaults: function setOptionDefaults(state, action) {\n    for (var _i3 = 0, _Object$keys3 = Object.keys(action.payload); _i3 < _Object$keys3.length; _i3++) {\n      var optionId = _Object$keys3[_i3];\n      if (optionId in state.optionMap) continue;\n      state.optionMap[optionId] = action.payload[optionId];\n    }\n  },\n  toggleOption: function toggleOption(state, action) {\n    state.optionMap[action.payload] = !state.optionMap[action.payload];\n  },\n  setThumbnailGenerator: function setThumbnailGenerator(state, action) {\n    state.thumbnailGenerator = action.payload;\n  },\n  setDoubleClickDelay: function setDoubleClickDelay(state, action) {\n    state.doubleClickDelay = action.payload;\n  },\n  setDisableDragAndDrop: function setDisableDragAndDrop(state, action) {\n    state.disableDragAndDrop = action.payload;\n  },\n  setClearSelectionOnOutsideClick: function setClearSelectionOnOutsideClick(state, action) {\n    state.clearSelectionOnOutsideClick = action.payload;\n  },\n  setLastClickIndex: function setLastClickIndex(state, action) {\n    state.lastClick = action.payload;\n  },\n  setContextMenuMounted: function setContextMenuMounted(state, action) {\n    state.contextMenuMounted = action.payload;\n  },\n  showContextMenu: function showContextMenu(state, action) {\n    state.contextMenuConfig = action.payload;\n  },\n  hideContextMenu: function hideContextMenu(state) {\n    if (!state.contextMenuConfig) return;\n    state.contextMenuConfig = null;\n  }\n};\nvar _createSlice = /*#__PURE__*/createSlice({\n    name: 'root',\n    initialState: initialRootState,\n    reducers: reducers\n  }),\n  reduxActions = _createSlice.actions,\n  rootReducer = _createSlice.reducer;\nvar useStoreWatchers = function useStoreWatchers(store) {\n  useEffect(function () {\n    var selectionWatcher = watch(function () {\n      return selectSelectionMap(store.getState());\n    });\n    var onSelectionChange = function onSelectionChange(newSelection, oldSelection) {\n      // We don't check for deep equality here as we expect the\n      // reducers to prevent all unnecessary updates.\n      if (newSelection === oldSelection) return; // Notify users the selection has changed.\n\n      var selectedFilesIds = selectSelectedFileIds(store.getState());\n      var selection = new Set(selectedFilesIds);\n      store.dispatch(thunkRequestFileAction(ChonkyActions.ChangeSelection, {\n        selection: selection\n      }));\n    };\n    var unsubscribeCallbacks = [store.subscribe(selectionWatcher(onSelectionChange))];\n    return function () {\n      for (var _iterator = _createForOfIteratorHelperLoose(unsubscribeCallbacks), _step; !(_step = _iterator()).done;) {\n        var unsubscribe = _step.value;\n        unsubscribe();\n      }\n    };\n  }, [store]);\n};\nvar useChonkyStore = function useChonkyStore(chonkyInstanceId) {\n  var store = useStaticValue(function () {\n    var preloadedState = _extends({}, initialRootState, {\n      instanceId: chonkyInstanceId\n    });\n    return configureStore({\n      preloadedState: preloadedState,\n      reducer: rootReducer,\n      middleware: function middleware(getDefaultMiddleware) {\n        return getDefaultMiddleware({\n          serializableCheck: false\n        });\n      },\n      devTools: {\n        name: \"chonky_\" + chonkyInstanceId\n      }\n    });\n  });\n  useStoreWatchers(store);\n  return store;\n};\n/**\r\n * Hook that can be used with parametrized selectors.\r\n */\n\nvar useParamSelector = function useParamSelector(parametrizedSelector) {\n  for (var _len = arguments.length, selectorParams = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    selectorParams[_key - 1] = arguments[_key];\n  }\n  var selector = useCallback(function (state) {\n    return parametrizedSelector.apply(void 0, selectorParams)(state);\n  },\n  // eslint-disable-next-line\n  [parametrizedSelector].concat(selectorParams));\n  return useSelector(selector);\n};\n/**\r\n * DTE - DispatchThunkEffect. This method is used to decrease code duplication in\r\n * main Chonky method.\r\n */\n\nvar useDTE = function useDTE(actionCreator) {\n  for (var _len2 = arguments.length, selectorParams = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    selectorParams[_key2 - 1] = arguments[_key2];\n  }\n  var dispatch = useDispatch();\n  useEffect(function () {\n    dispatch(actionCreator.apply(void 0, selectorParams));\n  },\n  // eslint-disable-next-line\n  [dispatch, actionCreator].concat(selectorParams));\n};\nvar usePropReduxUpdate = function usePropReduxUpdate(actionCreator, payload) {\n  var dispatch = useDispatch();\n  useEffect(function () {\n    dispatch(actionCreator(payload));\n  }, [dispatch, actionCreator, payload]);\n};\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ChonkyIconPlaceholder = function ChonkyIconPlaceholder() {\n  // This component should not be rendered unless the user has misconfigured Chonky\n  var title = 'No icon component found. Please follow Chonky installation instructions to ' + 'provide a pre-made icon component (or a custom icon).';\n  return React.createElement(\"span\", {\n    title: title\n  }, \"\\u26A0\\uFE0F\");\n};\nvar defaultConfig = {\n  fileActions: null,\n  onFileAction: null,\n  thumbnailGenerator: null,\n  doubleClickDelay: 300,\n  disableSelection: false,\n  disableDefaultFileActions: false,\n  disableDragAndDrop: false,\n  disableDragAndDropProvider: false,\n  defaultSortActionId: ChonkyActions.SortFilesByName.id,\n  defaultFileViewActionId: ChonkyActions.EnableGridView.id,\n  clearSelectionOnOutsideClick: true,\n  iconComponent: ChonkyIconPlaceholder,\n  darkMode: false,\n  i18n: {}\n};\nvar setChonkyDefaults = function setChonkyDefaults(config) {\n  for (var _i = 0, _Object$keys = Object.keys(defaultConfig); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n    if (key in config) {\n      defaultConfig[key] = config[key];\n    }\n  }\n};\nvar I18nNamespace;\n(function (I18nNamespace) {\n  I18nNamespace[\"Toolbar\"] = \"toolbar\";\n  I18nNamespace[\"FileList\"] = \"fileList\";\n  I18nNamespace[\"FileEntry\"] = \"fileEntry\";\n  I18nNamespace[\"FileContextMenu\"] = \"contextMenu\";\n  I18nNamespace[\"FileActions\"] = \"actions\";\n  I18nNamespace[\"FileActionGroups\"] = \"actionGroups\";\n})(I18nNamespace || (I18nNamespace = {}));\nvar getI18nId = function getI18nId(namespace, stringId) {\n  return \"chonky.\" + namespace + \".\" + stringId;\n};\nvar getActionI18nId = function getActionI18nId(actionId, stringId) {\n  return \"chonky.\" + I18nNamespace.FileActions + \".\" + actionId + \".\" + stringId;\n};\nvar useLocalizedFileActionGroup = function useLocalizedFileActionGroup(groupName) {\n  var intl = useIntl();\n  return useMemo(function () {\n    return intl.formatMessage({\n      id: getI18nId(I18nNamespace.FileActionGroups, groupName),\n      defaultMessage: groupName\n    });\n  }, [groupName, intl]);\n};\nvar useLocalizedFileActionStrings = function useLocalizedFileActionStrings(action) {\n  var intl = useIntl();\n  return useMemo(function () {\n    var _action$button, _action$button2;\n    if (!action) {\n      return {\n        buttonName: '',\n        buttonTooltip: undefined\n      };\n    }\n    var buttonName = intl.formatMessage({\n      id: getActionI18nId(action.id, 'button.name'),\n      defaultMessage: (_action$button = action.button) == null ? void 0 : _action$button.name\n    });\n    var buttonTooltip = undefined;\n    if ((_action$button2 = action.button) != null && _action$button2.tooltip) {\n      var _action$button3;\n\n      // We only translate the tooltip if the original action has a tooltip.\n      buttonTooltip = intl.formatMessage({\n        id: getActionI18nId(action.id, 'button.tooltip'),\n        defaultMessage: (_action$button3 = action.button) == null ? void 0 : _action$button3.tooltip\n      });\n    }\n    return {\n      buttonName: buttonName,\n      buttonTooltip: buttonTooltip\n    };\n  }, [action, intl]);\n};\nvar useLocalizedFileEntryStrings = function useLocalizedFileEntryStrings(file) {\n  var intl = useIntl();\n  var formatters = useContext(ChonkyFormattersContext);\n  return useMemo(function () {\n    return {\n      fileModDateString: formatters.formatFileModDate(intl, file),\n      fileSizeString: formatters.formatFileSize(intl, file)\n    };\n  }, [file, formatters, intl]);\n};\nvar defaultFormatters = {\n  formatFileModDate: function formatFileModDate(intl, file) {\n    var safeModDate = FileHelper.getModDate(file);\n    if (safeModDate) {\n      return intl.formatDate(safeModDate, {\n        dateStyle: 'medium',\n        timeStyle: 'short'\n      });\n    } else {\n      return null;\n    }\n  },\n  formatFileSize: function formatFileSize(_intl, file) {\n    if (!file || typeof file.size !== 'number') return null;\n    var size = file.size;\n    var sizeData = filesize(size, {\n      bits: false,\n      output: 'object'\n    });\n    if (sizeData.symbol === 'B') {\n      return Math.round(sizeData.value / 10) / 100.0 + \" KB\";\n    } else if (sizeData.symbol === 'KB') {\n      return Math.round(sizeData.value) + \" \" + sizeData.symbol;\n    }\n    return sizeData.value + \" \" + sizeData.symbol;\n  }\n};\nvar ChonkyFormattersContext = /*#__PURE__*/createContext(defaultFormatters);\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2019\r\n * @license MIT\r\n */\nvar ChonkyIconContext = /*#__PURE__*/createContext(ChonkyIconPlaceholder);\nvar VideoExtensions = ['3g2', '3gp', '3gpp', 'asf', 'asx', 'avi', 'dvb', 'f4v', 'fli', 'flv', 'fvt', 'h261', 'h263', 'h264', 'jpgm', 'jpgv', 'jpm', 'm1v', 'm2v', 'm4u', 'm4v', 'mj2', 'mjp2', 'mk3d', 'mks', 'mkv', 'mng', 'mov', 'movie', 'mp4', 'mp4v', 'mpe', 'mpeg', 'mpg', 'mpg4', 'mxu', 'ogv', 'pyv', 'qt', 'smv', 'ts', 'uvh', 'uvm', 'uvp', 'uvs', 'uvu', 'uvv', 'uvvh', 'uvvm', 'uvvp', 'uvvs', 'uvvu', 'uvvv', 'viv', 'vob', 'webm', 'wm', 'wmv', 'wmx', 'wvx'];\nvar ImageExtensions = ['3ds', 'apng', 'azv', 'bmp', 'bmp', 'btif', 'cgm', 'cmx', 'djv', 'djvu', 'drle', 'dwg', 'dxf', 'emf', 'exr', 'fbs', 'fh', 'fh4', 'fh5', 'fh7', 'fhc', 'fits', 'fpx', 'fst', 'g3', 'gif', 'heic', 'heics', 'heif', 'heifs', 'ico', 'ico', 'ief', 'jls', 'jng', 'jp2', 'jpe', 'jpeg', 'jpf', 'jpg', 'jpg2', 'jpm', 'jpx', 'jxr', 'ktx', 'mdi', 'mmr', 'npx', 'pbm', 'pct', 'pcx', 'pcx', 'pgm', 'pic', 'png', 'pnm', 'ppm', 'psd', 'pti', 'ras', 'rgb', 'rlc', 'sgi', 'sid', 'sub', 'svg', 'svgz', 't38', 'tap', 'tfx', 'tga', 'tif', 'tiff', 'uvg', 'uvi', 'uvvg', 'uvvi', 'vtf', 'wbmp', 'wdp', 'webp', 'wmf', 'xbm', 'xif', 'xpm', 'xwd'];\nvar AudioExtensions = ['3gpp', 'aac', 'adp', 'aif', 'aifc', 'aiff', 'au', 'caf', 'dra', 'dts', 'dtshd', 'ecelp4800', 'ecelp7470', 'ecelp9600', 'eol', 'flac', 'kar', 'lvp', 'm2a', 'm3a', 'm3u', 'm4a', 'm4a', 'mid', 'midi', 'mka', 'mp2', 'mp2a', 'mp3', 'mp3', 'mp4a', 'mpga', 'oga', 'ogg', 'pya', 'ra', 'ra', 'ram', 'rip', 'rmi', 'rmp', 's3m', 'sil', 'snd', 'spx', 'uva', 'uvva', 'wav', 'wav', 'wav', 'wax', 'weba', 'wma', 'xm'];\nvar ColorsLight = ['#bbbbbb', '#d65c5c', '#d6665c', '#d6705c', '#d67a5c', '#d6855c', '#d68f5c', '#d6995c', '#d6a35c', '#d6ad5c', '#d6b85c', '#d6c25c', '#d6cc5c', '#d6d65c', '#ccd65c', '#c2d65c', '#b8d65c', '#add65c', '#a3d65c', '#99d65c', '#8fd65c', '#85d65c', '#7ad65c', '#70d65c', '#66d65c', '#5cd65c', '#5cd666', '#5cd670', '#5cd67a', '#5cd685', '#5cd68f', '#5cd699', '#5cd6a3', '#5cd6ad', '#5cd6b8', '#5cd6c2', '#5cd6cc', '#5cd6d6', '#5cccd6', '#5cc2d6', '#5cb8d6', '#5cadd6', '#5ca3d6', '#5c99d6', '#5c8fd6', '#5c85d6', '#5c7ad6', '#5c70d6', '#5c66d6', '#5c5cd6', '#665cd6', '#705cd6', '#7a5cd6', '#855cd6', '#8f5cd6', '#995cd6', '#a35cd6', '#ad5cd6', '#b85cd6', '#c25cd6', '#cc5cd6', '#d65cd6', '#d65ccc', '#d65cc2', '#d65cb8', '#d65cad', '#d65ca3', '#d65c99', '#d65c8f', '#d65c85', '#d65c7a', '#d65c70', '#d65c66'];\nvar ColorsDark = ['#777', '#8f3d3d', '#8f443d', '#8f4b3d', '#8f523d', '#8f583d', '#8f5f3d', '#8f663d', '#8f6d3d', '#8f743d', '#8f7a3d', '#8f813d', '#8f883d', '#8f8f3d', '#888f3d', '#818f3d', '#7a8f3d', '#748f3d', '#6d8f3d', '#668f3d', '#5f8f3d', '#588f3d', '#528f3d', '#4b8f3d', '#448f3d', '#3d8f3d', '#3d8f44', '#3d8f4b', '#3d8f52', '#3d8f58', '#3d8f5f', '#3d8f66', '#3d8f6d', '#3d8f74', '#3d8f7a', '#3d8f81', '#3d8f88', '#3d8f8f', '#3d888f', '#3d818f', '#3d7a8f', '#3d748f', '#3d6d8f', '#3d668f', '#3d5f8f', '#3d588f', '#3d528f', '#3d4b8f', '#3d448f', '#3d3d8f', '#443d8f', '#4b3d8f', '#523d8f', '#583d8f', '#5f3d8f', '#663d8f', '#6d3d8f', '#743d8f', '#7a3d8f', '#813d8f', '#883d8f', '#8f3d8f', '#8f3d88', '#8f3d81', '#8f3d7a', '#8f3d74', '#8f3d6d', '#8f3d66', '#8f3d5f', '#8f3d58', '#8f3d52', '#8f3d4b', '#8f3d44'];\nvar getIconTrie = function getIconTrie() {\n  var colourIndex = 0;\n  var step = 5;\n  var IconsToExtensions = [\n  // Generic file types\n  [ChonkyIconName.license, ['license']], [ChonkyIconName.config, ['sfk', 'ini', 'yml', 'toml', 'iml']], [ChonkyIconName.model, ['3ds', 'obj', 'ply', 'fbx']], [ChonkyIconName.database, ['csv', 'json', 'sql', 'sqlite', 'sqlite3', 'npy', 'npz', 'rec', 'idx', 'hdf5']], [ChonkyIconName.text, ['txt', 'md', 'mdx']], [ChonkyIconName.archive, ['zip', 'rar', 'tar', 'tar.gz', '7z']], [ChonkyIconName.image, ImageExtensions], [ChonkyIconName.video, VideoExtensions], [ChonkyIconName.code, ['html', 'php', 'css', 'sass', 'scss', 'less', 'cpp', 'h', 'hpp', 'c', 'xml']], [ChonkyIconName.info, ['bib', 'readme', 'nfo']], [ChonkyIconName.key, ['pem', 'pub']], [ChonkyIconName.lock, ['lock', 'lock.json', 'shrinkwrap.json']], [ChonkyIconName.music, AudioExtensions], [ChonkyIconName.terminal, ['run', 'sh']], [ChonkyIconName.trash, ['.Trashes']], [ChonkyIconName.users, ['authors', 'contributors']],\n  // OS file types\n  [ChonkyIconName.linux, ['AppImage']], [ChonkyIconName.ubuntu, ['deb']], [ChonkyIconName.windows, ['exe']],\n  // Programming language file types\n  [ChonkyIconName.rust, ['rs', 'rlib']], [ChonkyIconName.python, ['py', 'ipynb']], [ChonkyIconName.nodejs, ['js', 'jsx', 'ts', 'tsx', 'd.ts']], [ChonkyIconName.php, ['php']],\n  // Development tools file types\n  [ChonkyIconName.git, ['.gitignore']],\n  // Brands file types\n  [ChonkyIconName.adobe, ['psd']],\n  // Other program file types\n  [ChonkyIconName.pdf, ['pdf']], [ChonkyIconName.excel, ['xls', 'xlsx']], [ChonkyIconName.word, ['doc', 'docx', 'odt']], [ChonkyIconName.flash, ['swf']]];\n  var exactTrie = new ExactTrie({\n    ignoreCase: true\n  });\n  for (var _i = 0, _IconsToExtensions = IconsToExtensions; _i < _IconsToExtensions.length; _i++) {\n    var pair = _IconsToExtensions[_i];\n    var icon = pair[0],\n      extensions = pair[1];\n    for (var i = 0; i < extensions.length; ++i) {\n      colourIndex += step;\n      var colorCode = colourIndex % (ColorsLight.length - 1) + 1;\n      var iconData = {\n        icon: icon,\n        colorCode: colorCode\n      };\n      exactTrie.put(extensions[i], iconData, true);\n    }\n  }\n  return exactTrie;\n};\nvar iconTrie = /*#__PURE__*/getIconTrie();\nvar useIconData = function useIconData(file) {\n  return useMemo(function () {\n    if (!file) return {\n      icon: ChonkyIconName.loading,\n      colorCode: 0\n    };\n    if (file.isDir === true) return {\n      icon: ChonkyIconName.folder,\n      colorCode: 0\n    };\n    var match = iconTrie.getWithCheckpoints(file.name, '.', true);\n    return match ? match : {\n      icon: ChonkyIconName.file,\n      colorCode: 32\n    };\n  }, [file]);\n};\nvar lightTheme = {\n  colors: {\n    debugRed: '#fabdbd',\n    debugBlue: '#bdd8fa',\n    debugGreen: '#d2fabd',\n    debugPurple: '#d2bdfa',\n    debugYellow: '#fae9bd',\n    textActive: '#09f'\n  },\n  fontSizes: {\n    rootPrimary: 15\n  },\n  margins: {\n    rootLayoutMargin: 8\n  },\n  toolbar: {\n    size: 30,\n    lineHeight: '30px',\n    fontSize: 15,\n    buttonRadius: 4\n  },\n  dnd: {\n    canDropColor: 'green',\n    cannotDropColor: 'red',\n    canDropMask: 'rgba(180, 235, 180, 0.75)',\n    cannotDropMask: 'rgba(235, 180, 180, 0.75)',\n    fileListCanDropMaskOne: 'rgba(180, 235, 180, 0.1)',\n    fileListCanDropMaskTwo: 'rgba(180, 235, 180, 0.2)',\n    fileListCannotDropMaskOne: 'rgba(235, 180, 180, 0.1)',\n    fileListCannotDropMaskTwo: 'rgba(235, 180, 180, 0.2)'\n  },\n  dragLayer: {\n    border: 'solid 2px #09f',\n    padding: '7px 10px',\n    borderRadius: 2\n  },\n  fileList: {\n    desktopGridGutter: 8,\n    mobileGridGutter: 5\n  },\n  gridFileEntry: {\n    childrenCountSize: '1.6em',\n    iconColorFocused: '#000',\n    iconSize: '2.4em',\n    iconColor: '#fff',\n    borderRadius: 5,\n    fontSize: 14,\n    fileColorTint: 'rgba(255, 255, 255, 0.4)',\n    folderBackColorTint: 'rgba(255, 255, 255, 0.1)',\n    folderFrontColorTint: 'rgba(255, 255, 255, 0.4)'\n  },\n  listFileEntry: {\n    propertyFontSize: 14,\n    iconFontSize: '1.1em',\n    iconBorderRadius: 5,\n    fontSize: 14\n  }\n};\nvar darkThemeOverride = {\n  gridFileEntry: {\n    fileColorTint: 'rgba(50, 50, 50, 0.4)',\n    folderBackColorTint: 'rgba(50, 50, 50, 0.4)',\n    folderFrontColorTint: 'rgba(50, 50, 50, 0.15)'\n  }\n};\nvar mobileThemeOverride = {\n  fontSizes: {\n    rootPrimary: 13\n  },\n  margins: {\n    rootLayoutMargin: 4\n  },\n  toolbar: {\n    size: 28,\n    lineHeight: '28px',\n    fontSize: 13\n  },\n  gridFileEntry: {\n    fontSize: 13\n  },\n  listFileEntry: {\n    propertyFontSize: 12,\n    iconFontSize: '1em',\n    fontSize: 13\n  }\n};\nvar useIsMobileBreakpoint = function useIsMobileBreakpoint() {\n  return useMediaQuery('(max-width:480px)');\n};\nvar getStripeGradient = function getStripeGradient(colorOne, colorTwo) {\n  return 'repeating-linear-gradient(' + '45deg,' + (colorOne + \",\") + (colorOne + \" 10px,\") + (colorTwo + \" 0,\") + (colorTwo + \" 20px\") + ')';\n};\nvar makeLocalChonkyStyles = function makeLocalChonkyStyles(styles // @ts-ignore\n) {\n  return createUseStyles(styles);\n};\nvar makeGlobalChonkyStyles = function makeGlobalChonkyStyles(makeStyles) {\n  var selectorMapping = {};\n  var makeGlobalStyles = function makeGlobalStyles(theme) {\n    var localStyles = makeStyles(theme);\n    var globalStyles = {};\n    var localSelectors = Object.keys(localStyles);\n    localSelectors.map(function (localSelector) {\n      var globalSelector = \"chonky-\" + localSelector;\n      var jssSelector = \"@global .\" + globalSelector; // @ts-ignore\n\n      globalStyles[jssSelector] = localStyles[localSelector]; // @ts-ignore\n\n      selectorMapping[localSelector] = globalSelector;\n    });\n    return globalStyles;\n  }; // @ts-ignore\n\n  var useStyles = createUseStyles(makeGlobalStyles);\n  return function () {\n    var styles = useStyles.apply(void 0, arguments);\n    var classes = {};\n    Object.keys(selectorMapping).map(function (localSelector) {\n      // @ts-ignore\n      classes[localSelector] = selectorMapping[localSelector];\n    });\n    return _extends({}, classes, styles);\n  };\n};\nvar important = function important(value) {\n  return [value, '!important'];\n};\nvar c = classnames;\nvar useFileBrowserHandle = function useFileBrowserHandle(ref) {\n  var store = useStore();\n  var dispatch = useDispatch();\n  useImperativeHandle(ref, function () {\n    return {\n      getFileSelection: function getFileSelection() {\n        var selectionMap = selectSelectionMap(store.getState());\n        var selectionSet = new Set(Object.keys(selectionMap));\n        return selectionSet;\n      },\n      setFileSelection: function setFileSelection(selection, reset) {\n        if (reset === void 0) {\n          reset = true;\n        }\n        var fileIds = Array.from(selection);\n        dispatch(reduxActions.selectFiles({\n          fileIds: fileIds,\n          reset: reset\n        }));\n      },\n      requestFileAction: function requestFileAction(action, payload) {\n        return Promise.resolve(dispatch(thunkRequestFileAction(action, payload))).then();\n      }\n    };\n  }, [store, dispatch]);\n};\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ChonkyBusinessLogicInner = /*#__PURE__*/React.memo( /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _props$files;\n\n  // ==== Update Redux state\n  usePropReduxUpdate(reduxActions.setRawFiles, (_props$files = props.files) != null ? _props$files : initialRootState.rawFiles);\n  usePropReduxUpdate(reduxActions.setRawFolderChain, props.folderChain);\n  useDTE(thunkUpdateRawFileActions, getValueOrFallback(props.fileActions, defaultConfig.fileActions), getValueOrFallback(props.disableDefaultFileActions, defaultConfig.disableDefaultFileActions));\n  useDTE(reduxActions.setExternalFileActionHandler, getValueOrFallback(props.onFileAction, defaultConfig.onFileAction));\n  useDTE(reduxActions.setSelectionDisabled, getValueOrFallback(props.disableSelection, defaultConfig.disableSelection, 'boolean'));\n  useDTE(thunkActivateSortAction, getValueOrFallback(props.defaultSortActionId, defaultConfig.defaultSortActionId));\n  useDTE(thunkUpdateDefaultFileViewActionId, getValueOrFallback(props.defaultFileViewActionId, defaultConfig.defaultFileViewActionId, 'string'));\n  useDTE(reduxActions.setThumbnailGenerator, getValueOrFallback(props.thumbnailGenerator, defaultConfig.thumbnailGenerator));\n  useDTE(reduxActions.setDoubleClickDelay, getValueOrFallback(props.doubleClickDelay, defaultConfig.doubleClickDelay, 'number'));\n  useDTE(reduxActions.setDisableDragAndDrop, getValueOrFallback(props.disableDragAndDrop, defaultConfig.disableDragAndDrop, 'boolean'));\n  useDTE(reduxActions.setClearSelectionOnOutsideClick, getValueOrFallback(props.clearSelectionOnOutsideClick, defaultConfig.clearSelectionOnOutsideClick, 'boolean')); // ==== Setup the imperative handle for external use\n\n  useFileBrowserHandle(ref);\n  return null;\n}));\nChonkyBusinessLogicInner.displayName = 'ChonkyBusinessLogicInner';\nvar ChonkyBusinessLogic = /*#__PURE__*/React.memo(ChonkyBusinessLogicInner);\nChonkyBusinessLogic.displayName = 'ChonkyBusinessLogic';\nvar useDndContextAvailable = function useDndContextAvailable() {\n  var dndContext = useContext(DndContext);\n  var dragDropManager = dndContext.dragDropManager;\n  return !!dragDropManager;\n};\nvar useDragIfAvailable = function useDragIfAvailable() {\n  // This is an ugly hack to make `useDrag` not throw if a `DndContext` is not available.\n  // See: https://github.com/react-dnd/react-dnd/issues/2212\n  var dndContextAvailable = useDndContextAvailable();\n  var mockHook = useCallback(function () {\n    return [{}, function () {\n      return null;\n    }, function () {\n      return null;\n    }];\n  }, []); // @ts-ignore\n\n  var useHook = dndContextAvailable ? useDrag : mockHook;\n  return useHook.apply(void 0, arguments);\n};\nvar useDropIfAvailable = function useDropIfAvailable() {\n  var dndContextAvailable = useDndContextAvailable();\n  var mockHook = useCallback(function () {\n    return [{}, function () {\n      return null;\n    }];\n  }, []); // @ts-ignore\n\n  var useHook = dndContextAvailable ? useDrop : mockHook;\n  return useHook.apply(void 0, arguments);\n};\nvar findClosestChonkyFileId = function findClosestChonkyFileId(element) {\n  var fileEntryWrapperDiv = findElementAmongAncestors(element, function (element) {\n    return element.tagName && element.tagName.toLowerCase() === 'div' && element.dataset && element.dataset.chonkyFileId;\n  });\n  return fileEntryWrapperDiv ? fileEntryWrapperDiv.dataset.chonkyFileId : null;\n};\nvar useContextMenuTrigger = function useContextMenuTrigger() {\n  var dispatch = useDispatch();\n  var contextMenuMountedRef = useInstanceVariable(useSelector(selectContextMenuMounted));\n  return useCallback(function (event) {\n    // Use default browser context menu when Chonky context menu component\n    // is not mounted.\n    if (!contextMenuMountedRef.current) return; // Users can use Alt+Right Click to bring up browser's default\n    // context menu instead of Chonky's context menu.\n\n    if (event.altKey) return;\n    event.preventDefault();\n    var triggerFileId = findClosestChonkyFileId(event.target);\n    dispatch(thunkRequestFileAction(ChonkyActions.OpenFileContextMenu, {\n      clientX: event.clientX,\n      clientY: event.clientY,\n      triggerFileId: triggerFileId\n    }));\n  }, [contextMenuMountedRef, dispatch]);\n};\nvar useContextMenuDismisser = function useContextMenuDismisser() {\n  var dispatch = useDispatch();\n  return useCallback(function () {\n    return dispatch(reduxActions.hideContextMenu());\n  }, [dispatch]);\n};\nvar ChonkyDndFileEntryType = 'dnd-chonky-file-entry';\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar layerStyles = {\n  position: 'fixed',\n  pointerEvents: 'none',\n  zIndex: 100,\n  left: 0,\n  top: 0,\n  width: '100%',\n  height: '100%'\n};\nvar getItemStyles = function getItemStyles(initialCursorOffset, initialFileOffset, currentFileOffset) {\n  if (!initialCursorOffset || !initialFileOffset || !currentFileOffset) {\n    return {\n      display: 'none'\n    };\n  }\n  var x = initialCursorOffset.x + (currentFileOffset.x - initialFileOffset.x);\n  var y = initialCursorOffset.y + (currentFileOffset.y - initialFileOffset.y);\n  var transform = \"translate(\" + x + \"px, \" + y + \"px)\";\n  return {\n    transform: transform,\n    WebkitTransform: transform\n  };\n};\nvar DnDFileListDragLayer = function DnDFileListDragLayer() {\n  var classes = useStyles();\n  var _useDragLayer = useDragLayer(function (monitor) {\n      return {\n        item: monitor.getItem(),\n        itemType: monitor.getItemType(),\n        initialCursorOffset: monitor.getInitialClientOffset(),\n        initialFileOffset: monitor.getInitialSourceClientOffset(),\n        currentFileOffset: monitor.getSourceClientOffset(),\n        isDragging: monitor.isDragging()\n      };\n    }),\n    itemType = _useDragLayer.itemType,\n    item = _useDragLayer.item,\n    initialCursorOffset = _useDragLayer.initialCursorOffset,\n    initialFileOffset = _useDragLayer.initialFileOffset,\n    currentFileOffset = _useDragLayer.currentFileOffset,\n    isDragging = _useDragLayer.isDragging;\n  if (!isDragging || itemType !== ChonkyDndFileEntryType || !item.payload) {\n    return null;\n  }\n  var selectionSize = item.payload.selectedFiles.length;\n  return React.createElement(\"div\", {\n    style: layerStyles\n  }, React.createElement(\"div\", {\n    style: getItemStyles(initialCursorOffset, initialFileOffset, currentFileOffset)\n  }, React.createElement(\"div\", {\n    className: classes.fileDragPreview\n  }, React.createElement(\"b\", null, item.payload.draggedFile.name), selectionSize > 1 && React.createElement(React.Fragment, null, ' and ', React.createElement(\"strong\", null, selectionSize - 1, \" other file\", selectionSize - 1 !== 1 ? 's' : '')))));\n};\nvar useStyles = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    fileDragPreview: {\n      boxShadow: \"2px 2px 5px \" + theme.palette.divider,\n      backgroundColor: theme.palette.background[\"default\"],\n      borderRadius: theme.dragLayer.borderRadius,\n      fontSize: theme.fontSizes.rootPrimary,\n      color: theme.palette.text.primary,\n      padding: theme.dragLayer.padding,\n      border: theme.dragLayer.border,\n      display: 'inline-block'\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar HotkeyListener = /*#__PURE__*/React.memo(function (props) {\n  var fileActionId = props.fileActionId;\n  var dispatch = useDispatch();\n  var fileAction = useParamSelector(selectFileActionData, fileActionId);\n  useEffect(function () {\n    if (!fileAction || !fileAction.hotkeys || fileAction.hotkeys.length === 0) {\n      return;\n    }\n    var hotkeysStr = fileAction.hotkeys.join(',');\n    var hotkeyCallback = function hotkeyCallback(event) {\n      event.preventDefault();\n      dispatch(thunkRequestFileAction(fileAction, undefined));\n    };\n    hotkeys(hotkeysStr, hotkeyCallback);\n    return function () {\n      return hotkeys.unbind(hotkeysStr, hotkeyCallback);\n    };\n  }, [dispatch, fileAction]);\n  return null;\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ChonkyPresentationLayer = function ChonkyPresentationLayer(_ref) {\n  var children = _ref.children;\n  var dispatch = useDispatch();\n  var fileActionIds = useSelector(selectFileActionIds);\n  var dndDisabled = useSelector(selectIsDnDDisabled);\n  var clearSelectionOnOutsideClick = useSelector(selectClearSelectionOnOutsideClick); // Deal with clicks outside of Chonky\n\n  var handleClickAway = useCallback(function (event) {\n    if (!clearSelectionOnOutsideClick || elementIsInsideButton(event.target)) {\n      // We only clear out the selection on outside click if the click target\n      // was not a button. We don't want to clear out the selection when a\n      // button is clicked because Chonky users might want to trigger some\n      // selection-related action on that button click.\n      return;\n    }\n    dispatch(reduxActions.clearSelection());\n  }, [dispatch, clearSelectionOnOutsideClick]); // Generate necessary components\n\n  var hotkeyListenerComponents = useMemo(function () {\n    return fileActionIds.map(function (actionId) {\n      return React.createElement(HotkeyListener, {\n        key: \"file-action-listener-\" + actionId,\n        fileActionId: actionId\n      });\n    });\n  }, [fileActionIds]);\n  var dndContextAvailable = useDndContextAvailable();\n  var showContextMenu = useContextMenuTrigger();\n  var classes = useStyles$1();\n  return React.createElement(ClickAwayListener, {\n    onClickAway: handleClickAway\n  }, React.createElement(Box, {\n    className: classes.chonkyRoot,\n    onContextMenu: showContextMenu\n  }, !dndDisabled && dndContextAvailable && React.createElement(DnDFileListDragLayer, null), hotkeyListenerComponents, children ? children : null));\n};\nvar useStyles$1 = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    chonkyRoot: {\n      backgroundColor: theme.palette.background.paper,\n      border: \"solid 1px \" + theme.palette.divider,\n      padding: theme.margins.rootLayoutMargin,\n      fontSize: theme.fontSizes.rootPrimary,\n      color: theme.palette.text.primary,\n      touchAction: 'manipulation',\n      fontFamily: 'sans-serif',\n      flexDirection: 'column',\n      boxSizing: 'border-box',\n      textAlign: 'left',\n      borderRadius: 4,\n      display: 'flex',\n      height: '100%',\n      // Disabling select\n      webkitTouchCallout: 'none',\n      webkitUserSelect: 'none',\n      mozUserSelect: 'none',\n      msUserSelect: 'none',\n      userSelect: 'none'\n    }\n  };\n});\n\n//     const whyDidYouRender = require('@welldone-software/why-did-you-render');\n//     whyDidYouRender(React, {\n//         trackAllPureComponents: true,\n//     });\n// }\n\nvar FileBrowser = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _ref;\n  var instanceId = props.instanceId,\n    iconComponent = props.iconComponent,\n    children = props.children;\n  var disableDragAndDrop = getValueOrFallback(props.disableDragAndDrop, defaultConfig.disableDragAndDrop, 'boolean');\n  var disableDragAndDropProvider = getValueOrFallback(props.disableDragAndDropProvider, defaultConfig.disableDragAndDropProvider, 'boolean');\n  var darkMode = getValueOrFallback(props.darkMode, defaultConfig.darkMode, 'boolean');\n  var i18n = getValueOrFallback(props.i18n, defaultConfig.i18n);\n  var formatters = useMemo(function () {\n    return _extends({}, defaultFormatters, i18n == null ? void 0 : i18n.formatters);\n  }, [i18n]);\n  var chonkyInstanceId = useStaticValue(function () {\n    return instanceId != null ? instanceId : shortid.generate();\n  });\n  var store = useChonkyStore(chonkyInstanceId);\n  var isMobileBreakpoint = useIsMobileBreakpoint();\n  var theme = useMemo(function () {\n    var muiTheme = createMuiTheme({\n      palette: {\n        type: darkMode ? 'dark' : 'light'\n      }\n    });\n    var combinedTheme = merge(muiTheme, merge(lightTheme, darkMode ? darkThemeOverride : {}));\n    return isMobileBreakpoint ? merge(combinedTheme, mobileThemeOverride) : combinedTheme;\n  }, [darkMode, isMobileBreakpoint]);\n  var chonkyComps = React.createElement(React.Fragment, null, React.createElement(ChonkyBusinessLogic, Object.assign({\n    ref: ref\n  }, props)), React.createElement(ChonkyPresentationLayer, null, children));\n  return React.createElement(IntlProvider, Object.assign({\n    locale: \"en\",\n    defaultLocale: \"en\"\n  }, i18n), React.createElement(ChonkyFormattersContext.Provider, {\n    value: formatters\n  }, React.createElement(Provider, {\n    store: store\n  }, React.createElement(ThemeProvider, {\n    theme: theme\n  }, React.createElement(ThemeProvider$1, {\n    theme: theme\n  }, React.createElement(ChonkyIconContext.Provider, {\n    value: (_ref = iconComponent != null ? iconComponent : defaultConfig.iconComponent) != null ? _ref : ChonkyIconPlaceholder\n  }, disableDragAndDrop || disableDragAndDropProvider ? chonkyComps : React.createElement(DndProvider, {\n    backend: HTML5Backend\n  }, chonkyComps)))))));\n});\nFileBrowser.displayName = 'FileBrowser';\nvar useFolderChainItems = function useFolderChainItems() {\n  var folderChain = useSelector(selectFolderChain);\n  var dispatch = useDispatch();\n  var folderChainItems = useMemo(function () {\n    var items = [];\n    if (!folderChain) return items;\n    var _loop = function _loop(i) {\n      var file = folderChain[i];\n      items.push({\n        file: file,\n        disabled: !file,\n        onClick: !FileHelper.isOpenable(file) || i === folderChain.length - 1 ? undefined : function () {\n          return dispatch(thunkRequestFileAction(ChonkyActions.OpenFiles, {\n            targetFile: file,\n            files: [file]\n          }));\n        }\n      });\n    };\n    for (var i = 0; i < folderChain.length; ++i) {\n      _loop(i);\n    }\n    return items;\n  }, [dispatch, folderChain]);\n  return folderChainItems;\n};\nvar useFileDrag = function useFileDrag(file) {\n  // Prepare the dnd payload\n  var store = useStore();\n  var fileRef = useInstanceVariable(file);\n  var getDndStartPayload = useCallback(function () {\n    var reduxState = store.getState();\n    return {\n      sourceInstanceId: selectInstanceId(reduxState),\n      source: selectCurrentFolder(reduxState),\n      // We force non-null type below because by convention, if drag & drop for\n      // this file was possible, it must have been non-null.\n      draggedFile: fileRef.current,\n      selectedFiles: selectSelectedFiles(reduxState)\n    };\n  }, [store, fileRef]); // For drag source\n\n  var dispatch = useDispatch();\n  var canDrag = useCallback(function () {\n    return FileHelper.isDraggable(fileRef.current);\n  }, [fileRef]);\n  var onDragStart = useCallback(function () {\n    var item = {\n      type: ChonkyDndFileEntryType,\n      payload: getDndStartPayload()\n    };\n    dispatch(thunkRequestFileAction(ChonkyActions.StartDragNDrop, item.payload));\n    return item;\n  }, [dispatch, getDndStartPayload]);\n  var onDragEnd = useCallback(function (item, monitor) {\n    var dropResult = monitor.getDropResult();\n    if (!FileHelper.isDraggable(item.payload.draggedFile) || !dropResult || !dropResult.dropTarget) {\n      return;\n    }\n    dispatch(thunkRequestFileAction(ChonkyActions.EndDragNDrop, _extends({}, item.payload, {\n      destination: dropResult.dropTarget,\n      copy: dropResult.dropEffect === 'copy'\n    })));\n  }, [dispatch]); // Create refs for react-dnd hooks\n\n  var item = useMemo(function () {\n    return {\n      type: ChonkyDndFileEntryType,\n      // Payload is actually added in `onDragStart`\n      payload: {}\n    };\n  }, []);\n  var collect = useCallback(function (monitor) {\n    return {\n      isDragging: monitor.isDragging()\n    };\n  }, []);\n  var _useDragIfAvailable = useDragIfAvailable({\n      item: item,\n      canDrag: canDrag,\n      begin: onDragStart,\n      // @ts-ignore\n      end: onDragEnd,\n      collect: collect\n    }),\n    dndIsDragging = _useDragIfAvailable[0].isDragging,\n    drag = _useDragIfAvailable[1],\n    preview = _useDragIfAvailable[2];\n  useEffect(function () {\n    // Set drag preview to an empty image because `DnDFileListDragLayer` will\n    // provide its own preview.\n    preview(getEmptyImage(), {\n      captureDraggingState: true\n    });\n  }, [preview]);\n  return {\n    dndIsDragging: dndIsDragging,\n    drag: drag\n  };\n};\nvar useFileDrop = function useFileDrop(_ref) {\n  var file = _ref.file,\n    forceDisableDrop = _ref.forceDisableDrop,\n    includeChildrenDrops = _ref.includeChildrenDrops;\n  var folderChainRef = useInstanceVariable(useSelector(selectFolderChain));\n  var onDrop = useCallback(function (_item, monitor) {\n    if (!monitor.canDrop()) return;\n    var customDropResult = {\n      dropTarget: file\n    };\n    return customDropResult;\n  }, [file]);\n  var canDrop = useCallback(function (item, monitor) {\n    if (forceDisableDrop || !FileHelper.isDroppable(file) || !monitor.isOver({\n      shallow: true\n    }) && !includeChildrenDrops) {\n      return false;\n    }\n    var _item$payload = item.payload,\n      source = _item$payload.source,\n      draggedFile = _item$payload.draggedFile,\n      selectedFiles = _item$payload.selectedFiles; // We prevent folders from being dropped into themselves. We also prevent\n    // any folder from current folder chain being moved - we can't move the\n    // folder that we are currently in.\n\n    var prohibitedFileIds = new Set();\n    prohibitedFileIds.add(file.id);\n    folderChainRef.current.map(function (folder) {\n      if (folder) prohibitedFileIds.add(folder.id);\n    });\n    var movedFiles = [draggedFile].concat(selectedFiles);\n    for (var _iterator = _createForOfIteratorHelperLoose(movedFiles), _step; !(_step = _iterator()).done;) {\n      var currFile = _step.value;\n      if (prohibitedFileIds.has(currFile.id)) return false;\n    } // Finally, prohibit files from being moved into their parent folder\n    // (which is a no-op).\n\n    return file.id !== (source == null ? void 0 : source.id);\n  }, [forceDisableDrop, file, includeChildrenDrops, folderChainRef]);\n  var collect = useCallback(function (monitor) {\n    return {\n      isOver: monitor.isOver(),\n      isOverCurrent: monitor.isOver({\n        shallow: true\n      }),\n      canDrop: monitor.canDrop()\n    };\n  }, []);\n  var _useDropIfAvailable = useDropIfAvailable({\n      accept: ChonkyDndFileEntryType,\n      drop: onDrop,\n      canDrop: canDrop,\n      collect: collect\n    }),\n    _useDropIfAvailable$ = _useDropIfAvailable[0],\n    dndIsOver = _useDropIfAvailable$.isOver,\n    dndIsOverCurrent = _useDropIfAvailable$.isOverCurrent,\n    dndCanDrop = _useDropIfAvailable$.canDrop,\n    drop = _useDropIfAvailable[1];\n  return {\n    dndIsOver: dndIsOver,\n    dndIsOverCurrent: dndIsOverCurrent,\n    dndCanDrop: dndCanDrop,\n    drop: drop\n  };\n};\nvar useFileEntryDnD = function useFileEntryDnD(file) {\n  var _useFileDrag = useFileDrag(file),\n    dndIsDragging = _useFileDrag.dndIsDragging,\n    drag = _useFileDrag.drag;\n  var _useFileDrop = useFileDrop({\n      file: file\n    }),\n    dndIsOver = _useFileDrop.dndIsOver,\n    dndCanDrop = _useFileDrop.dndCanDrop,\n    drop = _useFileDrop.drop;\n  var dndState = useMemo(function () {\n    return {\n      dndIsDragging: dndIsDragging,\n      dndIsOver: dndIsOver,\n      dndCanDrop: dndCanDrop\n    };\n  }, [dndCanDrop, dndIsDragging, dndIsOver]);\n  return {\n    drop: drop,\n    drag: drag,\n    dndState: dndState\n  };\n};\nvar useDndHoverOpen = function useDndHoverOpen(file, dndState) {\n  var dispatch = useDispatch();\n  var currentFolderRef = useInstanceVariable(useSelector(selectCurrentFolder));\n  useEffect(function () {\n    var _currentFolderRef$cur;\n    var timeout = null;\n    if (dndState.dndIsOver && FileHelper.isDndOpenable(file) && file.id !== ((_currentFolderRef$cur = currentFolderRef.current) == null ? void 0 : _currentFolderRef$cur.id)) {\n      timeout = setTimeout(function () {\n        return dispatch(thunkRequestFileAction(EssentialActions.OpenFiles, {\n          targetFile: file,\n          files: [file]\n        }));\n      },\n      // TODO: Make this timeout configurable\n      1500);\n    }\n    return function () {\n      if (timeout) clearTimeout(timeout);\n    };\n  }, [dispatch, file, dndState.dndIsOver, currentFolderRef]);\n};\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\n\nvar getRandomInt = function getRandomInt(min, max) {\n  return min + Math.floor(Math.random() * Math.floor(max - min));\n};\nvar TextPlaceholder = /*#__PURE__*/React.memo(function (props) {\n  var minLength = props.minLength,\n    maxLength = props.maxLength;\n  var placeholderLength = getRandomInt(minLength, maxLength);\n  var whitespace = '&nbsp;'.repeat(placeholderLength);\n  var classes = useStyles$2();\n  return React.createElement(\"span\", {\n    className: classes.textPlaceholder,\n    dangerouslySetInnerHTML: {\n      __html: whitespace\n    }\n  });\n});\nvar useStyles$2 = /*#__PURE__*/makeLocalChonkyStyles(function () {\n  return {\n    '@keyframes loading-placeholder': {\n      '0%': {\n        opacity: 0.2\n      },\n      '50%': {\n        opacity: 0.4\n      },\n      '100%': {\n        opacity: 0.2\n      }\n    },\n    textPlaceholder: {\n      animationName: '$loading-placeholder',\n      animationIterationCount: 'infinite',\n      animationTimingFunction: 'linear',\n      animationDuration: '1.5s',\n      backgroundColor: '#ccc',\n      whiteSpace: 'nowrap',\n      overflow: 'hidden',\n      borderRadius: 4,\n      maxWidth: '40%',\n      minWidth: 20\n    }\n  };\n});\nvar useFileEntryHtmlProps = function useFileEntryHtmlProps(file) {\n  return useMemo(function () {\n    var dataProps = {\n      'data-test-id': 'file-entry',\n      'data-chonky-file-id': file ? file.id : undefined\n    };\n    return _extends({\n      role: 'listitem'\n    }, dataProps);\n  }, [file]);\n};\nvar useFileEntryState = function useFileEntryState(file, selected, focused) {\n  var iconData = useIconData(file);\n  var _useThumbnailUrl = useThumbnailUrl(file),\n    thumbnailUrl = _useThumbnailUrl.thumbnailUrl,\n    thumbnailLoading = _useThumbnailUrl.thumbnailLoading;\n  return useMemo(function () {\n    var fileColor = thumbnailUrl ? ColorsDark[iconData.colorCode] : ColorsLight[iconData.colorCode];\n    var iconSpin = thumbnailLoading || !file;\n    var icon = thumbnailLoading ? ChonkyIconName.loading : iconData.icon;\n    return {\n      childrenCount: FileHelper.getChildrenCount(file),\n      icon: file && file.icon !== undefined ? file.icon : icon,\n      iconSpin: iconSpin,\n      thumbnailUrl: thumbnailUrl,\n      color: file && file.color !== undefined ? file.color : fileColor,\n      selected: selected,\n      focused: !!focused\n    };\n  }, [file, focused, iconData, selected, thumbnailLoading, thumbnailUrl]);\n};\nvar useDndIcon = function useDndIcon(dndState) {\n  var dndIconName = null;\n  if (dndState.dndIsOver) {\n    var showDropIcon = dndState.dndCanDrop;\n    dndIconName = showDropIcon ? ChonkyIconName.dndCanDrop : ChonkyIconName.dndCannotDrop;\n  } else if (dndState.dndIsDragging) {\n    dndIconName = ChonkyIconName.dndDragging;\n  }\n  return dndIconName;\n};\nvar useModifierIconComponents = function useModifierIconComponents(file) {\n  var modifierIcons = useMemo(function () {\n    var modifierIcons = [];\n    if (FileHelper.isHidden(file)) modifierIcons.push(ChonkyIconName.hidden);\n    if (FileHelper.isSymlink(file)) modifierIcons.push(ChonkyIconName.symlink);\n    if (FileHelper.isEncrypted(file)) modifierIcons.push(ChonkyIconName.lock);\n    return modifierIcons;\n  }, [file]);\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var modifierIconComponents = useMemo(function () {\n    return modifierIcons.map(function (icon, index) {\n      return React.createElement(ChonkyIcon, {\n        key: \"file-modifier-\" + index,\n        icon: icon\n      });\n    });\n  },\n  // For some reason ESLint marks `ChonkyIcon` as an unnecessary dependency,\n  // but we expect it can change at runtime so we disable the check.\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [ChonkyIcon, modifierIcons]);\n  return modifierIconComponents;\n};\nvar _extname = function _extname(fileName) {\n  var parts = fileName.split('.');\n  if (parts.length) {\n    return \".\" + parts[parts.length - 1];\n  }\n  return '';\n};\nvar useFileNameComponent = function useFileNameComponent(file) {\n  return useMemo(function () {\n    if (!file) return React.createElement(TextPlaceholder, {\n      minLength: 15,\n      maxLength: 20\n    });\n    var name;\n    var extension = null;\n    var isDir = FileHelper.isDirectory(file);\n    if (isDir) {\n      name = file.name;\n    } else {\n      var _file$ext;\n      extension = (_file$ext = file.ext) != null ? _file$ext : _extname(file.name);\n      name = file.name.substr(0, file.name.length - extension.length);\n    }\n    return React.createElement(React.Fragment, null, name, extension && React.createElement(\"span\", {\n      className: \"chonky-file-entry-description-title-extension\"\n    }, extension));\n  }, [file]);\n};\nvar useThumbnailUrl = function useThumbnailUrl(file) {\n  var thumbnailGenerator = useSelector(selectThumbnailGenerator);\n  var _useState = useState(null),\n    thumbnailUrl = _useState[0],\n    setThumbnailUrl = _useState[1];\n  var _useState2 = useState(false),\n    thumbnailLoading = _useState2[0],\n    setThumbnailLoading = _useState2[1];\n  var loadingAttempts = useRef(0);\n  useEffect(function () {\n    var loadingCancelled = false;\n    if (file) {\n      if (thumbnailGenerator) {\n        if (loadingAttempts.current === 0) {\n          setThumbnailLoading(true);\n        }\n        loadingAttempts.current++;\n        Promise.resolve().then(function () {\n          return thumbnailGenerator(file);\n        }).then(function (thumbnailUrl) {\n          if (loadingCancelled) return;\n          setThumbnailLoading(false);\n          if (thumbnailUrl && typeof thumbnailUrl === 'string') {\n            setThumbnailUrl(thumbnailUrl);\n          }\n        })[\"catch\"](function (error) {\n          if (!loadingCancelled) setThumbnailLoading(false);\n          Logger.error(\"User-defined \\\"thumbnailGenerator\\\" handler threw an error: \" + error.message);\n        });\n      } else if (file.thumbnailUrl) {\n        setThumbnailUrl(file.thumbnailUrl);\n      }\n    }\n    return function () {\n      loadingCancelled = true;\n    };\n  }, [file, setThumbnailUrl, setThumbnailLoading, thumbnailGenerator]);\n  return {\n    thumbnailUrl: thumbnailUrl,\n    thumbnailLoading: thumbnailLoading\n  };\n};\nvar useFileClickHandlers = function useFileClickHandlers(file, displayIndex) {\n  var dispatch = useDispatch(); // Prepare base handlers\n\n  var onMouseClick = useCallback(function (event, clickType) {\n    if (!file) return;\n    dispatch(thunkRequestFileAction(ChonkyActions.MouseClickFile, {\n      clickType: clickType,\n      file: file,\n      fileDisplayIndex: displayIndex,\n      altKey: event.altKey,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey\n    }));\n  }, [dispatch, file, displayIndex]);\n  var onKeyboardClick = useCallback(function (event) {\n    if (!file) return;\n    dispatch(thunkRequestFileAction(ChonkyActions.KeyboardClickFile, {\n      file: file,\n      fileDisplayIndex: displayIndex,\n      enterKey: event.enterKey,\n      spaceKey: event.spaceKey,\n      altKey: event.altKey,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey\n    }));\n  }, [dispatch, file, displayIndex]); // Prepare single/double click handlers\n\n  var onSingleClick = useCallback(function (event) {\n    return onMouseClick(event, 'single');\n  }, [onMouseClick]);\n  var onDoubleClick = useCallback(function (event) {\n    return onMouseClick(event, 'double');\n  }, [onMouseClick]);\n  return {\n    onSingleClick: onSingleClick,\n    onDoubleClick: onDoubleClick,\n    onKeyboardClick: onKeyboardClick\n  };\n};\nvar CustomVisibilityState;\n(function (CustomVisibilityState) {\n  CustomVisibilityState[CustomVisibilityState[\"Hidden\"] = 0] = \"Hidden\";\n  CustomVisibilityState[CustomVisibilityState[\"Disabled\"] = 1] = \"Disabled\";\n  CustomVisibilityState[CustomVisibilityState[\"Default\"] = 2] = \"Default\";\n  CustomVisibilityState[CustomVisibilityState[\"Active\"] = 3] = \"Active\";\n})(CustomVisibilityState || (CustomVisibilityState = {}));\nvar useFileActionTrigger = function useFileActionTrigger(fileActionId) {\n  var dispatch = useDispatch();\n  var fileAction = useParamSelector(selectFileActionData, fileActionId);\n  return useCallback(function () {\n    return dispatch(thunkRequestFileAction(fileAction, undefined));\n  }, [dispatch, fileAction]);\n};\nvar useFileActionProps = function useFileActionProps(fileActionId) {\n  var _action$option;\n  var parentFolder = useSelector(selectParentFolder);\n  var fileViewConfig = useSelector(selectFileViewConfig);\n  var sortActionId = useSelector(selectSortActionId);\n  var sortOrder = useSelector(selectSortOrder);\n  var action = useParamSelector(selectFileActionData, fileActionId); // @ts-ignore\n\n  var optionValue = useParamSelector(selectOptionValue, action == null ? void 0 : (_action$option = action.option) == null ? void 0 : _action$option.id);\n  var actionSelectionSize = useParamSelector(selectSelectedFilesForActionCount, fileActionId);\n  var actionSelectionEmpty = actionSelectionSize === 0;\n  return useMemo(function () {\n    var _action$button$icon, _action$button;\n    if (!action) return {\n      icon: null,\n      active: false,\n      disabled: true\n    };\n    var icon = (_action$button$icon = (_action$button = action.button) == null ? void 0 : _action$button.icon) != null ? _action$button$icon : null;\n    if (action.sortKeySelector) {\n      if (sortActionId === action.id) {\n        if (sortOrder === SortOrder.ASC) {\n          icon = ChonkyIconName.sortAsc;\n        } else {\n          icon = ChonkyIconName.sortDesc;\n        }\n      } else {\n        icon = ChonkyIconName.placeholder;\n      }\n    } else if (action.option) {\n      if (optionValue) {\n        icon = ChonkyIconName.toggleOn;\n      } else {\n        icon = ChonkyIconName.toggleOff;\n      }\n    }\n    var isSortButtonAndCurrentSort = action.id === sortActionId;\n    var isFileViewButtonAndCurrentView = action.fileViewConfig === fileViewConfig;\n    var isOptionAndEnabled = action.option ? !!optionValue : false;\n    var customDisabled = false;\n    var customActive = false;\n    if (action.customVisibility !== undefined) {\n      customDisabled = action.customVisibility() === CustomVisibilityState.Disabled;\n      customActive = action.customVisibility() === CustomVisibilityState.Active;\n    }\n    var active = isSortButtonAndCurrentSort || isFileViewButtonAndCurrentView || isOptionAndEnabled || customActive;\n    var disabled = !!action.requiresSelection && actionSelectionEmpty || customDisabled;\n    if (action.id === ChonkyActions.OpenParentFolder.id) {\n      // We treat `open_parent_folder` file action as a special case as it\n      // requires the parent folder to be present to work...\n      disabled = disabled || !FileHelper.isOpenable(parentFolder);\n    }\n    return {\n      icon: icon,\n      active: active,\n      disabled: disabled\n    };\n  }, [parentFolder, fileViewConfig, sortActionId, sortOrder, action, optionValue, actionSelectionEmpty]);\n};\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ToolbarButton = /*#__PURE__*/React.memo(function (props) {\n  var _c;\n  var externalClassName = props.className,\n    text = props.text,\n    tooltip = props.tooltip,\n    active = props.active,\n    icon = props.icon,\n    iconOnly = props.iconOnly,\n    onClick = props.onClick,\n    disabled = props.disabled,\n    dropdown = props.dropdown;\n  var classes = useStyles$3();\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var iconComponent = icon || iconOnly ? React.createElement(\"div\", {\n    className: iconOnly ? '' : classes.iconWithText\n  }, React.createElement(ChonkyIcon, {\n    icon: icon ? icon : ChonkyIconName.fallbackIcon,\n    fixedWidth: true\n  })) : null;\n  var className = c((_c = {}, _c[externalClassName != null ? externalClassName : ''] = true, _c[classes.baseButton] = true, _c[classes.iconOnlyButton] = iconOnly, _c[classes.activeButton] = !!active, _c));\n  return React.createElement(Button, {\n    className: className,\n    onClick: onClick,\n    title: tooltip ? tooltip : text,\n    disabled: disabled || !onClick\n  }, iconComponent, text && !iconOnly && React.createElement(\"span\", null, text), dropdown && React.createElement(\"div\", {\n    className: classes.iconDropdown\n  }, React.createElement(ChonkyIcon, {\n    icon: icon ? icon : ChonkyIconName.dropdown,\n    fixedWidth: true\n  })));\n});\nvar useStyles$3 = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    baseButton: {\n      fontSize: important(theme.toolbar.fontSize),\n      textTransform: important('none'),\n      letterSpacing: important(0),\n      minWidth: important('auto'),\n      lineHeight: theme.toolbar.lineHeight,\n      height: theme.toolbar.size,\n      paddingBottom: important(0),\n      paddingTop: important(0)\n    },\n    iconWithText: {\n      marginRight: 8\n    },\n    iconOnlyButton: {\n      width: theme.toolbar.size,\n      textAlign: 'center'\n    },\n    iconDropdown: {\n      fontSize: '0.7em',\n      marginLeft: 2,\n      marginTop: 1\n    },\n    activeButton: {\n      color: important(theme.colors.textActive)\n    }\n  };\n});\nvar SmartToolbarButton = /*#__PURE__*/React.memo(function (props) {\n  var fileActionId = props.fileActionId;\n  var action = useParamSelector(selectFileActionData, fileActionId);\n  var triggerAction = useFileActionTrigger(fileActionId);\n  var _useFileActionProps = useFileActionProps(fileActionId),\n    icon = _useFileActionProps.icon,\n    active = _useFileActionProps.active,\n    disabled = _useFileActionProps.disabled;\n  var _useLocalizedFileActi = useLocalizedFileActionStrings(action),\n    buttonName = _useLocalizedFileActi.buttonName,\n    buttonTooltip = _useLocalizedFileActi.buttonTooltip;\n  if (!action) return null;\n  var button = action.button;\n  if (!button) return null;\n  if (action.customVisibility !== undefined && action.customVisibility() === CustomVisibilityState.Hidden) return null;\n  return React.createElement(ToolbarButton, {\n    text: buttonName,\n    tooltip: buttonTooltip,\n    icon: icon,\n    iconOnly: button.iconOnly,\n    active: active,\n    onClick: triggerAction,\n    disabled: disabled\n  });\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar FolderChainButton = /*#__PURE__*/React.memo(function (_ref) {\n  var _c;\n  var first = _ref.first,\n    current = _ref.current,\n    item = _ref.item;\n  var file = item.file,\n    disabled = item.disabled,\n    onClick = item.onClick;\n  var _useFileDrop = useFileDrop({\n      file: file,\n      forceDisableDrop: !file || current\n    }),\n    dndIsOver = _useFileDrop.dndIsOver,\n    dndCanDrop = _useFileDrop.dndCanDrop,\n    drop = _useFileDrop.drop;\n  var dndState = useMemo(function () {\n    return {\n      dndIsOver: dndIsOver,\n      dndCanDrop: dndCanDrop,\n      dndIsDragging: false\n    };\n  }, [dndCanDrop, dndIsOver]);\n  useDndHoverOpen(file, dndState);\n  var dndIconName = useDndIcon(dndState);\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var classes = useStyles$4(dndState);\n  var className = c((_c = {}, _c[classes.baseBreadcrumb] = true, _c[classes.disabledBreadcrumb] = disabled, _c[classes.currentBreadcrumb] = current, _c));\n  var text = file ? file.name : 'Loading...';\n  var icon = first && (file == null ? void 0 : file.folderChainIcon) === undefined ? ChonkyIconName.folder : file == null ? void 0 : file.folderChainIcon;\n  return React.createElement(\"div\", {\n    className: classes.buttonContainer,\n    ref: file ? drop : null\n  }, file && dndIconName && React.createElement(\"div\", {\n    className: classes.dndIndicator\n  }, React.createElement(ChonkyIcon, {\n    icon: dndIconName,\n    fixedWidth: true\n  })), React.createElement(ToolbarButton, {\n    icon: icon,\n    className: className,\n    text: text,\n    disabled: disabled,\n    onClick: onClick\n  }));\n});\nvar useStyles$4 = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    buttonContainer: {\n      position: 'relative'\n    },\n    baseBreadcrumb: {\n      color: function color(dndState) {\n        var color = theme.palette.text.primary;\n        if (dndState.dndIsOver) {\n          color = dndState.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor;\n        }\n        return important(color);\n      }\n    },\n    disabledBreadcrumb: {\n      // Constant function here is on purpose. Without the function, the color here\n      // does not override the `baseBreadcrumb` color from above.\n      color: function color() {\n        return important(theme.palette.text.disabled);\n      }\n    },\n    currentBreadcrumb: {\n      textDecoration: important('underline')\n    },\n    dndIndicator: {\n      color: function color(dndState) {\n        return dndState.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor;\n      },\n      backgroundColor: function backgroundColor(dndState) {\n        return dndState.dndCanDrop ? theme.dnd.canDropMask : theme.dnd.cannotDropMask;\n      },\n      lineHeight: \"calc(\" + theme.toolbar.lineHeight + \" - 6px)\",\n      transform: 'translateX(-50%) translateY(-50%)',\n      borderRadius: theme.toolbar.buttonRadius,\n      height: theme.toolbar.size - 6,\n      width: theme.toolbar.size - 6,\n      boxSizing: 'border-box',\n      position: 'absolute',\n      textAlign: 'center',\n      left: '50%',\n      top: '50%',\n      zIndex: 5\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar FileNavbar = /*#__PURE__*/React.memo(function () {\n  var classes = useStyles$5();\n  var folderChainItems = useFolderChainItems();\n  var folderChainComponents = useMemo(function () {\n    var components = [];\n    for (var i = 0; i < folderChainItems.length; ++i) {\n      var key = \"folder-chain-\" + i;\n      var component = React.createElement(FolderChainButton, {\n        key: key,\n        first: i === 0,\n        current: i === folderChainItems.length - 1,\n        item: folderChainItems[i]\n      });\n      components.push(component);\n    }\n    return components;\n  }, [folderChainItems]);\n  return React.createElement(Box, {\n    className: classes.navbarWrapper\n  }, React.createElement(Box, {\n    className: classes.navbarContainer\n  }, React.createElement(SmartToolbarButton, {\n    fileActionId: ChonkyActions.OpenParentFolder.id\n  }), React.createElement(Breadcrumbs, {\n    className: classes.navbarBreadcrumbs,\n    classes: {\n      separator: classes.separator\n    }\n  }, folderChainComponents)));\n});\nvar useStyles$5 = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    navbarWrapper: {\n      paddingBottom: theme.margins.rootLayoutMargin\n    },\n    navbarContainer: {\n      display: 'flex'\n    },\n    upDirectoryButton: {\n      fontSize: important(theme.toolbar.fontSize),\n      height: theme.toolbar.size,\n      width: theme.toolbar.size,\n      padding: '0px !important'\n    },\n    navbarBreadcrumbs: {\n      fontSize: important(theme.toolbar.fontSize),\n      flexGrow: 100\n    },\n    separator: {\n      marginRight: important(4),\n      marginLeft: important(4)\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ToolbarDropdownButton = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _c;\n  var text = props.text,\n    active = props.active,\n    icon = props.icon,\n    onClick = props.onClick,\n    disabled = props.disabled;\n  var classes = useStyles$6();\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var className = c((_c = {}, _c[classes.baseButton] = true, _c[classes.activeButton] = active, _c));\n  return React.createElement(MenuItem, {\n    ref: ref,\n    className: className,\n    onClick: onClick,\n    disabled: disabled\n  }, icon && React.createElement(ListItemIcon, {\n    className: classes.icon\n  }, React.createElement(ChonkyIcon, {\n    icon: icon,\n    fixedWidth: true\n  })), React.createElement(ListItemText, {\n    primaryTypographyProps: {\n      className: classes.text\n    }\n  }, text));\n});\nvar useStyles$6 = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    baseButton: {\n      lineHeight: important(theme.toolbar.lineHeight),\n      height: important(theme.toolbar.size),\n      minHeight: important('auto'),\n      minWidth: important('auto'),\n      padding: important(20)\n    },\n    icon: {\n      fontSize: important(theme.toolbar.fontSize),\n      minWidth: important('auto'),\n      color: important('inherit'),\n      marginRight: 8\n    },\n    text: {\n      fontSize: important(theme.toolbar.fontSize)\n    },\n    activeButton: {\n      color: important(theme.colors.textActive)\n    }\n  };\n});\nvar SmartToolbarDropdownButton = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var fileActionId = props.fileActionId,\n    onClickFollowUp = props.onClickFollowUp;\n  var action = useParamSelector(selectFileActionData, fileActionId);\n  var triggerAction = useFileActionTrigger(fileActionId);\n  var _useFileActionProps = useFileActionProps(fileActionId),\n    icon = _useFileActionProps.icon,\n    active = _useFileActionProps.active,\n    disabled = _useFileActionProps.disabled;\n  var _useLocalizedFileActi = useLocalizedFileActionStrings(action),\n    buttonName = _useLocalizedFileActi.buttonName; // Combine external click handler with internal one\n\n  var handleClick = useCallback(function () {\n    triggerAction();\n    if (onClickFollowUp) onClickFollowUp();\n  }, [onClickFollowUp, triggerAction]);\n  if (!action) return null;\n  var button = action.button;\n  if (!button) return null;\n  if (action.customVisibility !== undefined && action.customVisibility() === CustomVisibilityState.Hidden) return null;\n  return React.createElement(ToolbarDropdownButton, {\n    ref: ref,\n    text: buttonName,\n    icon: icon,\n    onClick: handleClick,\n    active: active,\n    disabled: disabled\n  });\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ToolbarDropdown = /*#__PURE__*/React.memo(function (props) {\n  var name = props.name,\n    fileActionIds = props.fileActionIds;\n  var _React$useState = React.useState(null),\n    anchor = _React$useState[0],\n    setAnchor = _React$useState[1];\n  var handleClick = useCallback(function (event) {\n    return setAnchor(event.currentTarget);\n  }, [setAnchor]);\n  var handleClose = useCallback(function () {\n    return setAnchor(null);\n  }, [setAnchor]);\n  var menuItemComponents = useMemo(function () {\n    return fileActionIds.map(function (id) {\n      return React.createElement(SmartToolbarDropdownButton, {\n        key: \"menu-item-\" + id,\n        fileActionId: id,\n        onClickFollowUp: handleClose\n      });\n    });\n  }, [fileActionIds, handleClose]);\n  var localizedName = useLocalizedFileActionGroup(name);\n  var classes = useStyles$7();\n  return React.createElement(React.Fragment, null, React.createElement(ToolbarButton, {\n    text: localizedName,\n    onClick: handleClick,\n    dropdown: true\n  }), React.createElement(Menu, {\n    autoFocus: true,\n    keepMounted: true,\n    elevation: 2,\n    anchorEl: anchor,\n    onClose: handleClose,\n    open: Boolean(anchor),\n    transitionDuration: 150,\n    classes: {\n      list: classes.dropdownList\n    }\n  }, menuItemComponents));\n});\nvar useStyles$7 = /*#__PURE__*/makeGlobalChonkyStyles(function () {\n  return {\n    dropdownList: {\n      paddingBottom: important(0),\n      paddingTop: important(0)\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ToolbarInfo = /*#__PURE__*/React.memo(function () {\n  var classes = useStyles$8();\n  var displayFileIds = useSelector(selectors.getDisplayFileIds);\n  var selectionSize = useSelector(selectSelectionSize);\n  var hiddenCount = useSelector(selectHiddenFileCount);\n  var intl = useIntl();\n  var fileCountString = intl.formatMessage({\n    id: getI18nId(I18nNamespace.Toolbar, 'visibleFileCount'),\n    defaultMessage: \"{fileCount, plural,\\n                =0 {# items}\\n                one {# item}\\n                other {# items}\\n            }\"\n  }, {\n    fileCount: displayFileIds.length\n  });\n  var selectedString = intl.formatMessage({\n    id: getI18nId(I18nNamespace.Toolbar, 'selectedFileCount'),\n    defaultMessage: \"{fileCount, plural,\\n                =0 {}\\n                other {# selected}\\n            }\"\n  }, {\n    fileCount: selectionSize\n  });\n  var hiddenString = intl.formatMessage({\n    id: getI18nId(I18nNamespace.Toolbar, 'hiddenFileCount'),\n    defaultMessage: \"{fileCount, plural,\\n                =0 {}\\n                other {# hidden}\\n            }\"\n  }, {\n    fileCount: hiddenCount\n  });\n  return React.createElement(\"div\", {\n    className: classes.infoContainer\n  }, React.createElement(Typography, {\n    className: classes.infoText,\n    variant: \"body1\"\n  }, fileCountString, (selectedString || hiddenString) && React.createElement(\"span\", {\n    className: classes.extraInfoSpan\n  }, \"(\", React.createElement(\"span\", {\n    className: classes.selectionSizeText\n  }, selectedString), selectedString && hiddenString && ', ', React.createElement(\"span\", {\n    className: classes.hiddenCountText\n  }, hiddenString), \")\")));\n});\nvar useStyles$8 = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    infoContainer: {\n      height: theme.toolbar.size,\n      display: 'flex'\n    },\n    infoText: {\n      lineHeight: important(theme.toolbar.lineHeight),\n      fontSize: important(theme.toolbar.fontSize),\n      marginLeft: important(12),\n      height: theme.toolbar.size\n    },\n    extraInfoSpan: {\n      marginRight: important(8),\n      marginLeft: important(8),\n      opacity: 0.8\n    },\n    selectionSizeText: {\n      color: theme.colors.textActive\n    },\n    hiddenCountText: {}\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ToolbarSearch = /*#__PURE__*/React.memo(function () {\n  var intl = useIntl();\n  var searchPlaceholderString = intl.formatMessage({\n    id: getI18nId(I18nNamespace.Toolbar, 'searchPlaceholder'),\n    defaultMessage: 'Search'\n  });\n  var classes = useStyles$9();\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var searchInputRef = useRef();\n  var dispatch = useDispatch();\n  var reduxSearchString = useSelector(selectSearchString);\n  var _useState = useState(reduxSearchString),\n    localSearchString = _useState[0],\n    setLocalSearchString = _useState[1];\n  var _useDebounce = useDebounce(localSearchString, 300),\n    debouncedLocalSearchString = _useDebounce[0];\n  var _useState2 = useState(false),\n    showLoadingIndicator = _useState2[0],\n    setShowLoadingIndicator = _useState2[1];\n  useEffect(function () {\n    dispatch(reduxActions.setFocusSearchInput(function () {\n      if (searchInputRef.current) searchInputRef.current.focus();\n    }));\n    return function () {\n      dispatch(reduxActions.setFocusSearchInput(null));\n    };\n  }, [dispatch]);\n  useEffect(function () {\n    setShowLoadingIndicator(false);\n    dispatch(reduxActions.setSearchString(debouncedLocalSearchString));\n  }, [debouncedLocalSearchString, dispatch]);\n  var handleChange = useCallback(function (event) {\n    setShowLoadingIndicator(true);\n    setLocalSearchString(event.currentTarget.value);\n  }, []);\n  var handleKeyUp = useCallback(function (event) {\n    // Remove focus from the search input field when user presses escape.\n    // Note: We use KeyUp instead of KeyPress because some browser plugins can\n    //       intercept KeyPress events with Escape key.\n    //       @see https://stackoverflow.com/a/37461974\n    if (event.key === 'Escape') {\n      setLocalSearchString('');\n      dispatch(reduxActions.setSearchString(''));\n      if (searchInputRef.current) searchInputRef.current.blur();\n    }\n  }, [dispatch]);\n  return React.createElement(TextField, {\n    className: classes.searchFieldContainer,\n    size: \"small\",\n    variant: \"outlined\",\n    value: localSearchString,\n    placeholder: searchPlaceholderString,\n    onChange: handleChange,\n    inputRef: searchInputRef,\n    InputProps: {\n      onKeyUp: handleKeyUp,\n      startAdornment: React.createElement(InputAdornment, {\n        className: classes.searchIcon,\n        position: \"start\"\n      }, React.createElement(ChonkyIcon, {\n        icon: showLoadingIndicator ? ChonkyIconName.loading : ChonkyIconName.search,\n        spin: showLoadingIndicator\n      })),\n      className: classes.searchFieldInput\n    },\n    inputProps: {\n      className: classes.searchFieldInputInner\n    }\n  });\n});\nvar useStyles$9 = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    searchFieldContainer: {\n      height: theme.toolbar.size,\n      width: 150\n    },\n    searchIcon: {\n      fontSize: '0.9em',\n      opacity: 0.75\n    },\n    searchFieldInput: {\n      lineHeight: important(0),\n      padding: important(0),\n      margin: important(0),\n      fontSize: important(theme.toolbar.fontSize),\n      borderRadius: theme.toolbar.buttonRadius,\n      height: theme.toolbar.size - 4,\n      paddingLeft: important(8),\n      marginTop: 2\n    },\n    searchFieldInputInner: {\n      lineHeight: important(theme.toolbar.size - 4 + \"px\"),\n      fontSize: important(theme.toolbar.fontSize),\n      height: important(theme.toolbar.size - 4),\n      padding: important([0, 8, 0, 0]),\n      margin: important(0),\n      '-webkit-appearance': 'none'\n    }\n  };\n});\nvar FileToolbar = /*#__PURE__*/React.memo(function () {\n  var classes = useStyles$a();\n  var toolbarItems = useSelector(selectToolbarItems);\n  var toolbarItemComponents = useMemo(function () {\n    var components = [];\n    for (var i = 0; i < toolbarItems.length; ++i) {\n      var item = toolbarItems[i];\n      var key = \"toolbar-item-\" + (typeof item === 'string' ? item : item.name);\n      var component = typeof item === 'string' ? React.createElement(SmartToolbarButton, {\n        key: key,\n        fileActionId: item\n      }) : React.createElement(ToolbarDropdown, {\n        key: key,\n        name: item.name,\n        fileActionIds: item.fileActionIds\n      });\n      components.push(component);\n    }\n    return components;\n  }, [toolbarItems]);\n  return React.createElement(\"div\", {\n    className: classes.toolbarWrapper\n  }, React.createElement(\"div\", {\n    className: classes.toolbarContainer\n  }, React.createElement(\"div\", {\n    className: classes.toolbarLeft\n  }, React.createElement(ToolbarSearch, null), React.createElement(ToolbarInfo, null)), React.createElement(\"div\", {\n    className: classes.toolbarRight\n  }, toolbarItemComponents)));\n});\nvar useStyles$a = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    toolbarWrapper: {},\n    toolbarContainer: {\n      flexWrap: 'wrap-reverse',\n      display: 'flex'\n    },\n    toolbarLeft: {\n      paddingBottom: theme.margins.rootLayoutMargin,\n      flexWrap: 'nowrap',\n      flexGrow: 10000,\n      display: 'flex'\n    },\n    toolbarLeftFiller: {\n      flexGrow: 10000\n    },\n    toolbarRight: {\n      paddingBottom: theme.margins.rootLayoutMargin,\n      flexWrap: 'nowrap',\n      display: 'flex'\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar FileListEmpty = function FileListEmpty(props) {\n  var width = props.width,\n    height = props.height;\n  var classes = useStyles$b();\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var style = {\n    width: width,\n    height: height\n  };\n  var intl = useIntl();\n  var emptyString = intl.formatMessage({\n    id: getI18nId(I18nNamespace.FileList, 'nothingToShow'),\n    defaultMessage: 'Nothing to show'\n  });\n  return React.createElement(\"div\", {\n    className: classes.fileListEmpty,\n    style: style\n  }, React.createElement(\"div\", {\n    className: classes.fileListEmptyContent\n  }, React.createElement(ChonkyIcon, {\n    icon: ChonkyIconName.folderOpen\n  }), \"\\xA0 \", emptyString));\n};\nvar useStyles$b = /*#__PURE__*/makeGlobalChonkyStyles(function (theme) {\n  return {\n    fileListEmpty: {\n      color: theme.palette.text.disabled,\n      position: 'relative',\n      textAlign: 'center',\n      fontSize: '1.2em'\n    },\n    fileListEmptyContent: {\n      transform: 'translateX(-50%) translateY(-50%)',\n      position: 'absolute',\n      left: '50%',\n      top: '50%'\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar useClickHandler = function useClickHandler(onSingleClick, onDoubleClick) {\n  var doubleClickDelay = useSelector(selectDoubleClickDelay);\n  var counter = useRef({\n    clickCount: 0,\n    clickTimeout: null\n  });\n  return useCallback(function (event) {\n    var mouseClickEvent = {\n      altKey: event.altKey,\n      ctrlKey: event.ctrlKey || event.metaKey,\n      shiftKey: event.shiftKey\n    };\n    counter.current.clickCount++;\n    if (counter.current.clickCount === 1) {\n      if (onSingleClick) {\n        event.preventDefault();\n        onSingleClick(mouseClickEvent);\n      }\n      counter.current.clickCount = 1; // @ts-ignore\n\n      counter.current.clickTimeout = setTimeout(function () {\n        return counter.current.clickCount = 0;\n      }, doubleClickDelay);\n    } else if (counter.current.clickCount === 2) {\n      if (onDoubleClick) {\n        event.preventDefault();\n        onDoubleClick(mouseClickEvent);\n      }\n      if (typeof counter.current.clickTimeout === 'number') {\n        clearTimeout(counter.current.clickTimeout);\n        counter.current.clickTimeout = null;\n        counter.current.clickCount = 0;\n      }\n    }\n  }, [doubleClickDelay, onSingleClick, onDoubleClick, counter]);\n};\nvar useKeyDownHandler = function useKeyDownHandler(onKeyboardClick) {\n  return useCallback(function (event) {\n    if (!onKeyboardClick) return;\n    var keyboardClickEvent = {\n      enterKey: event.nativeEvent.code === 'Enter',\n      spaceKey: event.nativeEvent.code === 'Space',\n      altKey: event.altKey,\n      ctrlKey: event.ctrlKey,\n      shiftKey: event.shiftKey\n    };\n    if (keyboardClickEvent.spaceKey || keyboardClickEvent.enterKey) {\n      event.preventDefault();\n      event.stopPropagation();\n      onKeyboardClick(keyboardClickEvent);\n    }\n  }, [onKeyboardClick]);\n};\nvar ClickableWrapper = function ClickableWrapper(props) {\n  var children = props.children,\n    WrapperTag = props.wrapperTag,\n    passthroughProps = props.passthroughProps,\n    onSingleClick = props.onSingleClick,\n    onDoubleClick = props.onDoubleClick,\n    onKeyboardClick = props.onKeyboardClick,\n    setFocused = props.setFocused;\n  var handleClick = useClickHandler(onSingleClick, onDoubleClick);\n  var handleKeyDown = useKeyDownHandler(onKeyboardClick);\n  var compProps = {\n    onFocus: useCallback(function () {\n      return setFocused && setFocused(true);\n    }, [setFocused]),\n    onBlur: useCallback(function () {\n      return setFocused && setFocused(false);\n    }, [setFocused])\n  };\n  if (onSingleClick || onDoubleClick || onKeyboardClick) {\n    compProps.onClick = handleClick;\n    compProps.onKeyDown = handleKeyDown;\n    compProps.tabIndex = 0;\n  }\n  var mergedProps = _extends({}, compProps, passthroughProps);\n  return React.createElement(WrapperTag, Object.assign({}, mergedProps), children);\n};\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar FileEntryName = /*#__PURE__*/React.memo(function (_ref) {\n  var file = _ref.file,\n    className = _ref.className;\n  var modifierIconComponents = useModifierIconComponents(file);\n  var fileNameComponent = useFileNameComponent(file);\n  var classes = useStyles$c();\n  return React.createElement(\"span\", {\n    className: className,\n    title: file ? file.name : undefined\n  }, modifierIconComponents.length > 0 && React.createElement(\"span\", {\n    className: classes.modifierIcons\n  }, modifierIconComponents), fileNameComponent);\n});\nFileEntryName.displayName = 'FileEntryName';\nvar useStyles$c = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    modifierIcons: {\n      color: theme.palette.text.hint,\n      position: 'relative',\n      fontSize: '0.775em',\n      paddingRight: 5\n    }\n  };\n});\nvar CompactEntry = /*#__PURE__*/React.memo(\n// @ts-ignore\nfunction (_ref) {\n  var file = _ref.file,\n    selected = _ref.selected,\n    focused = _ref.focused;\n  var entryState = useFileEntryState(file, selected, focused);\n  var _useLocalizedFileEntr = useLocalizedFileEntryStrings(file),\n    fileModDateString = _useLocalizedFileEntr.fileModDateString,\n    fileSizeString = _useLocalizedFileEntr.fileSizeString;\n  var classes = useStyles$d(entryState);\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var fileEntryHtmlProps = useFileEntryHtmlProps(file);\n  return React.createElement(\"div\", Object.assign({\n    className: classes.listFileEntry\n  }, fileEntryHtmlProps), React.createElement(\"div\", {\n    className: classes.listFileEntryIcon\n  }, React.createElement(ChonkyIcon, {\n    icon: entryState.icon,\n    spin: entryState.iconSpin,\n    fixedWidth: true\n  })), React.createElement(\"div\", {\n    className: classes.listFileEntryDescription\n  }, React.createElement(\"div\", {\n    className: classes.listFileEntryName,\n    title: file ? file.name : undefined\n  }, React.createElement(FileEntryName, {\n    file: file\n  })), React.createElement(\"div\", {\n    className: classes.listFileEntryProperties\n  }, React.createElement(\"div\", {\n    className: classes.listFileEntryProperty\n  }, file ? fileModDateString != null ? fileModDateString : React.createElement(\"span\", null, \"\\u2014\") : React.createElement(TextPlaceholder, {\n    minLength: 5,\n    maxLength: 15\n  })), React.createElement(\"div\", {\n    className: classes.listFileEntryProperty\n  }, file ? fileSizeString != null ? fileSizeString : React.createElement(\"span\", null, \"\\u2014\") : React.createElement(TextPlaceholder, {\n    minLength: 10,\n    maxLength: 20\n  })))), React.createElement(\"div\", {\n    className: \"chonky-file-entry-outline\"\n  }), React.createElement(\"div\", {\n    className: \"chonky-file-entry-selection\"\n  }));\n});\nvar useStyles$d = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    listFileEntry: {\n      fontSize: theme.listFileEntry.fontSize,\n      alignItems: 'center',\n      position: 'relative',\n      display: 'flex',\n      height: '100%'\n    },\n    listFileEntryIcon: {\n      backgroundColor: function backgroundColor(state) {\n        return state.color;\n      },\n      boxShadow: 'inset rgba(255, 255, 255, 0.5) 0 0 0 999px',\n      borderRadius: theme.listFileEntry.iconBorderRadius,\n      fontSize: theme.listFileEntry.iconFontSize,\n      color: '#fff',\n      padding: 8\n    },\n    listFileEntryDescription: {\n      flexDirection: 'column',\n      display: 'flex',\n      flexGrow: 1\n    },\n    listFileEntryName: {\n      padding: [0, 8, 4, 8]\n    },\n    listFileEntryProperties: {\n      fontSize: theme.listFileEntry.propertyFontSize,\n      flexDirection: 'row',\n      display: 'flex'\n    },\n    listFileEntryProperty: {\n      padding: [0, 8],\n      opacity: 0.4\n    }\n  };\n});\nvar DnDFileEntry = /*#__PURE__*/React.memo(function (_ref) {\n  var file = _ref.file,\n    children = _ref.children;\n  var _useFileEntryDnD = useFileEntryDnD(file),\n    drop = _useFileEntryDnD.drop,\n    drag = _useFileEntryDnD.drag,\n    dndState = _useFileEntryDnD.dndState;\n  useDndHoverOpen(file, dndState);\n  var classes = useStyles$e();\n  return React.createElement(\"div\", {\n    ref: drop,\n    className: classes.fillParent\n  }, React.createElement(\"div\", {\n    ref: FileHelper.isDraggable(file) ? drag : null,\n    className: classes.fillParent\n  }, children(dndState)));\n});\nvar useStyles$e = /*#__PURE__*/makeLocalChonkyStyles(function () {\n  return {\n    fillParent: {\n      height: '100%'\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar FileThumbnail = /*#__PURE__*/React.memo(function (props) {\n  var className = props.className,\n    thumbnailUrl = props.thumbnailUrl;\n  var thumbnailStyle = thumbnailUrl ? {\n    backgroundImage: \"url('\" + thumbnailUrl + \"')\"\n  } : {};\n  var classes = useStyles$f();\n  return React.createElement(\"div\", {\n    className: classnames([className, classes.fileThumbnail]),\n    style: thumbnailStyle\n  });\n});\nFileThumbnail.displayName = 'FileThumbnail';\nvar useStyles$f = /*#__PURE__*/makeGlobalChonkyStyles(function () {\n  return {\n    fileThumbnail: {\n      backgroundRepeat: 'no-repeat',\n      backgroundPosition: 'center',\n      backgroundSize: 'contain'\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar GridEntryDndIndicator = /*#__PURE__*/React.memo(function (props) {\n  var _c;\n  var externalClassName = props.className,\n    dndState = props.dndState;\n  var dndIconName = useDndIcon(dndState);\n  var classes = useStyles$g(dndState);\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  if (!dndIconName) return null;\n  var className = c((_c = {}, _c[classes.dndIndicator] = true, _c[externalClassName] = true, _c));\n  return React.createElement(\"div\", {\n    className: className\n  }, React.createElement(ChonkyIcon, {\n    icon: dndIconName\n  }));\n});\nvar useStyles$g = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    dndIndicator: {\n      color: function color(dndState) {\n        return dndState.dndIsOver ? dndState.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor : '#000';\n      },\n      boxSizing: 'border-box',\n      position: 'absolute',\n      fontSize: '1.2em',\n      opacity: 0.6,\n      padding: 6,\n      '&:before': {\n        borderBottom: '50px solid transparent',\n        borderLeft: '50px solid #fff',\n        position: 'absolute',\n        content: '\"\"',\n        zIndex: -1,\n        left: 0,\n        top: 0\n      }\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar GridEntryPreviewFolder = /*#__PURE__*/React.memo(function (props) {\n  var _c;\n  var externalClassName = props.className,\n    entryState = props.entryState,\n    dndState = props.dndState;\n  var folderClasses = useFolderStyles(entryState);\n  var fileClasses = useFileStyles(entryState);\n  var commonClasses = useCommonEntryStyles(entryState);\n  var className = c((_c = {}, _c[folderClasses.previewFile] = true, _c[externalClassName || ''] = !!externalClassName, _c));\n  return React.createElement(\"div\", {\n    className: className\n  }, React.createElement(\"div\", {\n    className: folderClasses.folderBackSideMid\n  }, React.createElement(\"div\", {\n    className: folderClasses.folderBackSideTop\n  }), React.createElement(\"div\", {\n    className: folderClasses.folderFrontSide\n  }, React.createElement(GridEntryDndIndicator, {\n    className: fileClasses.dndIndicator,\n    dndState: dndState\n  }), React.createElement(\"div\", {\n    className: c([fileClasses.fileIcon, folderClasses.fileIcon])\n  }, entryState.childrenCount), React.createElement(\"div\", {\n    className: commonClasses.selectionIndicator\n  }), React.createElement(FileThumbnail, {\n    className: fileClasses.thumbnail,\n    thumbnailUrl: entryState.thumbnailUrl\n  }))));\n});\nGridEntryPreviewFolder.displayName = 'GridEntryPreviewFolder';\nvar useFolderStyles = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    previewFile: {\n      borderRadius: theme.gridFileEntry.borderRadius,\n      position: 'relative',\n      overflow: 'hidden'\n    },\n    folderBackSideTop: {\n      backgroundColor: function backgroundColor(state) {\n        return state.color;\n      },\n      boxShadow: function boxShadow(state) {\n        var color = theme.gridFileEntry.folderBackColorTint;\n        if (state.focused) color = 'rgba(0, 0, 0, 0.3)';else if (state.selected) color = 'rgba(0, 153, 255, .4)';\n        return \"inset \" + color + \" 0 0 0 999px\";\n      },\n      borderTopLeftRadius: theme.gridFileEntry.borderRadius,\n      borderTopRightRadius: 10,\n      position: 'absolute',\n      right: '60%',\n      height: 13,\n      top: -10,\n      left: 0,\n      '&:after': {\n        borderRightColor: theme.palette.background.paper,\n        borderTopColor: theme.palette.background.paper,\n        borderBottomColor: 'transparent',\n        borderLeftColor: 'transparent',\n        borderWidth: [0, 15, 10, 0],\n        borderStyle: 'solid',\n        position: 'absolute',\n        display: 'block',\n        content: '\"\"',\n        right: 0,\n        top: 0\n      }\n    },\n    folderBackSideMid: {\n      backgroundColor: function backgroundColor(state) {\n        return state.color;\n      },\n      boxShadow: function boxShadow(state) {\n        var color = theme.gridFileEntry.folderBackColorTint;\n        if (state.focused) color = 'rgba(0, 0, 0, 0.3)';else if (state.selected) color = 'rgba(0, 153, 255, .4)';\n        return \"inset \" + color + \" 0 0 0 999px\";\n      },\n      borderTopRightRadius: theme.gridFileEntry.borderRadius,\n      position: 'absolute',\n      bottom: 0,\n      right: 0,\n      left: 0,\n      top: 10\n    },\n    folderFrontSide: {\n      boxShadow: function boxShadow(state) {\n        var shadows = [];\n        if (state.focused) shadows.push('inset rgba(0, 0, 0, 1) 0 0 0 3px');\n        if (state.selected) shadows.push('inset rgba(0, 153, 255, .65) 0 0 0 3px');\n        shadows.push(\"inset \" + theme.gridFileEntry.folderFrontColorTint + \" 0 0 0 999px\");\n        return shadows.join(', ');\n      },\n      backgroundColor: function backgroundColor(state) {\n        return state.color;\n      },\n      borderRadius: theme.gridFileEntry.borderRadius,\n      position: 'absolute',\n      overflow: 'hidden',\n      bottom: 0,\n      right: 0,\n      left: 0,\n      top: 10\n    },\n    fileIcon: {\n      fontSize: important(theme.gridFileEntry.childrenCountSize)\n    }\n  };\n});\nvar GridEntryPreviewFile = /*#__PURE__*/React.memo(function (props) {\n  var _c2;\n  var externalClassName = props.className,\n    entryState = props.entryState,\n    dndState = props.dndState;\n  var fileClasses = useFileStyles(entryState);\n  var commonClasses = useCommonEntryStyles(entryState);\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var className = c((_c2 = {}, _c2[fileClasses.previewFile] = true, _c2[externalClassName || ''] = !!externalClassName, _c2));\n  return React.createElement(\"div\", {\n    className: className\n  }, React.createElement(GridEntryDndIndicator, {\n    className: fileClasses.dndIndicator,\n    dndState: dndState\n  }), React.createElement(\"div\", {\n    className: fileClasses.fileIcon\n  }, React.createElement(ChonkyIcon, {\n    icon: entryState.icon,\n    spin: entryState.iconSpin\n  })), React.createElement(\"div\", {\n    className: commonClasses.selectionIndicator\n  }), React.createElement(FileThumbnail, {\n    className: fileClasses.thumbnail,\n    thumbnailUrl: entryState.thumbnailUrl\n  }));\n});\nGridEntryPreviewFile.displayName = 'GridEntryPreviewFile';\nvar useFileStyles = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    previewFile: {\n      boxShadow: function boxShadow(state) {\n        var shadows = [];\n        if (state.selected) shadows.push('inset rgba(0,153,255, .65) 0 0 0 3px');\n        if (state.focused) shadows.push('inset rgba(0, 0, 0, 1) 0 0 0 3px');\n        shadows.push(\"inset \" + theme.gridFileEntry.fileColorTint + \" 0 0 0 999px\");\n        return shadows.join(', ');\n      },\n      backgroundColor: function backgroundColor(state) {\n        return state.color;\n      },\n      borderRadius: theme.gridFileEntry.borderRadius,\n      position: 'relative',\n      overflow: 'hidden'\n    },\n    dndIndicator: {\n      zIndex: 14\n    },\n    fileIcon: {\n      transform: 'translateX(-50%) translateY(-50%)',\n      fontSize: theme.gridFileEntry.iconSize,\n      opacity: function opacity(state) {\n        return state.thumbnailUrl && !state.focused ? 0 : 1;\n      },\n      color: function color(state) {\n        return state.focused ? theme.gridFileEntry.iconColorFocused : theme.gridFileEntry.iconColor;\n      },\n      position: 'absolute',\n      left: '50%',\n      zIndex: 12,\n      top: '50%'\n    },\n    thumbnail: {\n      borderRadius: theme.gridFileEntry.borderRadius,\n      position: 'absolute',\n      zIndex: 6,\n      bottom: 5,\n      right: 5,\n      left: 5,\n      top: 5\n    }\n  };\n});\nvar useCommonEntryStyles = /*#__PURE__*/makeLocalChonkyStyles(function () {\n  return {\n    selectionIndicator: {\n      display: function display(state) {\n        return state.selected ? 'block' : 'none';\n      },\n      background: 'repeating-linear-gradient(' + '45deg,' + 'rgba(0,153,255,.14),' + 'rgba(0,153,255,.14) 10px,' + 'rgba(0,153,255,.25) 0,' + 'rgba(0,153,255,.25) 20px' + ')',\n      backgroundColor: 'rgba(0, 153, 255, .14)',\n      position: 'absolute',\n      height: '100%',\n      width: '100%',\n      zIndex: 10\n    },\n    focusIndicator: {\n      display: function display(state) {\n        return state.focused ? 'block' : 'none';\n      },\n      boxShadow: 'inset rgba(0, 0, 0, 1) 0 0 0 2px',\n      position: 'absolute',\n      height: '100%',\n      width: '100%',\n      zIndex: 11\n    }\n  };\n});\nvar GridEntry = /*#__PURE__*/React.memo(function (_ref) {\n  var _c;\n  var file = _ref.file,\n    selected = _ref.selected,\n    focused = _ref.focused,\n    dndState = _ref.dndState;\n  var isDirectory = FileHelper.isDirectory(file);\n  var entryState = useFileEntryState(file, selected, focused);\n  var classes = useFileEntryStyles(entryState);\n  var fileEntryHtmlProps = useFileEntryHtmlProps(file);\n  var entryClassName = c((_c = {}, _c[classes.gridFileEntry] = true, _c));\n  return React.createElement(\"div\", Object.assign({\n    className: entryClassName\n  }, fileEntryHtmlProps), isDirectory ? React.createElement(GridEntryPreviewFolder, {\n    className: classes.gridFileEntryPreview,\n    entryState: entryState,\n    dndState: dndState\n  }) : React.createElement(GridEntryPreviewFile, {\n    className: classes.gridFileEntryPreview,\n    entryState: entryState,\n    dndState: dndState\n  }), React.createElement(\"div\", {\n    className: classes.gridFileEntryNameContainer\n  }, React.createElement(FileEntryName, {\n    className: classes.gridFileEntryName,\n    file: file\n  })));\n});\nGridEntry.displayName = 'GridEntry';\nvar useFileEntryStyles = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    gridFileEntry: {\n      flexDirection: 'column',\n      display: 'flex',\n      height: '100%'\n    },\n    gridFileEntryPreview: {\n      flexGrow: 1\n    },\n    gridFileEntryNameContainer: {\n      fontSize: theme.gridFileEntry.fontSize,\n      wordBreak: 'break-word',\n      textAlign: 'center',\n      paddingTop: 5\n    },\n    gridFileEntryName: {\n      backgroundColor: function backgroundColor(state) {\n        return state.selected ? 'rgba(0,153,255, .25)' : 'transparent';\n      },\n      textDecoration: function textDecoration(state) {\n        return state.focused ? 'underline' : 'none';\n      },\n      borderRadius: 3,\n      padding: [2, 4]\n    }\n  };\n});\nvar ListEntry = /*#__PURE__*/React.memo(function (_ref) {\n  var file = _ref.file,\n    selected = _ref.selected,\n    focused = _ref.focused,\n    dndState = _ref.dndState;\n  var entryState = useFileEntryState(file, selected, focused);\n  var dndIconName = useDndIcon(dndState);\n  var _useLocalizedFileEntr = useLocalizedFileEntryStrings(file),\n    fileModDateString = _useLocalizedFileEntr.fileModDateString,\n    fileSizeString = _useLocalizedFileEntr.fileSizeString;\n  var styleState = useMemo(function () {\n    return {\n      entryState: entryState,\n      dndState: dndState\n    };\n  }, [dndState, entryState]);\n  var classes = useStyles$h(styleState);\n  var commonClasses = useCommonEntryStyles(entryState);\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  var fileEntryHtmlProps = useFileEntryHtmlProps(file);\n  return React.createElement(\"div\", Object.assign({\n    className: classes.listFileEntry\n  }, fileEntryHtmlProps), React.createElement(\"div\", {\n    className: commonClasses.focusIndicator\n  }), React.createElement(\"div\", {\n    className: c([commonClasses.selectionIndicator, classes.listFileEntrySelection])\n  }), React.createElement(\"div\", {\n    className: classes.listFileEntryIcon\n  }, React.createElement(ChonkyIcon, {\n    icon: dndIconName != null ? dndIconName : entryState.icon,\n    spin: dndIconName ? false : entryState.iconSpin,\n    fixedWidth: true\n  })), React.createElement(\"div\", {\n    className: classes.listFileEntryName,\n    title: file ? file.name : undefined\n  }, React.createElement(FileEntryName, {\n    file: file\n  })), React.createElement(\"div\", {\n    className: classes.listFileEntryProperty\n  }, file ? fileModDateString != null ? fileModDateString : React.createElement(\"span\", null, \"\\u2014\") : React.createElement(TextPlaceholder, {\n    minLength: 5,\n    maxLength: 15\n  })), React.createElement(\"div\", {\n    className: classes.listFileEntryProperty\n  }, file ? fileSizeString != null ? fileSizeString : React.createElement(\"span\", null, \"\\u2014\") : React.createElement(TextPlaceholder, {\n    minLength: 10,\n    maxLength: 20\n  })));\n});\nvar useStyles$h = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    listFileEntry: {\n      boxShadow: \"inset \" + theme.palette.divider + \" 0 -1px 0\",\n      fontSize: theme.listFileEntry.fontSize,\n      color: function color(_ref2) {\n        var dndState = _ref2.dndState;\n        return dndState.dndIsOver ? dndState.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor : 'inherit';\n      },\n      alignItems: 'center',\n      position: 'relative',\n      display: 'flex',\n      height: '100%'\n    },\n    listFileEntrySelection: {\n      opacity: 0.6\n    },\n    listFileEntryIcon: {\n      color: function color(_ref3) {\n        var entryState = _ref3.entryState,\n          dndState = _ref3.dndState;\n        return dndState.dndIsOver ? dndState.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor : entryState.color;\n      },\n      fontSize: theme.listFileEntry.iconFontSize,\n      boxSizing: 'border-box',\n      padding: [2, 4],\n      zIndex: 20\n    },\n    listFileEntryName: {\n      textOverflow: 'ellipsis',\n      boxSizing: 'border-box',\n      whiteSpace: 'nowrap',\n      overflow: 'hidden',\n      flex: '1 1 300px',\n      paddingLeft: 8,\n      zIndex: 20\n    },\n    listFileEntryProperty: {\n      fontSize: theme.listFileEntry.propertyFontSize,\n      boxSizing: 'border-box',\n      whiteSpace: 'nowrap',\n      overflow: 'hidden',\n      flex: '0 1 150px',\n      padding: [2, 8],\n      zIndex: 20\n    }\n  };\n});\nvar disabledDndState = {\n  dndIsDragging: false,\n  dndIsOver: false,\n  dndCanDrop: false\n};\nvar SmartFileEntry = /*#__PURE__*/React.memo(function (_ref) {\n  var fileId = _ref.fileId,\n    displayIndex = _ref.displayIndex,\n    fileViewMode = _ref.fileViewMode;\n  var classes = useStyles$i(); // Basic properties\n\n  var file = useParamSelector(selectFileData, fileId);\n  var selected = useParamSelector(selectIsFileSelected, fileId);\n  var dndDisabled = useSelector(selectIsDnDDisabled); // Clickable wrapper properties\n\n  var fileClickHandlers = useFileClickHandlers(file, displayIndex);\n  var _useState = useState(false),\n    focused = _useState[0],\n    setFocused = _useState[1];\n  var clickableWrapperProps = _extends({\n    wrapperTag: 'div',\n    passthroughProps: {\n      className: classes.fileEntryClickableWrapper\n    }\n  }, FileHelper.isClickable(file) ? fileClickHandlers : undefined, {\n    setFocused: setFocused\n  }); // File entry properties\n\n  var fileEntryProps = {\n    file: file,\n    selected: selected,\n    focused: focused\n  };\n  var EntryComponent;\n  if (fileViewMode === FileViewMode.List) EntryComponent = ListEntry;else if (fileViewMode === FileViewMode.Compact) EntryComponent = CompactEntry;else EntryComponent = GridEntry;\n  return dndDisabled ? React.createElement(ClickableWrapper, Object.assign({}, clickableWrapperProps), React.createElement(EntryComponent, Object.assign({}, fileEntryProps, {\n    dndState: disabledDndState\n  }))) : React.createElement(DnDFileEntry, {\n    file: file\n  }, function (dndState) {\n    return React.createElement(ClickableWrapper, Object.assign({}, clickableWrapperProps), React.createElement(EntryComponent, Object.assign({}, fileEntryProps, {\n      dndState: dndState\n    })));\n  });\n});\nSmartFileEntry.displayName = 'SmartFileEntry';\nvar useStyles$i = /*#__PURE__*/makeGlobalChonkyStyles(function () {\n  return {\n    fileEntryClickableWrapper: {\n      // We disable default browser outline because Chonky provides its own outline\n      // (which doesn't compromise accessibility, hopefully)\n      outline: 'none !important',\n      position: 'relative',\n      height: '100%'\n    }\n  };\n});\nvar isMobileDevice = function isMobileDevice() {\n  // noinspection JSDeprecatedSymbols\n  return typeof window.orientation !== 'undefined' || navigator.userAgent.indexOf('IEMobile') !== -1;\n};\nvar getGridConfig = function getGridConfig(width, fileCount, viewConfig, isMobileBreakpoint) {\n  var gutter = isMobileBreakpoint ? 5 : 8;\n  var scrollbar = isMobileDevice() ? 0 : 18;\n  var columnCount;\n  var columnWidth;\n  if (isMobileBreakpoint) {\n    columnCount = 2;\n    columnWidth = (width - gutter - scrollbar) / columnCount;\n  } else {\n    columnWidth = viewConfig.entryWidth;\n    columnCount = Math.max(1, Math.floor((width - scrollbar) / (columnWidth + gutter)));\n  }\n  var rowCount = Math.ceil(fileCount / columnCount);\n  return {\n    rowCount: rowCount,\n    columnCount: columnCount,\n    gutter: gutter,\n    rowHeight: viewConfig.entryHeight,\n    columnWidth: columnWidth\n  };\n};\nvar GridContainer = /*#__PURE__*/React.memo(function (props) {\n  var width = props.width,\n    height = props.height;\n  var viewConfig = useSelector(selectFileViewConfig);\n  var displayFileIds = useSelector(selectors.getDisplayFileIds);\n  var fileCount = useMemo(function () {\n    return displayFileIds.length;\n  }, [displayFileIds]);\n  var gridRef = useRef();\n  var isMobileBreakpoint = useIsMobileBreakpoint(); // Whenever the grid config changes at runtime, we call a method on the\n  // `VariableSizeGrid` handle to reset column width/row height cache.\n  // !!! Note that we deliberately update the `gridRef` firsts and update the React\n  //     state AFTER that. This is needed to avoid file entries jumping up/down.\n\n  var _useState = useState(getGridConfig(width, fileCount, viewConfig, isMobileBreakpoint)),\n    gridConfig = _useState[0],\n    setGridConfig = _useState[1];\n  var gridConfigRef = useRef(gridConfig);\n  useEffect(function () {\n    var oldConf = gridConfigRef.current;\n    var newConf = getGridConfig(width, fileCount, viewConfig, isMobileBreakpoint);\n    gridConfigRef.current = newConf;\n    if (gridRef.current) {\n      if (oldConf.rowCount !== newConf.rowCount) {\n        gridRef.current.resetAfterRowIndex(Math.min(oldConf.rowCount, newConf.rowCount) - 1);\n      }\n      if (oldConf.columnCount !== newConf.columnCount) {\n        gridRef.current.resetAfterColumnIndex(Math.min(oldConf.columnCount, newConf.rowCount) - 1);\n      }\n      if (oldConf.columnWidth !== newConf.columnWidth) {\n        gridRef.current.resetAfterIndices({\n          columnIndex: 0,\n          rowIndex: 0\n        });\n      }\n    }\n    setGridConfig(newConf);\n  }, [setGridConfig, gridConfigRef, isMobileBreakpoint, width, viewConfig, fileCount]);\n  var sizers = useMemo(function () {\n    var gc = gridConfigRef;\n    return {\n      getColumnWidth: function getColumnWidth(index) {\n        return gc.current.columnWidth + (index === gc.current.columnCount - 1 ? 0 : gc.current.gutter);\n      },\n      getRowHeight: function getRowHeight(index) {\n        return gc.current.rowHeight + (index === gc.current.rowCount - 1 ? 0 : gc.current.gutter);\n      }\n    };\n  }, [gridConfigRef]);\n  var displayFileIdsRef = useInstanceVariable(useSelector(selectors.getDisplayFileIds));\n  var getItemKey = useCallback(function (data) {\n    var _displayFileIdsRef$cu;\n    var index = data.rowIndex * gridConfigRef.current.columnCount + data.columnIndex;\n    return (_displayFileIdsRef$cu = displayFileIdsRef.current[index]) != null ? _displayFileIdsRef$cu : \"loading-file-\" + index;\n  }, [gridConfigRef, displayFileIdsRef]);\n  var cellRenderer = useCallback(function (data) {\n    var gc = gridConfigRef;\n    var index = data.rowIndex * gc.current.columnCount + data.columnIndex;\n    var fileId = displayFileIds[index];\n    if (displayFileIds[index] === undefined) return null;\n    var styleWithGutter = _extends({}, data.style, {\n      paddingRight: data.columnIndex === gc.current.columnCount - 1 ? 0 : gc.current.gutter,\n      paddingBottom: data.rowIndex === gc.current.rowCount - 1 ? 0 : gc.current.gutter,\n      boxSizing: 'border-box'\n    });\n    return React.createElement(\"div\", {\n      style: styleWithGutter\n    }, React.createElement(SmartFileEntry, {\n      fileId: fileId != null ? fileId : null,\n      displayIndex: index,\n      fileViewMode: viewConfig.mode\n    }));\n  }, [displayFileIds, viewConfig.mode]);\n  var classes = useStyles$j();\n  var gridComponent = useMemo(function () {\n    return React.createElement(VariableSizeGrid, {\n      ref: gridRef,\n      className: classes.gridContainer,\n      estimatedRowHeight: gridConfig.rowHeight + gridConfig.gutter,\n      rowHeight: sizers.getRowHeight,\n      estimatedColumnWidth: gridConfig.columnWidth + gridConfig.gutter,\n      columnWidth: sizers.getColumnWidth,\n      columnCount: gridConfig.columnCount,\n      height: height,\n      rowCount: gridConfig.rowCount,\n      width: width,\n      itemKey: getItemKey\n    }, cellRenderer);\n  }, [classes.gridContainer, gridConfig.rowHeight, gridConfig.gutter, gridConfig.columnWidth, gridConfig.columnCount, gridConfig.rowCount, sizers.getRowHeight, sizers.getColumnWidth, height, width, getItemKey, cellRenderer]);\n  return gridComponent;\n});\nvar useStyles$j = /*#__PURE__*/makeGlobalChonkyStyles(function () {\n  return {\n    gridContainer: {}\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar ListContainer = /*#__PURE__*/React.memo(function (props) {\n  var width = props.width,\n    height = props.height;\n  var viewConfig = useSelector(selectFileViewConfig);\n  var listRef = useRef();\n  var displayFileIds = useSelector(selectors.getDisplayFileIds);\n  var displayFileIdsRef = useInstanceVariable(displayFileIds);\n  var getItemKey = useCallback(function (index) {\n    var _displayFileIdsRef$cu;\n    return (_displayFileIdsRef$cu = displayFileIdsRef.current[index]) != null ? _displayFileIdsRef$cu : \"loading-file-\" + index;\n  }, [displayFileIdsRef]);\n  var classes = useStyles$k();\n  var listComponent = useMemo(function () {\n    // When entry size is null, we use List view\n    var rowRenderer = function rowRenderer(data) {\n      var _displayFileIds$data$;\n      return React.createElement(\"div\", {\n        style: data.style\n      }, React.createElement(SmartFileEntry, {\n        fileId: (_displayFileIds$data$ = displayFileIds[data.index]) != null ? _displayFileIds$data$ : null,\n        displayIndex: data.index,\n        fileViewMode: FileViewMode.List\n      }));\n    };\n    return React.createElement(FixedSizeList, {\n      ref: listRef,\n      className: classes.listContainer,\n      itemSize: viewConfig.entryHeight,\n      height: height,\n      itemCount: displayFileIds.length,\n      width: width,\n      itemKey: getItemKey\n    }, rowRenderer);\n  }, [classes.listContainer, viewConfig.entryHeight, height, displayFileIds, width, getItemKey]);\n  return listComponent;\n});\nvar useStyles$k = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    listContainer: {\n      borderTop: \"solid 1px \" + theme.palette.divider\n    }\n  };\n});\nvar FileList = /*#__PURE__*/React.memo(function (props) {\n  var displayFileIds = useSelector(selectors.getDisplayFileIds);\n  var viewConfig = useSelector(selectFileViewConfig);\n  var currentFolder = useSelector(selectCurrentFolder);\n  var _useFileDrop = useFileDrop({\n      file: currentFolder\n    }),\n    drop = _useFileDrop.drop,\n    dndCanDrop = _useFileDrop.dndCanDrop,\n    dndIsOverCurrent = _useFileDrop.dndIsOverCurrent;\n  var styleState = useMemo(function () {\n    return {\n      dndCanDrop: dndCanDrop,\n      dndIsOverCurrent: dndIsOverCurrent\n    };\n  }, [dndCanDrop, dndIsOverCurrent]);\n  var localClasses = useLocalStyles(styleState);\n  var classes = useStyles$l(viewConfig);\n  var onScroll = props.onScroll; // In Chonky v0.x, this field was user-configurable. In Chonky v1.x+, we hardcode\n  // this to `true` to simplify configuration. Users can just wrap Chonky in their\n  // own `div` if they want to have finer control over the height.\n\n  var fillParentContainer = true;\n  var listRenderer = useCallback(function (_ref) {\n    var width = _ref.width,\n      height = _ref.height;\n    if (displayFileIds.length === 0) {\n      return React.createElement(FileListEmpty, {\n        width: width,\n        height: viewConfig.entryHeight\n      });\n    } else if (viewConfig.mode === FileViewMode.List) {\n      return React.createElement(ListContainer, {\n        width: width,\n        height: height\n      });\n    } else {\n      return React.createElement(GridContainer, {\n        width: width,\n        height: height\n      });\n    }\n  }, [displayFileIds, viewConfig]);\n  var ChonkyIcon = useContext(ChonkyIconContext);\n  return React.createElement(\"div\", {\n    onScroll: onScroll,\n    ref: drop,\n    className: c([classes.fileListWrapper, localClasses.fileListWrapper]),\n    role: \"list\"\n  }, React.createElement(\"div\", {\n    className: localClasses.dndDropZone\n  }, React.createElement(\"div\", {\n    className: localClasses.dndDropZoneIcon\n  }, React.createElement(ChonkyIcon, {\n    icon: dndCanDrop ? ChonkyIconName.dndCanDrop : ChonkyIconName.dndCannotDrop\n  }))), React.createElement(AutoSizer, {\n    disableHeight: !fillParentContainer\n  }, listRenderer));\n});\nFileList.displayName = 'FileList';\nvar useLocalStyles = /*#__PURE__*/makeLocalChonkyStyles(function (theme) {\n  return {\n    fileListWrapper: {\n      minHeight: ChonkyActions.EnableGridView.fileViewConfig.entryHeight + 2,\n      background: function background(state) {\n        return state.dndIsOverCurrent && state.dndCanDrop ? state.dndCanDrop ? getStripeGradient(theme.dnd.fileListCanDropMaskOne, theme.dnd.fileListCanDropMaskTwo) : getStripeGradient(theme.dnd.fileListCannotDropMaskOne, theme.dnd.fileListCannotDropMaskTwo) : 'none';\n      }\n    },\n    dndDropZone: {\n      display: function display(state) {\n        return (\n          // When we cannot drop, we don't show an indicator at all\n          state.dndIsOverCurrent && state.dndCanDrop ? 'block' : 'none'\n        );\n      },\n      borderRadius: theme.gridFileEntry.borderRadius,\n      pointerEvents: 'none',\n      position: 'absolute',\n      height: '100%',\n      width: '100%',\n      zIndex: 2\n    },\n    dndDropZoneIcon: {\n      backgroundColor: function backgroundColor(state) {\n        return state.dndCanDrop ? theme.dnd.canDropMask : theme.dnd.cannotDropMask;\n      },\n      color: function color(state) {\n        return state.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor;\n      },\n      borderRadius: theme.gridFileEntry.borderRadius,\n      transform: 'translateX(-50%) translateY(-50%)',\n      position: 'absolute',\n      textAlign: 'center',\n      lineHeight: '60px',\n      fontSize: '2em',\n      left: '50%',\n      height: 60,\n      top: '50%',\n      width: 60\n    }\n  };\n});\nvar useStyles$l = /*#__PURE__*/makeGlobalChonkyStyles(function () {\n  return {\n    fileListWrapper: {\n      height: '100%',\n      maxHeight: '100%'\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar FileContextMenu = /*#__PURE__*/React.memo(function () {\n  var dispatch = useDispatch();\n  useEffect(function () {\n    dispatch(reduxActions.setContextMenuMounted(true));\n    return function () {\n      dispatch(reduxActions.setContextMenuMounted(false));\n    };\n  }, [dispatch]);\n  var intl = useIntl();\n  var browserMenuShortcutString = intl.formatMessage({\n    id: getI18nId(I18nNamespace.FileContextMenu, 'browserMenuShortcut'),\n    defaultMessage: 'Browser menu: {shortcut}'\n  }, {\n    shortcut: React.createElement(\"strong\", null, \"Alt + Right Click\")\n  });\n  var contextMenuConfig = useSelector(selectContextMenuConfig);\n  var contextMenuItems = useSelector(selectContextMenuItems);\n  var hideContextMenu = useContextMenuDismisser();\n  var contextMenuItemComponents = useMemo(function () {\n    var components = [];\n    var _loop = function _loop(i) {\n      var item = contextMenuItems[i];\n      if (typeof item === 'string') {\n        components.push(React.createElement(SmartToolbarDropdownButton, {\n          key: \"context-menu-item-\" + item,\n          fileActionId: item,\n          onClickFollowUp: hideContextMenu\n        }));\n      } else {\n        item.fileActionIds.map(function (id) {\n          return components.push(React.createElement(SmartToolbarDropdownButton, {\n            key: \"context-menu-item-\" + item.name + \"-\" + id,\n            fileActionId: id,\n            onClickFollowUp: hideContextMenu\n          }));\n        });\n      }\n    };\n    for (var i = 0; i < contextMenuItems.length; ++i) {\n      _loop(i);\n    }\n    return components;\n  }, [contextMenuItems, hideContextMenu]);\n  var anchorPosition = useMemo(function () {\n    return contextMenuConfig ? {\n      top: contextMenuConfig.mouseY,\n      left: contextMenuConfig.mouseX\n    } : undefined;\n  }, [contextMenuConfig]);\n  var classes = useStyles$m();\n  return React.createElement(Menu, {\n    elevation: 2,\n    disablePortal: true,\n    onClose: hideContextMenu,\n    transitionDuration: 150,\n    open: !!contextMenuConfig,\n    anchorPosition: anchorPosition,\n    anchorReference: \"anchorPosition\",\n    classes: {\n      list: classes.contextMenuList\n    }\n  }, contextMenuItemComponents, React.createElement(ListSubheader, {\n    component: \"div\",\n    className: classes.browserMenuTooltip\n  }, browserMenuShortcutString));\n});\nvar useStyles$m = /*#__PURE__*/makeGlobalChonkyStyles(function () {\n  return {\n    contextMenuList: {\n      paddingBottom: important(0),\n      paddingTop: important(0)\n    },\n    browserMenuTooltip: {\n      lineHeight: important('30px'),\n      fontSize: important('0.7em')\n    }\n  };\n});\n\n/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\nvar FullFileBrowser = /*#__PURE__*/React.memo( /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var onScroll = props.onScroll;\n  return React.createElement(FileBrowser, Object.assign({\n    ref: ref\n  }, props), React.createElement(FileNavbar, null), React.createElement(FileToolbar, null), React.createElement(FileList, {\n    onScroll: onScroll\n  }), React.createElement(FileContextMenu, null));\n}));\nFullFileBrowser.displayName = 'FullFileBrowser';\nvar useFolderChain = function useFolderChain(fileMap, currentFolderId) {\n  return useMemo(function () {\n    var currentFolder = fileMap[currentFolderId];\n    var folderChain = [currentFolder];\n    var parentId = currentFolder.parentId;\n    while (parentId) {\n      var parentFile = fileMap[parentId];\n      if (parentFile) {\n        folderChain.unshift(parentFile);\n        parentId = parentFile.parentId;\n      } else {\n        break;\n      }\n    }\n    return folderChain;\n  }, [currentFolderId, fileMap]);\n};\nvar useFiles = function useFiles(fileMap, currentFolderId) {\n  return useMemo(function () {\n    var currentFolder = fileMap[currentFolderId];\n    var childrenIds = currentFolder.childrenIds;\n    var files = childrenIds.map(function (fileId) {\n      return fileMap[fileId];\n    });\n    return files;\n  }, [currentFolderId, fileMap]);\n};\nvar useFileMapMethods = function useFileMapMethods(baseFileMap, initialFolderId) {\n  var _useState = useState(baseFileMap),\n    fileMap = _useState[0],\n    setFileMap = _useState[1];\n  var _useState2 = useState(initialFolderId),\n    currentFolderId = _useState2[0],\n    setCurrentFolderId = _useState2[1];\n  var resetFileMap = useCallback(function () {\n    setFileMap(baseFileMap);\n    setCurrentFolderId(initialFolderId);\n  }, [baseFileMap, initialFolderId]);\n  var moveFiles = useCallback(function (files, source, destination) {\n    return setFileMap(function (currentFileMap) {\n      var newFileMap = _extends({}, currentFileMap);\n      var moveFileIds = new Set(files.map(function (f) {\n        return f.id;\n      })); // Delete files from their source folder.\n\n      var newSourceChildrenIds = source.childrenIds.filter(function (id) {\n        return !moveFileIds.has(id);\n      });\n      newFileMap[source.id] = _extends({}, source, {\n        childrenIds: newSourceChildrenIds,\n        childrenCount: newSourceChildrenIds.length\n      }); // Add the files to their destination folder.\n\n      var newDestinationChildrenIds = [].concat(destination.childrenIds, files.map(function (f) {\n        return f.id;\n      }));\n      newFileMap[destination.id] = _extends({}, destination, {\n        childrenIds: newDestinationChildrenIds,\n        childrenCount: newDestinationChildrenIds.length\n      }); // Finally, update the parent folder ID on the files from source folder\n      // ID to the destination folder ID.\n\n      files.forEach(function (file) {\n        newFileMap[file.id] = _extends({}, file, {\n          parentId: destination.id\n        });\n      });\n      return newFileMap;\n    });\n  }, []);\n  var methods = useMemo(function () {\n    return {\n      setFileMap: setFileMap,\n      setCurrentFolderId: setCurrentFolderId,\n      resetFileMap: resetFileMap,\n      moveFiles: moveFiles\n    };\n  }, [setFileMap, setCurrentFolderId, resetFileMap, moveFiles]);\n  return {\n    fileMap: fileMap,\n    currentFolderId: currentFolderId,\n    methods: methods\n  };\n};\nvar useFileActionHandler = function useFileActionHandler(methods) {\n  return useCallback(function (data) {\n    if (data.id === ChonkyActions.OpenFiles.id) {\n      var _data$payload = data.payload,\n        targetFile = _data$payload.targetFile,\n        files = _data$payload.files;\n      var fileToOpen = targetFile != null ? targetFile : files[0];\n      if (fileToOpen && FileHelper.isDirectory(fileToOpen)) {\n        methods.setCurrentFolderId(fileToOpen.id);\n      }\n    } else if (data.id === ChonkyActions.MoveFiles.id) {\n      methods.moveFiles(data.payload.files, data.payload.source, data.payload.destination);\n    }\n  }, [methods]);\n};\nvar useFileMap = function useFileMap(_ref) {\n  var baseFileMap = _ref.baseFileMap,\n    initialFolderId = _ref.initialFolderId;\n  var _useFileMapMethods = useFileMapMethods(baseFileMap, initialFolderId),\n    fileMap = _useFileMapMethods.fileMap,\n    currentFolderId = _useFileMapMethods.currentFolderId,\n    methods = _useFileMapMethods.methods;\n  var folderChain = useFolderChain(fileMap, currentFolderId);\n  var files = useFiles(fileMap, currentFolderId);\n  var fileActionHandler = useFileActionHandler(methods);\n  var data = {\n    fileMap: fileMap,\n    currentFolderId: currentFolderId,\n    folderChain: folderChain,\n    files: files\n  };\n  return {\n    data: data,\n    methods: methods,\n    fileActionHandler: fileActionHandler\n  };\n};\nvar fileMap = {\n  __proto__: null,\n  useFolderChain: useFolderChain,\n  useFiles: useFiles,\n  useFileMapMethods: useFileMapMethods,\n  useFileActionHandler: useFileActionHandler,\n  useFileMap: useFileMap\n};\nexport { ChonkyActions, ChonkyDndFileEntryType, ChonkyIconName, CustomVisibilityState, DefaultFileActions, FileBrowser, FileContextMenu, FileHelper, FileList, FileNavbar, FileToolbar, FileViewMode, FullFileBrowser, I18nNamespace, OptionIds, defaultFormatters, defineFileAction, fileMap, getActionI18nId, getFileData, getI18nId, getIsFileSelected, getSelectedFiles, getSelectedFilesForAction, reduxActions, rootReducer, selectCleanFileIds, selectClearSelectionOnOutsideClick, selectContextMenuConfig, selectContextMenuItems, selectContextMenuMounted, selectContextMenuTriggerFile, selectCurrentFolder, selectDisableSelection, selectDoubleClickDelay, selectExternalFileActionHandler, selectFileActionData, selectFileActionIds, selectFileActionMap, selectFileData, selectFileMap, selectFileViewConfig, selectFocusSearchInput, selectFolderChain, selectHiddenFileCount, selectHiddenFileIdMap, selectInstanceId, selectIsDnDDisabled, selectIsFileSelected, selectOptionMap, selectOptionValue, selectParentFolder, selectRawFiles, selectSearchString, selectSelectedFileIds, selectSelectedFiles, selectSelectedFilesForAction, selectSelectedFilesForActionCount, selectSelectionMap, selectSelectionSize, selectSortActionId, selectSortOrder, selectThumbnailGenerator, selectToolbarItems, selectors, setChonkyDefaults, thunkDispatchFileAction, thunkRequestFileAction, useChonkyStore, useDTE, useParamSelector, usePropReduxUpdate };","map":{"version":3,"sources":["../src/util/hooks-helpers.ts","../src/util/logger.ts","../src/util/file-helper.ts","../src/redux/files-transforms.ts","../src/action-definitions/option-ids.ts","../src/types/sort.types.ts","../src/redux/selectors.ts","../src/redux/thunks/file-actions.thunks.ts","../src/redux/thunks/dispatchers.thunks.ts","../src/types/file-view.types.ts","../src/types/icons.types.ts","../src/util/helpers.ts","../src/redux/thunks/index.ts","../src/action-definitions/essential.ts","../src/action-definitions/default.ts","../src/action-definitions/extra.ts","../src/action-definitions/index.ts","../src/redux/state.ts","../src/redux/reducers.ts","../src/redux/watchers.ts","../src/redux/store.ts","../src/components/internal/ChonkyIconPlaceholder.tsx","../src/util/default-config.ts","../src/util/i18n.ts","../src/util/icon-helper.ts","../src/util/styles.ts","../src/util/file-browser-handle.ts","../src/components/internal/ChonkyBusinessLogic.tsx","../src/util/dnd-fallback.ts","../src/components/external/FileContextMenu-hooks.ts","../src/types/dnd.types.ts","../src/components/file-list/DnDFileListDragLayer.tsx","../src/components/internal/HotkeyListener.tsx","../src/components/internal/ChonkyPresentationLayer.tsx","../src/components/external/FileBrowser.tsx","../src/components/external/FileNavbar-hooks.ts","../src/util/dnd.ts","../src/components/external/TextPlaceholder.tsx","../src/components/file-list/FileEntry-hooks.tsx","../src/types/action.types.ts","../src/util/file-actions.ts","../src/components/external/ToolbarButton.tsx","../src/components/external/FolderChainButton.tsx","../src/components/external/FileNavbar.tsx","../src/components/external/ToolbarDropdownButton.tsx","../src/components/external/ToolbarDropdown.tsx","../src/components/external/ToolbarInfo.tsx","../src/components/external/ToolbarSearch.tsx","../src/components/external/FileToolbar.tsx","../src/components/file-list/FileListEmpty.tsx","../src/components/internal/ClickableWrapper-hooks.tsx","../src/components/internal/ClickableWrapper.tsx","../src/components/file-list/FileEntryName.tsx","../src/components/file-list/CompactEntry.tsx","../src/components/file-list/DnDFileEntry.tsx","../src/components/file-list/FileThumbnail.tsx","../src/components/file-list/GridEntryDndIndicator.tsx","../src/components/file-list/GridEntryPreview.tsx","../src/components/file-list/GridEntry.tsx","../src/components/file-list/ListEntry.tsx","../src/components/file-list/FileEntry.tsx","../src/components/file-list/GridContainer.tsx","../src/components/file-list/ListContainer.tsx","../src/components/file-list/FileList.tsx","../src/components/external/FileContextMenu.tsx","../src/components/external/FullFileBrowser.tsx","../src/extensions/file-map.ts"],"names":["useDebounce","value","delay","debouncedValue","setDebouncedValue","useState","useEffect","handler","setTimeout","clearTimeout","UNINITIALIZED_SENTINEL","useStaticValue","factory","valueRef","useRef","current","useInstanceVariable","ref","Logger","error","args","warn","debug","formatBullets","bullets","join","FileHelper","isDirectory","file","isDir","isHidden","isSymlink","isEncrypted","isClickable","isOpenable","openable","isSelectable","selectable","isDraggable","draggable","isDroppable","droppable","isDndOpenable","dndOpenable","getModDate","modDate","undefined","parseDate","maybeDate","Date","message","isNaN","getTime","getChildrenCount","childrenCount","sanitizeInputArray","mode","rawArray","sanitizedFiles","errorMessages","Array","isArray","push","nonObjectFileCount","missingFieldFileCount","seenIds","Set","duplicateIds","i","length","item","id","name","has","add","size","repeatedIdsString","from","errorMessageString","arrayString","itemString","sanitizedArray","OptionIds","ShowHiddenFiles","ShowFoldersFirst","DarkMode","SortOrder","selectInstanceId","state","instanceId","selectExternalFileActionHandler","externalFileActionHandler","selectFileActionMap","fileActionMap","selectFileActionIds","fileActionIds","selectFileActionData","fileActionId","selectToolbarItems","toolbarItems","selectContextMenuItems","contextMenuItems","selectFolderChain","folderChain","selectCurrentFolder","currentFolder","selectParentFolder","parentFolder","selectRawFiles","rawFiles","selectFileMap","fileMap","selectCleanFileIds","cleanFileIds","selectFileData","fileId","selectHiddenFileIdMap","hiddenFileIdMap","selectHiddenFileCount","Object","keys","selectFocusSearchInput","focusSearchInput","selectSearchString","searchString","selectSelectionMap","selectionMap","selectSelectedFileIds","selectSelectionSize","selectIsFileSelected","selectSelectedFiles","map","selectSelectedFilesForAction","action","requiresSelection","getSelectedFiles","fileFilter","selectSelectedFilesForActionCount","getSelectedFilesForAction","selectDisableSelection","disableSelection","selectFileViewConfig","fileViewConfig","selectSortActionId","sortActionId","selectSortOrder","sortOrder","selectOptionMap","optionMap","selectOptionValue","optionId","selectThumbnailGenerator","thumbnailGenerator","selectDoubleClickDelay","doubleClickDelay","selectIsDnDDisabled","disableDragAndDrop","selectClearSelectionOnOutsideClick","clearSelectionOnOutsideClick","selectContextMenuMounted","contextMenuMounted","selectContextMenuConfig","contextMenuConfig","selectContextMenuTriggerFile","config","triggerFileId","getFileActionMap","getOptionMap","getFileMap","getFileIds","fileIds","getCleanFileIds","getSortActionId","getSortOrder","getSearchString","_getLastClick","lastClick","makeGetAction","fileActionSelector","createSelector","makeGetOptionValue","defaultValue","makeGetFiles","fileIdsSelector","getSortedFileIds","files","sortAction","showFolderFirst","prepareSortKeySelector","selector","sortFunctions","desc","sortKeySelector","configKeyName","ASC","sortedFileIds","by","getSearcher","FuzzySearch","cleanFiles","caseSensitive","getSearchFilteredFileIds","searcher","search","f","getHiddenFileIdMap","searchFilteredFileIds","showHiddenFiles","searchFilteredFileIdsSet","forEach","getDisplayFileIds","filter","getLastClickIndex","displayFileIds","index","selectors","getFileData","getIsFileSelected","filters","selectedFiles","filteredSelectedFiles","reduce","prevFiles","mergeFileActionsArrays","fileActionArrays","seenActionIds","addToSeen","a","wasNotSeen","duplicateFreeArrays","duplicateFreeArray","arr","concat","thunkUpdateRawFileActions","rawFileActions","disableDefaultFileActions","defaultActionsToAdd","disabledActionIds","DefaultFileActions","fileActions","EssentialFileActions","optionDefaults","option","dispatch","reduxActions","setRawFileActions","setFileActionsErrorMessages","setFileActions","setOptionDefaults","thunkUpdateToolbarNContextMenuItems","excludedToolbarFileActionIds","ChonkyActions","OpenParentFolder","seenToolbarGroups","seenContextMenuGroups","getGroup","itemArray","seenMap","groupName","group","button","toolbar","contextMenu","updateFileActionMenuItems","thunkUpdateDefaultFileViewActionId","getState","setFileViewConfig","thunkActivateSortAction","oldActionId","oldOrder","order","DESC","setSort","actionId","thunkApplySelectionTransform","selectionTransform","prevSelection","hiddenFileIds","newSelection","clearSelection","selectFiles","reset","thunkDispatchFileAction","data","_dispatch","Promise","resolve","thunkRequestFileAction","payload","selectedFilesForAction","contextMenuTriggerFile","actionState","toggleOption","effect","maybeEffectPromise","reduxDispatch","getReduxState","then","triggerDispatchAfterEffect","effectResult","preventDispatch","FileViewMode","ChonkyIconName","defineFileAction","__payloadType","hotkeys","errorMessage","Error","findElementAmongAncestors","maybeElement","predicate","parentElement","elementIsInsideButton","buttonCandidate","element","tagName","toLowerCase","getValueOrFallback","fallback","desiredType","reduxThunks","selectRange","params","fileIdsToSelect","slice","rangeStart","rangeEnd","EssentialActions","MouseClickFile","clickType","OpenFiles","targetFile","ctrlKey","toggleSelection","exclusive","setLastClickIndex","fileDisplayIndex","shiftKey","lastClickIndex","KeyboardClickFile","enterKey","spaceKey","StartDragNDrop","draggedFile","EndDragNDrop","destination","droppedFiles","MoveFiles","ChangeSelection","icon","openParentFolder","iconOnly","OpenFileContextMenu","triggerFile","fileSelected","showContextMenu","mouseX","clientX","mouseY","clientY","DefaultActions","OpenSelection","openFiles","SelectAllFiles","selectAllFiles","ClearSelection","EnableListView","List","entryHeight","list","EnableCompactView","Compact","entryWidth","compact","EnableGridView","Grid","smallThumbnail","SortFilesByName","SortFilesBySize","SortFilesByDate","ToggleHiddenFiles","ToggleShowFoldersFirst","FocusSearchInput","ToggleDarkMode","ExtraActions","CopyFiles","copy","CreateFolder","tooltip","folderCreate","UploadFiles","upload","DownloadFiles","download","DeleteFiles","trash","initialRootState","fileActionsErrorMessages","rawFolderChain","folderChainErrorMessages","filesErrorMessages","searchMode","reducers","setExternalFileActionHandler","setRawFolderChain","setRawFiles","selectedFileId","setSortedFileIds","setHiddenFileIds","setFocusSearchInput","setSearchString","oldValue","setSelectionDisabled","setThumbnailGenerator","setDoubleClickDelay","setDisableDragAndDrop","setClearSelectionOnOutsideClick","setContextMenuMounted","hideContextMenu","actions","reducer","rootReducer","createSlice","initialState","useStoreWatchers","store","selectionWatcher","watch","onSelectionChange","oldSelection","selectedFilesIds","selection","unsubscribeCallbacks","subscribe","unsubscribe","useChonkyStore","chonkyInstanceId","preloadedState","configureStore","middleware","getDefaultMiddleware","serializableCheck","devTools","useParamSelector","parametrizedSelector","selectorParams","useCallback","useSelector","useDTE","actionCreator","useDispatch","usePropReduxUpdate","ChonkyIconPlaceholder","title","defaultConfig","onFileAction","disableDragAndDropProvider","defaultSortActionId","defaultFileViewActionId","iconComponent","darkMode","i18n","setChonkyDefaults","key","I18nNamespace","getI18nId","namespace","stringId","getActionI18nId","FileActions","useLocalizedFileActionGroup","intl","useIntl","useMemo","formatMessage","FileActionGroups","defaultMessage","useLocalizedFileActionStrings","buttonName","buttonTooltip","useLocalizedFileEntryStrings","formatters","useContext","ChonkyFormattersContext","fileModDateString","formatFileModDate","fileSizeString","formatFileSize","defaultFormatters","safeModDate","formatDate","dateStyle","timeStyle","_intl","sizeData","filesize","bits","output","symbol","Math","round","createContext","ChonkyIconContext","VideoExtensions","ImageExtensions","AudioExtensions","ColorsLight","ColorsDark","getIconTrie","colourIndex","step","IconsToExtensions","license","model","database","text","archive","image","video","code","info","lock","music","terminal","users","linux","ubuntu","windows","rust","python","nodejs","php","git","adobe","pdf","excel","word","flash","exactTrie","ExactTrie","ignoreCase","pair","extensions","colorCode","iconData","put","iconTrie","useIconData","loading","folder","match","getWithCheckpoints","lightTheme","colors","debugRed","debugBlue","debugGreen","debugPurple","debugYellow","textActive","fontSizes","rootPrimary","margins","rootLayoutMargin","lineHeight","fontSize","buttonRadius","dnd","canDropColor","cannotDropColor","canDropMask","cannotDropMask","fileListCanDropMaskOne","fileListCanDropMaskTwo","fileListCannotDropMaskOne","fileListCannotDropMaskTwo","dragLayer","border","padding","borderRadius","fileList","desktopGridGutter","mobileGridGutter","gridFileEntry","childrenCountSize","iconColorFocused","iconSize","iconColor","fileColorTint","folderBackColorTint","folderFrontColorTint","listFileEntry","propertyFontSize","iconFontSize","iconBorderRadius","darkThemeOverride","mobileThemeOverride","useIsMobileBreakpoint","useMediaQuery","getStripeGradient","colorOne","colorTwo","makeLocalChonkyStyles","styles","createUseStyles","makeGlobalChonkyStyles","makeStyles","selectorMapping","makeGlobalStyles","theme","localStyles","globalStyles","localSelectors","globalSelector","localSelector","jssSelector","useStyles","classes","important","c","classnames","useFileBrowserHandle","useStore","useImperativeHandle","getFileSelection","selectionSet","setFileSelection","requestFileAction","ChonkyBusinessLogicInner","memo","forwardRef","props","displayName","ChonkyBusinessLogic","React","useDndContextAvailable","dndContext","DndContext","dragDropManager","useDragIfAvailable","dndContextAvailable","mockHook","useHook","useDrag","useDropIfAvailable","useDrop","findClosestChonkyFileId","fileEntryWrapperDiv","dataset","chonkyFileId","useContextMenuTrigger","contextMenuMountedRef","event","altKey","preventDefault","target","useContextMenuDismisser","ChonkyDndFileEntryType","layerStyles","position","pointerEvents","zIndex","left","top","width","height","getItemStyles","initialCursorOffset","initialFileOffset","currentFileOffset","display","x","y","transform","WebkitTransform","DnDFileListDragLayer","itemType","isDragging","useDragLayer","monitor","getItem","getItemType","getInitialClientOffset","getInitialSourceClientOffset","getSourceClientOffset","selectionSize","style","className","fileDragPreview","boxShadow","palette","divider","backgroundColor","background","color","primary","HotkeyListener","fileAction","hotkeysStr","hotkeyCallback","unbind","ChonkyPresentationLayer","children","dndDisabled","handleClickAway","hotkeyListenerComponents","ClickAwayListener","onClickAway","Box","chonkyRoot","onContextMenu","paper","touchAction","fontFamily","flexDirection","boxSizing","textAlign","webkitTouchCallout","webkitUserSelect","mozUserSelect","msUserSelect","userSelect","FileBrowser","shortid","generate","isMobileBreakpoint","muiTheme","createMuiTheme","type","combinedTheme","merge","chonkyComps","IntlProvider","locale","defaultLocale","Provider","ReduxProvider","ThemeProvider","MuiThemeProvider","DndProvider","backend","HTML5Backend","useFolderChainItems","folderChainItems","items","disabled","onClick","useFileDrag","fileRef","getDndStartPayload","reduxState","sourceInstanceId","source","canDrag","onDragStart","onDragEnd","dropResult","getDropResult","dropTarget","dropEffect","collect","dndIsDragging","drag","preview","begin","end","getEmptyImage","captureDraggingState","useFileDrop","forceDisableDrop","includeChildrenDrops","folderChainRef","onDrop","_item","canDrop","customDropResult","isOver","shallow","prohibitedFileIds","movedFiles","currFile","isOverCurrent","dndIsOver","dndIsOverCurrent","dndCanDrop","drop","accept","useFileEntryDnD","dndState","useDndHoverOpen","currentFolderRef","timeout","getRandomInt","min","max","floor","random","TextPlaceholder","minLength","maxLength","placeholderLength","whitespace","repeat","textPlaceholder","dangerouslySetInnerHTML","__html","opacity","animationName","animationIterationCount","animationTimingFunction","animationDuration","whiteSpace","overflow","maxWidth","minWidth","useFileEntryHtmlProps","dataProps","role","useFileEntryState","selected","focused","thumbnailUrl","thumbnailLoading","useThumbnailUrl","fileColor","iconSpin","useDndIcon","dndIconName","showDropIcon","dndCannotDrop","dndDragging","useModifierIconComponents","modifierIcons","hidden","symlink","ChonkyIcon","modifierIconComponents","_extname","fileName","parts","split","useFileNameComponent","extension","ext","substr","setThumbnailUrl","setThumbnailLoading","loadingAttempts","loadingCancelled","useFileClickHandlers","displayIndex","onMouseClick","onKeyboardClick","onSingleClick","onDoubleClick","CustomVisibilityState","useFileActionTrigger","useFileActionProps","optionValue","actionSelectionSize","actionSelectionEmpty","active","sortAsc","sortDesc","placeholder","toggleOn","toggleOff","isSortButtonAndCurrentSort","isFileViewButtonAndCurrentView","isOptionAndEnabled","customDisabled","customActive","customVisibility","Disabled","Active","ToolbarButton","externalClassName","dropdown","iconWithText","fallbackIcon","fixedWidth","baseButton","iconOnlyButton","activeButton","Button","iconDropdown","textTransform","letterSpacing","paddingBottom","paddingTop","marginRight","marginLeft","marginTop","SmartToolbarButton","triggerAction","Hidden","FolderChainButton","first","baseBreadcrumb","disabledBreadcrumb","currentBreadcrumb","folderChainIcon","buttonContainer","dndIndicator","textDecoration","FileNavbar","folderChainComponents","components","component","navbarWrapper","navbarContainer","Breadcrumbs","navbarBreadcrumbs","separator","upDirectoryButton","flexGrow","ToolbarDropdownButton","MenuItem","ListItemIcon","ListItemText","primaryTypographyProps","minHeight","SmartToolbarDropdownButton","onClickFollowUp","handleClick","ToolbarDropdown","anchor","setAnchor","currentTarget","handleClose","menuItemComponents","localizedName","Menu","autoFocus","keepMounted","elevation","anchorEl","onClose","open","Boolean","transitionDuration","dropdownList","ToolbarInfo","hiddenCount","fileCountString","Toolbar","fileCount","selectedString","hiddenString","infoContainer","Typography","infoText","variant","extraInfoSpan","selectionSizeText","hiddenCountText","ToolbarSearch","searchPlaceholderString","searchInputRef","reduxSearchString","localSearchString","setLocalSearchString","debouncedLocalSearchString","showLoadingIndicator","setShowLoadingIndicator","focus","handleChange","handleKeyUp","blur","TextField","searchFieldContainer","onChange","inputRef","InputProps","onKeyUp","startAdornment","InputAdornment","searchIcon","spin","searchFieldInput","inputProps","searchFieldInputInner","margin","paddingLeft","FileToolbar","toolbarItemComponents","toolbarWrapper","toolbarContainer","toolbarLeft","toolbarRight","flexWrap","toolbarLeftFiller","FileListEmpty","emptyString","FileList","fileListEmpty","fileListEmptyContent","folderOpen","useClickHandler","counter","clickCount","clickTimeout","mouseClickEvent","metaKey","useKeyDownHandler","keyboardClickEvent","nativeEvent","stopPropagation","ClickableWrapper","wrapperTag","WrapperTag","passthroughProps","setFocused","handleKeyDown","compProps","onFocus","onBlur","onKeyDown","tabIndex","mergedProps","FileEntryName","fileNameComponent","hint","paddingRight","CompactEntry","entryState","fileEntryHtmlProps","listFileEntryIcon","listFileEntryDescription","listFileEntryName","listFileEntryProperties","listFileEntryProperty","alignItems","DnDFileEntry","fillParent","FileThumbnail","thumbnailStyle","backgroundImage","fileThumbnail","backgroundRepeat","backgroundPosition","backgroundSize","GridEntryDndIndicator","borderBottom","borderLeft","content","GridEntryPreviewFolder","folderClasses","useFolderStyles","fileClasses","useFileStyles","commonClasses","useCommonEntryStyles","previewFile","folderBackSideMid","folderBackSideTop","folderFrontSide","fileIcon","selectionIndicator","thumbnail","borderTopLeftRadius","borderTopRightRadius","right","borderRightColor","borderTopColor","borderBottomColor","borderLeftColor","borderWidth","borderStyle","bottom","shadows","GridEntryPreviewFile","focusIndicator","GridEntry","useFileEntryStyles","entryClassName","gridFileEntryPreview","gridFileEntryNameContainer","gridFileEntryName","wordBreak","ListEntry","styleState","listFileEntrySelection","textOverflow","flex","disabledDndState","SmartFileEntry","fileViewMode","fileClickHandlers","clickableWrapperProps","fileEntryClickableWrapper","fileEntryProps","EntryComponent","outline","isMobileDevice","window","orientation","navigator","userAgent","indexOf","getGridConfig","viewConfig","gutter","scrollbar","columnCount","columnWidth","rowCount","ceil","rowHeight","GridContainer","gridRef","gridConfig","setGridConfig","gridConfigRef","oldConf","newConf","resetAfterRowIndex","resetAfterColumnIndex","resetAfterIndices","columnIndex","rowIndex","sizers","gc","getColumnWidth","getRowHeight","displayFileIdsRef","getItemKey","cellRenderer","styleWithGutter","gridComponent","VariableSizeGrid","gridContainer","estimatedRowHeight","estimatedColumnWidth","itemKey","ListContainer","listRef","listComponent","rowRenderer","FixedSizeList","listContainer","itemSize","itemCount","borderTop","localClasses","useLocalStyles","onScroll","fillParentContainer","listRenderer","fileListWrapper","dndDropZone","dndDropZoneIcon","AutoSizer","disableHeight","maxHeight","FileContextMenu","browserMenuShortcutString","shortcut","contextMenuItemComponents","anchorPosition","disablePortal","anchorReference","contextMenuList","ListSubheader","browserMenuTooltip","FullFileBrowser","useFolderChain","currentFolderId","parentId","parentFile","unshift","useFiles","childrenIds","useFileMapMethods","baseFileMap","initialFolderId","setFileMap","setCurrentFolderId","resetFileMap","moveFiles","newFileMap","currentFileMap","moveFileIds","newSourceChildrenIds","newDestinationChildrenIds","methods","useFileActionHandler","fileToOpen","useFileMap","fileActionHandler"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEO,IAAMA,WAAW,GAAG,SAAdA,WAAc,CACvBC,KADuB,EAEvBC,KAFuB,EAAA;EAIvB,IAAA,SAAA,GAA4CG,QAAQ,CAACJ,KAAD,CAApD;IAAOE,cAAP,GAAA,SAAA,CAAA,CAAA,CAAA;IAAuBC,iBAAvB,GAAA,SAAA,CAAA,CAAA,CAAA;EAEAE,SAAS,CAAC,YAAA;IACN,IAAMC,OAAO,GAAGC,UAAU,CAAC,YAAA;MACvBJ,iBAAiB,CAACH,KAAD,CAAjBG;IACH,CAFyB,EAEvBF,KAFuB,CAA1B;IAIA,OAAO,YAAA;MACHO,YAAY,CAACF,OAAD,CAAZE;IACH,CAFD;EAGH,CARQ,EAQN,CAACR,KAAD,EAAQC,KAAR,CARM,CAATI;EAUA,OAAO,CAACH,cAAD,EAAiBC,iBAAjB,CAAP;AACH,CAjBM;AAmBP,IAAMM,sBAAsB,GAAG,CAAA,CAA/B;AACO,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAAIC,OAAJ,EAAA;EAC1B,IAAMC,QAAQ,GAAGC,MAAM,CAAIJ,sBAAJ,CAAvB;EACA,IAAIG,QAAQ,CAACE,OAATF,KAAqBH,sBAAzB,EAAiDG,QAAQ,CAACE,OAATF,GAAmBD,OAAO,EAA1BC;EACjD,OAAOA,QAAQ,CAACE,OAAhB;AACH,CAJM;AAMA,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAIf,KAAJ,EAAA;EAC/B,IAAMgB,GAAG,GAAGH,MAAM,CAACb,KAAD,CAAlB;EACAK,SAAS,CAAC,YAAA;IACNW,GAAG,CAACF,OAAJE,GAAchB,KAAdgB;EACH,CAFQ,EAEN,CAACA,GAAD,EAAMhB,KAAN,CAFM,CAATK;EAGA,OAAOW,GAAP;AACH,CANM;IC5BMC,MAAb,GAAA,aAAA,YAAA;EAAA,SAAA,MAAA,CAAA,EAAA,CAAA;EAAA,MAAA,CACkBC,KADlB,GACW,SAAA,KAAA,CAAA,EAAA;;sCAAgBC,IAAAA,GAAAA,IAAAA,KAAAA,CAAAA,IAAAA,CAAAA,EAAAA,IAAAA,GAAAA,CAAAA,EAAAA,IAAAA,GAAAA,IAAAA,EAAAA,IAAAA,EAAAA,EAAAA;MAAAA,IAAAA,CAAAA,IAAAA,CAAAA,GAAAA,SAAAA,CAAAA,IAAAA,CAAAA;;;IACnB;IACA,CAAA,QAAA,GAAA,OAAO,EAACD,KAAR,CAAA,KAAA,CAAA,QAAA,EAAA,CAAc,wBAAd,CAAA,CAAA,MAAA,CAA2CC,IAA3C,CAAA,CAAA;EACH,CAJL;EAAA,MAAA,CAMkBC,IANlB,GAMW,SAAA,IAAA,CAAA,EAAA;;uCAAeD,IAAAA,GAAAA,IAAAA,KAAAA,CAAAA,KAAAA,CAAAA,EAAAA,KAAAA,GAAAA,CAAAA,EAAAA,KAAAA,GAAAA,KAAAA,EAAAA,KAAAA,EAAAA,EAAAA;MAAAA,IAAAA,CAAAA,KAAAA,CAAAA,GAAAA,SAAAA,CAAAA,KAAAA,CAAAA;;;IAClB;IACA,CAAA,SAAA,GAAA,OAAO,EAACC,IAAR,CAAA,KAAA,CAAA,SAAA,EAAA,CAAa,0BAAb,CAAA,CAAA,MAAA,CAA4CD,IAA5C,CAAA,CAAA;EACH,CATL;EAAA,MAAA,CAWkBE,KAXlB,GAWW,SAAA,KAAA,CAAA,EAAA;;uCAAgBF,IAAAA,GAAAA,IAAAA,KAAAA,CAAAA,KAAAA,CAAAA,EAAAA,KAAAA,GAAAA,CAAAA,EAAAA,KAAAA,GAAAA,KAAAA,EAAAA,KAAAA,EAAAA,EAAAA;MAAAA,IAAAA,CAAAA,KAAAA,CAAAA,GAAAA,SAAAA,CAAAA,KAAAA,CAAAA;;;IACnB;IACA,CAAA,SAAA,GAAA,OAAO,EAACE,KAAR,CAAA,KAAA,CAAA,SAAA,EAAA,CAAc,wBAAd,CAAA,CAAA,MAAA,CAA2CF,IAA3C,CAAA,CAAA;EACH,CAdL;EAAA,MAAA,CAgBkBG,aAhBlB,GAgBW,SAAA,aAAA,CAAqBC,OAArB,EAAA;IACH,OAAA,MAAA,GAAcA,OAAO,CAACC,IAARD,CAAa,MAAbA,CAAd;EACH,CAlBL;EAAA,OAAA,MAAA;AAAA,CAAA,EAAA;ICKaE,UAAb,GAAA,aAAA,YAAA;EAAA,SAAA,UAAA,CAAA,EAAA,CAAA;EAAA,UAAA,CACkBC,WADlB,GACW,SAAA,WAAA,CAAmBC,IAAnB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACC,KAALD,KAAe,IAAhC;EACH,CAJL;EAAA,UAAA,CAMkBE,QANlB,GAMW,SAAA,QAAA,CAAgBF,IAAhB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACE,QAALF,KAAkB,IAAnC;EACH,CATL;EAAA,UAAA,CAWkBG,SAXlB,GAWW,SAAA,SAAA,CAAiBH,IAAjB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACG,SAALH,KAAmB,IAApC;EACH,CAdL;EAAA,UAAA,CAgBkBI,WAhBlB,GAgBW,SAAA,WAAA,CAAmBJ,IAAnB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACI,WAALJ,KAAqB,IAAtC;EACH,CAnBL;EAAA,UAAA,CAqBkBK,WArBlB,GAqBW,SAAA,WAAA,CAAmBL,IAAnB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAT;EACH,CAxBL;EAAA,UAAA,CA0BkBM,UA1BlB,GA0BW,SAAA,UAAA,CAAkBN,IAAlB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACO,QAALP,KAAkB,KAAnC;EACH,CA7BL;EAAA,UAAA,CA+BkBQ,YA/BlB,GA+BW,SAAA,YAAA,CAAoBR,IAApB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACS,UAALT,KAAoB,KAArC;EACH,CAlCL;EAAA,UAAA,CAoCkBU,WApClB,GAoCW,SAAA,WAAA,CAAmBV,IAAnB,EAAA;IACH;IACA,OAAO,CAAC,CAACA,IAAF,IAAUA,IAAI,CAACW,SAALX,KAAmB,KAApC;EACH,CAvCL;EAAA,UAAA,CAyCkBY,WAzClB,GAyCW,SAAA,WAAA,CAAmBZ,IAAnB,EAAA;IACH;IACA,IAAI,CAACA,IAAL,EAAW,OAAO,KAAP;IACX,IAAIA,IAAI,CAACC,KAALD,IAAcA,IAAI,CAACa,SAALb,KAAmB,KAArC,EAA4C,OAAO,IAAP;IAC5C,OAAOA,IAAI,CAACa,SAALb,KAAmB,IAA1B;EACH,CA9CL;EAAA,UAAA,CAgDkBc,aAhDlB,GAgDW,SAAA,aAAA,CAAqBd,IAArB,EAAA;IACH;IACA,IAAI,CAACF,UAAU,CAACQ,UAAXR,CAAsBE,IAAtBF,CAAL,EAAkC,OAAO,KAAP;IAClC,IAAIE,IAAI,CAACC,KAALD,IAAcA,IAAI,CAACe,WAALf,KAAqB,KAAvC,EAA8C,OAAO,IAAP;IAC9C,OAAOA,IAAI,CAACe,WAALf,KAAqB,IAA5B;EACH,CArDL;EAAA,UAAA,CAuDkBgB,UAvDlB,GAuDW,SAAA,UAAA,CAAkBhB,IAAlB,EAAA;IACH,IAAI,CAACA,IAAD,IAASA,IAAI,CAACiB,OAALjB,KAAiB,IAA1B,IAAkCA,IAAI,CAACiB,OAALjB,KAAiBkB,SAAvD,EAAkE,OAAO,IAAP;IAClE,OAAOpB,UAAU,CAACqB,SAAXrB,CAAqBE,IAAI,CAACiB,OAA1BnB,CAAP;EACH,CA1DL;EAAA,UAAA,CA4DkBqB,SA5DlB,GA4DW,SAAA,SAAA,CAAiBC,SAAjB,EAAA;IACH,IAAI,OAAOA,SAAP,KAAqB,QAArB,IAAiC,OAAOA,SAAP,KAAqB,QAA1D,EAAoE;MAChE;MACA,IAAI;QACA,OAAO,IAAIC,IAAJ,CAASD,SAAT,CAAP;MACH,CAFD,CAEE,OAAO7B,KAAP,EAAc;QACZD,MAAM,CAACC,KAAPD,CAAAA,wDAAAA,GAC6DC,KAAK,CAAC+B,OADnEhC,GAAAA,GAAAA,EAEI,gBAFJA,EAGI8B,SAHJ9B,CAAAA;MAKH;IACJ;IACD,IAAI8B,SAAS,YAAYC,IAArBD,IAA6B,CAACG,KAAK,CAACH,SAAS,CAACI,OAAVJ,EAAD,CAAvC,EAA8D;MAC1D;MACA,OAAOA,SAAP;IACH,CAAA,CAAA;;IAGD9B,MAAM,CAACG,IAAPH,CAAY,kCAAZA,EAAgD8B,SAAhD9B,CAAAA;IACA,OAAO,IAAP;EACH,CAjFL;EAAA,UAAA,CAmFkBmC,gBAnFlB,GAmFW,SAAA,gBAAA,CAAwBzB,IAAxB,EAAA;IACH,IAAI,CAACA,IAAD,IAAS,OAAOA,IAAI,CAAC0B,aAAZ,KAA8B,QAA3C,EAAqD,OAAO,IAAP;IAErD,OAAO1B,IAAI,CAAC0B,aAAZ;EACH,CAvFL;EAAA,OAAA,UAAA;AAAA,CAAA,EAAA;ACgBO,IAAMC,kBAAkB,GAAkB,SAApCA,kBAAoC,CAACC,IAAD,EAAeC,QAAf,EAAA;EAC7C,IAAMC,cAAc,GAAG,EAAvB;EACA,IAAMC,aAAa,GAAa,EAAhC;EAEA,IAAI,CAACH,IAAI,KAAK,aAATA,IAA0BA,IAAI,KAAK,aAApC,KAAsD,CAACC,QAA3D,EAAqE,CAArE,KAEO,IAAI,CAACG,KAAK,CAACC,OAAND,CAAcH,QAAdG,CAAL,EAA8B;IACjCD,aAAa,CAACG,IAAdH,CAAAA,aAAAA,GACiBH,IADjBG,GAAAA,gCAAAA,GACoD,OAAOF,QAD3DE,GAAAA,aAAAA,CAAAA;EAGH,CAJM,MAIA;IACH,IAAII,kBAAkB,GAAG,CAAzB;IACA,IAAIC,qBAAqB,GAAG,CAA5B;IACA,IAAMC,OAAO,GAAG,IAAIC,GAAJ,EAAhB;IACA,IAAMC,YAAY,GAAG,IAAID,GAAJ,EAArB;IAEA,KAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGX,QAAQ,CAACY,MAA7B,EAAqC,EAAED,CAAvC,EAA0C;MACtC,IAAME,IAAI,GAAGb,QAAQ,CAACW,CAAD,CAArB;MACA,IAAI,CAACE,IAAL,EAAW;QACP,IAAId,IAAI,KAAK,aAAb,EAA4BO,kBAAkB,EAAA,CAA9C,KACKL,cAAc,CAACI,IAAfJ,CAAoB,IAApBA,CAAAA;MACR,CAHD,MAGO,IAAI,OAAOY,IAAP,KAAgB,QAApB,EAA8B;QACjCP,kBAAkB,EAAA;MACrB,CAFM,MAEA;QACH,IAAI,CAACO,IAAI,CAACC,EAAN,IAAaf,IAAI,KAAK,aAATA,IAA0B,CAACc,IAAI,CAACE,IAAjD,EAAwD;UACpDR,qBAAqB,EAAA;QACxB,CAFD,MAEO,IAAIC,OAAO,CAACQ,GAARR,CAAYK,IAAI,CAACC,EAAjBN,CAAJ,EAA0B;UAC7BE,YAAY,CAACO,GAAbP,CAAiBG,IAAI,CAACC,EAAtBJ,CAAAA;QACH,CAFM,MAEA;UACHF,OAAO,CAACS,GAART,CAAYK,IAAI,CAACC,EAAjBN,CAAAA;UACAP,cAAc,CAACI,IAAfJ,CAAoBY,IAApBZ,CAAAA;QACH;MACJ;IACJ;IAED,IAAIK,kBAAJ,EAAwB;MACpBJ,aAAa,CAACG,IAAdH,CACI,WAAA,GAAYI,kBAAZ,GAAA,qCAAA,GAAA,8DADJJ,CAAAA;IAIH;IACD,IAAIK,qBAAJ,EAA2B;MACvBL,aAAa,CAACG,IAAdH,CACI,WAAA,GAAYK,qBAAZ,GAAA,gCAAA,GAAA,8DAAA,GAAA,wBADJL,CAAAA;IAKH;IACD,IAAIQ,YAAY,CAACQ,IAAbR,GAAoB,CAAxB,EAA2B;MACvB,IAAMS,iBAAiB,GAAG,GAAA,GAAMhB,KAAK,CAACiB,IAANjB,CAAWO,YAAXP,CAAAA,CAAyBnC,IAAzBmC,CAA8B,MAA9BA,CAAN,GAA8C,GAAxE;MACAD,aAAa,CAACG,IAAdH,CACI,WAAA,GAAYQ,YAAY,CAACQ,IAAzB,GAAA,mCAAA,GAAA,+DAAA,IAAA,0CAAA,GAE+CC,iBAF/C,CADJjB,CAAAA;IAKH;EACJ;EAED,IAAIA,aAAa,CAACU,MAAdV,GAAuB,CAA3B,EAA8B;IAC1B,IAAMmB,kBAAkB,GAAG,MAAA,GAASnB,aAAa,CAAClC,IAAdkC,CAAmB,MAAnBA,CAApC;IACA,IAAIoB,WAAJ;IACA,IAAIC,UAAJ;IACA,IAAIxB,IAAI,KAAK,aAAb,EAA4B;MACxBuB,WAAW,GAAG,cAAdA;MACAC,UAAU,GAAG,OAAbA;IACH,CAHD,MAGO,IAAIxB,IAAI,KAAK,aAAb,EAA4B;MAC/BuB,WAAW,GAAG,cAAdA;MACAC,UAAU,GAAG,cAAbA;IACH,CAHM,MAGA;MACH;MACAD,WAAW,GAAG,OAAdA;MACAC,UAAU,GAAG,OAAbA;IACH;IAED9D,MAAM,CAACC,KAAPD,CACI,2CAAA,GAA4C6D,WAA5C,GAAA,UAAA,IAAA,YAAA,GACiBC,UADjB,GAAA,2CAAA,CAAA,IAAA,qBAAA,GAE0BF,kBAF1B,CADJ5D,CAAAA;EAKH;EAED,OAAO;IACH+D,cAAc,EAAEvB,cADb;IAEHC,aAAa,EAAbA;EAFG,CAAP;AAIH,CArFM;;ACrBP;;;AAGA,IAAauB,SAAS,GAAG;EACrBC,eAAe,EAAE,mBADI;EAErBC,gBAAgB,EAAE,oBAFG;EAGrBC,QAAQ,EAAE;AAHW,CAAlB;ACGP,IAAYC,SAAZ;AAAA,CAAA,UAAYA,SAAAA,EAAAA;EACRA,SAAAA,CAAAA,KAAAA,CAAAA,GAAAA,KAAAA;EACAA,SAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;AACH,CAHD,EAAYA,SAAS,KAATA,SAAS,GAAA,CAAA,CAAA,CAArB,CAAA;ICOaC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACC,UAA5B;AAAA,CAAzB;AACP,IAAaC,+BAA+B,GAAG,SAAlCA,+BAAkC,CAACF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACG,yBAA5B;AAAA,CAAxC;AAEP,IAAaC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACJ,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACK,aAA5B;AAAA,CAA5B;AACP,IAAaC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACN,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACO,aAA5B;AAAA,CAA5B;AACP,IAAaC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,YAAD,EAAA;EAAA,OAA0B,UAACT,KAAD,EAAA;IAAA,OAC1DI,mBAAmB,CAACJ,KAAD,CAAnBI,CAA2BK,YAA3BL,CAD0D;EAAA,CAA1B;AAAA,CAA7B;AAEP,IAAaM,kBAAkB,GAAG,SAArBA,kBAAqB,CAACV,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACW,YAA5B;AAAA,CAA3B;AACP,IAAaC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACZ,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACa,gBAA5B;AAAA,CAA/B;AAEP,IAAaC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACd,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACe,WAA5B;AAAA,CAA1B;AACP,IAAaC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAChB,KAAD,EAAA;EAC/B,IAAMe,WAAW,GAAGD,iBAAiB,CAACd,KAAD,CAArC;EACA,IAAMiB,aAAa,GAAGF,WAAW,CAAClC,MAAZkC,GAAqB,CAArBA,GAAyBA,WAAW,CAACA,WAAW,CAAClC,MAAZkC,GAAqB,CAAtB,CAApCA,GAA+D,IAArF;EACA,OAAOE,aAAP;AACH,CAJM;AAKP,IAAaC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAClB,KAAD,EAAA;EAC9B,IAAMe,WAAW,GAAGD,iBAAiB,CAACd,KAAD,CAArC;EACA,IAAMmB,YAAY,GAAGJ,WAAW,CAAClC,MAAZkC,GAAqB,CAArBA,GAAyBA,WAAW,CAACA,WAAW,CAAClC,MAAZkC,GAAqB,CAAtB,CAApCA,GAA+D,IAApF;EACA,OAAOI,YAAP;AACH,CAJM;AAMP,IAAaC,cAAc,GAAG,SAAjBA,cAAiB,CAACpB,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACqB,QAA5B;AAAA,CAAvB;AACP,IAAaC,aAAa,GAAG,SAAhBA,aAAgB,CAACtB,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACuB,OAA5B;AAAA,CAAtB;AACP,IAAaC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACxB,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACyB,YAA5B;AAAA,CAA3B;AACP,IAAaC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,MAAD,EAAA;EAAA,OAA8B,UAAC3B,KAAD,EAAA;IAAA,OACxD2B,MAAM,GAAGL,aAAa,CAACtB,KAAD,CAAbsB,CAAqBK,MAArBL,CAAH,GAAkC,IADgB;EAAA,CAA9B;AAAA,CAAvB;AAGP,IAAaM,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAC5B,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAAC6B,eAA5B;AAAA,CAA9B;AACP,IAAaC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAC9B,KAAD,EAAA;EAAA,OAAsB+B,MAAM,CAACC,IAAPD,CAAYH,qBAAqB,CAAC5B,KAAD,CAAjC+B,CAAAA,CAA0ClD,MAAhE;AAAA,CAA9B;AAEP,IAAaoD,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACjC,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACkC,gBAA5B;AAAA,CAA/B;AACP,IAAaC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACnC,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACoC,YAA5B;AAAA,CAA3B;AAEP,IAAaC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACrC,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACsC,YAA5B;AAAA,CAA3B;AACP,IAAaC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACvC,KAAD,EAAA;EAAA,OAAsB+B,MAAM,CAACC,IAAPD,CAAYM,kBAAkB,CAACrC,KAAD,CAA9B+B,CAAtB;AAAA,CAA9B;AACP,IAAaS,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACxC,KAAD,EAAA;EAAA,OAAsBuC,qBAAqB,CAACvC,KAAD,CAArBuC,CAA6B1D,MAAnD;AAAA,CAA5B;AACP,IAAa4D,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACd,MAAD,EAAA;EAAA,OAA8B,UAAC3B,KAAD,EAAA;IAAA,OAC9D,CAAC,CAAC2B,MAAF,IAAY,CAAC,CAACU,kBAAkB,CAACrC,KAAD,CAAlBqC,CAA0BV,MAA1BU,CADgD;EAAA,CAA9B;AAAA,CAA7B;AAEP,IAAaK,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAC1C,KAAD,EAAA;EAC/B,IAAMuB,OAAO,GAAGD,aAAa,CAACtB,KAAD,CAA7B;EACA,OAAO,MAAM,CAACgC,IAAP,CAAYK,kBAAkB,CAACrC,KAAD,CAA9B,CAAA,CAAuC2C,GAAvC,CAA2C,UAAA,EAAE,EAAA;IAAA,OAAIpB,OAAO,CAACxC,EAAD,CAAX;EAAA,CAA7C,CAAP;AACH,CAHM;AAIP,IAAa6D,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACnC,YAAD,EAAA;EAAA,OAA0B,UAACT,KAAD,EAAA;IAClE,IAAQK,aAAR,GAA0BL,KAA1B,CAAQK,aAAR;IACA,IAAMwC,MAAM,GAAGxC,aAAa,CAACI,YAAD,CAA5B;IACA,IAAI,CAACoC,MAAD,IAAW,CAACA,MAAM,CAACC,iBAAvB,EAA0C,OAAOxF,SAAP;IAE1C,OAAOyF,gBAAgB,CAAC/C,KAAD,EAAQ6C,MAAM,CAACG,UAAf,CAAvB;EACH,CAN2C;AAAA,CAArC;AAOP,IAAaC,iCAAiC,GAAG,SAApCA,iCAAoC,CAACxC,YAAD,EAAA;EAAA,OAA0B,UAACT,KAAD,EAAA;IAAA,IAAA,qBAAA;IAAA,OAAA,CAAA,qBAAA,GACvEkD,yBAAyB,CAAClD,KAAD,EAAQS,YAAR,CAD8C,KAAA,IAAA,GAAA,KAAA,CAAA,GACvEyC,qBAAAA,CAAgDrE,MADuB;EAAA,CAA1B;AAAA,CAA1C;AAEP,IAAasE,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACnD,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACoD,gBAA5B;AAAA,CAA/B;AAEP,IAAaC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACrD,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACsD,cAA5B;AAAA,CAA7B;AAEP,IAAaC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACvD,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACwD,YAA5B;AAAA,CAA3B;AACP,IAAaC,eAAe,GAAG,SAAlBA,eAAkB,CAACzD,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAAC0D,SAA5B;AAAA,CAAxB;AAEP,IAAaC,eAAe,GAAG,SAAlBA,eAAkB,CAAC3D,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAAC4D,SAA5B;AAAA,CAAxB;AACP,IAAaC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,QAAD,EAAA;EAAA,OAAsB,UAAC9D,KAAD,EAAA;IAAA,OAAsB2D,eAAe,CAAC3D,KAAD,CAAf2D,CAAuBG,QAAvBH,CAAtB;EAAA,CAAtB;AAAA,CAA1B;AAEP,IAAaI,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAC/D,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACgE,kBAA5B;AAAA,CAAjC;AACP,IAAaC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACjE,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACkE,gBAA5B;AAAA,CAA/B;AACP,IAAaC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACnE,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACoE,kBAA5B;AAAA,CAA5B;AACP,IAAaC,kCAAkC,GAAG,SAArCA,kCAAqC,CAACrE,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACsE,4BAA5B;AAAA,CAA3C;AAEP,IAAaC,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACvE,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACwE,kBAA5B;AAAA,CAAjC;AACP,IAAaC,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACzE,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAAC0E,iBAA5B;AAAA,CAAhC;AACP,IAAaC,4BAA4B,GAAG,SAA/BA,4BAA+B,CAAC3E,KAAD,EAAA;;EACxC,IAAM4E,MAAM,GAAGH,uBAAuB,CAACzE,KAAD,CAAtC;EACA,IAAI,CAAC4E,MAAD,IAAW,CAACA,MAAM,CAACC,aAAvB,EAAsC,OAAO,IAAP;EACtC,IAAMtD,OAAO,GAAGD,aAAa,CAACtB,KAAD,CAA7B;EACA,OAAA,CAAA,qBAAA,GAAOuB,OAAO,CAACqD,MAAM,CAACC,aAAR,CAAd,KAAA,IAAA,GAAA,qBAAA,GAAwC,IAAxC;AACH,CALM,CAAA,CAAA;;AAQP,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC9E,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACK,aAA5B;AAAA,CAAzB;AACA,IAAM0E,YAAY,GAAG,SAAfA,YAAe,CAAC/E,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAAC4D,SAA5B;AAAA,CAArB;AACA,IAAMoB,UAAU,GAAG,SAAbA,UAAa,CAAChF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACuB,OAA5B;AAAA,CAAnB;AACA,IAAM0D,UAAU,GAAG,SAAbA,UAAa,CAACjF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACkF,OAA5B;AAAA,CAAnB;AACA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACnF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACyB,YAA5B;AAAA,CAAxB;AACA,IAAM2D,eAAe,GAAG,SAAlBA,eAAkB,CAACpF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACwD,YAA5B;AAAA,CAAxB;AACA,IAAM6B,YAAY,GAAG,SAAfA,YAAe,CAACrF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAAC0D,SAA5B;AAAA,CAArB;AACA,IAAM4B,eAAe,GAAG,SAAlBA,eAAkB,CAACtF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACoC,YAA5B;AAAA,CAAxB;AACA,IAAMmD,aAAa,GAAG,SAAhBA,aAAgB,CAACvF,KAAD,EAAA;EAAA,OAAsBA,KAAK,CAACwF,SAA5B;AAAA,CAAtB,CAAA,CAAA;;AAGA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,kBAAD,EAAA;EAAA,OAClBC,cAAc,CAAC,CAACb,gBAAD,EAAmBY,kBAAnB,CAAD,EAAyC,UAACrF,aAAD,EAAgBI,YAAhB,EAAA;IAAA,OACnDA,YAAY,IAAIJ,aAAa,CAACI,YAAD,CAA7BA,GAA8CJ,aAAa,CAACI,YAAD,CAA3DA,GAA4E,IADzB;EAAA,CAAzC,CADI;AAAA,CAAtB;AAIA,IAAMmF,kBAAkB,GAAG,SAArBA,kBAAqB,CAAC9B,QAAD,EAAmB+B,YAAnB,EAAA;EAAA,IAAmBA,YAAnB,KAAA,KAAA,CAAA,EAAA;IAAmBA,YAAnB,GAAuCvI,SAAvC;EAAA;EAAA,OACvBqI,cAAc,CAAC,CAACZ,YAAD,CAAD,EAAiB,UAAA,SAAS,EAAA;IACpC,IAAMtK,KAAK,GAAGmJ,SAAS,CAACE,QAAD,CAAvB;IACA,IAAIrJ,KAAK,KAAK6C,SAAd,EAAyB;MACrB,OAAOuI,YAAP;IACH;IACD,OAAOpL,KAAP;EACH,CANa,CADS;AAAA,CAA3B;AAQA,IAAMqL,YAAY,GAAG,SAAfA,YAAe,CAACC,eAAD,EAAA;EAAA,OACjBJ,cAAc,CACV,CAACX,UAAD,EAAae,eAAb,CADU,EAEV,UAACxE,OAAD,EAAU2D,OAAV,EAAA;IAAA,OAAiC,OAAO,CAACvC,GAAR,CAAY,UAAA,MAAM,EAAA;MAAA,OAAKhB,MAAM,IAAIJ,OAAO,CAACI,MAAD,CAAjBA,GAA4BJ,OAAO,CAACI,MAAD,CAAnCA,GAA8C,IAAnD;IAAA,CAAlB,CAAjC;EAAA,CAFU,CADG;AAAA,CAArB;AAKA,IAAMqE,gBAAgB,GAAA,aAAGL,cAAc,CACnC,CACIV,UADJ,EAEII,YAFJ,EAAA,aAGIS,YAAY,CAACb,UAAD,CAHhB,EAAA,aAIIQ,aAAa,CAACL,eAAD,CAJjB,EAAA,aAKIQ,kBAAkB,CAAClG,SAAS,CAACE,gBAAX,EAA6B,KAA7B,CALtB,CADmC,EAQnC,UAACsF,OAAD,EAAUxB,SAAV,EAAqBuC,KAArB,EAA4BC,UAA5B,EAAwCC,eAAxC,EAAA;EACI,IAAI,CAACD,UAAL,EAAiB;IACb;IACA;IACA,OAAOhB,OAAP;EACH;EAED,IAAMkB,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACC,QAAD,EAAA;IAAA,OAAmC,UAACjK,IAAD,EAAA;MAAA,OAA8BiK,QAAQ,CAACjK,IAAD,CAAtC;IAAA,CAAnC;EAAA,CAA/B;EAEA,IAAMkK,aAAa,GAGb,EAHN;EAKA,IAAIH,eAAJ,EAAqB;IACjB;IACA;IACAG,aAAa,CAAChI,IAAdgI,CAAmB;MACfC,IAAI,EAAEH,sBAAsB,CAAClK,UAAU,CAACC,WAAZ;IADb,CAAnBmK,CAAAA;EAGH;EACD,IAAIJ,UAAU,CAACM,eAAf,EAAgC;IAAA,IAAA,mBAAA;IAC5B,IAAMC,aAAa,GAAG/C,SAAS,KAAK5D,SAAS,CAAC4G,GAAxBhD,GAA8B,KAA9BA,GAAsC,MAA5D;IACA4C,aAAa,CAAChI,IAAdgI,EAAAA,mBAAAA,GAAAA,CAAAA,CAAAA,EAAAA,mBAAAA,CACKG,aADLH,CAAAA,GACqBF,sBAAsB,CAACF,UAAU,CAACM,eAAZ,CAD3CF,EAAAA,mBAAAA,EAAAA;EAGH;EACD,IAAIA,aAAa,CAACzH,MAAdyH,KAAyB,CAA7B,EAAgC,OAAOpB,OAAP,CAAA,CAAA;;EAGhC,IAAMyB,aAAa,GAAG,IAAI,CAAA,EAAA,CAAA,MAAA,CAAKV,KAAL,CAAA,CAAJ,CACjBW,EADiB,CACdN,aADc,CAAA,CAEjB3D,GAFiB,CAEb,UAAA,IAAI,EAAA;IAAA,OAAKvG,IAAI,GAAGA,IAAI,CAAC2C,EAAR,GAAa,IAAtB;EAAA,CAFS,CAAtB;EAGA,OAAO4H,aAAP;AACH,CA1CkC,CAAvC;AA4CA,IAAME,WAAW,GAAA,aAAGlB,cAAc,CAC9B,CAAA,aAACG,YAAY,CAACX,eAAD,CAAb,CAD8B,EAE9B,UAAA,UAAU,EAAA;EAAA,OAAI,IAAI2B,WAAJ,CAAgBC,UAAhB,EAA0C,CAAC,MAAD,CAA1C,EAAoD;IAAEC,aAAa,EAAE;EAAjB,CAApD,CAAJ;AAAA,CAFoB,CAAlC;AAIA,IAAMC,wBAAwB,GAAA,aAAGtB,cAAc,CAC3C,CAACR,eAAD,EAAkBG,eAAlB,EAAmCuB,WAAnC,CAD2C,EAE3C,UAACpF,YAAD,EAAeW,YAAf,EAA6B8E,QAA7B,EAAA;EAAA,OACI9E,YAAY,GAAG,QAAQ,CAAC+E,MAAT,CAAgB/E,YAAhB,CAAA,CAA8BO,GAA9B,CAAkC,UAAA,CAAC,EAAA;IAAA,OAAIyE,CAAC,CAACrI,EAAN;EAAA,CAAnC,CAAH,GAAkD0C,YADlE;AAAA,CAF2C,CAA/C;AAKA,IAAM4F,kBAAkB,GAAA,aAAG1B,cAAc,CACrC,CAACsB,wBAAD,EAAA,aAA2BnB,YAAY,CAACX,eAAD,CAAvC,EAAA,aAA0DS,kBAAkB,CAAClG,SAAS,CAACC,eAAX,CAA5E,CADqC,EAErC,UAAC2H,qBAAD,EAAwBP,UAAxB,EAAoCQ,eAApC,EAAA;EACI,IAAMC,wBAAwB,GAAG,IAAI9I,GAAJ,CAAQ4I,qBAAR,CAAjC;EACA,IAAMzF,eAAe,GAAQ,CAAA,CAA7B;EACAkF,UAAU,CAACU,OAAXV,CAAmB,UAAA,IAAI,EAAA;IACnB,IAAI,CAAC3K,IAAL,EAAW,OAAX,KACK,IAAI,CAACoL,wBAAwB,CAACvI,GAAzBuI,CAA6BpL,IAAI,CAAC2C,EAAlCyI,CAAL,EAA4C;MAC7C;MACA3F,eAAe,CAACzF,IAAI,CAAC2C,EAAN,CAAf8C,GAA2B,IAA3BA;IACH,CAHI,MAGE,IAAI,CAAC0F,eAAD,IAAoBrL,UAAU,CAACI,QAAXJ,CAAoBE,IAApBF,CAAxB,EAAmD;MACtD;MACA2F,eAAe,CAACzF,IAAI,CAAC2C,EAAN,CAAf8C,GAA2B,IAA3BA;IACH;EACJ,CATDkF,CAAAA;EAUA,OAAOlF,eAAP;AACH,CAhBoC,CAAzC;AAkBA,IAAM6F,iBAAiB,GAAA,aAAG/B,cAAc,CACpC,CAACK,gBAAD,EAAmBqB,kBAAnB,CADoC,EAEpC;AACA,UAACV,aAAD,EAAgB9E,eAAhB,EAAA;EAAA,OAAoC,aAAa,CAAC8F,MAAd,CAAqB,UAAA,EAAE,EAAA;IAAA,OAAI,CAAC5I,EAAD,IAAO,CAAC8C,eAAe,CAAC9C,EAAD,CAA3B;EAAA,CAAvB,CAApC;AAAA,CAHoC,CAAxC;AAKA,IAAM6I,iBAAiB,GAAA,aAAGjC,cAAc,CACpC,CAACJ,aAAD,EAAgBS,gBAAhB,CADoC,EAEpC;AACA,UAACR,SAAD,EAAYqC,cAAZ,EAAA;EACI,IACI,CAACrC,SAAD,IACAA,SAAS,CAACsC,KAAVtC,GAAkBqC,cAAc,CAAChJ,MAAfgJ,GAAwB,CAD1C,IAEArC,SAAS,CAAC7D,MAAV6D,IAAoBqC,cAAc,CAACrC,SAAS,CAACsC,KAAX,CAHtC,EAIE;IACE,OAAO,IAAP;EACH;EACD,OAAOtC,SAAS,CAACsC,KAAjB;AACH,CAZmC,CAAxC;AAeA,IAAaC,SAAS,GAAG;EACrB;EACAjD,gBAAgB,EAAhBA,gBAFqB;EAGrBC,YAAY,EAAZA,YAHqB;EAIrBC,UAAU,EAAVA,UAJqB;EAKrBC,UAAU,EAAVA,UALqB;EAMrBE,eAAe,EAAfA,eANqB;EAOrBC,eAAe,EAAfA,eAPqB;EAQrBC,YAAY,EAAZA,YARqB;EASrBC,eAAe,EAAfA,eATqB;EAUrBC,aAAa,EAAbA,aAVqB;EAYrB;EACAS,gBAAgB,EAAhBA,gBAbqB;EAcrBa,WAAW,EAAXA,WAdqB;EAerBI,wBAAwB,EAAxBA,wBAfqB;EAgBrBI,kBAAkB,EAAlBA,kBAhBqB;EAiBrBK,iBAAiB,EAAjBA,iBAjBqB;EAkBrBE,iBAAiB,EAAjBA,iBAlBqB;EAoBrB;EACAnC,aAAa,EAAbA,aArBqB;EAsBrBG,kBAAkB,EAAlBA,kBAtBqB;EAuBrBE,YAAY,EAAZA;AAvBqB,CAAlB,CAAA,CAAA;;AA2BP,IAAakC,WAAW,GAAG,SAAdA,WAAc,CAAChI,KAAD,EAAmB2B,MAAnB,EAAA;EAAA,OACvBA,MAAM,GAAGL,aAAa,CAACtB,KAAD,CAAbsB,CAAqBK,MAArBL,CAAH,GAAkC,IADjB;AAAA,CAApB;AAEP,IAAa2G,iBAAiB,GAAG,SAApBA,iBAAoB,CAACjI,KAAD,EAAmB5D,IAAnB,EAAA;EAC7B;EACA;EACA,OAAO,CAAC,CAACiG,kBAAkB,CAACrC,KAAD,CAAlBqC,CAA0BjG,IAAI,CAAC2C,EAA/BsD,CAAT;AACH,CAJM;AAKP,IAAaU,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC/C,KAAD,EAAA;EAC5B,IAAQuB,OAAR,GAAkCvB,KAAlC,CAAQuB,OAAR;IAAiBe,YAAjB,GAAkCtC,KAAlC,CAAiBsC,YAAjB;EAEA,IAAM6F,aAAa,GAAG,MAAM,CAACnG,IAAP,CAAYM,YAAZ,CAAA,CAA0BK,GAA1B,CAA8B,UAAA,EAAE,EAAA;IAAA,OAAIpB,OAAO,CAACxC,EAAD,CAAX;EAAA,CAAhC,CAAtB;oCAHkDmJ,OAAAA,GAAAA,IAAAA,KAAAA,CAAAA,IAAAA,GAAAA,CAAAA,GAAAA,IAAAA,GAAAA,CAAAA,GAAAA,CAAAA,CAAAA,EAAAA,IAAAA,GAAAA,CAAAA,EAAAA,IAAAA,GAAAA,IAAAA,EAAAA,IAAAA,EAAAA,EAAAA;IAAAA,OAAAA,CAAAA,IAAAA,GAAAA,CAAAA,CAAAA,GAAAA,SAAAA,CAAAA,IAAAA,CAAAA;;EAIlD,IAAME,qBAAqB,GAAG,OAAO,CAACC,MAAR,CAC1B,UAACC,SAAD,EAAYX,MAAZ,EAAA;IAAA,OAAwBA,MAAM,GAAGW,SAAS,CAACX,MAAVW,CAAiBX,MAAjBW,CAAH,GAA8BA,SAA5D;EAAA,CAD0B,EAE1BH,aAF0B,CAA9B;EAIA,OAAOC,qBAAP;AACH,CATM;AAUP,IAAalF,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAClD,KAAD,EAAmBS,YAAnB,EAAA;EAAA,OACrCmC,4BAA4B,CAACnC,YAAD,CAA5BmC,CAA2C5C,KAA3C4C,CADqC;AAAA,CAAlC;;AClPP;;;;AAGA,IAAM2F,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAA,EAAA;;EAC3B,IAAME,aAAa,GAAG,IAAI/J,GAAJ,EAAtB;EACA,IAAMgK,SAAS,GAAG,SAAZA,SAAY,CAACC,CAAD,EAAA;IAAA,OAAmB,CAAC,CAACF,aAAa,CAACvJ,GAAduJ,CAAkBE,CAAC,CAAC5J,EAApB0J,CAArB;EAAA,CAAlB;EACA,IAAMG,UAAU,GAAG,SAAbA,UAAa,CAACD,CAAD,EAAA;IAAA,OAAmB,CAACF,aAAa,CAACxJ,GAAdwJ,CAAkBE,CAAC,CAAC5J,EAApB0J,CAApB;EAAA,CAAnB;oCAH+BD,gBAAAA,GAAAA,IAAAA,KAAAA,CAAAA,IAAAA,CAAAA,EAAAA,IAAAA,GAAAA,CAAAA,EAAAA,IAAAA,GAAAA,IAAAA,EAAAA,IAAAA,EAAAA,EAAAA;IAAAA,gBAAAA,CAAAA,IAAAA,CAAAA,GAAAA,SAAAA,CAAAA,IAAAA,CAAAA;;EAK/B,IAAMK,mBAAmB,GAAG,gBAAgB,CAAClG,GAAjB,CAAqB,UAAA,GAAG,EAAA;IAChD,IAAMmG,kBAAkB,GAAGC,GAAG,CAACpB,MAAJoB,CAAWH,UAAXG,CAA3B;IACAD,kBAAkB,CAACnG,GAAnBmG,CAAuBJ,SAAvBI,CAAAA;IACA,OAAOA,kBAAP;EACH,CAJ2B,CAA5B;EAKA,OAAO,CAAA,MAAA,GAAA,IAAI1K,KAAJ,EAAA,EAAwB4K,MAAxB,CAAA,KAAA,CAAA,MAAA,EAAkCH,mBAAlC,CAAP;AACH,CAXD;AAaO,IAAMI,yBAAyB,GAAG,SAA5BA,yBAA4B,CACrCC,cADqC,EAErCC,yBAFqC,EAAA;EAAA,OAGvB,UAAA,QAAQ,EAAA;IACtB,IAAA,mBAAA,GAA0CpL,kBAAkB,CAAC,aAAD,EAAgBmL,cAAhB,CAA5D;MAAQzJ,cAAR,GAAA,mBAAA,CAAQA,cAAR;MAAwBtB,aAAxB,GAAA,mBAAA,CAAwBA,aAAxB,CAAA,CAAA;;IAGA,IAAIiL,mBAAJ;IACA,IAAIhL,KAAK,CAACC,OAAND,CAAc+K,yBAAd/K,CAAJ,EAA8C;MAC1C,IAAMiL,iBAAiB,GAAG,IAAI3K,GAAJ,CAAQyK,yBAAR,CAA1B;MACAC,mBAAmB,GAAG,kBAAkB,CAACzB,MAAnB,CAA0B,UAAA,MAAM,EAAA;QAAA,OAAI,CAAC0B,iBAAiB,CAACpK,GAAlBoK,CAAsBxG,MAAM,CAAC9D,EAA7BsK,CAAL;MAAA,CAAhC,CAAtBD;IACH,CAHD,MAGO,IAAID,yBAAJ,EAA+B;MAClCC,mBAAmB,GAAG,EAAtBA;IACH,CAFM,MAEA;MACHA,mBAAmB,GAAGE,kBAAtBF;IACH;IAED,IAAMG,WAAW,GAAGhB,sBAAsB,CAAC9I,cAAD,EAAiB+J,oBAAjB,EAAuCJ,mBAAvC,CAA1C;IACA,IAAMK,cAAc,GAAQ,CAAA,CAA5B;IACAF,WAAW,CAAC5G,GAAZ4G,CAAgB,UAAA,CAAC,EAAA;MAAA,OAAKZ,CAAC,CAACe,MAAFf,GAAYc,cAAc,CAACd,CAAC,CAACe,MAAFf,CAAS5J,EAAV,CAAd0K,GAA8Bd,CAAC,CAACe,MAAFf,CAAS9C,YAAnD8C,GAAmE,IAAxE;IAAA,CAAjBY,CAAAA;IAEAI,QAAQ,CAACC,YAAY,CAACC,iBAAbD,CAA+BV,cAA/BU,CAAD,CAARD;IACAA,QAAQ,CAACC,YAAY,CAACE,2BAAbF,CAAyCzL,aAAzCyL,CAAD,CAARD;IACAA,QAAQ,CAACC,YAAY,CAACG,cAAbH,CAA4BL,WAA5BK,CAAD,CAARD;IACAA,QAAQ,CAACC,YAAY,CAACI,iBAAbJ,CAA+BH,cAA/BG,CAAD,CAARD;IACAA,QAAQ,CAACM,mCAAmC,CAACV,WAAD,CAApC,CAARI;EACH,CA1BwC;AAAA,CAAlC;AA4BA,IAAMM,mCAAmC,GAAG,SAAtCA,mCAAsC,CAACV,WAAD,EAAA;EAAA,OAA4C,UAAA,QAAQ,EAAA;IACnG,IAAMW,4BAA4B,GAAG,IAAIxL,GAAJ,CAAgB;IAAA;IAEjD;IACAyL,aAAa,CAACC,gBAAdD,CAA+BpL,EAHkB,CAAhB,CAArC;IAQA,IAAM4B,YAAY,GAAyB,EAA3C;IACA,IAAM0J,iBAAiB,GAAiB,CAAA,CAAxC;IAEA,IAAMxJ,gBAAgB,GAAyB,EAA/C;IACA,IAAMyJ,qBAAqB,GAAiB,CAAA,CAA5C;IAEA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,SAAD,EAAkCC,OAAlC,EAAyDC,SAAzD,EAAA;MACb,IAAID,OAAO,CAACC,SAAD,CAAX,EAAwB,OAAOD,OAAO,CAACC,SAAD,CAAd;MACxB,IAAMC,KAAK,GAAoB;QAAE3L,IAAI,EAAE0L,SAAR;QAAmBnK,aAAa,EAAE;MAAlC,CAA/B;MACAiK,SAAS,CAAClM,IAAVkM,CAAeG,KAAfH,CAAAA;MACAC,OAAO,CAACC,SAAD,CAAPD,GAAqBE,KAArBF;MACA,OAAOE,KAAP;IACH,CAND;IAQA,KAAA,IAAA,SAAA,GAAA,+BAAA,CAAqBpB,WAArB,CAAA,EAAA,KAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,GAAkC;MAAA,IAAvB1G,MAAuB,GAAA,KAAA,CAAA,KAAA;MAC9B,IAAM+H,MAAM,GAAG/H,MAAM,CAAC+H,MAAtB;MACA,IAAI,CAACA,MAAL,EAAa;MAEb,IAAIA,MAAM,CAACC,OAAPD,IAAkB,CAACV,4BAA4B,CAACjL,GAA7BiL,CAAiCrH,MAAM,CAAC9D,EAAxCmL,CAAvB,EAAoE;QAChE,IAAIU,MAAM,CAACD,KAAX,EAAkB;UACd,IAAMA,KAAK,GAAGJ,QAAQ,CAAC5J,YAAD,EAAe0J,iBAAf,EAAkCO,MAAM,CAACD,KAAzC,CAAtB;UACAA,KAAK,CAACpK,aAANoK,CAAoBrM,IAApBqM,CAAyB9H,MAAM,CAAC9D,EAAhC4L,CAAAA;QACH,CAHD,MAGO;UACHhK,YAAY,CAACrC,IAAbqC,CAAkBkC,MAAM,CAAC9D,EAAzB4B,CAAAA;QACH;MACJ;MAED,IAAIiK,MAAM,CAACE,WAAX,EAAwB;QACpB,IAAIF,MAAM,CAACD,KAAX,EAAkB;UACd,IAAMA,MAAK,GAAGJ,QAAQ,CAAC1J,gBAAD,EAAmByJ,qBAAnB,EAA0CM,MAAM,CAACD,KAAjD,CAAtB;UACAA,MAAK,CAACpK,aAANoK,CAAoBrM,IAApBqM,CAAyB9H,MAAM,CAAC9D,EAAhC4L,CAAAA;QACH,CAHD,MAGO;UACH9J,gBAAgB,CAACvC,IAAjBuC,CAAsBgC,MAAM,CAAC9D,EAA7B8B,CAAAA;QACH;MACJ;IACJ;IAED8I,QAAQ,CAACC,YAAY,CAACmB,yBAAbnB,CAAuC,CAACjJ,YAAD,EAAeE,gBAAf,CAAvC+I,CAAD,CAARD;EACH,CA/CkD;AAAA,CAA5C;AAiDA,IAAMqB,kCAAkC,GAAG,SAArCA,kCAAqC,CAACvK,YAAD,EAAA;EAAA,OAAgD,UAC9FkJ,QAD8F,EAE9FsB,QAF8F,EAAA;IAI9F,IAAA,SAAA,GAA0BA,QAAQ,EAAlC;MAAQ5K,aAAR,GAAA,SAAA,CAAQA,aAAR;IACA,IAAMwC,MAAM,GAAGpC,YAAY,GAAGJ,aAAa,CAACI,YAAD,CAAhB,GAAiC,IAA5D;IACA,IAAIoC,MAAM,IAAIA,MAAM,CAACS,cAArB,EAAqC;MACjCqG,QAAQ,CAACC,YAAY,CAACsB,iBAAbtB,CAA+B/G,MAAM,CAACS,cAAtCsG,CAAD,CAARD;IACH;EACJ,CATiD;AAAA,CAA3C;AAWA,IAAMwB,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAC1K,YAAD,EAAA;EAAA,OAAgD,UAACkJ,QAAD,EAAWsB,QAAX,EAAA;IACnF,IAAI,CAACxK,YAAL,EAAmB;IAEnB,IAAA,UAAA,GAA0EwK,QAAQ,EAAlF;MAAsBG,WAAtB,GAAA,UAAA,CAAQ5H,YAAR;MAA8C6H,QAA9C,GAAA,UAAA,CAAmC3H,SAAnC;MAAwDrD,aAAxD,GAAA,UAAA,CAAwDA,aAAxD;IACA,IAAMwC,MAAM,GAAGxC,aAAa,CAACI,YAAD,CAA5B;IACA,IAAI,CAACoC,MAAD,IAAW,CAACA,MAAM,CAAC2D,eAAvB,EAAwC;IAExC,IAAI8E,KAAK,GAAGD,QAAQ,KAAKvL,SAAS,CAAC4G,GAAvB2E,GAA6BvL,SAAS,CAACyL,IAAvCF,GAA8CvL,SAAS,CAAC4G,GAApE;IACA,IAAI0E,WAAW,KAAK3K,YAApB,EAAkC;MAC9B6K,KAAK,GAAGxL,SAAS,CAAC4G,GAAlB4E;IACH;IAED3B,QAAQ,CAAC,YAAY,CAAC6B,OAAb,CAAqB;MAAEC,QAAQ,EAAEhL,YAAZ;MAA0B6K,KAAK,EAAEA;IAAjC,CAArB,CAAD,CAAR3B;EACH,CAbsC;AAAA,CAAhC;AAeA,IAAM+B,4BAA4B,GAAG,SAA/BA,4BAA+B,CAAC7I,MAAD,EAAA;EAAA,OAAqC,UAAC8G,QAAD,EAAWsB,QAAX,EAAA;IAC7E,IAAMU,kBAAkB,GAAG9I,MAAM,CAAC8I,kBAAlC;IACA,IAAI,CAACA,kBAAL,EAAyB;IAEzB,IAAM3L,KAAK,GAAGiL,QAAQ,EAAtB;IACA,IAAMW,aAAa,GAAG,IAAIlN,GAAJ,CAAgBqD,MAAM,CAACC,IAAPD,CAAYM,kBAAkB,CAACrC,KAAD,CAA9B+B,CAAhB,CAAtB;IACA,IAAM8J,aAAa,GAAG,IAAInN,GAAJ,CAAgBqD,MAAM,CAACC,IAAPD,CAAYH,qBAAqB,CAAC5B,KAAD,CAAjC+B,CAAhB,CAAtB;IAEA,IAAM+J,YAAY,GAAGH,kBAAkB,CAAC;MACpCC,aAAa,EAAbA,aADoC;MAEpC1G,OAAO,EAAE1D,kBAAkB,CAACxB,KAAD,CAFS;MAGpCuB,OAAO,EAAED,aAAa,CAACtB,KAAD,CAHc;MAIpC6L,aAAa,EAAbA;IAJoC,CAAD,CAAvC;IAMA,IAAI,CAACC,YAAL,EAAmB;IAEnB,IAAIA,YAAY,CAAC3M,IAAb2M,KAAsB,CAA1B,EAA6B;MACzBnC,QAAQ,CAACC,YAAY,CAACmC,cAAbnC,EAAD,CAARD;IACH,CAFD,MAEO;MACHA,QAAQ,CAAC,YAAY,CAACqC,WAAb,CAAyB;QAAE9G,OAAO,EAAE9G,KAAK,CAACiB,IAANjB,CAAW0N,YAAX1N,CAAX;QAAqC6N,KAAK,EAAE;MAA5C,CAAzB,CAAD,CAARtC;IACH;EACJ,CArB2C;AAAA,CAArC;;ACrHP;;;;AAGA,IAAauC,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACC,IAAD,EAAA;EAAA,OAAmD,UAACC,SAAD,EAAYnB,QAAZ,EAAA;IACtFvP,MAAM,CAACI,KAAPJ,CAAAA,yBAAAA,GAAuCyQ,IAAI,CAACpN,EAA5CrD,GAAAA,GAAAA,EAAmD,OAAnDA,EAA4DyQ,IAA5DzQ,CAAAA;IACA,IAAMsE,KAAK,GAAGiL,QAAQ,EAAtB;IACA,IAAMpI,MAAM,GAAGzC,mBAAmB,CAACJ,KAAD,CAAnBI,CAA2B+L,IAAI,CAACpN,EAAhCqB,CAAf;IACA,IAAMD,yBAAyB,GAAGD,+BAA+B,CAACF,KAAD,CAAjE;IACA,IAAI6C,MAAJ,EAAY;MACR,IAAI1C,yBAAJ,EAA+B;QAC3BkM,OAAO,CAACC,OAARD,CAAgBlM,yBAAyB,CAACgM,IAAD,CAAzCE,CAAAA,CAAAA,OAAAA,CAAAA,CAAuD,UAAA,KAAK,EAAA;UAAA,OACxD3Q,MAAM,CAACC,KAAPD,CAAAA,mDAAAA,GAAiEC,KAAK,CAAC+B,OAAvEhC,CADwD;QAAA,CAA5D2Q,CAAAA;MAGH;IACJ,CAND,MAMO;MACH3Q,MAAM,CAACG,IAAPH,CACI,uCAAA,GAAuCyQ,IAAI,CAACpN,EAA5C,GAAA,2BAAA,GAAA,4BADJrD,CAAAA;IAGH;EACJ,CAhBsC;AAAA,CAAhC;AAkBP;;;;;;;AAMA,IAAa6Q,sBAAsB,GAAG,SAAzBA,sBAAyB,CAClC1J,MADkC,EAElC2J,OAFkC,EAAA;EAAA,OAGpB,UAAC7C,QAAD,EAAWsB,QAAX,EAAA;IACdvP,MAAM,CAACI,KAAPJ,CAAAA,wBAAAA,GAAsCmH,MAAM,CAAC9D,EAA7CrD,GAAAA,GAAAA,EAAoD,SAApDA,EAA+DmH,MAA/DnH,EAAuE,UAAvEA,EAAmF8Q,OAAnF9Q,CAAAA;IACA,IAAMsE,KAAK,GAAGiL,QAAQ,EAAtB;IACA,IAAMhL,UAAU,GAAGF,gBAAgB,CAACC,KAAD,CAAnC;IAEA,IAAI,CAACI,mBAAmB,CAACJ,KAAD,CAAnBI,CAA2ByC,MAAM,CAAC9D,EAAlCqB,CAAL,EAA4C;MACxC1E,MAAM,CAACG,IAAPH,CACI,eAAA,GAAemH,MAAM,CAAC9D,EAAtB,GAAA,kDAAA,GAAA,oEAAA,GAAA,4DAAA,GAAA,uBADJrD,CAAAA;IAMH,CAAA,CAAA;;IAGD,IAAMyM,aAAa,GAAGzF,mBAAmB,CAAC1C,KAAD,CAAzC;IACA,IAAMyM,sBAAsB,GAAG5J,MAAM,CAACG,UAAPH,GAAoBsF,aAAa,CAACR,MAAdQ,CAAqBtF,MAAM,CAACG,UAA5BmF,CAApBtF,GAA8DsF,aAA7F;IACA,IAAItF,MAAM,CAACC,iBAAPD,IAA4B4J,sBAAsB,CAAC5N,MAAvB4N,KAAkC,CAAlE,EAAqE;MACjE/Q,MAAM,CAACG,IAAPH,CACI,sCAAA,GAAsCmH,MAAM,CAAC9D,EAA7C,GAAA,UAAA,GAAA,4DAAA,GAAA,2DADJrD,CAAAA;MAKA;IACH;IAED,IAAMgR,sBAAsB,GAAG/H,4BAA4B,CAAC3E,KAAD,CAA3D;IACA,IAAM2M,WAAW,GAAwB;MACrC1M,UAAU,EAAVA,UADqC;MAErCkI,aAAa,EAAbA,aAFqC;MAGrCsE,sBAAsB,EAAtBA,sBAHqC;MAIrCC,sBAAsB,EAAtBA;IAJqC,CAAzC,CAAA,CAAA;;IAQA,IAAMlG,eAAe,GAAG3D,MAAM,CAAC2D,eAA/B;IACA,IAAIA,eAAJ,EAAqBmD,QAAQ,CAACwB,uBAAuB,CAACtI,MAAM,CAAC9D,EAAR,CAAxB,CAAR4K,CAAAA,CAAAA;;IAGrB,IAAMrG,cAAc,GAAGT,MAAM,CAACS,cAA9B;IACA,IAAIA,cAAJ,EAAoBqG,QAAQ,CAACC,YAAY,CAACsB,iBAAbtB,CAA+BtG,cAA/BsG,CAAD,CAARD,CAAAA,CAAAA;;IAGpB,IAAMD,MAAM,GAAG7G,MAAM,CAAC6G,MAAtB;IACA,IAAIA,MAAJ,EAAYC,QAAQ,CAACC,YAAY,CAACgD,YAAbhD,CAA0BF,MAAM,CAAC3K,EAAjC6K,CAAD,CAARD,CAAAA,CAAAA;;IAGZ,IAAMgC,kBAAkB,GAAG9I,MAAM,CAAC8I,kBAAlC;IACA,IAAIA,kBAAJ,EAAwBhC,QAAQ,CAAC+B,4BAA4B,CAAC7I,MAAD,CAA7B,CAAR8G,CAAAA,CAAAA;;IAGxB,IAAMkD,MAAM,GAAGhK,MAAM,CAACgK,MAAtB;IACA,IAAIC,kBAAkB,GAAsCxP,SAA5D;IACA,IAAIuP,MAAJ,EAAY;MACR,IAAI;QACAC,kBAAkB,GAAGD,MAAM,CAAC;UACxBhK,MAAM,EAANA,MADwB;UAExB2J,OAAO,EAAPA,OAFwB;UAGxBxM,KAAK,EAAE2M,WAHiB;UAIxBI,aAAa,EAAEpD,QAJS;UAKxBqD,aAAa,EAAE/B;QALS,CAAD,CAA3B6B;MAOH,CARD,CAQE,OAAOnR,KAAP,EAAc;QACZD,MAAM,CAACC,KAAPD,CAAa,0CAAA,GAA2CmH,MAAM,CAAC9D,EAAlD,GAAA,YAAA,IAAA,SAAA,GAA6EpD,KAAK,CAAC+B,OAAnF,CAAbhC,CAAAA;MACH;IACJ,CAAA,CAAA;IAGD;;IACA,OAAO,OAAO,CAAC4Q,OAAR,CAAgBQ,kBAAhB,CAAA,CACFG,IADE,CACG,UAAA,YAAY,EAAA;MACd,IAAMd,IAAI,GAA2B;QACjCpN,EAAE,EAAE8D,MAAM,CAAC9D,EADsB;QAEjC8D,MAAM,EAANA,MAFiC;QAGjC2J,OAAO,EAAPA,OAHiC;QAIjCxM,KAAK,EAAE2M;MAJ0B,CAArC;MAMAO,0BAA0B,CAACvD,QAAD,EAAWwC,IAAX,EAAiBgB,YAAjB,CAA1BD;IACH,CATE,CAAA,CAAA,OAAA,CAAA,CAUI,UAAA,KAAK,EAAA;MACRxR,MAAM,CAACC,KAAPD,CACI,0CAAA,GAA2CmH,MAAM,CAAC9D,EAAlD,GAAA,cAAA,IAAA,6BAAA,GACkCpD,KAAK,CAAC+B,OADxC,CADJhC,CAAAA;MAIA,IAAMyQ,IAAI,GAA2B;QACjCpN,EAAE,EAAE8D,MAAM,CAAC9D,EADsB;QAEjC8D,MAAM,EAANA,MAFiC;QAGjC2J,OAAO,EAAPA,OAHiC;QAIjCxM,KAAK,EAAE2M;MAJ0B,CAArC;MAMAO,0BAA0B,CAACvD,QAAD,EAAWwC,IAAX,EAAiB7O,SAAjB,CAA1B4P;IACH,CAtBE,CAAP;EAuBH,CA/FqC;AAAA,CAA/B;AAiGA,IAAMA,0BAA0B,GAAG,SAA7BA,0BAA6B,CACtCvD,QADsC,EAEtCwC,IAFsC,EAGtCgB,YAHsC,EAAA;EAKtC,IAAMC,eAAe,GAAGD,YAAY,KAAK,IAAzC;EACA,IAAI,CAACC,eAAL,EAAsBzD,QAAQ,CAACuC,uBAAuB,CAACC,IAAD,CAAxB,CAARxC;AACzB,CAPM;ICzIK0D,YAAZ;AAAA,CAAA,UAAYA,YAAAA,EAAAA;EACRA,YAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,YAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,YAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;AACH,CAJD,EAAYA,YAAY,KAAZA,YAAY,GAAA,CAAA,CAAA,CAAxB,CAAA;ICEYC,cAAZ;AAAA,CAAA,UAAYA,cAAAA,EAAAA;EACR;EACAA,cAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,cAAAA,CAAAA,UAAAA,CAAAA,GAAAA,UAAAA;EACAA,cAAAA,CAAAA,aAAAA,CAAAA,GAAAA,aAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,aAAAA,CAAAA,GAAAA,aAAAA;EACAA,cAAAA,CAAAA,YAAAA,CAAAA,GAAAA,YAAAA;EACAA,cAAAA,CAAAA,eAAAA,CAAAA,GAAAA,eAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,WAAAA,CAAAA,GAAAA,WAAAA;EACAA,cAAAA,CAAAA,kBAAAA,CAAAA,GAAAA,kBAAAA;EACAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA;EACAA,cAAAA,CAAAA,gBAAAA,CAAAA,GAAAA,gBAAAA;EACAA,cAAAA,CAAAA,gBAAAA,CAAAA,GAAAA,gBAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,cAAAA,CAAAA,UAAAA,CAAAA,GAAAA,UAAAA;EACAA,cAAAA,CAAAA,UAAAA,CAAAA,GAAAA,UAAAA;EACAA,cAAAA,CAAAA,WAAAA,CAAAA,GAAAA,WAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,cAAAA,CAAAA,gBAAAA,CAAAA,GAAAA,gBAAAA;EACAA,cAAAA,CAAAA,gBAAAA,CAAAA,GAAAA,gBAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA;EACAA,cAAAA,CAAAA,cAAAA,CAAAA,GAAAA,cAAAA;EACAA,cAAAA,CAAAA,YAAAA,CAAAA,GAAAA,YAAAA;EACAA,cAAAA,CAAAA,sBAAAA,CAAAA,GAAAA,sBAAAA;EACAA,cAAAA,CAAAA,UAAAA,CAAAA,GAAAA,UAAAA;EACAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,cAAAA,CAAAA,GAAAA,cAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,UAAAA,CAAAA,GAAAA,UAAAA;EACAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,KAAAA,CAAAA,GAAAA,KAAAA;EACAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,UAAAA,CAAAA,GAAAA,UAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA;EACAA,cAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA;EACAA,cAAAA,CAAAA,QAAAA,CAAAA,GAAAA,QAAAA;EACAA,cAAAA,CAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA,CAAAA,CAAAA;;EAGAA,cAAAA,CAAAA,KAAAA,CAAAA,GAAAA,KAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;EACAA,cAAAA,CAAAA,MAAAA,CAAAA,GAAAA,MAAAA;EACAA,cAAAA,CAAAA,OAAAA,CAAAA,GAAAA,OAAAA;AACH,CAvFD,EAAYA,cAAc,KAAdA,cAAc,GAAA,CAAA,CAAA,CAA1B,CAAA;ICoBaC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAC5B1K,MAD4B,EAE5BgK,MAF4B,EAAA;EAI5B,IAAIhK,MAAM,CAAC2K,aAAP3K,KAAyBvF,SAAzBuF,KAAuCA,MAAM,CAAC4K,OAAP5K,IAAkBA,MAAM,CAAC+H,MAAhE/H,CAAJ,EAA6E;IACzE,IAAM6K,YAAY,GACd,oDAAA,GAAoD7K,MAAM,CAAC9D,EAA3D,GAAA,cAAA,GAAA,mEAAA,GAAA,mEAAA,GAAA,+BADJ;IAKArD,MAAM,CAACC,KAAPD,CAAagS,YAAbhS,CAAAA;IACA,MAAM,IAAIiS,KAAJ,CAAUD,YAAV,CAAN;EACH;EAED7K,MAAM,CAACgK,MAAPhK,GAAgBgK,MAAhBhK;EACA,OAAOA,MAAP;AACH,CAhBM;AAkBP;;;;;;AAKO,IAAM+K,yBAAyB,GAAG,SAA5BA,yBAA4B,CACrCC,YADqC,EAErCC,SAFqC,EAAA;EAIrC,IAAI,CAACD,YAAL,EAAmB,OAAOA,YAAP;EAEnB,IAAIC,SAAS,CAACD,YAAD,CAAb,EAA6B,OAAOA,YAAP;EAE7B,IAAIA,YAAY,CAACE,aAAjB,EAAgC;IAC5B,OAAOH,yBAAyB,CAACC,YAAY,CAACE,aAAd,EAA6BD,SAA7B,CAAhC;EACH;EAED,OAAO,IAAP;AACH,CAbM;AAeA,IAAME,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,eAAD,EAAA;EACjC,OAAO,CAAC,CAACL,yBAAyB,CAC9BK,eAD8B,EAE9B,UAACC,OAAD,EAAA;IAAA,OAAkBA,OAAO,CAACC,OAARD,IAAmBA,OAAO,CAACC,OAARD,CAAgBE,WAAhBF,EAAAA,KAAkC,QAAvE;EAAA,CAF8B,CAAlC;AAIH,CALM;AAOA,IAAMG,kBAAkB,GAAG,SAArBA,kBAAqB,CAC9B5T,KAD8B,EAE9B6T,QAF8B,EAG9BC,WAH8B,EAAA;EAK9B,IAAIA,WAAJ,EAAiB;IACb,OAAQ,OAAO9T,KAAP,KAAiB8T,WAAjB,GAA+B9T,KAA/B,GAAuC6T,QAA/C;EACH;EACD,OAAQ7T,KAAK,KAAK6C,SAAV7C,GAAsBA,KAAtBA,GAA8B6T,QAAtC;AACH,CATM;AC9DA,IAAME,WAAW,GAAG;EACvBC,WAAW,EAAE,SAAA,WAAA,CAACC,MAAD,EAAA;IAAA,OAIM,UAAC/E,QAAD,EAAWsB,QAAX,EAAA;MACf,IAAMjL,KAAK,GAAGiL,QAAQ,EAAtB;MACA,IAAIjL,KAAK,CAACoD,gBAAV,EAA4B;MAC5B,IAAMyE,cAAc,GAAGE,SAAS,CAACL,iBAAVK,CAA4B/H,KAA5B+H,CAAvB;MACA,IAAM4G,eAAe,GAAG,cAAc,CACjCC,KADmB,CACbF,MAAM,CAACG,UADM,EACMH,MAAM,CAACI,QAAPJ,GAAkB,CADxB,CAAA,CAEnB/G,MAFmB,CAEZ,UAAA,EAAE,EAAA;QAAA,OAAI5I,EAAE,IAAI7C,UAAU,CAACU,YAAXV,CAAwB8D,KAAK,CAACuB,OAANvB,CAAcjB,EAAdiB,CAAxB9D,CAAV;MAAA,CAFU,CAAxB;MAGAyN,QAAQ,CACJ,YAAY,CAACqC,WAAb,CAAyB;QACrB9G,OAAO,EAAEyJ,eADY;QAErB1C,KAAK,EAAE,CAAC,CAACyC,MAAM,CAACzC;MAFK,CAAzB,CADI,CAARtC;IAMH,CAjBY;EAAA;AADU,CAApB;ACYA,IAAMoF,gBAAgB,GAAG;EAC5B;;;;EAIAC,cAAc,EAAA,aAAEzB,gBAAgB,CAC5B;IACIxO,EAAE,EAAE,kBADR;IAEIyO,aAAa,EAAE,CAAA;EAFnB,CAD4B,EAK5B,UAAA,IAAA,EAAA;QAAGhB,OAAAA,GAAAA,IAAAA,CAAAA,OAAAA;MAASO,aAAAA,GAAAA,IAAAA,CAAAA,aAAAA;MAAeC,aAAAA,GAAAA,IAAAA,CAAAA,aAAAA;IACvB,IAAIR,OAAO,CAACyC,SAARzC,KAAsB,QAA1B,EAAoC;MAChC,IAAItQ,UAAU,CAACQ,UAAXR,CAAsBsQ,OAAO,CAACpQ,IAA9BF,CAAJ,EAAyC;QACrC6Q,aAAa,CACTR,sBAAsB,CAACpC,aAAa,CAAC+E,SAAf,EAA0B;UAC5CC,UAAU,EAAE3C,OAAO,CAACpQ,IADwB;UAG5C;UACA;UACA;UACA6J,KAAK,EAAE,CAACuG,OAAO,CAACpQ,IAAT;QANqC,CAA1B,CADb,CAAb2Q;MAUH;IACJ,CAbD,MAaO;MACH;MAEA,IAAM3J,gBAAgB,GAAGD,sBAAsB,CAAC6J,aAAa,EAAd,CAA/C;MACA,IAAI9Q,UAAU,CAACU,YAAXV,CAAwBsQ,OAAO,CAACpQ,IAAhCF,CAAAA,IAAyC,CAACkH,gBAA9C,EAAgE;QAC5D,IAAIoJ,OAAO,CAAC4C,OAAZ,EAAqB;UACjB;UACArC,aAAa,CACT,YAAY,CAACsC,eAAb,CAA6B;YACzB1N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN,EADI;YAEzBuQ,SAAS,EAAE;UAFc,CAA7B,CADS,CAAbvC;UAMAA,aAAa,CACT,YAAY,CAACwC,iBAAb,CAA+B;YAC3BzH,KAAK,EAAE0E,OAAO,CAACgD,gBADY;YAE3B7N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN;UAFM,CAA/B,CADS,CAAbgO;QAMH,CAdD,MAcO,IAAIP,OAAO,CAACiD,QAAZ,EAAsB;UACzB;UACA,IAAMC,cAAc,GAAG3H,SAAS,CAACH,iBAAVG,CAA4BiF,aAAa,EAAzCjF,CAAvB;UACA,IAAI,OAAO2H,cAAP,KAA0B,QAA9B,EAAwC;YACpC;YACA,IAAIb,UAAU,GAAGa,cAAjB;YACA,IAAIZ,QAAQ,GAAGtC,OAAO,CAACgD,gBAAvB;YACA,IAAIX,UAAU,GAAGC,QAAjB,EAA2B;cAAA,IAAA,KAAA,GACE,CAACA,QAAD,EAAWD,UAAX,CADF;cACtBA,UADsB,GAAA,KAAA,CAAA,CAAA,CAAA;cACVC,QADU,GAAA,KAAA,CAAA,CAAA,CAAA;YAE1B;YAED/B,aAAa,CAAC,WAAW,CAAC0B,WAAZ,CAAwB;cAAEI,UAAU,EAAVA,UAAF;cAAcC,QAAQ,EAARA;YAAd,CAAxB,CAAD,CAAb/B;UACH,CATD,MASO;YACH;YACA;YACAA,aAAa,CACT,YAAY,CAACsC,eAAb,CAA6B;cACzB1N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN,EADI;cAEzBuQ,SAAS,EAAE;YAFc,CAA7B,CADS,CAAbvC;YAMAA,aAAa,CACT,YAAY,CAACwC,iBAAb,CAA+B;cAC3BzH,KAAK,EAAE0E,OAAO,CAACgD,gBADY;cAE3B7N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN;YAFM,CAA/B,CADS,CAAbgO;UAMH;QACJ,CA5BM,MA4BA;UACH;UACAA,aAAa,CACT,YAAY,CAACsC,eAAb,CAA6B;YACzB1N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN,EADI;YAEzBuQ,SAAS,EAAE;UAFc,CAA7B,CADS,CAAbvC;UAMAA,aAAa,CACT,YAAY,CAACwC,iBAAb,CAA+B;YAC3BzH,KAAK,EAAE0E,OAAO,CAACgD,gBADY;YAE3B7N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN;UAFM,CAA/B,CADS,CAAbgO;QAMH;MACJ,CA1DD,MA0DO;QACH,IAAI,CAACP,OAAO,CAAC4C,OAAT,IAAoB,CAAChM,gBAAzB,EAA2C;UACvC2J,aAAa,CAACnD,YAAY,CAACmC,cAAbnC,EAAD,CAAbmD;QACH;QACDA,aAAa,CACT,YAAY,CAACwC,iBAAb,CAA+B;UAC3BzH,KAAK,EAAE0E,OAAO,CAACgD,gBADY;UAE3B7N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN;QAFM,CAA/B,CADS,CAAbgO;MAMH;IACJ;EACJ,CA7F2B,CALJ;EAoG5B;;;;EAIA4C,iBAAiB,EAAA,aAAEpC,gBAAgB,CAC/B;IACIxO,EAAE,EAAE,qBADR;IAEIyO,aAAa,EAAE,CAAA;EAFnB,CAD+B,EAK/B,UAAA,KAAA,EAAA;QAAGhB,OAAAA,GAAAA,KAAAA,CAAAA,OAAAA;MAASO,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;MAAeC,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;IACvBD,aAAa,CACT,YAAY,CAACwC,iBAAb,CAA+B;MAC3BzH,KAAK,EAAE0E,OAAO,CAACgD,gBADY;MAE3B7N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN;IAFM,CAA/B,CADS,CAAbgO;IAMA,IAAIP,OAAO,CAACoD,QAAZ,EAAsB;MAClB;MACA;MACA;MACA,IAAIpN,mBAAmB,CAACwK,aAAa,EAAd,CAAnBxK,KAAyC,CAA7C,EAAgD;QAC5CuK,aAAa,CACTR,sBAAsB,CAACpC,aAAa,CAAC+E,SAAf,EAA0B;UAC5CC,UAAU,EAAE3C,OAAO,CAACpQ,IADwB;UAE5C6J,KAAK,EAAE,CAACuG,OAAO,CAACpQ,IAAT;QAFqC,CAA1B,CADb,CAAb2Q;MAMH;IACJ,CAZD,MAYO,IAAIP,OAAO,CAACqD,QAARrD,IAAoBtQ,UAAU,CAACU,YAAXV,CAAwBsQ,OAAO,CAACpQ,IAAhCF,CAAxB,EAA+D;MAClE6Q,aAAa,CACT,YAAY,CAACsC,eAAb,CAA6B;QACzB1N,MAAM,EAAE6K,OAAO,CAACpQ,IAARoQ,CAAazN,EADI;QAEzBuQ,SAAS,EAAE9C,OAAO,CAAC4C;MAFM,CAA7B,CADS,CAAbrC;IAMH;EACJ,CAhC8B,CAxGP;EA0I5B;;;EAGA+C,cAAc,EAAA,aAAEvC,gBAAgB,CAC5B;IACIxO,EAAE,EAAE,mBADR;IAEIyO,aAAa,EAAE,CAAA;EAFnB,CAD4B,EAK5B,UAAA,KAAA,EAAA;QAAGhB,OAAAA,GAAAA,KAAAA,CAAAA,OAAAA;MAASO,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;MAAeC,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;IACvB,IAAM5Q,IAAI,GAAGoQ,OAAO,CAACuD,WAArB;IACA,IAAI,CAAC9H,iBAAiB,CAAC+E,aAAa,EAAd,EAAkB5Q,IAAlB,CAAtB,EAA+C;MAC3C,IAAIF,UAAU,CAACU,YAAXV,CAAwBE,IAAxBF,CAAJ,EAAmC;QAC/B6Q,aAAa,CACT,YAAY,CAACf,WAAb,CAAyB;UACrB9G,OAAO,EAAE,CAAC9I,IAAI,CAAC2C,EAAN,CADY;UAErBkN,KAAK,EAAE;QAFc,CAAzB,CADS,CAAbc;MAMH;IACJ;EACJ,CAjB2B,CA7IJ;EAgK5B;;;;EAIAiD,YAAY,EAAA,aAAEzC,gBAAgB,CAC1B;IACIxO,EAAE,EAAE,iBADR;IAEIyO,aAAa,EAAE,CAAA;EAFnB,CAD0B,EAK1B,UAAA,KAAA,EAAA;QAAGhB,OAAAA,GAAAA,KAAAA,CAAAA,OAAAA;MAASO,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;MAAeC,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;IACvB,IAAI/E,iBAAiB,CAAC+E,aAAa,EAAd,EAAkBR,OAAO,CAACyD,WAA1B,CAArB,EAA6D;MACzD;MACA;IACH;IAED,IAAQF,WAAR,GAAuCvD,OAAvC,CAAQuD,WAAR;MAAqB5H,aAArB,GAAuCqE,OAAvC,CAAqBrE,aAArB;IACA,IAAM+H,YAAY,GAAG/H,aAAa,CAACtJ,MAAdsJ,GAAuB,CAAvBA,GAA2BA,aAA3BA,GAA2C,CAAC4H,WAAD,CAAhE;IACAhD,aAAa,CACTR,sBAAsB,CAACpC,aAAa,CAACgG,SAAf,EAAA,QAAA,CAAA,CAAA,CAAA,EACf3D,OADe,EAAA;MAElBvG,KAAK,EAAEiK;IAFW,CAAA,CAAA,CADb,CAAbnD;EAMH,CAnByB,CApKF;EAyL5B;;;;EAIAoD,SAAS,EAAA,aAAE5C,gBAAgB,CAAC;IACxBxO,EAAE,EAAE,YADoB;IAExByO,aAAa,EAAE,CAAA;EAFS,CAAD,CA7LC;EAiM5B;;;EAGA4C,eAAe,EAAA,aAAE7C,gBAAgB,CAAC;IAC9BxO,EAAE,EAAE,kBAD0B;IAE9ByO,aAAa,EAAE,CAAA;EAFe,CAAD,CApML;EAwM5B;;;;EAIA0B,SAAS,EAAA,aAAE3B,gBAAgB,CAAC;IACxBxO,EAAE,EAAE,YADoB;IAExByO,aAAa,EAAE,CAAA;EAFS,CAAD,CA5MC;EAgN5B;;;EAGApD,gBAAgB,EAAA,aAAEmD,gBAAgB,CAC9B;IACIxO,EAAE,EAAE,oBADR;IAEI0O,OAAO,EAAE,CAAC,WAAD,CAFb;IAGI7C,MAAM,EAAE;MACJ5L,IAAI,EAAE,mBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJC,WAAW,EAAE,KAHT;MAIJuF,IAAI,EAAE/C,cAAc,CAACgD,gBAJjB;MAKJC,QAAQ,EAAE;IALN;EAHZ,CAD8B,EAY9B,UAAA,KAAA,EAAA;QAAGxD,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;MAAeC,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;IACd,IAAM7L,YAAY,GAAGD,kBAAkB,CAAC8L,aAAa,EAAd,CAAvC;IACA,IAAI9Q,UAAU,CAACQ,UAAXR,CAAsBiF,YAAtBjF,CAAJ,EAAyC;MACrC6Q,aAAa,CACTR,sBAAsB,CAACpC,aAAa,CAAC+E,SAAf,EAA0B;QAC5CC,UAAU,EAAEhO,YADgC;QAE5C8E,KAAK,EAAE,CAAC9E,YAAD;MAFqC,CAA1B,CADb,CAAb4L;IAMH,CAPD,MAOO;MACHrR,MAAM,CAACG,IAAPH,CACI,wEAAA,GACI,oEAFRA,CAAAA;IAIH;EACJ,CA3B6B,CAnNN;EAgP5B;;;;EAIA8U,mBAAmB,EAAA,aAAEjD,gBAAgB,CACjC;IACIxO,EAAE,EAAE,wBADR;IAEIyO,aAAa,EAAE,CAAA;EAFnB,CADiC,EAKjC,UAAA,KAAA,EAAA;QAAGhB,OAAAA,GAAAA,KAAAA,CAAAA,OAAAA;MAASO,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;MAAeC,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;IACvB;IACA;IACA;IACA;IACA;IACA,IAAMyD,WAAW,GAAGzI,WAAW,CAACgF,aAAa,EAAd,EAAkBR,OAAO,CAAC3H,aAA1B,CAA/B;IACA,IAAI4L,WAAJ,EAAiB;MACb,IAAMC,YAAY,GAAGzI,iBAAiB,CAAC+E,aAAa,EAAd,EAAkByD,WAAlB,CAAtC;MACA,IAAI,CAACC,YAAL,EAAmB;QACf;QACA;QACA;QACA;QACA,IAAIxU,UAAU,CAACU,YAAXV,CAAwBuU,WAAxBvU,CAAJ,EAA0C;UACtC6Q,aAAa,CACT,YAAY,CAACf,WAAb,CAAyB;YACrB9G,OAAO,EAAE,CAACsH,OAAO,CAAC3H,aAAT,CADY;YAErBoH,KAAK,EAAE;UAFc,CAAzB,CADS,CAAbc;QAMH,CAPD,MAOO;UACHA,aAAa,CAACnD,YAAY,CAACmC,cAAbnC,EAAD,CAAbmD;QACH;MACJ;IACJ;IAEDA,aAAa,CACT,YAAY,CAAC4D,eAAb,CAA6B;MACzB9L,aAAa,EAAE2H,OAAO,CAAC3H,aADE;MAEzB+L,MAAM,EAAEpE,OAAO,CAACqE,OAARrE,GAAkB,CAFD;MAGzBsE,MAAM,EAAEtE,OAAO,CAACuE,OAARvE,GAAkB;IAHD,CAA7B,CADS,CAAbO;EAOH,CAvCgC;AApPT,CAAzB;ACJA,IAAMiE,cAAc,GAAG;EAC1B;;;EAGAC,aAAa,EAAA,aAAE1D,gBAAgB,CAC3B;IACIxO,EAAE,EAAE,gBADR;IAEI0O,OAAO,EAAE,CAAC,OAAD,CAFb;IAGI3K,iBAAiB,EAAE,IAHvB;IAIIE,UAAU,EAAE9G,UAAU,CAACQ,UAJ3B;IAKIkO,MAAM,EAAE;MACJ5L,IAAI,EAAE,gBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJC,WAAW,EAAE,IAHT;MAIJH,KAAK,EAAE,SAJH;MAKJ0F,IAAI,EAAE/C,cAAc,CAAC4D;IALjB;EALZ,CAD2B,EAc3B,UAAA,IAAA,EAAA;QAAGlR,KAAAA,GAAAA,IAAAA,CAAAA,KAAAA;MAAO+M,aAAAA,GAAAA,IAAAA,CAAAA,aAAAA;IACNA,aAAa,CACTR,sBAAsB,CAACwC,gBAAgB,CAACG,SAAlB,EAA6B;MAC/CjJ,KAAK,EAAEjG,KAAK,CAACyM;IADkC,CAA7B,CADb,CAAbM;IAKA,OAAOzP,SAAP;EACH,CArB0B,CAJL;EA2B1B;;;EAGA6T,cAAc,EAAA,aAAE5D,gBAAgB,CAAC;IAC7BxO,EAAE,EAAE,kBADyB;IAE7B0O,OAAO,EAAE,CAAC,QAAD,CAFoB;IAG7B7C,MAAM,EAAE;MACJ5L,IAAI,EAAE,kBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJC,WAAW,EAAE,IAHT;MAIJH,KAAK,EAAE,SAJH;MAKJ0F,IAAI,EAAE/C,cAAc,CAAC8D;IALjB,CAHqB;IAU7BzF,kBAAkB,EAAG,SAAA,kBAAA,CAAA,KAAA,EAAA;UAAGzG,OAAAA,GAAAA,KAAAA,CAAAA,OAAAA;QAAS2G,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;MAC7B,IAAMC,YAAY,GAAG,IAAIpN,GAAJ,EAArB;MACAwG,OAAO,CAACvC,GAARuC,CAAY,UAAA,MAAM,EAAA;QACd;QACA;QACA,IAAI,CAAC2G,aAAa,CAAC5M,GAAd4M,CAAkBlK,MAAlBkK,CAAL,EAAgCC,YAAY,CAAC5M,GAAb4M,CAAiBnK,MAAjBmK,CAAAA;MACnC,CAJD5G,CAAAA;MAKA,OAAO4G,YAAP;IACH;EAlB4B,CAAD,CA9BN;EAkD1B;;;EAGAuF,cAAc,EAAA,aAAE9D,gBAAgB,CAAC;IAC7BxO,EAAE,EAAE,iBADyB;IAE7B0O,OAAO,EAAE,CAAC,QAAD,CAFoB;IAG7B7C,MAAM,EAAE;MACJ5L,IAAI,EAAE,iBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJC,WAAW,EAAE,IAHT;MAIJH,KAAK,EAAE,SAJH;MAKJ0F,IAAI,EAAE/C,cAAc,CAACvB;IALjB,CAHqB;IAU7BJ,kBAAkB,EAAG,SAAA,kBAAA,CAAA,KAAA,EAAA;UAAGC,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;MACpB,IAAIA,aAAa,CAACzM,IAAdyM,KAAuB,CAA3B,EAA8B,OAAO,IAAP;MAC9B,OAAO,IAAIlN,GAAJ,EAAP;IACH;EAb4B,CAAD,CArDN;EAoE1B;;;EAGA4S,cAAc,EAAA,aAAE/D,gBAAgB,CAAC;IAC7BxO,EAAE,EAAE,kBADyB;IAE7BuE,cAAc,EAAE;MACZtF,IAAI,EAAEqP,YAAY,CAACkE,IADP;MAEZC,WAAW,EAAE;IAFD,CAFa;IAM7B5G,MAAM,EAAE;MACJ5L,IAAI,EAAE,qBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJwF,IAAI,EAAE/C,cAAc,CAACmE,IAHjB;MAIJlB,QAAQ,EAAE;IAJN;EANqB,CAAD,CAvEN;EAoF1B;;;;EAIAmB,iBAAiB,EAAA,aAAEnE,gBAAgB,CAAC;IAChC;IACAxO,EAAE,EAAE,qBAF4B;IAGhCuE,cAAc,EAAE;MACZtF,IAAI,EAAEqP,YAAY,CAACsE,OADP;MAEZH,WAAW,EAAE,EAFD;MAGZI,UAAU,EAAE;IAHA,CAHgB;IAQhChH,MAAM,EAAE;MACJ5L,IAAI,EAAE,wBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJwF,IAAI,EAAE/C,cAAc,CAACuE,OAHjB;MAIJtB,QAAQ,EAAE;IAJN;EARwB,CAAD,CAxFT;EAuG1B;;;EAGAuB,cAAc,EAAA,aAAEvE,gBAAgB,CAAC;IAC7BxO,EAAE,EAAE,kBADyB;IAE7BuE,cAAc,EAAE;MAAEtF,IAAI,EAAEqP,YAAY,CAAC0E,IAArB;MAA2BH,UAAU,EAAE,GAAvC;MAA4CJ,WAAW,EAAE;IAAzD,CAFa;IAG7B5G,MAAM,EAAE;MACJ5L,IAAI,EAAE,qBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJwF,IAAI,EAAE/C,cAAc,CAAC0E,cAHjB;MAIJzB,QAAQ,EAAE;IAJN;EAHqB,CAAD,CA1GN;EAoH1B;;;EAGA0B,eAAe,EAAA,aAAE1E,gBAAgB,CAAC;IAC9BxO,EAAE,EAAE,oBAD0B;IAE9ByH,eAAe,EAAE,SAAA,eAAA,CAACpK,IAAD,EAAA;MAAA,OAA+BA,IAAI,GAAGA,IAAI,CAAC4C,IAAL5C,CAAUgS,WAAVhS,EAAH,GAA6BkB,SAAhE;IAAA,CAFa;IAG9BsN,MAAM,EAAE;MACJ5L,IAAI,EAAE,cADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJF,KAAK,EAAE;IAHH;EAHsB,CAAD,CAvHP;EAgI1B;;;EAGAuH,eAAe,EAAA,aAAE3E,gBAAgB,CAAC;IAC9BxO,EAAE,EAAE,oBAD0B;IAE9ByH,eAAe,EAAE,SAAA,eAAA,CAACpK,IAAD,EAAA;MAAA,OAA+BA,IAAI,GAAGA,IAAI,CAAC+C,IAAR,GAAe7B,SAAlD;IAAA,CAFa;IAG9BsN,MAAM,EAAE;MACJ5L,IAAI,EAAE,cADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJF,KAAK,EAAE;IAHH;EAHsB,CAAD,CAnIP;EA4I1B;;;EAGAwH,eAAe,EAAA,aAAE5E,gBAAgB,CAAC;IAC9BxO,EAAE,EAAE,oBAD0B;IAE9ByH,eAAe,EAAE,SAAA,eAAA,CAACpK,IAAD,EAAA;MAAA,OAA+BA,IAAI,GAAGA,IAAI,CAACiB,OAAR,GAAkBC,SAArD;IAAA,CAFa;IAG9BsN,MAAM,EAAE;MACJ5L,IAAI,EAAE,cADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJF,KAAK,EAAE;IAHH;EAHsB,CAAD,CA/IP;EAwJ1B;;;EAGAyH,iBAAiB,EAAA,aAAE7E,gBAAgB,CAAC;IAChCxO,EAAE,EAAE,qBAD4B;IAEhC0O,OAAO,EAAE,CAAC,QAAD,CAFuB;IAGhC/D,MAAM,EAAE;MACJ3K,EAAE,EAAEW,SAAS,CAACC,eADV;MAEJkG,YAAY,EAAE;IAFV,CAHwB;IAOhC+E,MAAM,EAAE;MACJ5L,IAAI,EAAE,mBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJF,KAAK,EAAE;IAHH;EAPwB,CAAD,CA3JT;EAwK1B;;;;EAIA0H,sBAAsB,EAAA,aAAE9E,gBAAgB,CAAC;IACrCxO,EAAE,EAAE,2BADiC;IAErC2K,MAAM,EAAE;MACJ3K,EAAE,EAAEW,SAAS,CAACE,gBADV;MAEJiG,YAAY,EAAE;IAFV,CAF6B;IAMrC+E,MAAM,EAAE;MACJ5L,IAAI,EAAE,oBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJF,KAAK,EAAE;IAHH;EAN6B,CAAD,CA5Kd;EAwL1B;;;EAGA2H,gBAAgB,EAAA,aAAE/E,gBAAgB,CAC9B;IACIxO,EAAE,EAAE,oBADR;IAEI0O,OAAO,EAAE,CAAC,QAAD;EAFb,CAD8B,EAK9B,UAAA,KAAA,EAAA;QAAGT,aAAAA,GAAAA,KAAAA,CAAAA,aAAAA;IACC,IAAM9K,gBAAgB,GAAGD,sBAAsB,CAAC+K,aAAa,EAAd,CAA/C;IACA,IAAI9K,gBAAJ,EAAsBA,gBAAgB,EAAA;EACzC,CAR6B,CA3LR;EAqM1B;;;EAGAqQ,cAAc,EAAA,aAAEhF,gBAAgB,CAAC;IAC7BxO,EAAE,EAAE,kBADyB;IAE7B2K,MAAM,EAAE;MACJ3K,EAAE,EAAEW,SAAS,CAACG,QADV;MAEJgG,YAAY,EAAE;IAFV,CAFqB;IAM7B+E,MAAM,EAAE;MACJ5L,IAAI,EAAE,kBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJwF,IAAI,EAAE/C,cAAc,CAACmE,IAHjB;MAIJlB,QAAQ,EAAE;IAJN;EANqB,CAAD;AAxMN,CAAvB;ACVA,IAAMiC,YAAY,GAAG;EACxB;;;EAGAC,SAAS,EAAA,aAAElF,gBAAgB,CAAC;IACxBxO,EAAE,EAAE,YADoB;IAExB+D,iBAAiB,EAAE,IAFK;IAGxB2K,OAAO,EAAE,CAAC,QAAD,CAHe;IAIxB7C,MAAM,EAAE;MACJ5L,IAAI,EAAE,gBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJC,WAAW,EAAE,IAHT;MAIJH,KAAK,EAAE,SAJH;MAKJ0F,IAAI,EAAE/C,cAAc,CAACoF;IALjB;EAJgB,CAAD,CAJH;EAgBxB;;;EAGAC,YAAY,EAAA,aAAEpF,gBAAgB,CAAC;IAC3BxO,EAAE,EAAE,eADuB;IAE3B6L,MAAM,EAAE;MACJ5L,IAAI,EAAE,eADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJ+H,OAAO,EAAE,iBAHL;MAIJvC,IAAI,EAAE/C,cAAc,CAACuF;IAJjB;EAFmB,CAAD,CAnBN;EA4BxB;;;EAGAC,WAAW,EAAA,aAAEvF,gBAAgB,CAAC;IAC1BxO,EAAE,EAAE,cADsB;IAE1B6L,MAAM,EAAE;MACJ5L,IAAI,EAAE,cADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJ+H,OAAO,EAAE,cAHL;MAIJvC,IAAI,EAAE/C,cAAc,CAACyF;IAJjB;EAFkB,CAAD,CA/BL;EAwCxB;;;EAGAC,aAAa,EAAA,aAAEzF,gBAAgB,CAAC;IAC5BxO,EAAE,EAAE,gBADwB;IAE5B+D,iBAAiB,EAAE,IAFS;IAG5B8H,MAAM,EAAE;MACJ5L,IAAI,EAAE,gBADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJC,WAAW,EAAE,IAHT;MAIJH,KAAK,EAAE,SAJH;MAKJ0F,IAAI,EAAE/C,cAAc,CAAC2F;IALjB;EAHoB,CAAD,CA3CP;EAsDxB;;;EAGAC,WAAW,EAAA,aAAE3F,gBAAgB,CAAC;IAC1BxO,EAAE,EAAE,cADsB;IAE1B+D,iBAAiB,EAAE,IAFO;IAG1B2K,OAAO,EAAE,CAAC,QAAD,CAHiB;IAI1B7C,MAAM,EAAE;MACJ5L,IAAI,EAAE,cADF;MAEJ6L,OAAO,EAAE,IAFL;MAGJC,WAAW,EAAE,IAHT;MAIJH,KAAK,EAAE,SAJH;MAKJ0F,IAAI,EAAE/C,cAAc,CAAC6F;IALjB;EAJkB,CAAD;AAzDL,CAArB;ICGMhJ,aAAa,GAAA,aAAA,QAAA,CAAA,CAAA,CAAA,EACnB4E,gBADmB,EAEnBiC,cAFmB,EAGnBwB,YAHmB,CAAnB;AAMA,IAAMhJ,oBAAoB,GAAG,CAChCW,aAAa,CAAC6E,cADkB,EAEhC7E,aAAa,CAACwF,iBAFkB,EAGhCxF,aAAa,CAAC2F,cAHkB,EAIhC3F,aAAa,CAAC6F,YAJkB,EAKhC7F,aAAa,CAACgG,SALkB,EAMhChG,aAAa,CAACiG,eANkB,EAOhCjG,aAAa,CAAC+E,SAPkB,EAQhC/E,aAAa,CAACC,gBARkB,EAShCD,aAAa,CAACqG,mBATkB,CAA7B;AAYP,IAAalH,kBAAkB,GAAG,CAC9Ba,aAAa,CAAC8G,aADgB,EAE9B9G,aAAa,CAACgH,cAFgB,EAG9BhH,aAAa,CAACkH,cAHgB,EAI9BlH,aAAa,CAACmH,cAJgB;AAAA;AAM9B;AACAnH,aAAa,CAAC2H,cAPgB,EAQ9B3H,aAAa,CAAC8H,eARgB,EAS9B9H,aAAa,CAAC+H,eATgB,EAU9B/H,aAAa,CAACgI,eAVgB,EAW9BhI,aAAa,CAACiI,iBAXgB,EAY9BjI,aAAa,CAACkI,sBAZgB,EAa9BlI,aAAa,CAACmI,gBAbgB,CAA3B;ACpBA,IAAMc,gBAAgB,GAAc;EACvCnT,UAAU,EAAE,mBAD2B;EAGvCE,yBAAyB,EAAE,IAHY;EAKvC+I,cAAc,EAAE,EALuB;EAMvCmK,wBAAwB,EAAE,EANa;EAOvChT,aAAa,EAAE,CAAA,CAPwB;EAQvCE,aAAa,EAAE,EARwB;EASvCI,YAAY,EAAE,EATyB;EAUvCE,gBAAgB,EAAE,EAVqB;EAYvCyS,cAAc,EAAE,IAZuB;EAavCC,wBAAwB,EAAE,EAba;EAcvCxS,WAAW,EAAE,EAd0B;EAgBvCM,QAAQ,EAAE,EAhB6B;EAiBvCmS,kBAAkB,EAAE,EAjBmB;EAkBvCjS,OAAO,EAAE,CAAA,CAlB8B;EAmBvC2D,OAAO,EAAE,EAnB8B;EAoBvCzD,YAAY,EAAE,EApByB;EAsBvCkF,aAAa,EAAE,EAtBwB;EAuBvC9E,eAAe,EAAE,CAAA,CAvBsB;EAyBvCK,gBAAgB,EAAE,IAzBqB;EA0BvCE,YAAY,EAAE,EA1ByB;EA2BvCqR,UAAU,EAAE,eA3B2B;EA6BvCnR,YAAY,EAAE,CAAA,CA7ByB;EA8BvCc,gBAAgB,EAAE,KA9BqB;EAgCvCE,cAAc,EAAE6G,aAAa,CAAC2H,cAAd3H,CAA6B7G,cAhCN;EAkCvCE,YAAY,EAAE,IAlCyB;EAmCvCE,SAAS,EAAE5D,SAAS,CAAC4G,GAnCkB;EAqCvC9C,SAAS,EAAE,CAAA,CArC4B;EAuCvCI,kBAAkB,EAAE,IAvCmB;EAwCvCE,gBAAgB,EAAE,GAxCqB;EAyCvCE,kBAAkB,EAAE,KAzCmB;EA0CvCE,4BAA4B,EAAE,IA1CS;EA4CvCkB,SAAS,EAAE,IA5C4B;EA8CvChB,kBAAkB,EAAE,KA9CmB;EA+CvCE,iBAAiB,EAAE;AA/CoB,CAApC;ACcP,IAAMgP,QAAQ,GAAG;EACbC,4BADa,EAAA,SAAA,4BAAA,CAET3T,KAFS,EAGT6C,MAHS,EAAA;;IAKT7C,KAAK,CAACG,yBAANH,GAAAA,CAAAA,eAAAA,GAAkC6C,MAAM,CAAC2J,OAAzCxM,KAAAA,IAAAA,GAAAA,eAAAA,GAAoD,IAApDA;EACH,CANY;EAOb6J,iBAPa,EAAA,SAAA,iBAAA,CAOK7J,KAPL,EAOuB6C,MAPvB,EAAA;IAQT7C,KAAK,CAACkJ,cAANlJ,GAAuB6C,MAAM,CAAC2J,OAA9BxM;EACH,CATY;EAUb8J,2BAVa,EAAA,SAAA,2BAAA,CAUe9J,KAVf,EAUiC6C,MAVjC,EAAA;IAWT7C,KAAK,CAACqT,wBAANrT,GAAiC6C,MAAM,CAAC2J,OAAxCxM;EACH,CAZY;EAab+J,cAba,EAAA,SAAA,cAAA,CAaE/J,KAbF,EAaoB6C,MAbpB,EAAA;IAcT,IAAMxC,aAAa,GAAkB,CAAA,CAArC;IACAwC,MAAM,CAAC2J,OAAP3J,CAAeF,GAAfE,CAAmB,UAAA,CAAC,EAAA;MAAA,OAAKxC,aAAa,CAACsI,CAAC,CAAC5J,EAAH,CAAbsB,GAAsBsI,CAA3B;IAAA,CAApB9F,CAAAA;IACA,IAAMqC,OAAO,GAAG,MAAM,CAACsH,OAAP,CAAe7J,GAAf,CAAmB,UAAA,CAAC,EAAA;MAAA,OAAIgG,CAAC,CAAC5J,EAAN;IAAA,CAApB,CAAhB;IAEAiB,KAAK,CAACK,aAANL,GAAsBK,aAAtBL;IACAA,KAAK,CAACO,aAANP,GAAsBkF,OAAtBlF;EACH,CApBY;EAqBb+K,yBArBa,EAAA,SAAA,yBAAA,CAqBa/K,KArBb,EAqB+B6C,MArB/B,EAAA;2BAsBsCA,MAAM,CAAC2J,OAAAA;IAArDxM,KAAK,CAACW,YAAAA,GAAAA,gBAAAA,CAAAA,CAAAA,CAAAA;IAAcX,KAAK,CAACa,gBAAAA,GAAAA,gBAAAA,CAAAA,CAAAA,CAAAA;EAC9B,CAvBY;EAwBb+S,iBAxBa,EAAA,SAAA,iBAAA,CAwBK5T,KAxBL,EAwBuB6C,MAxBvB,EAAA;IAyBT,IAAMyQ,cAAc,GAAGzQ,MAAM,CAAC2J,OAA9B;IACA,IAAA,mBAAA,GAAuDzO,kBAAkB,CAAC,aAAD,EAAgBuV,cAAhB,CAAzE;MAAwBvS,WAAxB,GAAA,mBAAA,CAAQtB,cAAR;MAAqCtB,aAArC,GAAA,mBAAA,CAAqCA,aAArC;IACA6B,KAAK,CAACsT,cAANtT,GAAuBsT,cAAvBtT;IACAA,KAAK,CAACe,WAANf,GAAoBe,WAApBf;IACAA,KAAK,CAACuT,wBAANvT,GAAiC7B,aAAjC6B;EACH,CA9BY;EA+Bb6T,WA/Ba,EAAA,SAAA,WAAA,CA+BD7T,KA/BC,EA+BiB6C,MA/BjB,EAAA;IAgCT,IAAMxB,QAAQ,GAAGwB,MAAM,CAAC2J,OAAxB;IACA,IAAA,oBAAA,GAAiDzO,kBAAkB,CAAC,OAAD,EAAUsD,QAAV,CAAnE;MAAwB4E,KAAxB,GAAA,oBAAA,CAAQxG,cAAR;MAA+BtB,aAA/B,GAAA,oBAAA,CAA+BA,aAA/B;IACA6B,KAAK,CAACqB,QAANrB,GAAiBqB,QAAjBrB;IACAA,KAAK,CAACwT,kBAANxT,GAA2B7B,aAA3B6B;IAEA,IAAMuB,OAAO,GAAY,CAAA,CAAzB;IACA0E,KAAK,CAACwB,OAANxB,CAAc,UAAA,CAAC,EAAA;MACX,IAAImB,CAAJ,EAAO7F,OAAO,CAAC6F,CAAC,CAACrI,EAAH,CAAPwC,GAAgB6F,CAAhB7F;IACV,CAFD0E,CAAAA;IAGA,IAAMf,OAAO,GAAG,KAAK,CAACvC,GAAN,CAAU,UAAA,CAAC,EAAA;MAAA,OAAKyE,CAAC,GAAGA,CAAC,CAACrI,EAAL,GAAU,IAAhB;IAAA,CAAX,CAAhB;IACA,IAAM0C,YAAY,GAAG,OAAO,CAACkG,MAAR,CAAe,UAAA,CAAC,EAAA;MAAA,OAAI,CAAC,CAACP,CAAN;IAAA,CAAhB,CAArB;IAEApH,KAAK,CAACuB,OAANvB,GAAgBuB,OAAhBvB;IACAA,KAAK,CAACkF,OAANlF,GAAgBkF,OAAhBlF;IACAA,KAAK,CAACyB,YAANzB,GAAqByB,YAArBzB,CAAAA,CAAAA;;IAGA,KAAA,IAAA,EAAA,GAAA,CAAA,EAAA,YAAA,GAA6B+B,MAAM,CAACC,IAAPD,CAAY/B,KAAK,CAACsC,YAAlBP,CAA7B,EAAA,EAAA,GAAA,YAAA,CAAA,MAAA,EAAA,EAAA,EAAA,EAA8D;MAAzD,IAAM+R,cAAc,GAAA,YAAA,CAAA,EAAA,CAApB;MACD,IAAI,CAACvS,OAAO,CAACuS,cAAD,CAAZ,EAA8B;QAC1B,OAAO9T,KAAK,CAACsC,YAANtC,CAAmB8T,cAAnB9T,CAAP;MACH;IACJ;EACJ,CAtDY;EAuDb+T,gBAvDa,EAAA,SAAA,gBAAA,CAuDI/T,KAvDJ,EAuDsB6C,MAvDtB,EAAA;IAwDT7C,KAAK,CAAC2G,aAAN3G,GAAsB6C,MAAM,CAAC2J,OAA7BxM;EACH,CAzDY;EA0DbgU,gBA1Da,EAAA,SAAA,gBAAA,CA0DIhU,KA1DJ,EA0DsB6C,MA1DtB,EAAA;IA2DT7C,KAAK,CAAC6B,eAAN7B,GAAwB6C,MAAM,CAAC2J,OAA/BxM,CAAAA,CAAAA;;IAGA,KAAA,IAAA,GAAA,GAAA,CAAA,EAAA,aAAA,GAA6B+B,MAAM,CAACC,IAAPD,CAAY/B,KAAK,CAACsC,YAAlBP,CAA7B,EAAA,GAAA,GAAA,aAAA,CAAA,MAAA,EAAA,GAAA,EAAA,EAA8D;MAAzD,IAAM+R,cAAc,GAAA,aAAA,CAAA,GAAA,CAApB;MACD,IAAI9T,KAAK,CAAC6B,eAAN7B,CAAsB8T,cAAtB9T,CAAJ,EAA2C;QACvC,OAAOA,KAAK,CAACsC,YAANtC,CAAmB8T,cAAnB9T,CAAP;MACH;IACJ;EACJ,CAnEY;EAoEbiU,mBApEa,EAAA,SAAA,mBAAA,CAoEOjU,KApEP,EAoEyB6C,MApEzB,EAAA;IAqET7C,KAAK,CAACkC,gBAANlC,GAAyB6C,MAAM,CAAC2J,OAAhCxM;EACH,CAtEY;EAuEbkU,eAvEa,EAAA,SAAA,eAAA,CAuEGlU,KAvEH,EAuEqB6C,MAvErB,EAAA;IAwET7C,KAAK,CAACoC,YAANpC,GAAqB6C,MAAM,CAAC2J,OAA5BxM;EACH,CAzEY;EA0EboR,cA1Ea,EAAA,SAAA,cAAA,CA0EEpR,KA1EF,EAAA;IA2ETA,KAAK,CAACkF,OAANlF,CACK2H,MADL3H,CACY,UAAA,EAAE,EAAA;MAAA,OAAIjB,EAAE,IAAI7C,UAAU,CAACU,YAAXV,CAAwB8D,KAAK,CAACuB,OAANvB,CAAcjB,EAAdiB,CAAxB9D,CAAV;IAAA,CADd8D,CAAAA,CAEK2C,GAFL3C,CAES,UAAA,EAAE,EAAA;MAAA,OAAKjB,EAAE,GAAIiB,KAAK,CAACsC,YAANtC,CAAmBjB,EAAnBiB,CAAAA,GAAyB,IAA7B,GAAqC,IAA5C;IAAA,CAFXA,CAAAA;EAGH,CA9EY;EA+EbgM,WA/Ea,EAAA,SAAA,WAAA,CA+EDhM,KA/EC,EA+EiB6C,MA/EjB,EAAA;IAgFT,IAAI7C,KAAK,CAACoD,gBAAV,EAA4B;IAC5B,IAAIP,MAAM,CAAC2J,OAAP3J,CAAeoJ,KAAnB,EAA0BjM,KAAK,CAACsC,YAANtC,GAAqB,CAAA,CAArBA;IAC1B6C,MAAM,CAAC2J,OAAP3J,CAAeqC,OAAfrC,CACK8E,MADL9E,CACY,UAAA,EAAE,EAAA;MAAA,OAAI9D,EAAE,IAAI7C,UAAU,CAACU,YAAXV,CAAwB8D,KAAK,CAACuB,OAANvB,CAAcjB,EAAdiB,CAAxB9D,CAAV;IAAA,CADd2G,CAAAA,CAEKF,GAFLE,CAES,UAAA,EAAE,EAAA;MAAA,OAAK7C,KAAK,CAACsC,YAANtC,CAAmBjB,EAAnBiB,CAAAA,GAAyB,IAA9B;IAAA,CAFX6C,CAAAA;EAGH,CArFY;EAsFbwM,eAtFa,EAAA,SAAA,eAAA,CAsFGrP,KAtFH,EAsFqB6C,MAtFrB,EAAA;IAuFT,IAAI7C,KAAK,CAACoD,gBAAV,EAA4B;IAC5B,IAAM+Q,QAAQ,GAAG,CAAC,CAACnU,KAAK,CAACsC,YAANtC,CAAmB6C,MAAM,CAAC2J,OAAP3J,CAAelB,MAAlC3B,CAAnB;IACA,IAAI6C,MAAM,CAAC2J,OAAP3J,CAAeyM,SAAnB,EAA8BtP,KAAK,CAACsC,YAANtC,GAAqB,CAAA,CAArBA;IAC9B,IAAImU,QAAJ,EAAc,OAAOnU,KAAK,CAACsC,YAANtC,CAAmB6C,MAAM,CAAC2J,OAAP3J,CAAelB,MAAlC3B,CAAP,CAAd,KACK,IAAI9D,UAAU,CAACU,YAAXV,CAAwB8D,KAAK,CAACuB,OAANvB,CAAc6C,MAAM,CAAC2J,OAAP3J,CAAelB,MAA7B3B,CAAxB9D,CAAJ,EAAmE;MACpE8D,KAAK,CAACsC,YAANtC,CAAmB6C,MAAM,CAAC2J,OAAP3J,CAAelB,MAAlC3B,CAAAA,GAA4C,IAA5CA;IACH;EACJ,CA9FY;EA+Fb+L,cA/Fa,EAAA,SAAA,cAAA,CA+FE/L,KA/FF,EAAA;IAgGT,IAAIA,KAAK,CAACoD,gBAAV,EAA4B;IAC5B,IAAIrB,MAAM,CAACC,IAAPD,CAAY/B,KAAK,CAACsC,YAAlBP,CAAAA,CAAgClD,MAAhCkD,KAA2C,CAA/C,EAAkD/B,KAAK,CAACsC,YAANtC,GAAqB,CAAA,CAArBA;EACrD,CAlGY;EAmGboU,oBAnGa,EAAA,SAAA,oBAAA,CAmGQpU,KAnGR,EAmG0B6C,MAnG1B,EAAA;IAoGT7C,KAAK,CAACoD,gBAANpD,GAAyB6C,MAAM,CAAC2J,OAAhCxM;IACA,IAAI+B,MAAM,CAACC,IAAPD,CAAY/B,KAAK,CAACsC,YAAlBP,CAAAA,CAAgClD,MAAhCkD,KAA2C,CAA/C,EAAkD/B,KAAK,CAACsC,YAANtC,GAAqB,CAAA,CAArBA;EACrD,CAtGY;EAuGbkL,iBAvGa,EAAA,SAAA,iBAAA,CAuGKlL,KAvGL,EAuGuB6C,MAvGvB,EAAA;IAwGT7C,KAAK,CAACsD,cAANtD,GAAuB6C,MAAM,CAAC2J,OAA9BxM;EACH,CAzGY;EA0GbwL,OA1Ga,EAAA,SAAA,OAAA,CA0GLxL,KA1GK,EA0Ga6C,MA1Gb,EAAA;IA2GT7C,KAAK,CAACwD,YAANxD,GAAqB6C,MAAM,CAAC2J,OAAP3J,CAAe4I,QAApCzL;IACAA,KAAK,CAAC0D,SAAN1D,GAAkB6C,MAAM,CAAC2J,OAAP3J,CAAeyI,KAAjCtL;EACH,CA7GY;EA8GbgK,iBA9Ga,EAAA,SAAA,iBAAA,CA8GKhK,KA9GL,EA8GuB6C,MA9GvB,EAAA;IA+GT,KAAA,IAAA,GAAA,GAAA,CAAA,EAAA,aAAA,GAAuBd,MAAM,CAACC,IAAPD,CAAYc,MAAM,CAAC2J,OAAnBzK,CAAvB,EAAA,GAAA,GAAA,aAAA,CAAA,MAAA,EAAA,GAAA,EAAA,EAAoD;MAA/C,IAAM+B,QAAQ,GAAA,aAAA,CAAA,GAAA,CAAd;MACD,IAAIA,QAAQ,IAAI9D,KAAK,CAAC4D,SAAtB,EAAiC;MACjC5D,KAAK,CAAC4D,SAAN5D,CAAgB8D,QAAhB9D,CAAAA,GAA4B6C,MAAM,CAAC2J,OAAP3J,CAAeiB,QAAfjB,CAA5B7C;IACH;EACJ,CAnHY;EAoHb4M,YApHa,EAAA,SAAA,YAAA,CAoHA5M,KApHA,EAoHkB6C,MApHlB,EAAA;IAqHT7C,KAAK,CAAC4D,SAAN5D,CAAgB6C,MAAM,CAAC2J,OAAvBxM,CAAAA,GAAkC,CAACA,KAAK,CAAC4D,SAAN5D,CAAgB6C,MAAM,CAAC2J,OAAvBxM,CAAnCA;EACH,CAtHY;EAuHbqU,qBAvHa,EAAA,SAAA,qBAAA,CAuHSrU,KAvHT,EAuH2B6C,MAvH3B,EAAA;IAwHT7C,KAAK,CAACgE,kBAANhE,GAA2B6C,MAAM,CAAC2J,OAAlCxM;EACH,CAzHY;EA0HbsU,mBA1Ha,EAAA,SAAA,mBAAA,CA0HOtU,KA1HP,EA0HyB6C,MA1HzB,EAAA;IA2HT7C,KAAK,CAACkE,gBAANlE,GAAyB6C,MAAM,CAAC2J,OAAhCxM;EACH,CA5HY;EA6HbuU,qBA7Ha,EAAA,SAAA,qBAAA,CA6HSvU,KA7HT,EA6H2B6C,MA7H3B,EAAA;IA8HT7C,KAAK,CAACoE,kBAANpE,GAA2B6C,MAAM,CAAC2J,OAAlCxM;EACH,CA/HY;EAgIbwU,+BAhIa,EAAA,SAAA,+BAAA,CAgImBxU,KAhInB,EAgIqC6C,MAhIrC,EAAA;IAiIT7C,KAAK,CAACsE,4BAANtE,GAAqC6C,MAAM,CAAC2J,OAA5CxM;EACH,CAlIY;EAmIbuP,iBAnIa,EAAA,SAAA,iBAAA,CAmIKvP,KAnIL,EAmIuB6C,MAnIvB,EAAA;IAoIT7C,KAAK,CAACwF,SAANxF,GAAkB6C,MAAM,CAAC2J,OAAzBxM;EACH,CArIY;EAsIbyU,qBAtIa,EAAA,SAAA,qBAAA,CAsISzU,KAtIT,EAsI2B6C,MAtI3B,EAAA;IAuIT7C,KAAK,CAACwE,kBAANxE,GAA2B6C,MAAM,CAAC2J,OAAlCxM;EACH,CAxIY;EAyIb2Q,eAzIa,EAAA,SAAA,eAAA,CAyIG3Q,KAzIH,EAyIqB6C,MAzIrB,EAAA;IA0IT7C,KAAK,CAAC0E,iBAAN1E,GAA0B6C,MAAM,CAAC2J,OAAjCxM;EACH,CA3IY;EA4Ib0U,eA5Ia,EAAA,SAAA,eAAA,CA4IG1U,KA5IH,EAAA;IA6IT,IAAI,CAACA,KAAK,CAAC0E,iBAAX,EAA8B;IAC9B1E,KAAK,CAAC0E,iBAAN1E,GAA0B,IAA1BA;EACH;AA/IY,CAAjB;AAkJO,IAAA,YAAA,GAAA,aAAwD8U,WAAW,CAAC;IACvE9V,IAAI,EAAE,MADiE;IAEvE+V,YAAY,EAAE3B,gBAFyD;IAGvEM,QAAQ,EAARA;EAHuE,CAAD,CAAnE;EAAiB9J,YAAjB,GAAA,YAAA,CAAQ+K,OAAR;EAAwCE,WAAxC,GAAA,YAAA,CAA+BD,OAA/B;ACzJA,IAAMI,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,KAAD,EAAA;EAC5Bna,SAAS,CAAC,YAAA;IACN,IAAMoa,gBAAgB,GAAGC,KAAK,CAAC,YAAA;MAAA,OAAM9S,kBAAkB,CAAC4S,KAAK,CAAChK,QAANgK,EAAD,CAAxB;IAAA,CAAD,CAA9B;IACA,IAAMG,iBAAiB,GAAG,SAApBA,iBAAoB,CACtBtJ,YADsB,EAEtBuJ,YAFsB,EAAA;MAItB;MACA;MACA,IAAIvJ,YAAY,KAAKuJ,YAArB,EAAmC,OAAA,CAAA;;MAGnC,IAAMC,gBAAgB,GAAG/S,qBAAqB,CAAC0S,KAAK,CAAChK,QAANgK,EAAD,CAA9C;MACA,IAAMM,SAAS,GAAG,IAAI7W,GAAJ,CAAgB4W,gBAAhB,CAAlB;MACAL,KAAK,CAACtL,QAANsL,CACI1I,sBAAsB,CAACpC,aAAa,CAACiG,eAAf,EAAgC;QAClDmF,SAAS,EAATA;MADkD,CAAhC,CAD1BN,CAAAA;IAKH,CAhBD;IAkBA,IAAMO,oBAAoB,GAAG,CACzBP,KAAK,CAACQ,SAANR,CAAgBC,gBAAgB,CAACE,iBAAD,CAAhCH,CADyB,CAA7B;IAGA,OAAO,YAAA;MACH,KAAA,IAAA,SAAA,GAAA,+BAAA,CAA0BO,oBAA1B,CAAA,EAAA,KAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,GAAA;QAAA,IAAWE,WAAX,GAAA,KAAA,CAAA,KAAA;QAAgDA,WAAW,EAAA;MAA3D;IACH,CAFD;EAGH,CA1BQ,EA0BN,CAACT,KAAD,CA1BM,CAATna;AA2BH,CA5BM;ICAM6a,cAAc,GAAG,SAAjBA,cAAiB,CAACC,gBAAD,EAAA;EAC1B,IAAMX,KAAK,GAAG9Z,cAAc,CAAC,YAAA;IACzB,IAAM0a,cAAc,GAAA,QAAA,CAAA,CAAA,CAAA,EACbzC,gBADa,EAAA;MAEhBnT,UAAU,EAAE2V;IAFI,CAAA,CAApB;IAKA,OAAOE,cAAc,CAAC;MAClBD,cAAc,EAAEA,cADE;MAElBjB,OAAO,EAAEC,WAFS;MAGlBkB,UAAU,EAAE,SAAA,UAAA,CAAA,oBAAoB,EAAA;QAAA,OAC5BC,oBAAoB,CAAC;UACjBC,iBAAiB,EAAE;QADF,CAAD,CADQ;MAAA,CAHd;MAOlBC,QAAQ,EAAE;QAAElX,IAAI,EAAA,SAAA,GAAY4W;MAAlB;IAPQ,CAAD,CAArB;EASH,CAf2B,CAA5B;EAgBAZ,gBAAgB,CAACC,KAAD,CAAhBD;EACA,OAAOC,KAAP;AACH,CAnBM;AAqBP;;;;AAGA,IAAakB,gBAAgB,GAAG,SAAnBA,gBAAmB,CAC5BC,oBAD4B,EAAA;oCAEzBC,cAAAA,GAAAA,IAAAA,KAAAA,CAAAA,IAAAA,GAAAA,CAAAA,GAAAA,IAAAA,GAAAA,CAAAA,GAAAA,CAAAA,CAAAA,EAAAA,IAAAA,GAAAA,CAAAA,EAAAA,IAAAA,GAAAA,IAAAA,EAAAA,IAAAA,EAAAA,EAAAA;IAAAA,cAAAA,CAAAA,IAAAA,GAAAA,CAAAA,CAAAA,GAAAA,SAAAA,CAAAA,IAAAA,CAAAA;;EAEH,IAAMhQ,QAAQ,GAAGiQ,WAAW,CACxB,UAACtW,KAAD,EAAA;IAAA,OAAsBoW,oBAAoB,CAAA,KAApBA,CAAAA,KAAAA,CAAAA,EAAwBC,cAAxBD,CAAAA,CAAwCpW,KAAxCoW,CAAtB;EAAA,CADwB;EAAA;EAAA,CAGvBA,oBAHuB,CAAA,CAAA,MAAA,CAGEC,cAHF,CAAA,CAA5B;EAKA,OAAOE,WAAW,CAAClQ,QAAD,CAAlB;AACH,CAVM;AAYP;;;;;AAIA,IAAamQ,MAAM,GAAG,SAATA,MAAS,CAA0BC,aAA1B,EAAA;qCAAoEJ,cAAAA,GAAAA,IAAAA,KAAAA,CAAAA,KAAAA,GAAAA,CAAAA,GAAAA,KAAAA,GAAAA,CAAAA,GAAAA,CAAAA,CAAAA,EAAAA,KAAAA,GAAAA,CAAAA,EAAAA,KAAAA,GAAAA,KAAAA,EAAAA,KAAAA,EAAAA,EAAAA;IAAAA,cAAAA,CAAAA,KAAAA,GAAAA,CAAAA,CAAAA,GAAAA,SAAAA,CAAAA,KAAAA,CAAAA;;EACtF,IAAM1M,QAAQ,GAAG+M,WAAW,EAA5B;EACA5b,SAAS,CACL,YAAA;IACI6O,QAAQ,CAAC8M,aAAa,CAAA,KAAbA,CAAAA,KAAAA,CAAAA,EAAiBJ,cAAjBI,CAAD,CAAR9M;EACH,CAHI;EAAA;EAAA,CAKJA,QALI,EAKM8M,aALN,CAAA,CAAA,MAAA,CAKwBJ,cALxB,CAAA,CAATvb;AAOH,CATM;AAWP,IAAa6b,kBAAkB,GAAG,SAArBA,kBAAqB,CAAsBF,aAAtB,EAAgEjK,OAAhE,EAAA;EAC9B,IAAM7C,QAAQ,GAAG+M,WAAW,EAA5B;EACA5b,SAAS,CAAC,YAAA;IACN6O,QAAQ,CAAC8M,aAAa,CAACjK,OAAD,CAAd,CAAR7C;EACH,CAFQ,EAEN,CAACA,QAAD,EAAW8M,aAAX,EAA0BjK,OAA1B,CAFM,CAAT1R;AAGH,CALM;;AC9DP;;;;;AAUO,IAAM8b,qBAAqB,GAA8B,SAAnDA,qBAAmD,CAAA,EAAA;EAC5D;EACA,IAAMC,KAAK,GACP,6EAAA,GACA,uDAFJ;EAGA,OAAO,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;IAAMA,KAAK,EAAEA;GAAb,EAAA,cAAA,CAAP;AACH,CANM;ACYA,IAAMC,aAAa,GAAiB;EACvCvN,WAAW,EAAE,IAD0B;EAEvCwN,YAAY,EAAE,IAFyB;EAGvC/S,kBAAkB,EAAE,IAHmB;EAIvCE,gBAAgB,EAAE,GAJqB;EAKvCd,gBAAgB,EAAE,KALqB;EAMvC+F,yBAAyB,EAAE,KANY;EAOvC/E,kBAAkB,EAAE,KAPmB;EAQvC4S,0BAA0B,EAAE,KARW;EASvCC,mBAAmB,EAAE9M,aAAa,CAAC8H,eAAd9H,CAA8BpL,EATZ;EAUvCmY,uBAAuB,EAAE/M,aAAa,CAAC2H,cAAd3H,CAA6BpL,EAVf;EAWvCuF,4BAA4B,EAAE,IAXS;EAYvC6S,aAAa,EAAEP,qBAZwB;EAavCQ,QAAQ,EAAE,KAb6B;EAcvCC,IAAI,EAAE,CAAA;AAdiC,CAApC;AAiBP,IAAaC,iBAAiB,GAAG,SAApBA,iBAAoB,CAAC1S,MAAD,EAAA;EAC7B,KAAA,IAAA,EAAA,GAAA,CAAA,EAAA,YAAA,GAAkB7C,MAAM,CAACC,IAAPD,CAAY+U,aAAZ/U,CAAlB,EAAA,EAAA,GAAA,YAAA,CAAA,MAAA,EAAA,EAAA,EAAA,EAA8C;IAAzC,IAAMwV,GAAG,GAAA,YAAA,CAAA,EAAA,CAAT;IACD,IAAIA,GAAG,IAAI3S,MAAX,EAAmB;MACfkS,aAAa,CAACS,GAAD,CAAbT,GAA2ClS,MAAM,CAC7C2S,GAD6C,CAAjDT;IAGH;EACJ;AACJ,CARM;IC7BKU,aAAZ;AAAA,CAAA,UAAYA,aAAAA,EAAAA;EACRA,aAAAA,CAAAA,SAAAA,CAAAA,GAAAA,SAAAA;EACAA,aAAAA,CAAAA,UAAAA,CAAAA,GAAAA,UAAAA;EACAA,aAAAA,CAAAA,WAAAA,CAAAA,GAAAA,WAAAA;EACAA,aAAAA,CAAAA,iBAAAA,CAAAA,GAAAA,aAAAA;EAEAA,aAAAA,CAAAA,aAAAA,CAAAA,GAAAA,SAAAA;EACAA,aAAAA,CAAAA,kBAAAA,CAAAA,GAAAA,cAAAA;AACH,CARD,EAAYA,aAAa,KAAbA,aAAa,GAAA,CAAA,CAAA,CAAzB,CAAA;AAUA,IAAaC,SAAS,GAAG,SAAZA,SAAY,CAACC,SAAD,EAA2BC,QAA3B,EAAA;EAAA,OAAA,SAAA,GACXD,SADW,GAAA,GAAA,GACEC,QADF;AAAA,CAAlB;AAGP,IAAaC,eAAe,GAAG,SAAlBA,eAAkB,CAACnM,QAAD,EAAmBkM,QAAnB,EAAA;EAAA,OAAA,SAAA,GACjBH,aAAa,CAACK,WADG,GAAA,GAAA,GACYpM,QADZ,GAAA,GAAA,GACwBkM,QADxB;AAAA,CAAxB;AAGA,IAAMG,2BAA2B,GAAG,SAA9BA,2BAA8B,CAACpN,SAAD,EAAA;EACvC,IAAMqN,IAAI,GAAGC,OAAO,EAApB;EACA,OAAOC,OAAO,CAAC,YAAA;IACX,OAAO,IAAI,CAACC,aAAL,CAAmB;MACtBnZ,EAAE,EAAE0Y,SAAS,CAACD,aAAa,CAACW,gBAAf,EAAiCzN,SAAjC,CADS;MAEtB0N,cAAc,EAAE1N;IAFM,CAAnB,CAAP;EAIH,CALa,EAKX,CAACA,SAAD,EAAYqN,IAAZ,CALW,CAAd;AAMH,CARM;AAUA,IAAMM,6BAA6B,GAAG,SAAhCA,6BAAgC,CAACxV,MAAD,EAAA;EACzC,IAAMkV,IAAI,GAAGC,OAAO,EAApB;EACA,OAAOC,OAAO,CAAC,YAAA;;IACX,IAAI,CAACpV,MAAL,EAAa;MACT,OAAO;QACHyV,UAAU,EAAE,EADT;QAEHC,aAAa,EAAEjb;MAFZ,CAAP;IAIH;IAED,IAAMgb,UAAU,GAAG,IAAI,CAACJ,aAAL,CAAmB;MAClCnZ,EAAE,EAAE6Y,eAAe,CAAC/U,MAAM,CAAC9D,EAAR,EAAY,aAAZ,CADe;MAElCqZ,cAAc,EAAA,CAAA,cAAA,GAAEvV,MAAM,CAAC+H,MAAT,KAAA,IAAA,GAAA,KAAA,CAAA,GAAE/H,cAAAA,CAAe7D;IAFG,CAAnB,CAAnB;IAKA,IAAIuZ,aAAa,GAAwBjb,SAAzC;IACA,IAAA,CAAA,eAAA,GAAIuF,MAAM,CAAC+H,MAAX,KAAA,IAAA,IAAI/H,eAAAA,CAAe+P,OAAnB,EAA4B;MAAA,IAAA,eAAA;;MACxB;MACA2F,aAAa,GAAG,IAAI,CAACL,aAAL,CAAmB;QAC/BnZ,EAAE,EAAE6Y,eAAe,CAAC/U,MAAM,CAAC9D,EAAR,EAAY,gBAAZ,CADY;QAE/BqZ,cAAc,EAAA,CAAA,eAAA,GAAEvV,MAAM,CAAC+H,MAAT,KAAA,IAAA,GAAA,KAAA,CAAA,GAAE/H,eAAAA,CAAe+P;MAFA,CAAnB,CAAhB2F;IAIH;IAED,OAAO;MACHD,UAAU,EAAVA,UADG;MAEHC,aAAa,EAAbA;IAFG,CAAP;EAIH,CA1Ba,EA0BX,CAAC1V,MAAD,EAASkV,IAAT,CA1BW,CAAd;AA2BH,CA7BM;AA+BA,IAAMS,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACpc,IAAD,EAAA;EACxC,IAAM2b,IAAI,GAAGC,OAAO,EAApB;EACA,IAAMS,UAAU,GAAGC,UAAU,CAACC,uBAAD,CAA7B;EACA,OAAOV,OAAO,CAAC,YAAA;IACX,OAAO;MACHW,iBAAiB,EAAEH,UAAU,CAACI,iBAAXJ,CAA6BV,IAA7BU,EAAmCrc,IAAnCqc,CADhB;MAEHK,cAAc,EAAEL,UAAU,CAACM,cAAXN,CAA0BV,IAA1BU,EAAgCrc,IAAhCqc;IAFb,CAAP;EAIH,CALa,EAKX,CAACrc,IAAD,EAAOqc,UAAP,EAAmBV,IAAnB,CALW,CAAd;AAMH,CATM;AAWP,IAAaiB,iBAAiB,GAAqB;EAC/CH,iBAAiB,EAAE,SAAA,iBAAA,CACfd,IADe,EAEf3b,IAFe,EAAA;IAIf,IAAM6c,WAAW,GAAG/c,UAAU,CAACkB,UAAXlB,CAAsBE,IAAtBF,CAApB;IACA,IAAI+c,WAAJ,EAAiB;MACb,OAAO,IAAI,CAACC,UAAL,CAAgBD,WAAhB,EAA6B;QAChCE,SAAS,EAAE,QADqB;QAEhCC,SAAS,EAAE;MAFqB,CAA7B,CAAP;IAIH,CALD,MAKO;MACH,OAAO,IAAP;IACH;EACJ,CAd8C;EAe/CL,cAAc,EAAE,SAAA,cAAA,CAACM,KAAD,EAAmBjd,IAAnB,EAAA;IACZ,IAAI,CAACA,IAAD,IAAS,OAAOA,IAAI,CAAC+C,IAAZ,KAAqB,QAAlC,EAA4C,OAAO,IAAP;IAE5C,IAAMA,IAAI,GAAG/C,IAAI,CAAC+C,IAAlB;IACA,IAAMma,QAAQ,GAAGC,QAAQ,CAACpa,IAAD,EAAO;MAAEqa,IAAI,EAAE,KAAR;MAAeC,MAAM,EAAE;IAAvB,CAAP,CAAzB;IACA,IAAIH,QAAQ,CAACI,MAATJ,KAAoB,GAAxB,EAA6B;MACzB,OAAUK,IAAI,CAACC,KAALD,CAAWL,QAAQ,CAAC7e,KAAT6e,GAAiB,EAA5BK,CAAAA,GAAkC,KAA5C,GAAA,KAAA;IACH,CAFD,MAEO,IAAIL,QAAQ,CAACI,MAATJ,KAAoB,IAAxB,EAA8B;MACjC,OAAUK,IAAI,CAACC,KAALD,CAAWL,QAAQ,CAAC7e,KAApBkf,CAAV,GAAA,GAAA,GAAwCL,QAAQ,CAACI,MAAjD;IACH;IACD,OAAUJ,QAAQ,CAAC7e,KAAnB,GAAA,GAAA,GAA4B6e,QAAQ,CAACI,MAArC;EACH;AA1B8C,CAA5C;AA6BA,IAAMf,uBAAuB,GAAA,aAAGkB,aAAa,CAACb,iBAAD,CAA7C;;AC3GP;;;;;AAeO,IAAMc,iBAAiB,GAAA,aAAGD,aAAa,CAA+BjD,qBAA/B,CAAvC;AAEA,IAAMmD,eAAe,GAAa,CACrC,KADqC,EAErC,KAFqC,EAGrC,MAHqC,EAIrC,KAJqC,EAKrC,KALqC,EAMrC,KANqC,EAOrC,KAPqC,EAQrC,KARqC,EASrC,KATqC,EAUrC,KAVqC,EAWrC,KAXqC,EAYrC,MAZqC,EAarC,MAbqC,EAcrC,MAdqC,EAerC,MAfqC,EAgBrC,MAhBqC,EAiBrC,KAjBqC,EAkBrC,KAlBqC,EAmBrC,KAnBqC,EAoBrC,KApBqC,EAqBrC,KArBqC,EAsBrC,KAtBqC,EAuBrC,MAvBqC,EAwBrC,MAxBqC,EAyBrC,KAzBqC,EA0BrC,KA1BqC,EA2BrC,KA3BqC,EA4BrC,KA5BqC,EA6BrC,OA7BqC,EA8BrC,KA9BqC,EA+BrC,MA/BqC,EAgCrC,KAhCqC,EAiCrC,MAjCqC,EAkCrC,KAlCqC,EAmCrC,MAnCqC,EAoCrC,KApCqC,EAqCrC,KArCqC,EAsCrC,KAtCqC,EAuCrC,IAvCqC,EAwCrC,KAxCqC,EAyCrC,IAzCqC,EA0CrC,KA1CqC,EA2CrC,KA3CqC,EA4CrC,KA5CqC,EA6CrC,KA7CqC,EA8CrC,KA9CqC,EA+CrC,KA/CqC,EAgDrC,MAhDqC,EAiDrC,MAjDqC,EAkDrC,MAlDqC,EAmDrC,MAnDqC,EAoDrC,MApDqC,EAqDrC,MArDqC,EAsDrC,KAtDqC,EAuDrC,KAvDqC,EAwDrC,MAxDqC,EAyDrC,IAzDqC,EA0DrC,KA1DqC,EA2DrC,KA3DqC,EA4DrC,KA5DqC,CAAlC;AA8DA,IAAMC,eAAe,GAAa,CACrC,KADqC,EAErC,MAFqC,EAGrC,KAHqC,EAIrC,KAJqC,EAKrC,KALqC,EAMrC,MANqC,EAOrC,KAPqC,EAQrC,KARqC,EASrC,KATqC,EAUrC,MAVqC,EAWrC,MAXqC,EAYrC,KAZqC,EAarC,KAbqC,EAcrC,KAdqC,EAerC,KAfqC,EAgBrC,KAhBqC,EAiBrC,IAjBqC,EAkBrC,KAlBqC,EAmBrC,KAnBqC,EAoBrC,KApBqC,EAqBrC,KArBqC,EAsBrC,MAtBqC,EAuBrC,KAvBqC,EAwBrC,KAxBqC,EAyBrC,IAzBqC,EA0BrC,KA1BqC,EA2BrC,MA3BqC,EA4BrC,OA5BqC,EA6BrC,MA7BqC,EA8BrC,OA9BqC,EA+BrC,KA/BqC,EAgCrC,KAhCqC,EAiCrC,KAjCqC,EAkCrC,KAlCqC,EAmCrC,KAnCqC,EAoCrC,KApCqC,EAqCrC,KArCqC,EAsCrC,MAtCqC,EAuCrC,KAvCqC,EAwCrC,KAxCqC,EAyCrC,MAzCqC,EA0CrC,KA1CqC,EA2CrC,KA3CqC,EA4CrC,KA5CqC,EA6CrC,KA7CqC,EA8CrC,KA9CqC,EA+CrC,KA/CqC,EAgDrC,KAhDqC,EAiDrC,KAjDqC,EAkDrC,KAlDqC,EAmDrC,KAnDqC,EAoDrC,KApDqC,EAqDrC,KArDqC,EAsDrC,KAtDqC,EAuDrC,KAvDqC,EAwDrC,KAxDqC,EAyDrC,KAzDqC,EA0DrC,KA1DqC,EA2DrC,KA3DqC,EA4DrC,KA5DqC,EA6DrC,KA7DqC,EA8DrC,KA9DqC,EA+DrC,KA/DqC,EAgErC,KAhEqC,EAiErC,KAjEqC,EAkErC,KAlEqC,EAmErC,MAnEqC,EAoErC,KApEqC,EAqErC,KArEqC,EAsErC,KAtEqC,EAuErC,KAvEqC,EAwErC,KAxEqC,EAyErC,MAzEqC,EA0ErC,KA1EqC,EA2ErC,KA3EqC,EA4ErC,MA5EqC,EA6ErC,MA7EqC,EA8ErC,KA9EqC,EA+ErC,MA/EqC,EAgFrC,KAhFqC,EAiFrC,MAjFqC,EAkFrC,KAlFqC,EAmFrC,KAnFqC,EAoFrC,KApFqC,EAqFrC,KArFqC,EAsFrC,KAtFqC,CAAlC;AAwFA,IAAMC,eAAe,GAAa,CACrC,MADqC,EAErC,KAFqC,EAGrC,KAHqC,EAIrC,KAJqC,EAKrC,MALqC,EAMrC,MANqC,EAOrC,IAPqC,EAQrC,KARqC,EASrC,KATqC,EAUrC,KAVqC,EAWrC,OAXqC,EAYrC,WAZqC,EAarC,WAbqC,EAcrC,WAdqC,EAerC,KAfqC,EAgBrC,MAhBqC,EAiBrC,KAjBqC,EAkBrC,KAlBqC,EAmBrC,KAnBqC,EAoBrC,KApBqC,EAqBrC,KArBqC,EAsBrC,KAtBqC,EAuBrC,KAvBqC,EAwBrC,KAxBqC,EAyBrC,MAzBqC,EA0BrC,KA1BqC,EA2BrC,KA3BqC,EA4BrC,MA5BqC,EA6BrC,KA7BqC,EA8BrC,KA9BqC,EA+BrC,MA/BqC,EAgCrC,MAhCqC,EAiCrC,KAjCqC,EAkCrC,KAlCqC,EAmCrC,KAnCqC,EAoCrC,IApCqC,EAqCrC,IArCqC,EAsCrC,KAtCqC,EAuCrC,KAvCqC,EAwCrC,KAxCqC,EAyCrC,KAzCqC,EA0CrC,KA1CqC,EA2CrC,KA3CqC,EA4CrC,KA5CqC,EA6CrC,KA7CqC,EA8CrC,KA9CqC,EA+CrC,MA/CqC,EAgDrC,KAhDqC,EAiDrC,KAjDqC,EAkDrC,KAlDqC,EAmDrC,KAnDqC,EAoDrC,MApDqC,EAqDrC,KArDqC,EAsDrC,IAtDqC,CAAlC;AAwDA,IAAMC,WAAW,GAAa,CACjC,SADiC,EAEjC,SAFiC,EAGjC,SAHiC,EAIjC,SAJiC,EAKjC,SALiC,EAMjC,SANiC,EAOjC,SAPiC,EAQjC,SARiC,EASjC,SATiC,EAUjC,SAViC,EAWjC,SAXiC,EAYjC,SAZiC,EAajC,SAbiC,EAcjC,SAdiC,EAejC,SAfiC,EAgBjC,SAhBiC,EAiBjC,SAjBiC,EAkBjC,SAlBiC,EAmBjC,SAnBiC,EAoBjC,SApBiC,EAqBjC,SArBiC,EAsBjC,SAtBiC,EAuBjC,SAvBiC,EAwBjC,SAxBiC,EAyBjC,SAzBiC,EA0BjC,SA1BiC,EA2BjC,SA3BiC,EA4BjC,SA5BiC,EA6BjC,SA7BiC,EA8BjC,SA9BiC,EA+BjC,SA/BiC,EAgCjC,SAhCiC,EAiCjC,SAjCiC,EAkCjC,SAlCiC,EAmCjC,SAnCiC,EAoCjC,SApCiC,EAqCjC,SArCiC,EAsCjC,SAtCiC,EAuCjC,SAvCiC,EAwCjC,SAxCiC,EAyCjC,SAzCiC,EA0CjC,SA1CiC,EA2CjC,SA3CiC,EA4CjC,SA5CiC,EA6CjC,SA7CiC,EA8CjC,SA9CiC,EA+CjC,SA/CiC,EAgDjC,SAhDiC,EAiDjC,SAjDiC,EAkDjC,SAlDiC,EAmDjC,SAnDiC,EAoDjC,SApDiC,EAqDjC,SArDiC,EAsDjC,SAtDiC,EAuDjC,SAvDiC,EAwDjC,SAxDiC,EAyDjC,SAzDiC,EA0DjC,SA1DiC,EA2DjC,SA3DiC,EA4DjC,SA5DiC,EA6DjC,SA7DiC,EA8DjC,SA9DiC,EA+DjC,SA/DiC,EAgEjC,SAhEiC,EAiEjC,SAjEiC,EAkEjC,SAlEiC,EAmEjC,SAnEiC,EAoEjC,SApEiC,EAqEjC,SArEiC,EAsEjC,SAtEiC,EAuEjC,SAvEiC,EAwEjC,SAxEiC,EAyEjC,SAzEiC,CAA9B;AA2EA,IAAMC,UAAU,GAAa,CAChC,MADgC,EAEhC,SAFgC,EAGhC,SAHgC,EAIhC,SAJgC,EAKhC,SALgC,EAMhC,SANgC,EAOhC,SAPgC,EAQhC,SARgC,EAShC,SATgC,EAUhC,SAVgC,EAWhC,SAXgC,EAYhC,SAZgC,EAahC,SAbgC,EAchC,SAdgC,EAehC,SAfgC,EAgBhC,SAhBgC,EAiBhC,SAjBgC,EAkBhC,SAlBgC,EAmBhC,SAnBgC,EAoBhC,SApBgC,EAqBhC,SArBgC,EAsBhC,SAtBgC,EAuBhC,SAvBgC,EAwBhC,SAxBgC,EAyBhC,SAzBgC,EA0BhC,SA1BgC,EA2BhC,SA3BgC,EA4BhC,SA5BgC,EA6BhC,SA7BgC,EA8BhC,SA9BgC,EA+BhC,SA/BgC,EAgChC,SAhCgC,EAiChC,SAjCgC,EAkChC,SAlCgC,EAmChC,SAnCgC,EAoChC,SApCgC,EAqChC,SArCgC,EAsChC,SAtCgC,EAuChC,SAvCgC,EAwChC,SAxCgC,EAyChC,SAzCgC,EA0ChC,SA1CgC,EA2ChC,SA3CgC,EA4ChC,SA5CgC,EA6ChC,SA7CgC,EA8ChC,SA9CgC,EA+ChC,SA/CgC,EAgDhC,SAhDgC,EAiDhC,SAjDgC,EAkDhC,SAlDgC,EAmDhC,SAnDgC,EAoDhC,SApDgC,EAqDhC,SArDgC,EAsDhC,SAtDgC,EAuDhC,SAvDgC,EAwDhC,SAxDgC,EAyDhC,SAzDgC,EA0DhC,SA1DgC,EA2DhC,SA3DgC,EA4DhC,SA5DgC,EA6DhC,SA7DgC,EA8DhC,SA9DgC,EA+DhC,SA/DgC,EAgEhC,SAhEgC,EAiEhC,SAjEgC,EAkEhC,SAlEgC,EAmEhC,SAnEgC,EAoEhC,SApEgC,EAqEhC,SArEgC,EAsEhC,SAtEgC,EAuEhC,SAvEgC,EAwEhC,SAxEgC,EAyEhC,SAzEgC,CAA7B;AA4EP,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAA,EAAA;EAChB,IAAIC,WAAW,GAAG,CAAlB;EACA,IAAMC,IAAI,GAAG,CAAb;EAEA,IAAMC,iBAAiB,GAAG;EAAA;EAEtB,CAACjN,cAAc,CAACkN,OAAhB,EAAyB,CAAC,SAAD,CAAzB,CAFsB,EAGtB,CAAClN,cAAc,CAAC1I,MAAhB,EAAwB,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,EAAsB,MAAtB,EAA8B,KAA9B,CAAxB,CAHsB,EAItB,CAAC0I,cAAc,CAACmN,KAAhB,EAAuB,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,EAAsB,KAAtB,CAAvB,CAJsB,EAKtB,CAACnN,cAAc,CAACoN,QAAhB,EAA0B,CAAC,KAAD,EAAQ,MAAR,EAAgB,KAAhB,EAAuB,QAAvB,EAAiC,SAAjC,EAA4C,KAA5C,EAAmD,KAAnD,EAA0D,KAA1D,EAAiE,KAAjE,EAAwE,MAAxE,CAA1B,CALsB,EAMtB,CAACpN,cAAc,CAACqN,IAAhB,EAAsB,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,CAAtB,CANsB,EAOtB,CAACrN,cAAc,CAACsN,OAAhB,EAAyB,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,EAAsB,QAAtB,EAAgC,IAAhC,CAAzB,CAPsB,EAQtB,CAACtN,cAAc,CAACuN,KAAhB,EAAuBb,eAAvB,CARsB,EAStB,CAAC1M,cAAc,CAACwN,KAAhB,EAAuBf,eAAvB,CATsB,EAUtB,CAACzM,cAAc,CAACyN,IAAhB,EAAsB,CAAC,MAAD,EAAS,KAAT,EAAgB,KAAhB,EAAuB,MAAvB,EAA+B,MAA/B,EAAuC,MAAvC,EAA+C,KAA/C,EAAsD,GAAtD,EAA2D,KAA3D,EAAkE,GAAlE,EAAuE,KAAvE,CAAtB,CAVsB,EAWtB,CAACzN,cAAc,CAAC0N,IAAhB,EAAsB,CAAC,KAAD,EAAQ,QAAR,EAAkB,KAAlB,CAAtB,CAXsB,EAYtB,CAAC1N,cAAc,CAACiK,GAAhB,EAAqB,CAAC,KAAD,EAAQ,KAAR,CAArB,CAZsB,EAatB,CAACjK,cAAc,CAAC2N,IAAhB,EAAsB,CAAC,MAAD,EAAS,WAAT,EAAsB,iBAAtB,CAAtB,CAbsB,EActB,CAAC3N,cAAc,CAAC4N,KAAhB,EAAuBjB,eAAvB,CAdsB,EAetB,CAAC3M,cAAc,CAAC6N,QAAhB,EAA0B,CAAC,KAAD,EAAQ,IAAR,CAA1B,CAfsB,EAgBtB,CAAC7N,cAAc,CAAC6F,KAAhB,EAAuB,CAAC,UAAD,CAAvB,CAhBsB,EAiBtB,CAAC7F,cAAc,CAAC8N,KAAhB,EAAuB,CAAC,SAAD,EAAY,cAAZ,CAAvB,CAjBsB;EAAA;EAoBtB,CAAC9N,cAAc,CAAC+N,KAAhB,EAAuB,CAAC,UAAD,CAAvB,CApBsB,EAqBtB,CAAC/N,cAAc,CAACgO,MAAhB,EAAwB,CAAC,KAAD,CAAxB,CArBsB,EAsBtB,CAAChO,cAAc,CAACiO,OAAhB,EAAyB,CAAC,KAAD,CAAzB,CAtBsB;EAAA;EAyBtB,CAACjO,cAAc,CAACkO,IAAhB,EAAsB,CAAC,IAAD,EAAO,MAAP,CAAtB,CAzBsB,EA0BtB,CAAClO,cAAc,CAACmO,MAAhB,EAAwB,CAAC,IAAD,EAAO,OAAP,CAAxB,CA1BsB,EA2BtB,CAACnO,cAAc,CAACoO,MAAhB,EAAwB,CAAC,IAAD,EAAO,KAAP,EAAc,IAAd,EAAoB,KAApB,EAA2B,MAA3B,CAAxB,CA3BsB,EA4BtB,CAACpO,cAAc,CAACqO,GAAhB,EAAqB,CAAC,KAAD,CAArB,CA5BsB;EAAA;EA+BtB,CAACrO,cAAc,CAACsO,GAAhB,EAAqB,CAAC,YAAD,CAArB,CA/BsB;EAAA;EAkCtB,CAACtO,cAAc,CAACuO,KAAhB,EAAuB,CAAC,KAAD,CAAvB,CAlCsB;EAAA;EAqCtB,CAACvO,cAAc,CAACwO,GAAhB,EAAqB,CAAC,KAAD,CAArB,CArCsB,EAsCtB,CAACxO,cAAc,CAACyO,KAAhB,EAAuB,CAAC,KAAD,EAAQ,MAAR,CAAvB,CAtCsB,EAuCtB,CAACzO,cAAc,CAAC0O,IAAhB,EAAsB,CAAC,KAAD,EAAQ,MAAR,EAAgB,KAAhB,CAAtB,CAvCsB,EAwCtB,CAAC1O,cAAc,CAAC2O,KAAhB,EAAuB,CAAC,KAAD,CAAvB,CAxCsB,CAA1B;EA2CA,IAAMC,SAAS,GAAG,IAAIC,SAAJ,CAAc;IAAEC,UAAU,EAAE;EAAd,CAAd,CAAlB;EACA,KAAA,IAAA,EAAA,GAAA,CAAA,EAAA,kBAAA,GAAmB7B,iBAAnB,EAAA,EAAA,GAAA,kBAAA,CAAA,MAAA,EAAA,EAAA,EAAA,EAAsC;IAAjC,IAAM8B,IAAI,GAAA,kBAAA,CAAA,EAAA,CAAV;IACD,IAAOhM,IAAP,GAA2BgM,IAA3B,CAAA,CAAA,CAAA;MAAaC,UAAb,GAA2BD,IAA3B,CAAA,CAAA,CAAA;IAEA,KAAK,IAAIzd,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0d,UAAU,CAACzd,MAA/B,EAAuC,EAAED,CAAzC,EAA4C;MACxCyb,WAAW,IAAIC,IAAfD;MACA,IAAMkC,SAAS,GAAIlC,WAAW,IAAIH,WAAW,CAACrb,MAAZqb,GAAqB,CAAzB,CAAZ,GAA2C,CAA7D;MACA,IAAMsC,QAAQ,GAAiB;QAC3BnM,IAAI,EAAJA,IAD2B;QAE3BkM,SAAS,EAATA;MAF2B,CAA/B;MAIAL,SAAS,CAACO,GAAVP,CAAcI,UAAU,CAAC1d,CAAD,CAAxBsd,EAA6BM,QAA7BN,EAAuC,IAAvCA,CAAAA;IACH;EACJ;EAED,OAAOA,SAAP;AACH,CA/DD;AAiEA,IAAMQ,QAAQ,GAAA,aAAGtC,WAAW,EAA5B;AAEO,IAAMuC,WAAW,GAAG,SAAdA,WAAc,CAACvgB,IAAD,EAAA;EACvB,OAAO6b,OAAO,CAAC,YAAA;IACX,IAAI,CAAC7b,IAAL,EAAW,OAAO;MAAEiU,IAAI,EAAE/C,cAAc,CAACsP,OAAvB;MAAgCL,SAAS,EAAE;IAA3C,CAAP;IACX,IAAIngB,IAAI,CAACC,KAALD,KAAe,IAAnB,EAAyB,OAAO;MAAEiU,IAAI,EAAE/C,cAAc,CAACuP,MAAvB;MAA+BN,SAAS,EAAE;IAA1C,CAAP;IAEzB,IAAMO,KAAK,GAAGJ,QAAQ,CAACK,kBAATL,CAA4BtgB,IAAI,CAAC4C,IAAjC0d,EAAuC,GAAvCA,EAA4C,IAA5CA,CAAd;IACA,OAAOI,KAAK,GAAGA,KAAH,GAAW;MAAEzM,IAAI,EAAE/C,cAAc,CAAClR,IAAvB;MAA6BmgB,SAAS,EAAE;IAAxC,CAAvB;EACH,CANa,EAMX,CAACngB,IAAD,CANW,CAAd;AAOH,CARM;ACnbA,IAAM4gB,UAAU,GAAG;EACtBC,MAAM,EAAE;IACJC,QAAQ,EAAE,SADN;IAEJC,SAAS,EAAE,SAFP;IAGJC,UAAU,EAAE,SAHR;IAIJC,WAAW,EAAE,SAJT;IAKJC,WAAW,EAAE,SALT;IAOJC,UAAU,EAAE;EAPR,CADc;EAWtBC,SAAS,EAAE;IACPC,WAAW,EAAE;EADN,CAXW;EAetBC,OAAO,EAAE;IACLC,gBAAgB,EAAE;EADb,CAfa;EAmBtB9S,OAAO,EAAE;IACL1L,IAAI,EAAE,EADD;IAELye,UAAU,EAAE,MAFP;IAGLC,QAAQ,EAAE,EAHL;IAILC,YAAY,EAAE;EAJT,CAnBa;EA0BtBC,GAAG,EAAE;IACDC,YAAY,EAAE,OADb;IAEDC,eAAe,EAAE,KAFhB;IAGDC,WAAW,EAAE,2BAHZ;IAIDC,cAAc,EAAE,2BAJf;IAKDC,sBAAsB,EAAE,0BALvB;IAMDC,sBAAsB,EAAE,0BANvB;IAODC,yBAAyB,EAAE,0BAP1B;IAQDC,yBAAyB,EAAE;EAR1B,CA1BiB;EAqCtBC,SAAS,EAAE;IACPC,MAAM,EAAE,gBADD;IAEPC,OAAO,EAAE,UAFF;IAGPC,YAAY,EAAE;EAHP,CArCW;EA2CtBC,QAAQ,EAAE;IACNC,iBAAiB,EAAE,CADb;IAENC,gBAAgB,EAAE;EAFZ,CA3CY;EAgDtBC,aAAa,EAAE;IACXC,iBAAiB,EAAE,OADR;IAEXC,gBAAgB,EAAE,MAFP;IAGXC,QAAQ,EAAE,OAHC;IAIXC,SAAS,EAAE,MAJA;IAKXR,YAAY,EAAE,CALH;IAMXd,QAAQ,EAAE,EANC;IAQXuB,aAAa,EAAE,0BARJ;IASXC,mBAAmB,EAAE,0BATV;IAUXC,oBAAoB,EAAE;EAVX,CAhDO;EA6DtBC,aAAa,EAAE;IACXC,gBAAgB,EAAE,EADP;IAEXC,YAAY,EAAE,OAFH;IAGXC,gBAAgB,EAAE,CAHP;IAIX7B,QAAQ,EAAE;EAJC;AA7DO,CAAnB;AAuEA,IAAM8B,iBAAiB,GAA6B;EACvDZ,aAAa,EAAE;IACXK,aAAa,EAAE,uBADJ;IAEXC,mBAAmB,EAAE,uBAFV;IAGXC,oBAAoB,EAAE;EAHX;AADwC,CAApD;AAQA,IAAMM,mBAAmB,GAA6B;EACzDpC,SAAS,EAAE;IACPC,WAAW,EAAE;EADN,CAD8C;EAIzDC,OAAO,EAAE;IACLC,gBAAgB,EAAE;EADb,CAJgD;EAOzD9S,OAAO,EAAE;IACL1L,IAAI,EAAE,EADD;IAELye,UAAU,EAAE,MAFP;IAGLC,QAAQ,EAAE;EAHL,CAPgD;EAYzDkB,aAAa,EAAE;IACXlB,QAAQ,EAAE;EADC,CAZ0C;EAezD0B,aAAa,EAAE;IACXC,gBAAgB,EAAE,EADP;IAEXC,YAAY,EAAE,KAFH;IAGX5B,QAAQ,EAAE;EAHC;AAf0C,CAAtD;AAsBA,IAAMgC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAA,EAAA;EACjC,OAAOC,aAAa,CAAC,mBAAD,CAApB;AACH,CAFM;AAIA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,QAAD,EAAmBC,QAAnB,EAAA;EAAA,OAC7B,4BAAA,GACA,QADA,IAEGD,QAFH,GAAA,GAAA,CAAA,IAGGA,QAHH,GAAA,QAAA,CAAA,IAIGC,QAJH,GAAA,KAAA,CAAA,IAKGA,QALH,GAAA,OAAA,CAAA,GAMA,GAP6B;AAAA,CAA1B;AASA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CACjCC,MADiC,CAAA;AAAA,EAAA;EAAA,OAG3BC,eAAe,CAAiBD,MAAjB,CAHY;AAAA,CAA9B;AAKA,IAAME,sBAAsB,GAAG,SAAzBA,sBAAyB,CAClCC,UADkC,EAAA;EAGlC,IAAMC,eAAe,GAAG,CAAA,CAAxB;EACA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,KAAD,EAAA;IACrB,IAAMC,WAAW,GAAGJ,UAAU,CAACG,KAAD,CAA9B;IACA,IAAME,YAAY,GAAG,CAAA,CAArB;IACA,IAAMC,cAAc,GAAG7e,MAAM,CAACC,IAAPD,CAAY2e,WAAZ3e,CAAvB;IACA6e,cAAc,CAACje,GAAfie,CAAmB,UAAA,aAAa,EAAA;MAC5B,IAAMC,cAAc,GAAA,SAAA,GAAaC,aAAjC;MACA,IAAMC,WAAW,GAAA,WAAA,GAAeF,cAAhC,CAAA,CAAA;;MAEAF,YAAY,CAACI,WAAD,CAAZJ,GAA4BD,WAAW,CAACI,aAAD,CAAvCH,CAAAA,CAAAA;;MAEAJ,eAAe,CAACO,aAAD,CAAfP,GAAiCM,cAAjCN;IACH,CAPDK,CAAAA;IAQA,OAAOD,YAAP;EACH,CAbD,CAAA,CAAA;;EAgBA,IAAMK,SAAS,GAAGZ,eAAe,CAAiBI,gBAAjB,CAAjC;EACA,OAAO,YAAA;IACH,IAAML,MAAM,GAAGa,SAAS,CAAA,KAATA,CAAAA,KAAAA,CAAAA,EAAAA,SAAAA,CAAf;IACA,IAAMC,OAAO,GAAG,CAAA,CAAhB;IACAlf,MAAM,CAACC,IAAPD,CAAYwe,eAAZxe,CAAAA,CAA6BY,GAA7BZ,CAAiC,UAAA,aAAa,EAAA;MAC1C;MACAkf,OAAO,CAACH,aAAD,CAAPG,GAAyBV,eAAe,CAACO,aAAD,CAAxCG;IACH,CAHDlf,CAAAA;IAIA,OAAA,QAAA,CAAA,CAAA,CAAA,EAAYkf,OAAZ,EAAwBd,MAAxB,CAAA;EACH,CARD;AASH,CA9BM;AAgCA,IAAMe,SAAS,GAAG,SAAZA,SAAY,CAAIzmB,KAAJ,EAAA;EAAA,OAAiB,CAACA,KAAD,EAAQ,YAAR,CAAjB;AAAA,CAAlB;AAEA,IAAM0mB,CAAC,GAAGC,UAAV;ACrJA,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC5lB,GAAD,EAAA;EAChC,IAAMwZ,KAAK,GAAGqM,QAAQ,EAAtB;EACA,IAAM3X,QAAQ,GAAG+M,WAAW,EAA5B;EAEA6K,mBAAmB,CACf9lB,GADe,EAEf,YAAA;IAAA,OAAO;MACH+lB,gBADG,EAAA,SAAA,gBAAA,CAAA,EAAA;QAEC,IAAMlf,YAAY,GAAGD,kBAAkB,CAAC4S,KAAK,CAAChK,QAANgK,EAAD,CAAvC;QACA,IAAMwM,YAAY,GAAG,IAAI/iB,GAAJ,CAAQqD,MAAM,CAACC,IAAPD,CAAYO,YAAZP,CAAR,CAArB;QACA,OAAO0f,YAAP;MACH,CALE;MAMHC,gBANG,EAAA,SAAA,gBAAA,CAMcnM,SANd,EAMyBtJ,KANzB,EAAA;YAMyBA,KAAAA,KAAAA,KAAAA,CAAAA,EAAAA;UAAAA,KAAAA,GAAQ,IAAA;;QAChC,IAAM/G,OAAO,GAAG9G,KAAK,CAACiB,IAANjB,CAAWmX,SAAXnX,CAAhB;QACAuL,QAAQ,CAAC,YAAY,CAACqC,WAAb,CAAyB;UAAE9G,OAAO,EAAPA,OAAF;UAAW+G,KAAK,EAALA;QAAX,CAAzB,CAAD,CAARtC;MACH,CATE;MAUHgY,iBAVG,EAAA,SAAA,iBAAA,CAWC9e,MAXD,EAYC2J,OAZD,EAAA;QAcC,OAAOH,OAAO,CAACC,OAARD,CACH1C,QAAQ,CAAC4C,sBAAsB,CAAC1J,MAAD,EAAS2J,OAAT,CAAvB,CADLH,CAAAA,CAELY,IAFKZ,EAAP;MAGH;IAjBE,CAAP;EAAA,CAFe,EAqBf,CAAC4I,KAAD,EAAQtL,QAAR,CArBe,CAAnB4X;AAuBH,CA3BM;;ACVP;;;;;AAmBO,IAAMK,wBAAwB,GAAA,aAAG,KAAK,CAACC,IAAN,EAAA,aACpC,KAAK,CAACC,UAAN,CAAsD,UAACC,KAAD,EAAQtmB,GAAR,EAAA;;;EAClD;EACAkb,kBAAkB,CAAC/M,YAAY,CAACiK,WAAd,EAAA,CAAA,YAAA,GAA2BkO,KAAK,CAAC9b,KAAjC,KAAA,IAAA,GAAA,YAAA,GAA0CmN,gBAAgB,CAAC/R,QAA3D,CAAlBsV;EACAA,kBAAkB,CAAC/M,YAAY,CAACgK,iBAAd,EAAiCmO,KAAK,CAAChhB,WAAvC,CAAlB4V;EACAH,MAAM,CACFvN,yBADE,EAEFoF,kBAAkB,CAAC0T,KAAK,CAACxY,WAAP,EAAoBuN,aAAa,CAACvN,WAAlC,CAFhB,EAGF8E,kBAAkB,CAAC0T,KAAK,CAAC5Y,yBAAP,EAAkC2N,aAAa,CAAC3N,yBAAhD,CAHhB,CAANqN;EAKAA,MAAM,CACF5M,YAAY,CAAC+J,4BADX,EAEFtF,kBAAkB,CAAC0T,KAAK,CAAChL,YAAP,EAAqBD,aAAa,CAACC,YAAnC,CAFhB,CAANP;EAIAA,MAAM,CACF5M,YAAY,CAACwK,oBADX,EAEF/F,kBAAkB,CAAC0T,KAAK,CAAC3e,gBAAP,EAAyB0T,aAAa,CAAC1T,gBAAvC,EAAyD,SAAzD,CAFhB,CAANoT;EAIAA,MAAM,CACFrL,uBADE,EAEFkD,kBAAkB,CAAC0T,KAAK,CAAC9K,mBAAP,EAA4BH,aAAa,CAACG,mBAA1C,CAFhB,CAANT;EAIAA,MAAM,CACFxL,kCADE,EAEFqD,kBAAkB,CAAC0T,KAAK,CAAC7K,uBAAP,EAAgCJ,aAAa,CAACI,uBAA9C,EAAuE,QAAvE,CAFhB,CAANV;EAKAA,MAAM,CACF5M,YAAY,CAACyK,qBADX,EAEFhG,kBAAkB,CAAC0T,KAAK,CAAC/d,kBAAP,EAA2B8S,aAAa,CAAC9S,kBAAzC,CAFhB,CAANwS;EAIAA,MAAM,CACF5M,YAAY,CAAC0K,mBADX,EAEFjG,kBAAkB,CAAC0T,KAAK,CAAC7d,gBAAP,EAAyB4S,aAAa,CAAC5S,gBAAvC,EAAyD,QAAzD,CAFhB,CAANsS;EAIAA,MAAM,CACF5M,YAAY,CAAC2K,qBADX,EAEFlG,kBAAkB,CAAC0T,KAAK,CAAC3d,kBAAP,EAA2B0S,aAAa,CAAC1S,kBAAzC,EAA6D,SAA7D,CAFhB,CAANoS;EAIAA,MAAM,CACF5M,YAAY,CAAC4K,+BADX,EAEFnG,kBAAkB,CACd0T,KAAK,CAACzd,4BADQ,EAEdwS,aAAa,CAACxS,4BAFA,EAGd,SAHc,CAFhB,CAANkS,CAAAA,CAAAA;;EAUA6K,oBAAoB,CAAC5lB,GAAD,CAApB4lB;EAEA,OAAO,IAAP;AACH,CAnDD,CADoC,CAAjC;AAsDPO,wBAAwB,CAACI,WAAzBJ,GAAuC,0BAAvCA;AAEO,IAAMK,mBAAmB,GAAA,aAAGC,KAAK,CAACL,IAANK,CAAWN,wBAAXM,CAA5B;AACPD,mBAAmB,CAACD,WAApBC,GAAkC,qBAAlCA;ACzEO,IAAME,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAA,EAAA;EAClC,IAAMC,UAAU,GAAG1J,UAAU,CAAC2J,UAAD,CAA7B;EACA,IAAQC,eAAR,GAA4BF,UAA5B,CAAQE,eAAR;EACA,OAAO,CAAC,CAACA,eAAT;AACH,CAJM;AAMA,IAAMC,kBAAkB,GAAmB,SAArCA,kBAAqC,CAAA,EAAA;EAC9C;EACA;EACA,IAAMC,mBAAmB,GAAGL,sBAAsB,EAAlD;EACA,IAAMM,QAAQ,GAAGnM,WAAW,CAAC,YAAA;IAAA,OAAM,CAAC,CAAA,CAAD,EAAY,YAAA;MAAA,OAAM,IAAN;IAAA,CAAZ,EAAwB,YAAA;MAAA,OAAM,IAAN;IAAA,CAAxB,CAAN;EAAA,CAAD,EAA4C,EAA5C,CAA5B,CAAA,CAAA;;EAEA,IAAMoM,OAAO,GAAmBF,mBAAmB,GAAGG,OAAH,GAAaF,QAAhE;EACA,OAAOC,OAAO,CAAA,KAAPA,CAAAA,KAAAA,CAAAA,EAAAA,SAAAA,CAAP;AACH,CARM;AAUA,IAAME,kBAAkB,GAAmB,SAArCA,kBAAqC,CAAA,EAAA;EAC9C,IAAMJ,mBAAmB,GAAGL,sBAAsB,EAAlD;EACA,IAAMM,QAAQ,GAAGnM,WAAW,CAAC,YAAA;IAAA,OAAM,CAAC,CAAA,CAAD,EAAY,YAAA;MAAA,OAAM,IAAN;IAAA,CAAZ,CAAN;EAAA,CAAD,EAAgC,EAAhC,CAA5B,CAAA,CAAA;;EAEA,IAAMoM,OAAO,GAAmBF,mBAAmB,GAAGK,OAAH,GAAaJ,QAAhE;EACA,OAAOC,OAAO,CAAA,KAAPA,CAAAA,KAAAA,CAAAA,EAAAA,SAAAA,CAAP;AACH,CANM;ACRA,IAAMI,uBAAuB,GAAG,SAA1BA,uBAA0B,CACnC5U,OADmC,EAAA;EAGnC,IAAM6U,mBAAmB,GAAGnV,yBAAyB,CACjDM,OADiD,EAEjD,UAACA,OAAD,EAAA;IAAA,OACIA,OAAO,CAACC,OAARD,IACAA,OAAO,CAACC,OAARD,CAAgBE,WAAhBF,EAAAA,KAAkC,KADlCA,IAEAA,OAAO,CAAC8U,OAFR9U,IAGAA,OAAO,CAAC8U,OAAR9U,CAAgB+U,YAJpB;EAAA,CAFiD,CAArD;EAQA,OAAOF,mBAAmB,GAAGA,mBAAmB,CAACC,OAApBD,CAA4BE,YAA/B,GAA+C,IAAzE;AACH,CAZM;AAcA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAA,EAAA;EACjC,IAAMvZ,QAAQ,GAAG+M,WAAW,EAA5B;EACA,IAAMyM,qBAAqB,GAAG3nB,mBAAmB,CAC7C+a,WAAW,CAAChS,wBAAD,CADkC,CAAjD;EAGA,OAAO+R,WAAW,CACd,UAAC8M,KAAD,EAAA;IACI;IACA;IACA,IAAI,CAACD,qBAAqB,CAAC5nB,OAA3B,EAAoC,OAAA,CAAA;IAEpC;;IACA,IAAI6nB,KAAK,CAACC,MAAV,EAAkB;IAElBD,KAAK,CAACE,cAANF,EAAAA;IAEA,IAAMve,aAAa,GAAGie,uBAAuB,CAACM,KAAK,CAACG,MAAP,CAA7C;IACA5Z,QAAQ,CACJ4C,sBAAsB,CAACpC,aAAa,CAACqG,mBAAf,EAAoC;MACtDK,OAAO,EAAEuS,KAAK,CAACvS,OADuC;MAEtDE,OAAO,EAAEqS,KAAK,CAACrS,OAFuC;MAGtDlM,aAAa,EAAbA;IAHsD,CAApC,CADlB,CAAR8E;EAOH,CAnBa,EAoBd,CAACwZ,qBAAD,EAAwBxZ,QAAxB,CApBc,CAAlB;AAsBH,CA3BM;AA6BA,IAAM6Z,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAA,EAAA;EACnC,IAAM7Z,QAAQ,GAAG+M,WAAW,EAA5B;EACA,OAAOJ,WAAW,CAAC,YAAA;IAAA,OAAM3M,QAAQ,CAACC,YAAY,CAAC8K,eAAb9K,EAAD,CAAd;EAAA,CAAD,EAAiD,CAACD,QAAD,CAAjD,CAAlB;AACH,CAHM;ICxCM8Z,sBAAsB,GAAG,uBAA/B;;ACdP;;;;;AAeA,IAAMC,WAAW,GAAwB;EACrCC,QAAQ,EAAE,OAD2B;EAErCC,aAAa,EAAE,MAFsB;EAGrCC,MAAM,EAAE,GAH6B;EAIrCC,IAAI,EAAE,CAJ+B;EAKrCC,GAAG,EAAE,CALgC;EAMrCC,KAAK,EAAE,MAN8B;EAOrCC,MAAM,EAAE;AAP6B,CAAzC;AASA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAClBC,mBADkB,EAElBC,iBAFkB,EAGlBC,iBAHkB,EAAA;EAKlB,IAAI,CAACF,mBAAD,IAAwB,CAACC,iBAAzB,IAA8C,CAACC,iBAAnD,EAAsE;IAClE,OAAO;MACHC,OAAO,EAAE;IADN,CAAP;EAGH;EACD,IAAMC,CAAC,GAAGJ,mBAAmB,CAACI,CAApBJ,IAAyBE,iBAAiB,CAACE,CAAlBF,GAAsBD,iBAAiB,CAACG,CAAjEJ,CAAV;EACA,IAAMK,CAAC,GAAGL,mBAAmB,CAACK,CAApBL,IAAyBE,iBAAiB,CAACG,CAAlBH,GAAsBD,iBAAiB,CAACI,CAAjEL,CAAV;EACA,IAAMM,SAAS,GAAA,YAAA,GAAgBF,CAAhB,GAAA,MAAA,GAAwBC,CAAxB,GAAA,KAAf;EACA,OAAO;IACHC,SAAS,EAATA,SADG;IAEHC,eAAe,EAAED;EAFd,CAAP;AAIH,CAjBD;AAmBO,IAAME,oBAAoB,GAAwC,SAA5DA,oBAA4D,CAAA,EAAA;EACrE,IAAM1D,OAAO,GAAGD,SAAS,EAAzB;EAEA,IAAA,aAAA,GAOI8D,YAAY,CAAC,UAAA,OAAO,EAAA;MAAA,OAAK;QACzBhmB,IAAI,EAAEimB,OAAO,CAACC,OAARD,EADmB;QAEzBH,QAAQ,EAAEG,OAAO,CAACE,WAARF,EAFe;QAGzBZ,mBAAmB,EAAEY,OAAO,CAACG,sBAARH,EAHI;QAIzBX,iBAAiB,EAAEW,OAAO,CAACI,4BAARJ,EAJM;QAKzBV,iBAAiB,EAAEU,OAAO,CAACK,qBAARL,EALM;QAMzBF,UAAU,EAAEE,OAAO,CAACF,UAARE;MANa,CAAL;IAAA,CAAR,CAPhB;IACIH,QADJ,GAAA,aAAA,CACIA,QADJ;IAEI9lB,IAFJ,GAAA,aAAA,CAEIA,IAFJ;IAGIqlB,mBAHJ,GAAA,aAAA,CAGIA,mBAHJ;IAIIC,iBAJJ,GAAA,aAAA,CAIIA,iBAJJ;IAKIC,iBALJ,GAAA,aAAA,CAKIA,iBALJ;IAMIQ,UANJ,GAAA,aAAA,CAMIA,UANJ;EAeA,IAAI,CAACA,UAAD,IAAeD,QAAQ,KAAKnB,sBAA5B,IAAsD,CAAC3kB,IAAI,CAAC0N,OAAhE,EAAyE;IACrE,OAAO,IAAP;EACH;EAED,IAAM6Y,aAAa,GAAGvmB,IAAI,CAAC0N,OAAL1N,CAAaqJ,aAAbrJ,CAA2BD,MAAjD;EACA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKymB,KAAK,EAAE5B;GAAZ,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IACI4B,KAAK,EAAEpB,aAAa,CAChBC,mBADgB,EAEhBC,iBAFgB,EAGhBC,iBAHgB;GADxB,EAOI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKkB,SAAS,EAAEtE,OAAO,CAACuE;GAAxB,EACItD,KAAAA,CAAAA,aAAAA,CAAAA,GAAAA,EAAAA,IAAAA,EAAIpjB,IAAI,CAAC0N,OAAL1N,CAAaiR,WAAbjR,CAAyBE,IAA7BkjB,CADJ,EAEKmD,aAAa,GAAG,CAAhBA,IACGnD,KAAAA,CAAAA,aAAAA,CAAAA,KAAAA,CAAAA,QAAAA,EAAAA,IAAAA,EACK,OADLA,EAEIA,KAAAA,CAAAA,aAAAA,CAAAA,QAAAA,EAAAA,IAAAA,EACKmD,aAAa,GAAG,CADrBnD,EAAAA,aAAAA,EAEKmD,aAAa,GAAG,CAAhBA,KAAsB,CAAtBA,GAA0B,GAA1BA,GAAgC,EAFrCnD,CAFJA,CAHR,CAPJ,CADJ,CADJ;AAwBH,CA/CM;AAiDP,IAAMlB,SAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/CmF,eAAe,EAAE;MACbC,SAAS,EAAA,cAAA,GAAiBhF,KAAK,CAACiF,OAANjF,CAAckF,OAD3B;MAEbC,eAAe,EAAEnF,KAAK,CAACiF,OAANjF,CAAcoF,UAAdpF,CAAAA,SAAAA,CAFJ;MAGb9B,YAAY,EAAE8B,KAAK,CAACjC,SAANiC,CAAgB9B,YAHjB;MAIbd,QAAQ,EAAE4C,KAAK,CAACjD,SAANiD,CAAgBhD,WAJb;MAKbqI,KAAK,EAAErF,KAAK,CAACiF,OAANjF,CAAc9F,IAAd8F,CAAmBsF,OALb;MAMbrH,OAAO,EAAE+B,KAAK,CAACjC,SAANiC,CAAgB/B,OANZ;MAObD,MAAM,EAAEgC,KAAK,CAACjC,SAANiC,CAAgBhC,MAPX;MAQb6F,OAAO,EAAE;IARI;EAD8B,CAAL;AAAA,CAAN,CAAxC;;AC5FA;;;;;AAkBO,IAAM0B,cAAc,GAAA,aAAkC,KAAK,CAACnE,IAAN,CAAW,UAAA,KAAK,EAAA;EACzE,IAAQphB,YAAR,GAAyBshB,KAAzB,CAAQthB,YAAR;EAEA,IAAMkJ,QAAQ,GAAG+M,WAAW,EAA5B;EACA,IAAMuP,UAAU,GAAG9P,gBAAgB,CAAC3V,oBAAD,EAAuBC,YAAvB,CAAnC;EAEA3F,SAAS,CAAC,YAAA;IACN,IAAI,CAACmrB,UAAD,IAAe,CAACA,UAAU,CAACxY,OAA3B,IAAsCwY,UAAU,CAACxY,OAAXwY,CAAmBpnB,MAAnBonB,KAA8B,CAAxE,EAA2E;MACvE;IACH;IAED,IAAMC,UAAU,GAAGD,UAAU,CAACxY,OAAXwY,CAAmBhqB,IAAnBgqB,CAAwB,GAAxBA,CAAnB;IACA,IAAME,cAAc,GAAG,SAAjBA,cAAiB,CAAC/C,KAAD,EAAA;MACnBA,KAAK,CAACE,cAANF,EAAAA;MACAzZ,QAAQ,CAAC4C,sBAAsB,CAAC0Z,UAAD,EAAa3oB,SAAb,CAAvB,CAARqM;IACH,CAHD;IAIA8D,OAAO,CAACyY,UAAD,EAAaC,cAAb,CAAP1Y;IACA,OAAO,YAAA;MAAA,OAAMA,OAAO,CAAC2Y,MAAR3Y,CAAeyY,UAAfzY,EAA2B0Y,cAA3B1Y,CAAN;IAAA,CAAP;EACH,CAZQ,EAYN,CAAC9D,QAAD,EAAWsc,UAAX,CAZM,CAATnrB;EAcA,OAAO,IAAP;AACH,CArB4D,CAAtD;;AClBP;;;;;AA0BO,IAAMurB,uBAAuB,GAA2C,SAAlEA,uBAAkE,CAAA,IAAA,EAAA;MAC3EC,QAAAA,GAAAA,IAAAA,CAAAA,QAAAA;EAEA,IAAM3c,QAAQ,GAAG+M,WAAW,EAA5B;EACA,IAAMnW,aAAa,GAAGgW,WAAW,CAACjW,mBAAD,CAAjC;EACA,IAAMimB,WAAW,GAAGhQ,WAAW,CAACpS,mBAAD,CAA/B;EACA,IAAMG,4BAA4B,GAAGiS,WAAW,CAC5ClS,kCAD4C,CAAhD,CAAA,CAAA;;EAKA,IAAMmiB,eAAe,GAAGlQ,WAAW,CAC/B,UAAC8M,KAAD,EAAA;IACI,IAAI,CAAC9e,4BAAD,IAAiC0J,qBAAqB,CAACoV,KAAK,CAACG,MAAP,CAA1D,EAA0E;MACtE;MACA;MACA;MACA;MACA;IACH;IACD5Z,QAAQ,CAACC,YAAY,CAACmC,cAAbnC,EAAD,CAARD;EACH,CAV8B,EAW/B,CAACA,QAAD,EAAWrF,4BAAX,CAX+B,CAAnC,CAAA,CAAA;;EAeA,IAAMmiB,wBAAwB,GAAGxO,OAAO,CACpC,YAAA;IAAA,OACI,aAAa,CAACtV,GAAd,CAAkB,UAAA,QAAQ,EAAA;MAAA,OACtB,KAAA,CAAA,aAAA,CAACqjB,cAAD,EAAA;QACIzO,GAAG,EAAA,uBAAA,GAA0B9L,QAAAA;QAC7BhL,YAAY,EAAEgL;OAFlB,CADsB;IAAA,CAA1B,CADJ;EAAA,CADoC,EAQpC,CAAClL,aAAD,CARoC,CAAxC;EAWA,IAAMiiB,mBAAmB,GAAGL,sBAAsB,EAAlD;EACA,IAAMxR,eAAe,GAAGuS,qBAAqB,EAA7C;EAEA,IAAMjC,OAAO,GAAGD,WAAS,EAAzB;EACA,OACI,KAAA,CAAA,aAAA,CAAC0F,iBAAD,EAAA;IAAmBC,WAAW,EAAEH;GAAhC,EACI,KAAA,CAAA,aAAA,CAACI,GAAD,EAAA;IAAKrB,SAAS,EAAEtE,OAAO,CAAC4F,UAAAA;IAAYC,aAAa,EAAEnW;GAAnD,EACK,CAAC4V,WAAD,IAAgB/D,mBAAhB,IAAuCN,KAAAA,CAAAA,aAAAA,CAACyC,oBAADzC,EAAAA,IAAAA,CAD5C,EAEKuE,wBAFL,EAGKH,QAAQ,GAAGA,QAAH,GAAc,IAH3B,CADJ,CADJ;AASH,CAlDM;AAoDP,IAAMtF,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/CwG,UAAU,EAAE;MACRjB,eAAe,EAAEnF,KAAK,CAACiF,OAANjF,CAAcoF,UAAdpF,CAAyBsG,KADlC;MAERtI,MAAM,EAAA,YAAA,GAAegC,KAAK,CAACiF,OAANjF,CAAckF,OAF3B;MAGRjH,OAAO,EAAE+B,KAAK,CAAC/C,OAAN+C,CAAc9C,gBAHf;MAIRE,QAAQ,EAAE4C,KAAK,CAACjD,SAANiD,CAAgBhD,WAJlB;MAKRqI,KAAK,EAAErF,KAAK,CAACiF,OAANjF,CAAc9F,IAAd8F,CAAmBsF,OALlB;MAMRiB,WAAW,EAAE,cANL;MAORC,UAAU,EAAE,YAPJ;MAQRC,aAAa,EAAE,QARP;MASRC,SAAS,EAAE,YATH;MAURC,SAAS,EAAE,MAVH;MAWRzI,YAAY,EAAE,CAXN;MAYR2F,OAAO,EAAE,MAZD;MAaRL,MAAM,EAAE,MAbA;MAeR;MACAoD,kBAAkB,EAAE,MAhBZ;MAiBRC,gBAAgB,EAAE,MAjBV;MAkBRC,aAAa,EAAE,MAlBP;MAmBRC,YAAY,EAAE,MAnBN;MAoBRC,UAAU,EAAE;IApBJ;EADmC,CAAL;AAAA,CAAN,CAAxC;;AC/CA;AACA;AACA;AACA;AACA;;AAEA,IAAaC,WAAW,GAAA,aAAG,KAAK,CAAC5F,UAAN,CAGzB,UAACC,KAAD,EAAQtmB,GAAR,EAAA;;EACE,IAAQwE,UAAR,GAAgD8hB,KAAhD,CAAQ9hB,UAAR;IAAoBkX,aAApB,GAAgD4K,KAAhD,CAAoB5K,aAApB;IAAmCmP,QAAnC,GAAgDvE,KAAhD,CAAmCuE,QAAnC;EACA,IAAMliB,kBAAkB,GAAGiK,kBAAkB,CACzC0T,KAAK,CAAC3d,kBADmC,EAEzC0S,aAAa,CAAC1S,kBAF2B,EAGzC,SAHyC,CAA7C;EAKA,IAAM4S,0BAA0B,GAAG3I,kBAAkB,CACjD0T,KAAK,CAAC/K,0BAD2C,EAEjDF,aAAa,CAACE,0BAFmC,EAGjD,SAHiD,CAArD;EAKA,IAAMI,QAAQ,GAAG/I,kBAAkB,CAC/B0T,KAAK,CAAC3K,QADyB,EAE/BN,aAAa,CAACM,QAFiB,EAG/B,SAH+B,CAAnC;EAKA,IAAMC,IAAI,GAAGhJ,kBAAkB,CAAC0T,KAAK,CAAC1K,IAAP,EAAaP,aAAa,CAACO,IAA3B,CAA/B;EACA,IAAMoB,UAAU,GAAGR,OAAO,CAAC,YAAA;IAAA,OAAA,QAAA,CAAA,CAAA,CAAA,EAAYe,iBAAZ,EAAkC3B,IAAlC,IAAA,IAAA,GAAA,KAAA,CAAA,GAAkCA,IAAI,CAAEoB,UAAxC,CAAA;EAAA,CAAD,EAAwD,CAC9EpB,IAD8E,CAAxD,CAA1B;EAIA,IAAMzB,gBAAgB,GAAGza,cAAc,CAAC,YAAA;IAAA,OAAM8E,UAAN,IAAA,IAAA,GAAMA,UAAN,GAAoB0nB,OAAO,CAACC,QAARD,EAApB;EAAA,CAAD,CAAvC;EACA,IAAM1S,KAAK,GAAGU,cAAc,CAACC,gBAAD,CAA5B;EAEA,IAAMiS,kBAAkB,GAAGhI,qBAAqB,EAAhD;EACA,IAAMY,KAAK,GAAGxI,OAAO,CAAC,YAAA;IAClB,IAAM6P,QAAQ,GAAGC,cAAc,CAAC;MAC5BrC,OAAO,EAAE;QAAEsC,IAAI,EAAE5Q,QAAQ,GAAG,MAAH,GAAY;MAA5B;IADmB,CAAD,CAA/B;IAGA,IAAM6Q,aAAa,GAAGC,KAAK,CACvBJ,QADuB,EAEvBI,KAAK,CAAClL,UAAD,EAAa5F,QAAQ,GAAGuI,iBAAH,GAAuB,CAAA,CAA5C,CAFkB,CAA3B;IAIA,OAAOkI,kBAAkB,GACnBK,KAAK,CAACD,aAAD,EAAgBrI,mBAAhB,CADc,GAEnBqI,aAFN;EAGH,CAXoB,EAWlB,CAAC7Q,QAAD,EAAWyQ,kBAAX,CAXkB,CAArB;EAaA,IAAMM,WAAW,GACb,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,EAAA,IAAA,EACI,KAAA,CAAA,aAAA,CAAClG,mBAAD,EAAA,MAAA,CAAA,MAAA,CAAA;IAAqBxmB,GAAG,EAAEA;KAASsmB,KAAAA,CAAnC,CADJ,EAEIG,KAAAA,CAAAA,aAAAA,CAACmE,uBAADnE,EAAAA,IAAAA,EAA0BoE,QAA1BpE,CAFJ,CADJ;EAOA,OACIA,KAAAA,CAAAA,aAAAA,CAACkG,YAADlG,EAAAA,MAAAA,CAAAA,MAAAA,CAAAA;IAAcmG,MAAM,EAAC,IAAA;IAAKC,aAAa,EAAC;KAASjR,IAAAA,CAAjD6K,EACI,KAAA,CAAA,aAAA,CAACvJ,uBAAuB,CAAC4P,QAAzB,EAAA;IAAkC9tB,KAAK,EAAEge;GAAzC,EACI,KAAA,CAAA,aAAA,CAAC+P,QAAD,EAAA;IAAevT,KAAK,EAAEA;GAAtB,EACI,KAAA,CAAA,aAAA,CAACwT,aAAD,EAAA;IAAehI,KAAK,EAAEA;GAAtB,EACI,KAAA,CAAA,aAAA,CAACiI,eAAD,EAAA;IAAkBjI,KAAK,EAAEA;GAAzB,EACI,KAAA,CAAA,aAAA,CAAC3G,iBAAiB,CAACyO,QAAnB,EAAA;IACI9tB,KAAK,EAAA,CAAA,IAAA,GACD0c,aADC,IAAA,IAAA,GACDA,aADC,GAEDL,aAAa,CAACK,aAFb,KAAA,IAAA,GAAA,IAAA,GAGDP;GAJR,EAOKxS,kBAAkB,IAAI4S,0BAAtB5S,GACG+jB,WADH/jB,GAGG,KAAA,CAAA,aAAA,CAACukB,WAAD,EAAA;IAAaC,OAAO,EAAEC;GAAtB,EACKV,WADL,CAVR,CADJ,CADJ,CADJ,CADJ,CADJjG,CADJ;AA2BH,CA5E0B,CAApB;AA6EPwF,WAAW,CAAC1F,WAAZ0F,GAA0B,aAA1BA;AClGO,IAAMoB,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAA,EAAA;EAC/B,IAAM/nB,WAAW,GAAGwV,WAAW,CAACzV,iBAAD,CAA/B;EACA,IAAM6I,QAAQ,GAAG+M,WAAW,EAA5B;EAEA,IAAMqS,gBAAgB,GAAG9Q,OAAO,CAAC,YAAA;IAC7B,IAAM+Q,KAAK,GAAsB,EAAjC;IACA,IAAI,CAACjoB,WAAL,EAAkB,OAAOioB,KAAP;+BAETpqB,CAAAA,EAAAA;MACL,IAAMxC,IAAI,GAAG2E,WAAW,CAACnC,CAAD,CAAxB;MACAoqB,KAAK,CAAC1qB,IAAN0qB,CAAW;QACP5sB,IAAI,EAAJA,IADO;QAEP6sB,QAAQ,EAAE,CAAC7sB,IAFJ;QAGP8sB,OAAO,EACH,CAAChtB,UAAU,CAACQ,UAAXR,CAAsBE,IAAtBF,CAAD,IAAgC0C,CAAC,KAAKmC,WAAW,CAAClC,MAAZkC,GAAqB,CAA3D,GACMzD,SADN,GAEM,YAAA;UAAA,OACIqM,QAAQ,CACJ4C,sBAAsB,CAACpC,aAAa,CAAC+E,SAAf,EAA0B;YAC5CC,UAAU,EAAE/S,IADgC;YAE5C6J,KAAK,EAAE,CAAC7J,IAAD;UAFqC,CAA1B,CADlB,CADZ;QAAA;MANH,CAAX4sB,CAAAA;;IAFJ,KAAK,IAAIpqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmC,WAAW,CAAClC,MAAhC,EAAwC,EAAED,CAA1C,EAA6C;MAAA,KAAA,CAApCA,CAAoC,CAAA;IAgB5C;IACD,OAAOoqB,KAAP;EACH,CAtB+B,EAsB7B,CAACrf,QAAD,EAAW5I,WAAX,CAtB6B,CAAhC;EAuBA,OAAOgoB,gBAAP;AACH,CA5BM;ACWA,IAAMI,WAAW,GAAG,SAAdA,WAAc,CAAC/sB,IAAD,EAAA;EACvB;EACA,IAAM6Y,KAAK,GAAGqM,QAAQ,EAAtB;EACA,IAAM8H,OAAO,GAAG5tB,mBAAmB,CAACY,IAAD,CAAnC;EACA,IAAMitB,kBAAkB,GAAG/S,WAAW,CAA8B,YAAA;IAChE,IAAMgT,UAAU,GAAGrU,KAAK,CAAChK,QAANgK,EAAnB;IACA,OAAO;MACHsU,gBAAgB,EAAExpB,gBAAgB,CAACupB,UAAD,CAD/B;MAEHE,MAAM,EAAExoB,mBAAmB,CAACsoB,UAAD,CAFxB;MAGH;MACA;MACAvZ,WAAW,EAAEqZ,OAAO,CAAC7tB,OALlB;MAMH4M,aAAa,EAAEzF,mBAAmB,CAAC4mB,UAAD;IAN/B,CAAP;EAQH,CAVqC,EAUnC,CAACrU,KAAD,EAAQmU,OAAR,CAVmC,CAAtC,CAAA,CAAA;;EAaA,IAAMzf,QAAQ,GAAG+M,WAAW,EAA5B;EACA,IAAM+S,OAAO,GAAGnT,WAAW,CAAC,YAAA;IAAA,OAAMpa,UAAU,CAACY,WAAXZ,CAAuBktB,OAAO,CAAC7tB,OAA/BW,CAAN;EAAA,CAAD,EAAgD,CACvEktB,OADuE,CAAhD,CAA3B;EAGA,IAAMM,WAAW,GAAGpT,WAAW,CAAC,YAAA;IAC5B,IAAMxX,IAAI,GAA2B;MACjCkpB,IAAI,EAAEvE,sBAD2B;MAEjCjX,OAAO,EAAE6c,kBAAkB;IAFM,CAArC;IAIA1f,QAAQ,CAAC4C,sBAAsB,CAACpC,aAAa,CAAC2F,cAAf,EAA+BhR,IAAI,CAAC0N,OAApC,CAAvB,CAAR7C;IACA,OAAO7K,IAAP;EACH,CAP8B,EAO5B,CAAC6K,QAAD,EAAW0f,kBAAX,CAP4B,CAA/B;EAQA,IAAMM,SAAS,GAAGrT,WAAW,CACzB,UAACxX,IAAD,EAA+BimB,OAA/B,EAAA;IACI,IAAM6E,UAAU,GAAG7E,OAAO,CAAC8E,aAAR9E,EAAnB;IACA,IACI,CAAC7oB,UAAU,CAACY,WAAXZ,CAAuB4C,IAAI,CAAC0N,OAAL1N,CAAaiR,WAApC7T,CAAD,IACA,CAAC0tB,UADD,IAEA,CAACA,UAAU,CAACE,UAHhB,EAIE;MACE;IACH;IAEDngB,QAAQ,CACJ4C,sBAAsB,CAACpC,aAAa,CAAC6F,YAAf,EAAA,QAAA,CAAA,CAAA,CAAA,EACflR,IAAI,CAAC0N,OADU,EAAA;MAElByD,WAAW,EAAE2Z,UAAU,CAACE,UAFN;MAGlBpX,IAAI,EAAEkX,UAAU,CAACG,UAAXH,KAA0B;IAHd,CAAA,CAAA,CADlB,CAARjgB;EAOH,CAlBwB,EAmBzB,CAACA,QAAD,CAnByB,CAA7B,CAAA,CAAA;;EAuBA,IAAM7K,IAAI,GAAGmZ,OAAO,CAChB,YAAA;IAAA,OAAO;MACH+P,IAAI,EAAEvE,sBADH;MAEH;MACAjX,OAAO,EAAE,CAAA;IAHN,CAAP;EAAA,CADgB,EAMhB,EANgB,CAApB;EAQA,IAAMwd,OAAO,GAAG1T,WAAW,CAAC,UAAA,OAAO,EAAA;IAAA,OAAK;MAAEuO,UAAU,EAAEE,OAAO,CAACF,UAARE;IAAd,CAAL;EAAA,CAAR,EAAoD,EAApD,CAA3B;EACA,IAAA,mBAAA,GAAuDxC,kBAAkB,CAAC;MACtEzjB,IAAI,EAAJA,IADsE;MAEtE2qB,OAAO,EAAPA,OAFsE;MAGtEW,KAAK,EAAEV,WAH+D;MAItE;MACAW,GAAG,EAAEV,SALiE;MAMtEK,OAAO,EAAPA;IANsE,CAAD,CAAzE;IAAqBC,aAArB,GAAA,mBAAA,CAAA,CAAA,CAAA,CAASpF,UAAT;IAAsCqF,IAAtC,GAAA,mBAAA,CAAA,CAAA,CAAA;IAA4CC,OAA5C,GAAA,mBAAA,CAAA,CAAA,CAAA;EASArvB,SAAS,CAAC,YAAA;IACN;IACA;IACAqvB,OAAO,CAACG,aAAa,EAAd,EAAkB;MAAEC,oBAAoB,EAAE;IAAxB,CAAlB,CAAPJ;EACH,CAJQ,EAIN,CAACA,OAAD,CAJM,CAATrvB;EAMA,OAAO;IAAEmvB,aAAa,EAAbA,aAAF;IAAiBC,IAAI,EAAJA;EAAjB,CAAP;AACH,CA7EM;AAqFA,IAAMM,WAAW,GAAG,SAAdA,WAAc,CAAA,IAAA,EAAA;MACvBpuB,IAAAA,GAAAA,IAAAA,CAAAA,IAAAA;IACAquB,gBAAAA,GAAAA,IAAAA,CAAAA,gBAAAA;IACAC,oBAAAA,GAAAA,IAAAA,CAAAA,oBAAAA;EAEA,IAAMC,cAAc,GAAGnvB,mBAAmB,CAAC+a,WAAW,CAACzV,iBAAD,CAAZ,CAA1C;EACA,IAAM8pB,MAAM,GAAGtU,WAAW,CACtB,UAACuU,KAAD,EAAgC9F,OAAhC,EAAA;IACI,IAAI,CAACA,OAAO,CAAC+F,OAAR/F,EAAL,EAAwB;IACxB,IAAMgG,gBAAgB,GAAmD;MACrEjB,UAAU,EAAE1tB;IADyD,CAAzE;IAGA,OAAO2uB,gBAAP;EACH,CAPqB,EAQtB,CAAC3uB,IAAD,CARsB,CAA1B;EAUA,IAAM0uB,OAAO,GAAGxU,WAAW,CACvB,UAACxX,IAAD,EAA+BimB,OAA/B,EAAA;IACI,IACI0F,gBAAgB,IAChB,CAACvuB,UAAU,CAACc,WAAXd,CAAuBE,IAAvBF,CADDuuB,IAEC,CAAC,OAAO,CAACO,MAAR,CAAe;MAAEC,OAAO,EAAE;IAAX,CAAf,CAAD,IAAsC,CAACP,oBAH5C,EAIE;MACE,OAAO,KAAP;IACH;IACD,IAAA,aAAA,GAA+C5rB,IAAI,CAAC0N,OAApD;MAAQgd,MAAR,GAAA,aAAA,CAAQA,MAAR;MAAgBzZ,WAAhB,GAAA,aAAA,CAAgBA,WAAhB;MAA6B5H,aAA7B,GAAA,aAAA,CAA6BA,aAA7B,CAAA,CAAA;IAGA;IACA;;IACA,IAAM+iB,iBAAiB,GAAG,IAAIxsB,GAAJ,EAA1B;IACAwsB,iBAAiB,CAAChsB,GAAlBgsB,CAAsB9uB,IAAI,CAAC2C,EAA3BmsB,CAAAA;IACAP,cAAc,CAACpvB,OAAfovB,CAAuBhoB,GAAvBgoB,CAA2B,UAAA,MAAM,EAAA;MAC7B,IAAI9N,MAAJ,EAAYqO,iBAAiB,CAAChsB,GAAlBgsB,CAAsBrO,MAAM,CAAC9d,EAA7BmsB,CAAAA;IACf,CAFDP,CAAAA;IAGA,IAAMQ,UAAU,GAAA,CAAgBpb,WAAhB,CAAA,CAAA,MAAA,CAAgC5H,aAAhC,CAAhB;IACA,KAAA,IAAA,SAAA,GAAA,+BAAA,CAAuBgjB,UAAvB,CAAA,EAAA,KAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,EAAA,EAAA,IAAA,GAAmC;MAAA,IAAxBC,QAAwB,GAAA,KAAA,CAAA,KAAA;MAC/B,IAAIF,iBAAiB,CAACjsB,GAAlBisB,CAAsBE,QAAQ,CAACrsB,EAA/BmsB,CAAJ,EAAwC,OAAO,KAAP;IAC3C,CAAA,CAAA;IAGD;;IACA,OAAO9uB,IAAI,CAAC2C,EAAL3C,MAAYotB,MAAZptB,IAAAA,IAAAA,GAAAA,KAAAA,CAAAA,GAAYotB,MAAM,CAAEzqB,EAApB3C,CAAP;EACH,CA3BsB,EA4BvB,CAACquB,gBAAD,EAAmBruB,IAAnB,EAAyBsuB,oBAAzB,EAA+CC,cAA/C,CA5BuB,CAA3B;EA8BA,IAAMX,OAAO,GAAG1T,WAAW,CACvB,UAAA,OAAO,EAAA;IAAA,OAAK;MACR0U,MAAM,EAAEjG,OAAO,CAACiG,MAARjG,EADA;MAERsG,aAAa,EAAE,OAAO,CAACL,MAAR,CAAe;QAAEC,OAAO,EAAE;MAAX,CAAf,CAFP;MAGRH,OAAO,EAAE/F,OAAO,CAAC+F,OAAR/F;IAHD,CAAL;EAAA,CADgB,EAMvB,EANuB,CAA3B;EAQA,IAAA,mBAAA,GAGInC,kBAAkB,CAAC;MACnB8I,MAAM,EAAEjI,sBADW;MAEnBgI,IAAI,EAAEb,MAFa;MAGnBE,OAAO,EAAPA,OAHmB;MAInBd,OAAO,EAAPA;IAJmB,CAAD,CAHtB;IAAA,oBAAA,GAAA,mBAAA,CAAA,CAAA,CAAA;IACcsB,SADd,GAAA,oBAAA,CACMN,MADN;IACwCO,gBADxC,GAAA,oBAAA,CACyBF,aADzB;IACmEG,UADnE,GAAA,oBAAA,CAC0DV,OAD1D;IAEIW,IAFJ,GAAA,mBAAA,CAAA,CAAA,CAAA;EASA,OAAO;IAAEH,SAAS,EAATA,SAAF;IAAaC,gBAAgB,EAAhBA,gBAAb;IAA+BC,UAAU,EAAVA,UAA/B;IAA2CC,IAAI,EAAJA;EAA3C,CAAP;AACH,CAhEM;AAkEA,IAAME,eAAe,GAAG,SAAlBA,eAAkB,CAACvvB,IAAD,EAAA;EAC3B,IAAA,YAAA,GAAgC+sB,WAAW,CAAC/sB,IAAD,CAA3C;IAAQ6tB,aAAR,GAAA,YAAA,CAAQA,aAAR;IAAuBC,IAAvB,GAAA,YAAA,CAAuBA,IAAvB;EACA,IAAA,YAAA,GAAwCM,WAAW,CAAC;MAAEpuB,IAAI,EAAJA;IAAF,CAAD,CAAnD;IAAQkvB,SAAR,GAAA,YAAA,CAAQA,SAAR;IAAmBE,UAAnB,GAAA,YAAA,CAAmBA,UAAnB;IAA+BC,IAA/B,GAAA,YAAA,CAA+BA,IAA/B;EACA,IAAMG,QAAQ,GAAG3T,OAAO,CACpB,YAAA;IAAA,OAAO;MACHgS,aAAa,EAAbA,aADG;MAEHqB,SAAS,EAATA,SAFG;MAGHE,UAAU,EAAVA;IAHG,CAAP;EAAA,CADoB,EAMpB,CAACA,UAAD,EAAavB,aAAb,EAA4BqB,SAA5B,CANoB,CAAxB;EAQA,OAAO;IACHG,IAAI,EAAJA,IADG;IAEHvB,IAAI,EAAJA,IAFG;IAGH0B,QAAQ,EAARA;EAHG,CAAP;AAKH,CAhBM;AAkBA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACzvB,IAAD,EAA2BwvB,QAA3B,EAAA;EAC3B,IAAMjiB,QAAQ,GAAG+M,WAAW,EAA5B;EACA,IAAMoV,gBAAgB,GAAGtwB,mBAAmB,CAAC+a,WAAW,CAACvV,mBAAD,CAAZ,CAA5C;EACAlG,SAAS,CAAC,YAAA;;IACN,IAAIixB,OAAO,GAAkB,IAA7B;IACA,IACIH,QAAQ,CAACN,SAATM,IACA1vB,UAAU,CAACgB,aAAXhB,CAAyBE,IAAzBF,CADA0vB,IAEAxvB,IAAI,CAAC2C,EAAL3C,MAAAA,CAAAA,qBAAAA,GAAY0vB,gBAAgB,CAACvwB,OAA7Ba,KAAAA,IAAAA,GAAAA,KAAAA,CAAAA,GAAY0vB,qBAAAA,CAA0B/sB,EAAtC3C,CAHJ,EAIE;MACE2vB,OAAO,GAAG/wB,UAAU,CAChB,YAAA;QAAA,OACI2O,QAAQ,CACJ4C,sBAAsB,CAACwC,gBAAgB,CAACG,SAAlB,EAA6B;UAC/CC,UAAU,EAAE/S,IADmC;UAE/C6J,KAAK,EAAE,CAAC7J,IAAD;QAFwC,CAA7B,CADlB,CADZ;MAAA,CADgB;MAAA;MAShB,IATgB,CAApB2vB;IAWH;IACD,OAAO,YAAA;MACH,IAAIA,OAAJ,EAAa9wB,YAAY,CAAC8wB,OAAD,CAAZ9wB;IAChB,CAFD;EAGH,CAtBQ,EAsBN,CAAC0O,QAAD,EAAWvN,IAAX,EAAiBwvB,QAAQ,CAACN,SAA1B,EAAqCQ,gBAArC,CAtBM,CAAThxB;AAuBH,CA1BM;;ACpMP;;;;;;AAeA,IAAMkxB,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAcC,GAAd,EAAA;EACjB,OAAOD,GAAG,GAAGtS,IAAI,CAACwS,KAALxS,CAAWA,IAAI,CAACyS,MAALzS,EAAAA,GAAgBA,IAAI,CAACwS,KAALxS,CAAWuS,GAAG,GAAGD,GAAjBtS,CAA3BA,CAAb;AACH,CAFD;AAGO,IAAM0S,eAAe,GAAA,aAAmC,KAAK,CAACxK,IAAN,CAAW,UAAA,KAAK,EAAA;EAC3E,IAAQyK,SAAR,GAAiCvK,KAAjC,CAAQuK,SAAR;IAAmBC,SAAnB,GAAiCxK,KAAjC,CAAmBwK,SAAnB;EAEA,IAAMC,iBAAiB,GAAGR,YAAY,CAACM,SAAD,EAAYC,SAAZ,CAAtC;EACA,IAAME,UAAU,GAAG,QAAA,CAASC,MAAT,CAAgBF,iBAAhB,CAAnB;EAEA,IAAMvL,OAAO,GAAGD,WAAS,EAAzB;EACA,OACI,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;IACIuE,SAAS,EAAEtE,OAAO,CAAC0L,eAAAA;IACnBC,uBAAuB,EAAE;MAAEC,MAAM,EAAEJ;IAAV;GAF7B,CADJ;AAMH,CAb8D,CAAxD;AAeP,IAAMzL,WAAS,GAAA,aAAGd,qBAAqB,CAAC,YAAA;EAAA,OAAO;IAC3C,gCAAA,EAAkC;MAC9B,IAAA,EAAM;QAAE4M,OAAO,EAAE;MAAX,CADwB;MAE9B,KAAA,EAAO;QAAEA,OAAO,EAAE;MAAX,CAFuB;MAG9B,MAAA,EAAQ;QAAEA,OAAO,EAAE;MAAX;IAHsB,CADS;IAM3CH,eAAe,EAAE;MACbI,aAAa,EAAE,sBADF;MAEbC,uBAAuB,EAAE,UAFZ;MAGbC,uBAAuB,EAAE,QAHZ;MAIbC,iBAAiB,EAAE,MAJN;MAKbtH,eAAe,EAAE,MALJ;MAMbuH,UAAU,EAAE,QANC;MAObC,QAAQ,EAAE,QAPG;MAQbzO,YAAY,EAAE,CARD;MASb0O,QAAQ,EAAE,KATG;MAUbC,QAAQ,EAAE;IAVG;EAN0B,CAAP;AAAA,CAAD,CAAvC;ACdO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACnxB,IAAD,EAAA;EACjC,OAAO6b,OAAO,CAAC,YAAA;IACX,IAAMuV,SAAS,GAA4C;MACvD,cAAA,EAAgB,YADuC;MAEvD,qBAAA,EAAuBpxB,IAAI,GAAGA,IAAI,CAAC2C,EAAR,GAAazB;IAFe,CAA3D;IAKA,OAAA,QAAA,CAAA;MACImwB,IAAI,EAAE;IADV,CAAA,EAEOD,SAFP,CAAA;EAIH,CAVa,EAUX,CAACpxB,IAAD,CAVW,CAAd;AAWH,CAZM;AAcA,IAAMsxB,iBAAiB,GAAG,SAApBA,iBAAoB,CAACtxB,IAAD,EAA2BuxB,QAA3B,EAA8CC,OAA9C,EAAA;EAC7B,IAAMpR,QAAQ,GAAGG,WAAW,CAACvgB,IAAD,CAA5B;EACA,IAAA,gBAAA,GAA2C2xB,eAAe,CAAC3xB,IAAD,CAA1D;IAAQyxB,YAAR,GAAA,gBAAA,CAAQA,YAAR;IAAsBC,gBAAtB,GAAA,gBAAA,CAAsBA,gBAAtB;EAEA,OAAO7V,OAAO,CAAiB,YAAA;IAC3B,IAAM+V,SAAS,GAAGH,YAAY,GAAG1T,UAAU,CAACqC,QAAQ,CAACD,SAAV,CAAb,GAAoCrC,WAAW,CAACsC,QAAQ,CAACD,SAAV,CAA7E;IACA,IAAM0R,QAAQ,GAAGH,gBAAgB,IAAI,CAAC1xB,IAAtC;IACA,IAAMiU,IAAI,GAAGyd,gBAAgB,GAAGxgB,cAAc,CAACsP,OAAlB,GAA4BJ,QAAQ,CAACnM,IAAlE;IAEA,OAAO;MACHvS,aAAa,EAAE5B,UAAU,CAAC2B,gBAAX3B,CAA4BE,IAA5BF,CADZ;MAEHmU,IAAI,EAAEjU,IAAI,IAAIA,IAAI,CAACiU,IAALjU,KAAckB,SAAtBlB,GAAkCA,IAAI,CAACiU,IAAvCjU,GAA8CiU,IAFjD;MAGH4d,QAAQ,EAAEA,QAHP;MAIHJ,YAAY,EAAEA,YAJX;MAKH/H,KAAK,EAAE1pB,IAAI,IAAIA,IAAI,CAAC0pB,KAAL1pB,KAAekB,SAAvBlB,GAAmCA,IAAI,CAAC0pB,KAAxC1pB,GAAgD4xB,SALpD;MAMHL,QAAQ,EAAEA,QANP;MAOHC,OAAO,EAAE,CAAC,CAACA;IAPR,CAAP;EASH,CAda,EAcX,CAACxxB,IAAD,EAAOwxB,OAAP,EAAgBpR,QAAhB,EAA0BmR,QAA1B,EAAoCG,gBAApC,EAAsDD,YAAtD,CAdW,CAAd;AAeH,CAnBM;AAqBA,IAAMK,UAAU,GAAG,SAAbA,UAAa,CAACtC,QAAD,EAAA;EACtB,IAAIuC,WAAW,GAA6B,IAA5C;EACA,IAAIvC,QAAQ,CAACN,SAAb,EAAwB;IACpB,IAAM8C,YAAY,GAAGxC,QAAQ,CAACJ,UAA9B;IACA2C,WAAW,GAAGC,YAAY,GAAG9gB,cAAc,CAACke,UAAlB,GAA+Ble,cAAc,CAAC+gB,aAAxEF;EACH,CAHD,MAGO,IAAIvC,QAAQ,CAAC3B,aAAb,EAA4B;IAC/BkE,WAAW,GAAG7gB,cAAc,CAACghB,WAA7BH;EACH;EAED,OAAOA,WAAP;AACH,CAVM;AAYA,IAAMI,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACnyB,IAAD,EAAA;EACrC,IAAMoyB,aAAa,GAAqBvW,OAAO,CAAC,YAAA;IAC5C,IAAMuW,aAAa,GAAqB,EAAxC;IACA,IAAItyB,UAAU,CAACI,QAAXJ,CAAoBE,IAApBF,CAAJ,EAA+BsyB,aAAa,CAAClwB,IAAdkwB,CAAmBlhB,cAAc,CAACmhB,MAAlCD,CAAAA;IAC/B,IAAItyB,UAAU,CAACK,SAAXL,CAAqBE,IAArBF,CAAJ,EAAgCsyB,aAAa,CAAClwB,IAAdkwB,CAAmBlhB,cAAc,CAACohB,OAAlCF,CAAAA;IAChC,IAAItyB,UAAU,CAACM,WAAXN,CAAuBE,IAAvBF,CAAJ,EAAkCsyB,aAAa,CAAClwB,IAAdkwB,CAAmBlhB,cAAc,CAAC2N,IAAlCuT,CAAAA;IAClC,OAAOA,aAAP;EACH,CAN8C,EAM5C,CAACpyB,IAAD,CAN4C,CAA/C;EAOA,IAAMuyB,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EACA,IAAM8U,sBAAsB,GAAG3W,OAAO,CAClC,YAAA;IAAA,OAAM,aAAa,CAACtV,GAAd,CAAkB,UAAC0N,IAAD,EAAOvI,KAAP,EAAA;MAAA,OAAiB,KAAA,CAAA,aAAA,CAAC6mB,UAAD,EAAA;QAAYpX,GAAG,EAAA,gBAAA,GAAmBzP,KAAAA;QAASuI,IAAI,EAAEA;OAAjD,CAAjB;IAAA,CAAlB,CAAN;EAAA,CADkC;EAAA;EAGlC;EACA;EACA,CAACse,UAAD,EAAaH,aAAb,CALkC,CAAtC;EAOA,OAAOI,sBAAP;AACH,CAjBM;AAmBP,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,QAAD,EAAA;EACb,IAAMC,KAAK,GAAGD,QAAQ,CAACE,KAATF,CAAe,GAAfA,CAAd;EACA,IAAIC,KAAK,CAAClwB,MAAV,EAAkB;IACd,OAAA,GAAA,GAAWkwB,KAAK,CAACA,KAAK,CAAClwB,MAANkwB,GAAe,CAAhB,CAAhB;EACH;EACD,OAAO,EAAP;AACH,CAND;AAQO,IAAME,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC7yB,IAAD,EAAA;EAChC,OAAO6b,OAAO,CAAC,YAAA;IACX,IAAI,CAAC7b,IAAL,EAAW,OAAO,KAAA,CAAA,aAAA,CAACiwB,eAAD,EAAA;MAAiBC,SAAS,EAAE,EAAA;MAAIC,SAAS,EAAE;KAA3C,CAAP;IAEX,IAAIvtB,IAAJ;IACA,IAAIkwB,SAAS,GAAG,IAAhB;IAEA,IAAM7yB,KAAK,GAAGH,UAAU,CAACC,WAAXD,CAAuBE,IAAvBF,CAAd;IACA,IAAIG,KAAJ,EAAW;MACP2C,IAAI,GAAG5C,IAAI,CAAC4C,IAAZA;IACH,CAFD,MAEO;MAAA,IAAA,SAAA;MACHkwB,SAAS,GAAA,CAAA,SAAA,GAAG9yB,IAAI,CAAC+yB,GAAR,KAAA,IAAA,GAAA,SAAA,GAAeN,QAAQ,CAACzyB,IAAI,CAAC4C,IAAN,CAAhCkwB;MACAlwB,IAAI,GAAG5C,IAAI,CAAC4C,IAAL5C,CAAUgzB,MAAVhzB,CAAiB,CAAjBA,EAAoBA,IAAI,CAAC4C,IAAL5C,CAAUyC,MAAVzC,GAAmB8yB,SAAS,CAACrwB,MAAjDzC,CAAP4C;IACH;IAED,OACIkjB,KAAAA,CAAAA,aAAAA,CAAAA,KAAAA,CAAAA,QAAAA,EAAAA,IAAAA,EACKljB,IADLkjB,EAEKgN,SAAS,IAAI,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;MAAM3J,SAAS,EAAC;KAAhB,EAAiE2J,SAAjE,CAFlBhN,CADJ;EAMH,CApBa,EAoBX,CAAC9lB,IAAD,CApBW,CAAd;AAqBH,CAtBM;AAwBA,IAAM2xB,eAAe,GAAG,SAAlBA,eAAkB,CAAC3xB,IAAD,EAAA;EAC3B,IAAM4H,kBAAkB,GAAGuS,WAAW,CAACxS,wBAAD,CAAtC;EACA,IAAA,SAAA,GAAwClJ,QAAQ,CAAmB,IAAnB,CAAhD;IAAOgzB,YAAP,GAAA,SAAA,CAAA,CAAA,CAAA;IAAqBwB,eAArB,GAAA,SAAA,CAAA,CAAA,CAAA;EACA,IAAA,UAAA,GAAgDx0B,QAAQ,CAAU,KAAV,CAAxD;IAAOizB,gBAAP,GAAA,UAAA,CAAA,CAAA,CAAA;IAAyBwB,mBAAzB,GAAA,UAAA,CAAA,CAAA,CAAA;EACA,IAAMC,eAAe,GAAGj0B,MAAM,CAAC,CAAD,CAA9B;EAEAR,SAAS,CAAC,YAAA;IACN,IAAI00B,gBAAgB,GAAG,KAAvB;IAEA,IAAIpzB,IAAJ,EAAU;MACN,IAAI4H,kBAAJ,EAAwB;QACpB,IAAIurB,eAAe,CAACh0B,OAAhBg0B,KAA4B,CAAhC,EAAmC;UAC/BD,mBAAmB,CAAC,IAAD,CAAnBA;QACH;QACDC,eAAe,CAACh0B,OAAhBg0B,EAAAA;QACAljB,OAAO,CAACC,OAARD,EAAAA,CACKY,IADLZ,CACU,YAAA;UAAA,OAAMrI,kBAAkB,CAAC5H,IAAD,CAAxB;QAAA,CADViQ,CAAAA,CAEKY,IAFLZ,CAEU,UAACwhB,YAAD,EAAA;UACF,IAAI2B,gBAAJ,EAAsB;UACtBF,mBAAmB,CAAC,KAAD,CAAnBA;UAEA,IAAIzB,YAAY,IAAI,OAAOA,YAAP,KAAwB,QAA5C,EAAsD;YAClDwB,eAAe,CAACxB,YAAD,CAAfwB;UACH;QACJ,CATLhjB,CAAAA,CAAAA,OAAAA,CAAAA,CAUW,UAAA,KAAK,EAAA;UACR,IAAI,CAACmjB,gBAAL,EAAuBF,mBAAmB,CAAC,KAAD,CAAnBA;UACvB5zB,MAAM,CAACC,KAAPD,CAAAA,8DAAAA,GAA0EC,KAAK,CAAC+B,OAAhFhC,CAAAA;QACH,CAbL2Q,CAAAA;MAcH,CAnBD,MAmBO,IAAIjQ,IAAI,CAACyxB,YAAT,EAAuB;QAC1BwB,eAAe,CAACjzB,IAAI,CAACyxB,YAAN,CAAfwB;MACH;IACJ;IAED,OAAO,YAAA;MACHG,gBAAgB,GAAG,IAAnBA;IACH,CAFD;EAGH,CA/BQ,EA+BN,CAACpzB,IAAD,EAAOizB,eAAP,EAAwBC,mBAAxB,EAA6CtrB,kBAA7C,CA/BM,CAATlJ;EAiCA,OAAO;IAAE+yB,YAAY,EAAZA,YAAF;IAAgBC,gBAAgB,EAAhBA;EAAhB,CAAP;AACH,CAxCM;AA0CA,IAAM2B,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACrzB,IAAD,EAA2BszB,YAA3B,EAAA;EAChC,IAAM/lB,QAAQ,GAAG+M,WAAW,EAA5B,CAAA,CAAA;;EAGA,IAAMiZ,YAAY,GAAGrZ,WAAW,CAC5B,UAAC8M,KAAD,EAAyBnU,SAAzB,EAAA;IACI,IAAI,CAAC7S,IAAL,EAAW;IAEXuN,QAAQ,CACJ4C,sBAAsB,CAACpC,aAAa,CAAC6E,cAAf,EAA+B;MACjDC,SAAS,EAATA,SADiD;MAEjD7S,IAAI,EAAJA,IAFiD;MAGjDoT,gBAAgB,EAAEkgB,YAH+B;MAIjDrM,MAAM,EAAED,KAAK,CAACC,MAJmC;MAKjDjU,OAAO,EAAEgU,KAAK,CAAChU,OALkC;MAMjDK,QAAQ,EAAE2T,KAAK,CAAC3T;IANiC,CAA/B,CADlB,CAAR9F;EAUH,CAd2B,EAe5B,CAACA,QAAD,EAAWvN,IAAX,EAAiBszB,YAAjB,CAf4B,CAAhC;EAiBA,IAAME,eAAe,GAAGtZ,WAAW,CAC/B,UAAC8M,KAAD,EAAA;IACI,IAAI,CAAChnB,IAAL,EAAW;IAEXuN,QAAQ,CACJ4C,sBAAsB,CAACpC,aAAa,CAACwF,iBAAf,EAAkC;MACpDvT,IAAI,EAAJA,IADoD;MAEpDoT,gBAAgB,EAAEkgB,YAFkC;MAGpD9f,QAAQ,EAAEwT,KAAK,CAACxT,QAHoC;MAIpDC,QAAQ,EAAEuT,KAAK,CAACvT,QAJoC;MAKpDwT,MAAM,EAAED,KAAK,CAACC,MALsC;MAMpDjU,OAAO,EAAEgU,KAAK,CAAChU,OANqC;MAOpDK,QAAQ,EAAE2T,KAAK,CAAC3T;IAPoC,CAAlC,CADlB,CAAR9F;EAWH,CAf8B,EAgB/B,CAACA,QAAD,EAAWvN,IAAX,EAAiBszB,YAAjB,CAhB+B,CAAnC,CAAA,CAAA;;EAoBA,IAAMG,aAAa,GAAGvZ,WAAW,CAAC,UAAC8M,KAAD,EAAA;IAAA,OAA4BuM,YAAY,CAACvM,KAAD,EAAQ,QAAR,CAAxC;EAAA,CAAD,EAA4D,CAACuM,YAAD,CAA5D,CAAjC;EACA,IAAMG,aAAa,GAAGxZ,WAAW,CAAC,UAAC8M,KAAD,EAAA;IAAA,OAA4BuM,YAAY,CAACvM,KAAD,EAAQ,QAAR,CAAxC;EAAA,CAAD,EAA4D,CAACuM,YAAD,CAA5D,CAAjC;EAEA,OAAO;IACHE,aAAa,EAAbA,aADG;IAEHC,aAAa,EAAbA,aAFG;IAGHF,eAAe,EAAfA;EAHG,CAAP;AAKH,CAjDM;ICpCKG,qBAAZ;AAAA,CAAA,UAAYA,qBAAAA,EAAAA;EACRA,qBAAAA,CAAAA,qBAAAA,CAAAA,QAAAA,CAAAA,GAAAA,CAAAA,CAAAA,GAAAA,QAAAA;EACAA,qBAAAA,CAAAA,qBAAAA,CAAAA,UAAAA,CAAAA,GAAAA,CAAAA,CAAAA,GAAAA,UAAAA;EACAA,qBAAAA,CAAAA,qBAAAA,CAAAA,SAAAA,CAAAA,GAAAA,CAAAA,CAAAA,GAAAA,SAAAA;EACAA,qBAAAA,CAAAA,qBAAAA,CAAAA,QAAAA,CAAAA,GAAAA,CAAAA,CAAAA,GAAAA,QAAAA;AACH,CALD,EAAYA,qBAAqB,KAArBA,qBAAqB,GAAA,CAAA,CAAA,CAAjC,CAAA;ACtGO,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACvvB,YAAD,EAAA;EAChC,IAAMkJ,QAAQ,GAAG+M,WAAW,EAA5B;EACA,IAAMuP,UAAU,GAAG9P,gBAAgB,CAAC3V,oBAAD,EAAuBC,YAAvB,CAAnC;EACA,OAAO6V,WAAW,CAAC,YAAA;IAAA,OAAM3M,QAAQ,CAAC4C,sBAAsB,CAAC0Z,UAAD,EAAa3oB,SAAb,CAAvB,CAAd;EAAA,CAAD,EAAgE,CAC9EqM,QAD8E,EAE9Esc,UAF8E,CAAhE,CAAlB;AAIH,CAPM;AASA,IAAMgK,kBAAkB,GAAG,SAArBA,kBAAqB,CAC9BxvB,YAD8B,EAAA;;EAG9B,IAAMU,YAAY,GAAGoV,WAAW,CAACrV,kBAAD,CAAhC;EACA,IAAMoC,cAAc,GAAGiT,WAAW,CAAClT,oBAAD,CAAlC;EAEA,IAAMG,YAAY,GAAG+S,WAAW,CAAChT,kBAAD,CAAhC;EACA,IAAMG,SAAS,GAAG6S,WAAW,CAAC9S,eAAD,CAA7B;EAEA,IAAMZ,MAAM,GAAGsT,gBAAgB,CAAC3V,oBAAD,EAAuBC,YAAvB,CAA/B,CAAA,CAAA;;EAEA,IAAMyvB,WAAW,GAAG/Z,gBAAgB,CAACtS,iBAAD,EAAoBhB,MAApB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,CAAA,cAAA,GAAoBA,MAAM,CAAE6G,MAA5B,KAAA,IAAA,GAAA,KAAA,CAAA,GAAoB7G,cAAAA,CAAgB9D,EAApC,CAApC;EAEA,IAAMoxB,mBAAmB,GAAGha,gBAAgB,CACxClT,iCADwC,EAExCxC,YAFwC,CAA5C;EAKA,IAAM2vB,oBAAoB,GAAGD,mBAAmB,KAAK,CAArD;EAEA,OAAOlY,OAAO,CAAC,YAAA;;IACX,IAAI,CAACpV,MAAL,EAAa,OAAO;MAAEwN,IAAI,EAAE,IAAR;MAAcggB,MAAM,EAAE,KAAtB;MAA6BpH,QAAQ,EAAE;IAAvC,CAAP;IAEb,IAAI5Y,IAAI,GAAA,CAAA,mBAAA,GAAA,CAAA,cAAA,GAAGxN,MAAM,CAAC+H,MAAV,KAAA,IAAA,GAAA,KAAA,CAAA,GAAG/H,cAAAA,CAAewN,IAAlB,KAAA,IAAA,GAAA,mBAAA,GAA0B,IAAlC;IACA,IAAIxN,MAAM,CAAC2D,eAAX,EAA4B;MACxB,IAAIhD,YAAY,KAAKX,MAAM,CAAC9D,EAA5B,EAAgC;QAC5B,IAAI2E,SAAS,KAAK5D,SAAS,CAAC4G,GAA5B,EAAiC;UAC7B2J,IAAI,GAAG/C,cAAc,CAACgjB,OAAtBjgB;QACH,CAFD,MAEO;UACHA,IAAI,GAAG/C,cAAc,CAACijB,QAAtBlgB;QACH;MACJ,CAND,MAMO;QACHA,IAAI,GAAG/C,cAAc,CAACkjB,WAAtBngB;MACH;IACJ,CAVD,MAUO,IAAIxN,MAAM,CAAC6G,MAAX,EAAmB;MACtB,IAAIwmB,WAAJ,EAAiB;QACb7f,IAAI,GAAG/C,cAAc,CAACmjB,QAAtBpgB;MACH,CAFD,MAEO;QACHA,IAAI,GAAG/C,cAAc,CAACojB,SAAtBrgB;MACH;IACJ;IAED,IAAMsgB,0BAA0B,GAAG9tB,MAAM,CAAC9D,EAAP8D,KAAcW,YAAjD;IACA,IAAMotB,8BAA8B,GAAG/tB,MAAM,CAACS,cAAPT,KAA0BS,cAAjE;IACA,IAAMutB,kBAAkB,GAAGhuB,MAAM,CAAC6G,MAAP7G,GAAgB,CAAC,CAACqtB,WAAlBrtB,GAAgC,KAA3D;IAEA,IAAIiuB,cAAc,GAAG,KAArB;IACA,IAAIC,YAAY,GAAG,KAAnB;IACA,IAAIluB,MAAM,CAACmuB,gBAAPnuB,KAA4BvF,SAAhC,EAA2C;MACvCwzB,cAAc,GAAGjuB,MAAM,CAACmuB,gBAAPnuB,EAAAA,KAA8BktB,qBAAqB,CAACkB,QAArEH;MACAC,YAAY,GAAGluB,MAAM,CAACmuB,gBAAPnuB,EAAAA,KAA8BktB,qBAAqB,CAACmB,MAAnEH;IACH;IACD,IAAMV,MAAM,GACRM,0BAA0B,IAC1BC,8BADAD,IAEAE,kBAFAF,IAGAI,YAJJ;IAMA,IAAI9H,QAAQ,GAAa,CAAC,CAACpmB,MAAM,CAACC,iBAAT,IAA8BstB,oBAA/B,IAAwDU,cAAhF;IAEA,IAAIjuB,MAAM,CAAC9D,EAAP8D,KAAcsH,aAAa,CAACC,gBAAdD,CAA+BpL,EAAjD,EAAqD;MACjD;MACA;MACAkqB,QAAQ,GAAGA,QAAQ,IAAI,CAAC/sB,UAAU,CAACQ,UAAXR,CAAsBiF,YAAtBjF,CAAxB+sB;IACH;IAED,OAAO;MAAE5Y,IAAI,EAAJA,IAAF;MAAQggB,MAAM,EAANA,MAAR;MAAgBpH,QAAQ,EAARA;IAAhB,CAAP;EACH,CA/Ca,EA+CX,CACC9nB,YADD,EAECmC,cAFD,EAGCE,YAHD,EAICE,SAJD,EAKCb,MALD,EAMCqtB,WAND,EAOCE,oBAPD,CA/CW,CAAd;AAwDH,CA5EM;;AC9BP;;;;;AA+BO,IAAMe,aAAa,GAAA,aAAiC,KAAK,CAACtP,IAAN,CAAW,UAAA,KAAK,EAAA;;EACvE,IACeuP,iBADf,GAUIrP,KAVJ,CACIwD,SADJ;IAEI5K,IAFJ,GAUIoH,KAVJ,CAEIpH,IAFJ;IAGI/H,OAHJ,GAUImP,KAVJ,CAGInP,OAHJ;IAIIyd,MAJJ,GAUItO,KAVJ,CAIIsO,MAJJ;IAKIhgB,IALJ,GAUI0R,KAVJ,CAKI1R,IALJ;IAMIE,QANJ,GAUIwR,KAVJ,CAMIxR,QANJ;IAOI2Y,OAPJ,GAUInH,KAVJ,CAOImH,OAPJ;IAQID,QARJ,GAUIlH,KAVJ,CAQIkH,QARJ;IASIoI,QATJ,GAUItP,KAVJ,CASIsP,QATJ;EAWA,IAAMpQ,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAM2N,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EAEA,IAAM3C,aAAa,GACf,IAAI,IAAI5G,QAAR,GACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKgV,SAAS,EAAEhV,QAAQ,GAAG,EAAH,GAAQ0Q,OAAO,CAACqQ;GAAxC,EACI,KAAA,CAAA,aAAA,CAAC3C,UAAD,EAAA;IACIte,IAAI,EAAEA,IAAI,GAAGA,IAAH,GAAU/C,cAAc,CAACikB,YAAAA;IACnCC,UAAU,EAAE;GAFhB,CADJ,CADJ,GAOI,IARR;EAUA,IAAMjM,SAAS,GAAGpE,CAAC,EAAA,EAAA,GAAA,CAAA,CAAA,EAAA,EAAA,CACdiQ,iBADc,IAAA,IAAA,GACdA,iBADc,GACO,EADP,CAAA,GACY,IADZ,EAAA,EAAA,CAEdnQ,OAAO,CAACwQ,UAFM,CAAA,GAEO,IAFP,EAAA,EAAA,CAGdxQ,OAAO,CAACyQ,cAHM,CAAA,GAGWnhB,QAHX,EAAA,EAAA,CAId0Q,OAAO,CAAC0Q,YAJM,CAAA,GAIS,CAAC,CAACtB,MAJX,EAAA,EAAA,EAAnB;EAMA,OACI,KAAA,CAAA,aAAA,CAACuB,MAAD,EAAA;IACIrM,SAAS,EAAEA,SAAAA;IACX2D,OAAO,EAAEA,OAAAA;IACTrS,KAAK,EAAEjE,OAAO,GAAGA,OAAH,GAAa+H,IAAAA;IAC3BsO,QAAQ,EAAEA,QAAQ,IAAI,CAACC;GAJ3B,EAMK/R,aANL,EAOKwD,IAAI,IAAI,CAACpK,QAAToK,IAAqBuH,KAAAA,CAAAA,aAAAA,CAAAA,MAAAA,EAAAA,IAAAA,EAAOvH,IAAPuH,CAP1B,EAQKmP,QAAQ,IACL,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK9L,SAAS,EAAEtE,OAAO,CAAC4Q;GAAxB,EACI,KAAA,CAAA,aAAA,CAAClD,UAAD,EAAA;IACIte,IAAI,EAAEA,IAAI,GAAGA,IAAH,GAAU/C,cAAc,CAAC+jB,QAAAA;IACnCG,UAAU,EAAE;GAFhB,CADJ,CATR,CADJ;AAmBH,CAlD0D,CAApD;AAoDP,IAAMxQ,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/CoR,UAAU,EAAE;MACR5T,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf,CADX;MAERiU,aAAa,EAAE5Q,SAAS,CAAC,MAAD,CAFhB;MAGR6Q,aAAa,EAAE7Q,SAAS,CAAC,CAAD,CAHhB;MAIRoM,QAAQ,EAAEpM,SAAS,CAAC,MAAD,CAJX;MAKRtD,UAAU,EAAE6C,KAAK,CAAC5V,OAAN4V,CAAc7C,UALlB;MAMRqG,MAAM,EAAExD,KAAK,CAAC5V,OAAN4V,CAActhB,IANd;MAOR6yB,aAAa,EAAE9Q,SAAS,CAAC,CAAD,CAPhB;MAQR+Q,UAAU,EAAE/Q,SAAS,CAAC,CAAD;IARb,CADmC;IAW/CoQ,YAAY,EAAE;MACVY,WAAW,EAAE;IADH,CAXiC;IAc/CR,cAAc,EAAE;MACZ1N,KAAK,EAAEvD,KAAK,CAAC5V,OAAN4V,CAActhB,IADT;MAEZioB,SAAS,EAAE;IAFC,CAd+B;IAkB/CyK,YAAY,EAAE;MACVhU,QAAQ,EAAE,OADA;MAEVsU,UAAU,EAAE,CAFF;MAGVC,SAAS,EAAE;IAHD,CAlBiC;IAuB/CT,YAAY,EAAE;MACV7L,KAAK,EAAE5E,SAAS,CAACT,KAAK,CAACxD,MAANwD,CAAalD,UAAd;IADN;EAvBiC,CAAL;AAAA,CAAN,CAAxC;AAgCO,IAAM8U,kBAAkB,GAAA,aAAsC,KAAK,CAACxQ,IAAN,CACjE,UAAA,KAAK,EAAA;EACD,IAAQphB,YAAR,GAAyBshB,KAAzB,CAAQthB,YAAR;EAEA,IAAMoC,MAAM,GAAGsT,gBAAgB,CAAC3V,oBAAD,EAAuBC,YAAvB,CAA/B;EACA,IAAM6xB,aAAa,GAAGtC,oBAAoB,CAACvvB,YAAD,CAA1C;EACA,IAAA,mBAAA,GAAmCwvB,kBAAkB,CAACxvB,YAAD,CAArD;IAAQ4P,IAAR,GAAA,mBAAA,CAAQA,IAAR;IAAcggB,MAAd,GAAA,mBAAA,CAAcA,MAAd;IAAsBpH,QAAtB,GAAA,mBAAA,CAAsBA,QAAtB;EACA,IAAA,qBAAA,GAAsC5Q,6BAA6B,CAACxV,MAAD,CAAnE;IAAQyV,UAAR,GAAA,qBAAA,CAAQA,UAAR;IAAoBC,aAApB,GAAA,qBAAA,CAAoBA,aAApB;EAEA,IAAI,CAAC1V,MAAL,EAAa,OAAO,IAAP;EACb,IAAQ+H,MAAR,GAAmB/H,MAAnB,CAAQ+H,MAAR;EACA,IAAI,CAACA,MAAL,EAAa,OAAO,IAAP;EACb,IAAI/H,MAAM,CAACmuB,gBAAPnuB,KAA4BvF,SAA5BuF,IAAyCA,MAAM,CAACmuB,gBAAPnuB,EAAAA,KAA8BktB,qBAAqB,CAACwC,MAAjG,EAAyG,OAAO,IAAP;EAEzG,OACI,KAAA,CAAA,aAAA,CAACpB,aAAD,EAAA;IACIxW,IAAI,EAAErC,UAAAA;IACN1F,OAAO,EAAE2F,aAAAA;IACTlI,IAAI,EAAEA,IAAAA;IACNE,QAAQ,EAAE3F,MAAM,CAAC2F,QAAAA;IACjB8f,MAAM,EAAEA,MAAAA;IACRnH,OAAO,EAAEoJ,aAAAA;IACTrJ,QAAQ,EAAEA;GAPd,CADJ;AAWH,CAzBgE,CAA9D;;ACnHP;;;;;AAuBO,IAAMuJ,iBAAiB,GAAA,aAAqC,KAAK,CAAC3Q,IAAN,CAC/D,UAAA,IAAA,EAAA;;MAAG4Q,KAAAA,GAAAA,IAAAA,CAAAA,KAAAA;IAAOl3B,OAAAA,GAAAA,IAAAA,CAAAA,OAAAA;IAASuD,IAAAA,GAAAA,IAAAA,CAAAA,IAAAA;EACf,IAAQ1C,IAAR,GAAoC0C,IAApC,CAAQ1C,IAAR;IAAc6sB,QAAd,GAAoCnqB,IAApC,CAAcmqB,QAAd;IAAwBC,OAAxB,GAAoCpqB,IAApC,CAAwBoqB,OAAxB;EACA,IAAA,YAAA,GAAwCsB,WAAW,CAAC;MAChDpuB,IAAI,EAAJA,IADgD;MAEhDquB,gBAAgB,EAAE,CAACruB,IAAD,IAASb;IAFqB,CAAD,CAAnD;IAAQ+vB,SAAR,GAAA,YAAA,CAAQA,SAAR;IAAmBE,UAAnB,GAAA,YAAA,CAAmBA,UAAnB;IAA+BC,IAA/B,GAAA,YAAA,CAA+BA,IAA/B;EAIA,IAAMG,QAAQ,GAAG3T,OAAO,CACpB,YAAA;IAAA,OAAO;MACHqT,SAAS,EAATA,SADG;MAEHE,UAAU,EAAVA,UAFG;MAGHvB,aAAa,EAAE;IAHZ,CAAP;EAAA,CADoB,EAMpB,CAACuB,UAAD,EAAaF,SAAb,CANoB,CAAxB;EAQAO,eAAe,CAACzvB,IAAD,EAAOwvB,QAAP,CAAfC;EACA,IAAMsC,WAAW,GAAGD,UAAU,CAACtC,QAAD,CAA9B;EACA,IAAM+C,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EAEA,IAAMmH,OAAO,GAAGD,WAAS,CAAC4K,QAAD,CAAzB;EACA,IAAMrG,SAAS,GAAGpE,CAAC,EAAA,EAAA,GAAA,CAAA,CAAA,EAAA,EAAA,CACdF,OAAO,CAACyR,cADM,CAAA,GACW,IADX,EAAA,EAAA,CAEdzR,OAAO,CAAC0R,kBAFM,CAAA,GAEe1J,QAFf,EAAA,EAAA,CAGdhI,OAAO,CAAC2R,iBAHM,CAAA,GAGcr3B,OAHd,EAAA,EAAA,EAAnB;EAKA,IAAMof,IAAI,GAAGve,IAAI,GAAGA,IAAI,CAAC4C,IAAR,GAAe,YAAhC;EACA,IAAMqR,IAAI,GACNoiB,KAAK,IAAI,CAAA,IAAI,IAAA,IAAJ,GAAA,KAAA,CAAA,GAAA,IAAI,CAAEI,eAAN,MAA0Bv1B,SAAnCm1B,GACMnlB,cAAc,CAACuP,MADrB4V,GAEMr2B,IAFNq2B,IAAAA,IAAAA,GAAAA,KAAAA,CAAAA,GAEMr2B,IAAI,CAAEy2B,eAHhB;EAKA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKtN,SAAS,EAAEtE,OAAO,CAAC6R,eAAAA;IAAiBr3B,GAAG,EAAEW,IAAI,GAAGqvB,IAAH,GAAU;GAA5D,EACKrvB,IAAI,IAAI+xB,WAAR/xB,IACG,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKmpB,SAAS,EAAEtE,OAAO,CAAC8R;GAAxB,EACI,KAAA,CAAA,aAAA,CAACpE,UAAD,EAAA;IAAYte,IAAI,EAAE8d,WAAAA;IAAaqD,UAAU,EAAE;GAA3C,CADJ,CAFR,EAMI,KAAA,CAAA,aAAA,CAACL,aAAD,EAAA;IACI9gB,IAAI,EAAEA,IAAAA;IACNkV,SAAS,EAAEA,SAAAA;IACX5K,IAAI,EAAEA,IAAAA;IACNsO,QAAQ,EAAEA,QAAAA;IACVC,OAAO,EAAEA;GALb,CANJ,CADJ;AAgBH,CA/C8D,CAA5D;AAkDP,IAAMlI,WAAS,GAAA,aAAGd,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC9C4S,eAAe,EAAE;MACbnP,QAAQ,EAAE;IADG,CAD6B;IAI9C+O,cAAc,EAAE;MACZ5M,KAAK,EAAE,SAAA,KAAA,CAAC8F,QAAD,EAAA;QACH,IAAI9F,KAAK,GAAGrF,KAAK,CAACiF,OAANjF,CAAc9F,IAAd8F,CAAmBsF,OAA/B;QACA,IAAI6F,QAAQ,CAACN,SAAb,EAAwB;UACpBxF,KAAK,GAAG8F,QAAQ,CAACJ,UAATI,GACFnL,KAAK,CAAC1C,GAAN0C,CAAUzC,YADR4N,GAEFnL,KAAK,CAAC1C,GAAN0C,CAAUxC,eAFhB6H;QAGH;QACD,OAAO5E,SAAS,CAAC4E,KAAD,CAAhB;MACH;IATW,CAJ8B;IAe9C6M,kBAAkB,EAAE;MAChB;MACA;MACA7M,KAAK,EAAE,SAAA,KAAA,CAAA,EAAA;QAAA,OAAM5E,SAAS,CAACT,KAAK,CAACiF,OAANjF,CAAc9F,IAAd8F,CAAmBwI,QAApB,CAAf;MAAA;IAHS,CAf0B;IAoB9C2J,iBAAiB,EAAE;MACfI,cAAc,EAAE9R,SAAS,CAAC,WAAD;IADV,CApB2B;IAuB9C6R,YAAY,EAAE;MACVjN,KAAK,EAAE,SAAA,KAAA,CAAC8F,QAAD,EAAA;QAAA,OACHA,QAAQ,CAACJ,UAATI,GAAsBnL,KAAK,CAAC1C,GAAN0C,CAAUzC,YAAhC4N,GAA+CnL,KAAK,CAAC1C,GAAN0C,CAAUxC,eADtD;MAAA,CADG;MAGV2H,eAAe,EAAE,SAAA,eAAA,CAACgG,QAAD,EAAA;QAAA,OACbA,QAAQ,CAACJ,UAATI,GAAsBnL,KAAK,CAAC1C,GAAN0C,CAAUvC,WAAhC0N,GAA8CnL,KAAK,CAAC1C,GAAN0C,CAAUtC,cAD3C;MAAA,CAHP;MAKVP,UAAU,EAAA,OAAA,GAAU6C,KAAK,CAAC5V,OAAN4V,CAAc7C,UAAxB,GAAA,SALA;MAMV6G,SAAS,EAAE,mCAND;MAOV9F,YAAY,EAAE8B,KAAK,CAAC5V,OAAN4V,CAAc3C,YAPlB;MAQVmG,MAAM,EAAExD,KAAK,CAAC5V,OAAN4V,CAActhB,IAAdshB,GAAqB,CARnB;MASVuD,KAAK,EAAEvD,KAAK,CAAC5V,OAAN4V,CAActhB,IAAdshB,GAAqB,CATlB;MAUV0G,SAAS,EAAE,YAVD;MAWVxD,QAAQ,EAAE,UAXA;MAYVyD,SAAS,EAAE,QAZD;MAaVtD,IAAI,EAAE,KAbI;MAcVC,GAAG,EAAE,KAdK;MAeVF,MAAM,EAAE;IAfE;EAvBgC,CAAL;AAAA,CAAN,CAAvC;;ACzEA;;;;;AAMA,IAYaoP,UAAU,GAAA,aAA8B,KAAK,CAACpR,IAAN,CAAW,YAAA;EAC5D,IAAMZ,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAM+H,gBAAgB,GAAGD,mBAAmB,EAA5C;EAEA,IAAMoK,qBAAqB,GAAGjb,OAAO,CAAC,YAAA;IAClC,IAAMkb,UAAU,GAAmB,EAAnC;IACA,KAAK,IAAIv0B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmqB,gBAAgB,CAAClqB,MAArC,EAA6C,EAAED,CAA/C,EAAkD;MAC9C,IAAM2Y,GAAG,GAAA,eAAA,GAAmB3Y,CAA5B;MACA,IAAMw0B,SAAS,GACX,KAAA,CAAA,aAAA,CAACZ,iBAAD,EAAA;QACIjb,GAAG,EAAEA,GAAAA;QACLkb,KAAK,EAAE7zB,CAAC,KAAK,CAAA;QACbrD,OAAO,EAAEqD,CAAC,KAAKmqB,gBAAgB,CAAClqB,MAAjBkqB,GAA0B,CAAA;QACzCjqB,IAAI,EAAEiqB,gBAAgB,CAACnqB,CAAD;OAJ1B,CADJ;MAQAu0B,UAAU,CAAC70B,IAAX60B,CAAgBC,SAAhBD,CAAAA;IACH;IACD,OAAOA,UAAP;EACH,CAfoC,EAelC,CAACpK,gBAAD,CAfkC,CAArC;EAiBA,OACI,KAAA,CAAA,aAAA,CAACnC,GAAD,EAAA;IAAKrB,SAAS,EAAEtE,OAAO,CAACoS;GAAxB,EACI,KAAA,CAAA,aAAA,CAACzM,GAAD,EAAA;IAAKrB,SAAS,EAAEtE,OAAO,CAACqS;GAAxB,EACI,KAAA,CAAA,aAAA,CAACjB,kBAAD,EAAA;IAAoB5xB,YAAY,EAAE0J,aAAa,CAACC,gBAAdD,CAA+BpL;GAAjE,CADJ,EAEI,KAAA,CAAA,aAAA,CAACw0B,WAAD,EAAA;IACIhO,SAAS,EAAEtE,OAAO,CAACuS,iBAAAA;IACnBvS,OAAO,EAAE;MAAEwS,SAAS,EAAExS,OAAO,CAACwS;IAArB;GAFb,EAIKP,qBAJL,CAFJ,CADJ,CADJ;AAaH,CAlCoD,CAA9C;AAoCP,IAAMlS,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/CgT,aAAa,EAAE;MACXrB,aAAa,EAAEvR,KAAK,CAAC/C,OAAN+C,CAAc9C;IADlB,CADgC;IAI/C2V,eAAe,EAAE;MACbhP,OAAO,EAAE;IADI,CAJ8B;IAO/CoP,iBAAiB,EAAE;MACf7V,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf,CADJ;MAEfoG,MAAM,EAAExD,KAAK,CAAC5V,OAAN4V,CAActhB,IAFP;MAGf6kB,KAAK,EAAEvD,KAAK,CAAC5V,OAAN4V,CAActhB,IAHN;MAIfuf,OAAO,EAAE;IAJM,CAP4B;IAa/C8U,iBAAiB,EAAE;MACf3V,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf,CADJ;MAEf8V,QAAQ,EAAE;IAFK,CAb4B;IAiB/CF,SAAS,EAAE;MACPvB,WAAW,EAAEhR,SAAS,CAAC,CAAD,CADf;MAEPiR,UAAU,EAAEjR,SAAS,CAAC,CAAD;IAFd;EAjBoC,CAAL;AAAA,CAAN,CAAxC;;ACtDA;;;;;AA6BO,IAAM0S,qBAAqB,GAAA,aAAG,KAAK,CAAC9R,UAAN,CACjC,UAACC,KAAD,EAAoCtmB,GAApC,EAAA;;EACI,IAAQkf,IAAR,GAAkDoH,KAAlD,CAAQpH,IAAR;IAAc0V,MAAd,GAAkDtO,KAAlD,CAAcsO,MAAd;IAAsBhgB,IAAtB,GAAkD0R,KAAlD,CAAsB1R,IAAtB;IAA4B6Y,OAA5B,GAAkDnH,KAAlD,CAA4BmH,OAA5B;IAAqCD,QAArC,GAAkDlH,KAAlD,CAAqCkH,QAArC;EACA,IAAMhI,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAM2N,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EAEA,IAAMyL,SAAS,GAAGpE,CAAC,EAAA,EAAA,GAAA,CAAA,CAAA,EAAA,EAAA,CACdF,OAAO,CAACwQ,UADM,CAAA,GACO,IADP,EAAA,EAAA,CAEdxQ,OAAO,CAAC0Q,YAFM,CAAA,GAEStB,MAFT,EAAA,EAAA,EAAnB;EAIA,OACI,KAAA,CAAA,aAAA,CAACwD,QAAD,EAAA;IACIp4B,GAAG,EAAEA,GAAAA;IACL8pB,SAAS,EAAEA,SAAAA;IACX2D,OAAO,EAAEA,OAAAA;IACTD,QAAQ,EAAEA;GAJd,EAMK5Y,IAAI,IACD,KAAA,CAAA,aAAA,CAACyjB,YAAD,EAAA;IAAcvO,SAAS,EAAEtE,OAAO,CAAC5Q;GAAjC,EACI,KAAA,CAAA,aAAA,CAACse,UAAD,EAAA;IAAYte,IAAI,EAAEA,IAAAA;IAAMmhB,UAAU,EAAE;GAApC,CADJ,CAPR,EAWI,KAAA,CAAA,aAAA,CAACuC,YAAD,EAAA;IAAcC,sBAAsB,EAAE;MAAEzO,SAAS,EAAEtE,OAAO,CAACtG;IAArB;GAAtC,EACKA,IADL,CAXJ,CADJ;AAiBH,CA3BgC,CAA9B;AA8BP,IAAMqG,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/CoR,UAAU,EAAE;MACR7T,UAAU,EAAEsD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc7C,UAAf,CADb;MAERqG,MAAM,EAAE/C,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAActhB,IAAf,CAFT;MAGR80B,SAAS,EAAE/S,SAAS,CAAC,MAAD,CAHZ;MAIRoM,QAAQ,EAAEpM,SAAS,CAAC,MAAD,CAJX;MAKRxC,OAAO,EAAEwC,SAAS,CAAC,EAAD;IALV,CADmC;IAQ/C7Q,IAAI,EAAE;MACFwN,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf,CADjB;MAEFyP,QAAQ,EAAEpM,SAAS,CAAC,MAAD,CAFjB;MAGF4E,KAAK,EAAE5E,SAAS,CAAC,SAAD,CAHd;MAIFgR,WAAW,EAAE;IAJX,CARyC;IAc/CvX,IAAI,EAAE;MACFkD,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf;IADjB,CAdyC;IAiB/C8T,YAAY,EAAE;MACV7L,KAAK,EAAE5E,SAAS,CAACT,KAAK,CAACxD,MAANwD,CAAalD,UAAd;IADN;EAjBiC,CAAL;AAAA,CAAN,CAAxC;AA2BO,IAAM2W,0BAA0B,GAAA,aAAG,KAAK,CAACpS,UAAN,CACtC,UAACC,KAAD,EAAyCtmB,GAAzC,EAAA;EACI,IAAQgF,YAAR,GAA0CshB,KAA1C,CAAQthB,YAAR;IAAsB0zB,eAAtB,GAA0CpS,KAA1C,CAAsBoS,eAAtB;EAEA,IAAMtxB,MAAM,GAAGsT,gBAAgB,CAAC3V,oBAAD,EAAuBC,YAAvB,CAA/B;EACA,IAAM6xB,aAAa,GAAGtC,oBAAoB,CAACvvB,YAAD,CAA1C;EACA,IAAA,mBAAA,GAAmCwvB,kBAAkB,CAACxvB,YAAD,CAArD;IAAQ4P,IAAR,GAAA,mBAAA,CAAQA,IAAR;IAAcggB,MAAd,GAAA,mBAAA,CAAcA,MAAd;IAAsBpH,QAAtB,GAAA,mBAAA,CAAsBA,QAAtB;EACA,IAAA,qBAAA,GAAuB5Q,6BAA6B,CAACxV,MAAD,CAApD;IAAQyV,UAAR,GAAA,qBAAA,CAAQA,UAAR,CAAA,CAAA;;EAGA,IAAM8b,WAAW,GAAG9d,WAAW,CAAC,YAAA;IAC5Bgc,aAAa,EAAA;IACb,IAAI6B,eAAJ,EAAqBA,eAAe,EAAA;EACvC,CAH8B,EAG5B,CAACA,eAAD,EAAkB7B,aAAlB,CAH4B,CAA/B;EAKA,IAAI,CAACzvB,MAAL,EAAa,OAAO,IAAP;EACb,IAAQ+H,MAAR,GAAmB/H,MAAnB,CAAQ+H,MAAR;EACA,IAAI,CAACA,MAAL,EAAa,OAAO,IAAP;EACb,IAAI/H,MAAM,CAACmuB,gBAAPnuB,KAA4BvF,SAA5BuF,IAAyCA,MAAM,CAACmuB,gBAAPnuB,EAAAA,KAA8BktB,qBAAqB,CAACwC,MAAjG,EAAyG,OAAO,IAAP;EAEzG,OACI,KAAA,CAAA,aAAA,CAACqB,qBAAD,EAAA;IACIn4B,GAAG,EAAEA,GAAAA;IACLkf,IAAI,EAAErC,UAAAA;IACNjI,IAAI,EAAEA,IAAAA;IACN6Y,OAAO,EAAEkL,WAAAA;IACT/D,MAAM,EAAEA,MAAAA;IACRpH,QAAQ,EAAEA;GANd,CADJ;AAUH,CA9BqC,CAAnC;;ACtFP;;;;;AAiBO,IAAMoL,eAAe,GAAA,aAAmC,KAAK,CAACxS,IAAN,CAAW,UAAA,KAAK,EAAA;EAC3E,IAAQ7iB,IAAR,GAAgC+iB,KAAhC,CAAQ/iB,IAAR;IAAcuB,aAAd,GAAgCwhB,KAAhC,CAAcxhB,aAAd;EACA,IAAA,eAAA,GAA4B2hB,KAAK,CAACrnB,QAANqnB,CAAmC,IAAnCA,CAA5B;IAAOoS,MAAP,GAAA,eAAA,CAAA,CAAA,CAAA;IAAeC,SAAf,GAAA,eAAA,CAAA,CAAA,CAAA;EAEA,IAAMH,WAAW,GAAG9d,WAAW,CAC3B,UAAC8M,KAAD,EAAA;IAAA,OAAgDmR,SAAS,CAACnR,KAAK,CAACoR,aAAP,CAAzD;EAAA,CAD2B,EAE3B,CAACD,SAAD,CAF2B,CAA/B;EAIA,IAAME,WAAW,GAAGne,WAAW,CAAC,YAAA;IAAA,OAAMie,SAAS,CAAC,IAAD,CAAf;EAAA,CAAD,EAAwB,CAACA,SAAD,CAAxB,CAA/B;EAEA,IAAMG,kBAAkB,GAAGzc,OAAO,CAC9B,YAAA;IAAA,OACI,aAAa,CAACtV,GAAd,CAAkB,UAAA,EAAE,EAAA;MAAA,OAChB,KAAA,CAAA,aAAA,CAACuxB,0BAAD,EAAA;QACI3c,GAAG,EAAA,YAAA,GAAexY,EAAAA;QAClB0B,YAAY,EAAE1B,EAAAA;QACdo1B,eAAe,EAAEM;OAHrB,CADgB;IAAA,CAApB,CADJ;EAAA,CAD8B,EAS9B,CAACl0B,aAAD,EAAgBk0B,WAAhB,CAT8B,CAAlC;EAYA,IAAME,aAAa,GAAG7c,2BAA2B,CAAC9Y,IAAD,CAAjD;EACA,IAAMiiB,OAAO,GAAGD,WAAS,EAAzB;EACA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,EAAA,IAAA,EACI,KAAA,CAAA,aAAA,CAACmQ,aAAD,EAAA;IAAexW,IAAI,EAAEga,aAAAA;IAAezL,OAAO,EAAEkL,WAAAA;IAAa/C,QAAQ,EAAE;GAApE,CADJ,EAEI,KAAA,CAAA,aAAA,CAACuD,IAAD,EAAA;IACIC,SAAS,EAAA,IAAA;IACTC,WAAW,EAAA,IAAA;IACXC,SAAS,EAAE,CAAA;IACXC,QAAQ,EAAEV,MAAAA;IACVW,OAAO,EAAER,WAAAA;IACTS,IAAI,EAAEC,OAAO,CAACb,MAAD,CAAA;IACbc,kBAAkB,EAAE,GAAA;IACpBnU,OAAO,EAAE;MAAExP,IAAI,EAAEwP,OAAO,CAACoU;IAAhB;GARb,EAUKX,kBAVL,CAFJ,CADJ;AAiBH,CAzC8D,CAAxD;AA2CP,IAAM1T,WAAS,GAAA,aAAGX,sBAAsB,CAAC,YAAA;EAAA,OAAO;IAC5CgV,YAAY,EAAE;MACVrD,aAAa,EAAE9Q,SAAS,CAAC,CAAD,CADd;MAEV+Q,UAAU,EAAE/Q,SAAS,CAAC,CAAD;IAFX;EAD8B,CAAP;AAAA,CAAD,CAAxC;;AC5DA;;;;;AAkBO,IAAMoU,WAAW,GAAA,aAA+B,KAAK,CAACzT,IAAN,CAAW,YAAA;EAC9D,IAAMZ,OAAO,GAAGD,WAAS,EAAzB;EAEA,IAAMnZ,cAAc,GAAG0O,WAAW,CAACxO,SAAS,CAACL,iBAAX,CAAlC;EACA,IAAM2d,aAAa,GAAG9O,WAAW,CAAC/T,mBAAD,CAAjC;EACA,IAAM+yB,WAAW,GAAGhf,WAAW,CAACzU,qBAAD,CAA/B;EAEA,IAAMiW,IAAI,GAAGC,OAAO,EAApB;EACA,IAAMwd,eAAe,GAAG,IAAI,CAACtd,aAAL,CACpB;IACInZ,EAAE,EAAE0Y,SAAS,CAACD,aAAa,CAACie,OAAf,EAAwB,kBAAxB,CADjB;IAEIrd,cAAc,EAAA;EAFlB,CADoB,EASpB;IAAEsd,SAAS,EAAE7tB,cAAc,CAAChJ;EAA5B,CAToB,CAAxB;EAWA,IAAM82B,cAAc,GAAG,IAAI,CAACzd,aAAL,CACnB;IACInZ,EAAE,EAAE0Y,SAAS,CAACD,aAAa,CAACie,OAAf,EAAwB,mBAAxB,CADjB;IAEIrd,cAAc,EAAA;EAFlB,CADmB,EAQnB;IAAEsd,SAAS,EAAErQ;EAAb,CARmB,CAAvB;EAUA,IAAMuQ,YAAY,GAAG,IAAI,CAAC1d,aAAL,CACjB;IACInZ,EAAE,EAAE0Y,SAAS,CAACD,aAAa,CAACie,OAAf,EAAwB,iBAAxB,CADjB;IAEIrd,cAAc,EAAA;EAFlB,CADiB,EAQjB;IAAEsd,SAAS,EAAEH;EAAb,CARiB,CAArB;EAWA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKhQ,SAAS,EAAEtE,OAAO,CAAC4U;GAAxB,EACI,KAAA,CAAA,aAAA,CAACC,UAAD,EAAA;IAAYvQ,SAAS,EAAEtE,OAAO,CAAC8U,QAAAA;IAAUC,OAAO,EAAC;GAAjD,EACKR,eADL,EAEK,CAACG,cAAc,IAAIC,YAAnB,KACG,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;IAAMrQ,SAAS,EAAEtE,OAAO,CAACgV;GAAzB,EAAA,GAAA,EAEI,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;IAAM1Q,SAAS,EAAEtE,OAAO,CAACiV;GAAzB,EACKP,cADL,CAFJ,EAKKA,cAAc,IAAIC,YAAlBD,IAAkC,IALvC,EAMI,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;IAAMpQ,SAAS,EAAEtE,OAAO,CAACkV;GAAzB,EAA2CP,YAA3C,CANJ,EAAA,GAAA,CAHR,CADJ,CADJ;AAiBH,CAzDsD,CAAhD;AA2DP,IAAM5U,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/CwV,aAAa,EAAE;MACX5R,MAAM,EAAExD,KAAK,CAAC5V,OAAN4V,CAActhB,IADX;MAEXmlB,OAAO,EAAE;IAFE,CADgC;IAK/CyR,QAAQ,EAAE;MACNnY,UAAU,EAAEsD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc7C,UAAf,CADf;MAENC,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf,CAFb;MAGNsU,UAAU,EAAEjR,SAAS,CAAC,EAAD,CAHf;MAIN+C,MAAM,EAAExD,KAAK,CAAC5V,OAAN4V,CAActhB;IAJhB,CALqC;IAW/C82B,aAAa,EAAE;MACX/D,WAAW,EAAEhR,SAAS,CAAC,CAAD,CADX;MAEXiR,UAAU,EAAEjR,SAAS,CAAC,CAAD,CAFV;MAGX4L,OAAO,EAAE;IAHE,CAXgC;IAgB/CoJ,iBAAiB,EAAE;MACfpQ,KAAK,EAAErF,KAAK,CAACxD,MAANwD,CAAalD;IADL,CAhB4B;IAmB/C4Y,eAAe,EAAE,CAAA;EAnB8B,CAAL;AAAA,CAAN,CAAxC;;AC7EA;;;;;AAuBO,IAAMC,aAAa,GAAA,aAAiC,KAAK,CAACvU,IAAN,CAAW,YAAA;EAClE,IAAM9J,IAAI,GAAGC,OAAO,EAApB;EACA,IAAMqe,uBAAuB,GAAG,IAAI,CAACne,aAAL,CAAmB;IAC/CnZ,EAAE,EAAE0Y,SAAS,CAACD,aAAa,CAACie,OAAf,EAAwB,mBAAxB,CADkC;IAE/Crd,cAAc,EAAE;EAF+B,CAAnB,CAAhC;EAKA,IAAM6I,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAM2N,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EAEA,IAAMwc,cAAc,GAAGh7B,MAAM,EAA7B;EAEA,IAAMqO,QAAQ,GAAG+M,WAAW,EAA5B;EACA,IAAM6f,iBAAiB,GAAGhgB,WAAW,CAACpU,kBAAD,CAArC;EAEA,IAAA,SAAA,GAAkDtH,QAAQ,CAAC07B,iBAAD,CAA1D;IAAOC,iBAAP,GAAA,SAAA,CAAA,CAAA,CAAA;IAA0BC,oBAA1B,GAAA,SAAA,CAAA,CAAA,CAAA;EACA,IAAA,YAAA,GAAqCj8B,WAAW,CAACg8B,iBAAD,EAAoB,GAApB,CAAhD;IAAOE,0BAAP,GAAA,YAAA,CAAA,CAAA,CAAA;EACA,IAAA,UAAA,GAAwD77B,QAAQ,CAAC,KAAD,CAAhE;IAAO87B,oBAAP,GAAA,UAAA,CAAA,CAAA,CAAA;IAA6BC,uBAA7B,GAAA,UAAA,CAAA,CAAA,CAAA;EAEA97B,SAAS,CAAC,YAAA;IACN6O,QAAQ,CACJ,YAAY,CAACsK,mBAAb,CAAiC,YAAA;MAC7B,IAAIqiB,cAAc,CAAC/6B,OAAnB,EAA4B+6B,cAAc,CAAC/6B,OAAf+6B,CAAuBO,KAAvBP,EAAAA;IAC/B,CAFD,CADI,CAAR3sB;IAKA,OAAO,YAAA;MACHA,QAAQ,CAACC,YAAY,CAACqK,mBAAbrK,CAAiC,IAAjCA,CAAD,CAARD;IACH,CAFD;EAGH,CATQ,EASN,CAACA,QAAD,CATM,CAAT7O;EAWAA,SAAS,CAAC,YAAA;IACN87B,uBAAuB,CAAC,KAAD,CAAvBA;IACAjtB,QAAQ,CAACC,YAAY,CAACsK,eAAbtK,CAA6B8sB,0BAA7B9sB,CAAD,CAARD;EACH,CAHQ,EAGN,CAAC+sB,0BAAD,EAA6B/sB,QAA7B,CAHM,CAAT7O;EAKA,IAAMg8B,YAAY,GAAGxgB,WAAW,CAAC,UAAC8M,KAAD,EAAA;IAC7BwT,uBAAuB,CAAC,IAAD,CAAvBA;IACAH,oBAAoB,CAACrT,KAAK,CAACoR,aAANpR,CAAoB3oB,KAArB,CAApBg8B;EACH,CAH+B,EAG7B,EAH6B,CAAhC;EAIA,IAAMM,WAAW,GAAGzgB,WAAW,CAC3B,UAAC8M,KAAD,EAAA;IACI;IACA;IACA;IACA;IACA,IAAIA,KAAK,CAAC7L,GAAN6L,KAAc,QAAlB,EAA4B;MACxBqT,oBAAoB,CAAC,EAAD,CAApBA;MACA9sB,QAAQ,CAACC,YAAY,CAACsK,eAAbtK,CAA6B,EAA7BA,CAAD,CAARD;MACA,IAAI2sB,cAAc,CAAC/6B,OAAnB,EAA4B+6B,cAAc,CAAC/6B,OAAf+6B,CAAuBU,IAAvBV,EAAAA;IAC/B;EACJ,CAX0B,EAY3B,CAAC3sB,QAAD,CAZ2B,CAA/B;EAeA,OACI,KAAA,CAAA,aAAA,CAACstB,SAAD,EAAA;IACI1R,SAAS,EAAEtE,OAAO,CAACiW,oBAAAA;IACnB/3B,IAAI,EAAC,OAAA;IACL62B,OAAO,EAAC,UAAA;IACRv7B,KAAK,EAAE+7B,iBAAAA;IACPhG,WAAW,EAAE6F,uBAAAA;IACbc,QAAQ,EAAEL,YAAAA;IACVM,QAAQ,EAAEd,cAAAA;IACVe,UAAU,EAAE;MACRC,OAAO,EAAEP,WADD;MAERQ,cAAc,EACV,KAAA,CAAA,aAAA,CAACC,cAAD,EAAA;QAAgBjS,SAAS,EAAEtE,OAAO,CAACwW,UAAAA;QAAY9T,QAAQ,EAAC;OAAxD,EACI,KAAA,CAAA,aAAA,CAACgL,UAAD,EAAA;QACIte,IAAI,EAAEsmB,oBAAoB,GAAGrpB,cAAc,CAACsP,OAAlB,GAA4BtP,cAAc,CAACnG,MAAAA;QACrEuwB,IAAI,EAAEf;OAFV,CADJ,CAHI;MAURpR,SAAS,EAAEtE,OAAO,CAAC0W;IAVX,CAAA;IAYZC,UAAU,EAAE;MAAErS,SAAS,EAAEtE,OAAO,CAAC4W;IAArB;GApBhB,CADJ;AAwBH,CA9E0D,CAApD;AAgFP,IAAM7W,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/C6W,oBAAoB,EAAE;MAClBjT,MAAM,EAAExD,KAAK,CAAC5V,OAAN4V,CAActhB,IADJ;MAElB6kB,KAAK,EAAE;IAFW,CADyB;IAK/CyT,UAAU,EAAE;MACR5Z,QAAQ,EAAE,OADF;MAERiP,OAAO,EAAE;IAFD,CALmC;IAS/C6K,gBAAgB,EAAE;MACd/Z,UAAU,EAAEsD,SAAS,CAAC,CAAD,CADP;MAEdxC,OAAO,EAAEwC,SAAS,CAAC,CAAD,CAFJ;MAGd4W,MAAM,EAAE5W,SAAS,CAAC,CAAD,CAHH;MAIdrD,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf,CAJL;MAKdc,YAAY,EAAE8B,KAAK,CAAC5V,OAAN4V,CAAc3C,YALd;MAMdmG,MAAM,EAAExD,KAAK,CAAC5V,OAAN4V,CAActhB,IAAdshB,GAAqB,CANf;MAOdsX,WAAW,EAAE7W,SAAS,CAAC,CAAD,CAPR;MAQdkR,SAAS,EAAE;IARG,CAT6B;IAmB/CyF,qBAAqB,EAAE;MACnBja,UAAU,EAAEsD,SAAS,CAAIT,KAAK,CAAC5V,OAAN4V,CAActhB,IAAdshB,GAAqB,CAAzB,GAAA,IAAA,CADF;MAEnB5C,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAAc5C,QAAf,CAFA;MAGnBoG,MAAM,EAAE/C,SAAS,CAACT,KAAK,CAAC5V,OAAN4V,CAActhB,IAAdshB,GAAqB,CAAtB,CAHE;MAInB/B,OAAO,EAAEwC,SAAS,CAAC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAD,CAJC;MAKnB4W,MAAM,EAAE5W,SAAS,CAAC,CAAD,CALE;MAMnB,oBAAA,EAAsB;IANH;EAnBwB,CAAL;AAAA,CAAN,CAAxC;IC3Fa8W,WAAW,GAAA,aAA+B,KAAK,CAACnW,IAAN,CAAW,YAAA;EAC9D,IAAMZ,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAMrgB,YAAY,GAAG4V,WAAW,CAAC7V,kBAAD,CAAhC;EAEA,IAAMu3B,qBAAqB,GAAGhgB,OAAO,CAAC,YAAA;IAClC,IAAMkb,UAAU,GAAmB,EAAnC;IACA,KAAK,IAAIv0B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+B,YAAY,CAAC9B,MAAjC,EAAyC,EAAED,CAA3C,EAA8C;MAC1C,IAAME,IAAI,GAAG6B,YAAY,CAAC/B,CAAD,CAAzB;MAEA,IAAM2Y,GAAG,GAAA,eAAA,IAAmB,OAAOzY,IAAP,KAAgB,QAAhB,GAA2BA,IAA3B,GAAkCA,IAAI,CAACE,IAA1D,CAAT;MACA,IAAMo0B,SAAS,GACX,OAAOt0B,IAAP,KAAgB,QAAhB,GACI,KAAA,CAAA,aAAA,CAACuzB,kBAAD,EAAA;QAAoB9a,GAAG,EAAEA,GAAAA;QAAK9W,YAAY,EAAE3B;OAA5C,CADJ,GAGI,KAAA,CAAA,aAAA,CAACu1B,eAAD,EAAA;QACI9c,GAAG,EAAEA,GAAAA;QACLvY,IAAI,EAAEF,IAAI,CAACE,IAAAA;QACXuB,aAAa,EAAEzB,IAAI,CAACyB;OAHxB,CAJR;MAUA4yB,UAAU,CAAC70B,IAAX60B,CAAgBC,SAAhBD,CAAAA;IACH;IACD,OAAOA,UAAP;EACH,CAnBoC,EAmBlC,CAACxyB,YAAD,CAnBkC,CAArC;EAqBA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK4kB,SAAS,EAAEtE,OAAO,CAACiX;GAAxB,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK3S,SAAS,EAAEtE,OAAO,CAACkX;GAAxB,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK5S,SAAS,EAAEtE,OAAO,CAACmX;GAAxB,EACIlW,KAAAA,CAAAA,aAAAA,CAACkU,aAADlU,EAAAA,IAAAA,CADJ,EAEIA,KAAAA,CAAAA,aAAAA,CAACoT,WAADpT,EAAAA,IAAAA,CAFJ,CADJ,EAKI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKqD,SAAS,EAAEtE,OAAO,CAACoX;GAAxB,EAAuCJ,qBAAvC,CALJ,CADJ,CADJ;AAWH,CApCsD,CAAhD;AAsCP,IAAMjX,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/C6X,cAAc,EAAE,CAAA,CAD+B;IAE/CC,gBAAgB,EAAE;MACdG,QAAQ,EAAE,cADI;MAEdhU,OAAO,EAAE;IAFK,CAF6B;IAM/C8T,WAAW,EAAE;MACTpG,aAAa,EAAEvR,KAAK,CAAC/C,OAAN+C,CAAc9C,gBADpB;MAET2a,QAAQ,EAAE,QAFD;MAGT3E,QAAQ,EAAE,KAHD;MAITrP,OAAO,EAAE;IAJA,CANkC;IAY/CiU,iBAAiB,EAAE;MACf5E,QAAQ,EAAE;IADK,CAZ4B;IAe/C0E,YAAY,EAAE;MACVrG,aAAa,EAAEvR,KAAK,CAAC/C,OAAN+C,CAAc9C,gBADnB;MAEV2a,QAAQ,EAAE,QAFA;MAGVhU,OAAO,EAAE;IAHC;EAfiC,CAAL;AAAA,CAAN,CAAxC;;AClDA;;;;;AAmBO,IAAMkU,aAAa,GAAiC,SAA9CA,aAA8C,CAAA,KAAK,EAAA;EAC5D,IAAQxU,KAAR,GAA0BjC,KAA1B,CAAQiC,KAAR;IAAeC,MAAf,GAA0BlC,KAA1B,CAAekC,MAAf;EACA,IAAMhD,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAM2N,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EACA,IAAMwL,KAAK,GAAkB;IACzBtB,KAAK,EAALA,KADyB;IAEzBC,MAAM,EAANA;EAFyB,CAA7B;EAKA,IAAMlM,IAAI,GAAGC,OAAO,EAApB;EACA,IAAMygB,WAAW,GAAG,IAAI,CAACvgB,aAAL,CAAmB;IACnCnZ,EAAE,EAAE0Y,SAAS,CAACD,aAAa,CAACkhB,QAAf,EAAyB,eAAzB,CADsB;IAEnCtgB,cAAc,EAAE;EAFmB,CAAnB,CAApB;EAKA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKmN,SAAS,EAAEtE,OAAO,CAAC0X,aAAAA;IAAerT,KAAK,EAAEA;GAA9C,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKC,SAAS,EAAEtE,OAAO,CAAC2X;GAAxB,EACI,KAAA,CAAA,aAAA,CAACjK,UAAD,EAAA;IAAYte,IAAI,EAAE/C,cAAc,CAACurB;GAAjC,CADJ,EAAA,OAAA,EAEYJ,WAFZ,CADJ,CADJ;AAQH,CAvBM;AAyBP,IAAMzX,WAAS,GAAA,aAAGX,sBAAsB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC/CsY,aAAa,EAAE;MACX7S,KAAK,EAAErF,KAAK,CAACiF,OAANjF,CAAc9F,IAAd8F,CAAmBwI,QADf;MAEXtF,QAAQ,EAAE,UAFC;MAGXyD,SAAS,EAAE,QAHA;MAIXvJ,QAAQ,EAAE;IAJC,CADgC;IAO/C+a,oBAAoB,EAAE;MAClBnU,SAAS,EAAE,mCADO;MAElBd,QAAQ,EAAE,UAFQ;MAGlBG,IAAI,EAAE,KAHY;MAIlBC,GAAG,EAAE;IAJa;EAPyB,CAAL;AAAA,CAAN,CAAxC;;AC5CA;;;;;AAkBO,IAAM+U,eAAe,GAAG,SAAlBA,eAAkB,CAC3BjJ,aAD2B,EAE3BC,aAF2B,EAAA;EAI3B,IAAM5rB,gBAAgB,GAAGqS,WAAW,CAACtS,sBAAD,CAApC;EAEA,IAAM80B,OAAO,GAAGz9B,MAAM,CAAC;IACnB09B,UAAU,EAAE,CADO;IAEnBC,YAAY,EAAE;EAFK,CAAD,CAAtB;EAKA,OAAO3iB,WAAW,CACd,UAAC8M,KAAD,EAAA;IACI,IAAM8V,eAAe,GAAoB;MACrC7V,MAAM,EAAED,KAAK,CAACC,MADuB;MAErCjU,OAAO,EAAEgU,KAAK,CAAChU,OAANgU,IAAiBA,KAAK,CAAC+V,OAFK;MAGrC1pB,QAAQ,EAAE2T,KAAK,CAAC3T;IAHqB,CAAzC;IAOAspB,OAAO,CAACx9B,OAARw9B,CAAgBC,UAAhBD,EAAAA;IACA,IAAIA,OAAO,CAACx9B,OAARw9B,CAAgBC,UAAhBD,KAA+B,CAAnC,EAAsC;MAClC,IAAIlJ,aAAJ,EAAmB;QACfzM,KAAK,CAACE,cAANF,EAAAA;QACAyM,aAAa,CAACqJ,eAAD,CAAbrJ;MACH;MACDkJ,OAAO,CAACx9B,OAARw9B,CAAgBC,UAAhBD,GAA6B,CAA7BA,CALkC,CAAA;;MAOlCA,OAAO,CAACx9B,OAARw9B,CAAgBE,YAAhBF,GAA+B/9B,UAAU,CACrC,YAAA;QAAA,OAAO+9B,OAAO,CAACx9B,OAARw9B,CAAgBC,UAAhBD,GAA6B,CAApC;MAAA,CADqC,EAErC70B,gBAFqC,CAAzC60B;IAIH,CAXD,MAWO,IAAIA,OAAO,CAACx9B,OAARw9B,CAAgBC,UAAhBD,KAA+B,CAAnC,EAAsC;MACzC,IAAIjJ,aAAJ,EAAmB;QACf1M,KAAK,CAACE,cAANF,EAAAA;QACA0M,aAAa,CAACoJ,eAAD,CAAbpJ;MACH;MACD,IAAI,OAAOiJ,OAAO,CAACx9B,OAARw9B,CAAgBE,YAAvB,KAAwC,QAA5C,EAAsD;QAClDh+B,YAAY,CAAC89B,OAAO,CAACx9B,OAARw9B,CAAgBE,YAAjB,CAAZh+B;QACA89B,OAAO,CAACx9B,OAARw9B,CAAgBE,YAAhBF,GAA+B,IAA/BA;QACAA,OAAO,CAACx9B,OAARw9B,CAAgBC,UAAhBD,GAA6B,CAA7BA;MACH;IACJ;EACJ,CAhCa,EAiCd,CAAC70B,gBAAD,EAAmB2rB,aAAnB,EAAkCC,aAAlC,EAAiDiJ,OAAjD,CAjCc,CAAlB;AAmCH,CA9CM;AAgDA,IAAMK,iBAAiB,GAAG,SAApBA,iBAAoB,CAACxJ,eAAD,EAAA;EAC7B,OAAOtZ,WAAW,CACd,UAAC8M,KAAD,EAAA;IACI,IAAI,CAACwM,eAAL,EAAsB;IAEtB,IAAMyJ,kBAAkB,GAAuB;MAC3CzpB,QAAQ,EAAEwT,KAAK,CAACkW,WAANlW,CAAkBrI,IAAlBqI,KAA2B,OADM;MAE3CvT,QAAQ,EAAEuT,KAAK,CAACkW,WAANlW,CAAkBrI,IAAlBqI,KAA2B,OAFM;MAG3CC,MAAM,EAAED,KAAK,CAACC,MAH6B;MAI3CjU,OAAO,EAAEgU,KAAK,CAAChU,OAJ4B;MAK3CK,QAAQ,EAAE2T,KAAK,CAAC3T;IAL2B,CAA/C;IAQA,IAAI4pB,kBAAkB,CAACxpB,QAAnBwpB,IAA+BA,kBAAkB,CAACzpB,QAAtD,EAAgE;MAC5DwT,KAAK,CAACE,cAANF,EAAAA;MACAA,KAAK,CAACmW,eAANnW,EAAAA;MACAwM,eAAe,CAACyJ,kBAAD,CAAfzJ;IACH;EACJ,CAjBa,EAkBd,CAACA,eAAD,CAlBc,CAAlB;AAoBH,CArBM;AC7BA,IAAM4J,gBAAgB,GAAoC,SAApDA,gBAAoD,CAAA,KAAK,EAAA;EAClE,IACIlT,QADJ,GAQIvE,KARJ,CACIuE,QADJ;IAEgBoT,UAFhB,GAQI3X,KARJ,CAEI0X,UAFJ;IAGIE,gBAHJ,GAQI5X,KARJ,CAGI4X,gBAHJ;IAII9J,aAJJ,GAQI9N,KARJ,CAII8N,aAJJ;IAKIC,aALJ,GAQI/N,KARJ,CAKI+N,aALJ;IAMIF,eANJ,GAQI7N,KARJ,CAMI6N,eANJ;IAOIgK,UAPJ,GAQI7X,KARJ,CAOI6X,UAPJ;EAUA,IAAMxF,WAAW,GAAG0E,eAAe,CAACjJ,aAAD,EAAgBC,aAAhB,CAAnC;EACA,IAAM+J,aAAa,GAAGT,iBAAiB,CAACxJ,eAAD,CAAvC;EAEA,IAAMkK,SAAS,GAA4B;IACvCC,OAAO,EAAEzjB,WAAW,CAAC,YAAA;MAAA,OAAMsjB,UAAU,IAAIA,UAAU,CAAC,IAAD,CAA9B;IAAA,CAAD,EAAuC,CAACA,UAAD,CAAvC,CADmB;IAEvCI,MAAM,EAAE1jB,WAAW,CAAC,YAAA;MAAA,OAAMsjB,UAAU,IAAIA,UAAU,CAAC,KAAD,CAA9B;IAAA,CAAD,EAAwC,CAACA,UAAD,CAAxC;EAFoB,CAA3C;EAKA,IAAI/J,aAAa,IAAIC,aAAjBD,IAAkCD,eAAtC,EAAuD;IACnDkK,SAAS,CAAC5Q,OAAV4Q,GAAoB1F,WAApB0F;IACAA,SAAS,CAACG,SAAVH,GAAsBD,aAAtBC;IACAA,SAAS,CAACI,QAAVJ,GAAqB,CAArBA;EACH;EAED,IAAMK,WAAW,GAAA,QAAA,CAAA,CAAA,CAAA,EAAQL,SAAR,EAAsBH,gBAAtB,CAAjB;EACA,OAAOzX,KAAAA,CAAAA,aAAAA,CAACwX,UAADxX,EAAAA,MAAAA,CAAAA,MAAAA,CAAAA,CAAAA,CAAAA,EAAgBiY,WAAAA,CAAhBjY,EAA8BoE,QAA9BpE,CAAP;AACH,CA3BM;;ACrCP;;;;;AAkBO,IAAMkY,aAAa,GAAA,aAAiC,KAAK,CAACvY,IAAN,CAAW,UAAA,IAAA,EAAA;MAAGzlB,IAAAA,GAAAA,IAAAA,CAAAA,IAAAA;IAAMmpB,SAAAA,GAAAA,IAAAA,CAAAA,SAAAA;EAC3E,IAAMqJ,sBAAsB,GAAGL,yBAAyB,CAACnyB,IAAD,CAAxD;EACA,IAAMi+B,iBAAiB,GAAGpL,oBAAoB,CAAC7yB,IAAD,CAA9C;EAEA,IAAM6kB,OAAO,GAAGD,WAAS,EAAzB;EACA,OACI,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;IAAMuE,SAAS,EAAEA,SAAAA;IAAW1O,KAAK,EAAEza,IAAI,GAAGA,IAAI,CAAC4C,IAAR,GAAe1B;GAAtD,EACKsxB,sBAAsB,CAAC/vB,MAAvB+vB,GAAgC,CAAhCA,IACG,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;IAAMrJ,SAAS,EAAEtE,OAAO,CAACuN;GAAzB,EAAyCI,sBAAzC,CAFR,EAIKyL,iBAJL,CADJ;AAQH,CAb0D,CAApD;AAcPD,aAAa,CAACpY,WAAdoY,GAA4B,eAA5BA;AAEA,IAAMpZ,WAAS,GAAA,aAAGd,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC9CsO,aAAa,EAAE;MACX1I,KAAK,EAAErF,KAAK,CAACiF,OAANjF,CAAc9F,IAAd8F,CAAmB6Z,IADf;MAEX3W,QAAQ,EAAE,UAFC;MAGX9F,QAAQ,EAAE,SAHC;MAIX0c,YAAY,EAAE;IAJH;EAD+B,CAAL;AAAA,CAAN,CAAvC;ACvBO,IAAMC,YAAY,GAAA,aAA6B,KAAK,CAAC3Y,IAAN;AAAA;AAElD,UAAA,IAAA,EAAA;MAAGzlB,IAAAA,GAAAA,IAAAA,CAAAA,IAAAA;IAAMuxB,QAAAA,GAAAA,IAAAA,CAAAA,QAAAA;IAAUC,OAAAA,GAAAA,IAAAA,CAAAA,OAAAA;EACf,IAAM6M,UAAU,GAAmB/M,iBAAiB,CAACtxB,IAAD,EAAOuxB,QAAP,EAAiBC,OAAjB,CAApD;EAEA,IAAA,qBAAA,GAA8CpV,4BAA4B,CACtEpc,IADsE,CAA1E;IAAQwc,iBAAR,GAAA,qBAAA,CAAQA,iBAAR;IAA2BE,cAA3B,GAAA,qBAAA,CAA2BA,cAA3B;EAIA,IAAMmI,OAAO,GAAGD,WAAS,CAACyZ,UAAD,CAAzB;EACA,IAAM9L,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EACA,IAAM4gB,kBAAkB,GAAGnN,qBAAqB,CAACnxB,IAAD,CAAhD;EACA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA,CAAA;IAAKmpB,SAAS,EAAEtE,OAAO,CAAC1B;KAAmBmb,kBAAAA,CAA3C,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKnV,SAAS,EAAEtE,OAAO,CAAC0Z;GAAxB,EACI,KAAA,CAAA,aAAA,CAAChM,UAAD,EAAA;IACIte,IAAI,EAAEoqB,UAAU,CAACpqB,IAAAA;IACjBqnB,IAAI,EAAE+C,UAAU,CAACxM,QAAAA;IACjBuD,UAAU,EAAE;GAHhB,CADJ,CADJ,EAQI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKjM,SAAS,EAAEtE,OAAO,CAAC2Z;GAAxB,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IACIrV,SAAS,EAAEtE,OAAO,CAAC4Z,iBAAAA;IACnBhkB,KAAK,EAAEza,IAAI,GAAGA,IAAI,CAAC4C,IAAR,GAAe1B;GAF9B,EAII,KAAA,CAAA,aAAA,CAAC88B,aAAD,EAAA;IAAeh+B,IAAI,EAAEA;GAArB,CAJJ,CADJ,EAOI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKmpB,SAAS,EAAEtE,OAAO,CAAC6Z;GAAxB,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKvV,SAAS,EAAEtE,OAAO,CAAC8Z;GAAxB,EACK3+B,IAAI,GACDwc,iBADC,IAAA,IAAA,GACDA,iBADC,GACoBsJ,KAAAA,CAAAA,aAAAA,CAAAA,MAAAA,EAAAA,IAAAA,EAAAA,QAAAA,CADpB,GAGD,KAAA,CAAA,aAAA,CAACmK,eAAD,EAAA;IAAiBC,SAAS,EAAE,CAAA;IAAGC,SAAS,EAAE;GAA1C,CAJR,CADJ,EAQI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKhH,SAAS,EAAEtE,OAAO,CAAC8Z;GAAxB,EACK3+B,IAAI,GACD0c,cADC,IAAA,IAAA,GACDA,cADC,GACiBoJ,KAAAA,CAAAA,aAAAA,CAAAA,MAAAA,EAAAA,IAAAA,EAAAA,QAAAA,CADjB,GAGD,KAAA,CAAA,aAAA,CAACmK,eAAD,EAAA;IAAiBC,SAAS,EAAE,EAAA;IAAIC,SAAS,EAAE;GAA3C,CAJR,CARJ,CAPJ,CARJ,EAgCI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKhH,SAAS,EAAC;GAAf,CAhCJ,EAiCI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKA,SAAS,EAAC;GAAf,CAjCJ,CADJ;AAqCH,CAjDiD,CAA/C;AAoDP,IAAMvE,WAAS,GAAA,aAAGd,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC9CX,aAAa,EAAE;MACX1B,QAAQ,EAAE4C,KAAK,CAAClB,aAANkB,CAAoB5C,QADnB;MAEXmd,UAAU,EAAE,QAFD;MAGXrX,QAAQ,EAAE,UAHC;MAIXW,OAAO,EAAE,MAJE;MAKXL,MAAM,EAAE;IALG,CAD+B;IAQ9C0W,iBAAiB,EAAE;MACf/U,eAAe,EAAE,SAAA,eAAA,CAAC5lB,KAAD,EAAA;QAAA,OAA2BA,KAAK,CAAC8lB,KAAjC;MAAA,CADF;MAEfL,SAAS,EAAE,4CAFI;MAGf9G,YAAY,EAAE8B,KAAK,CAAClB,aAANkB,CAAoBf,gBAHnB;MAIf7B,QAAQ,EAAE4C,KAAK,CAAClB,aAANkB,CAAoBhB,YAJf;MAKfqG,KAAK,EAAE,MALQ;MAMfpH,OAAO,EAAE;IANM,CAR2B;IAgB9Ckc,wBAAwB,EAAE;MACtB1T,aAAa,EAAE,QADO;MAEtB5C,OAAO,EAAE,MAFa;MAGtBqP,QAAQ,EAAE;IAHY,CAhBoB;IAqB9CkH,iBAAiB,EAAE;MACfnc,OAAO,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV;IADM,CArB2B;IAwB9Coc,uBAAuB,EAAE;MACrBjd,QAAQ,EAAE4C,KAAK,CAAClB,aAANkB,CAAoBjB,gBADT;MAErB0H,aAAa,EAAE,KAFM;MAGrB5C,OAAO,EAAE;IAHY,CAxBqB;IA6B9CyW,qBAAqB,EAAE;MACnBrc,OAAO,EAAE,CAAC,CAAD,EAAI,CAAJ,CADU;MAEnBoO,OAAO,EAAE;IAFU;EA7BuB,CAAL;AAAA,CAAN,CAAvC;ACjDO,IAAMmO,YAAY,GAAA,aAAG,KAAK,CAACpZ,IAAN,CAAW,UAAA,IAAA,EAAA;MAAGzlB,IAAAA,GAAAA,IAAAA,CAAAA,IAAAA;IAAMkqB,QAAAA,GAAAA,IAAAA,CAAAA,QAAAA;EAC5C,IAAA,gBAAA,GAAiCqF,eAAe,CAACvvB,IAAD,CAAhD;IAAQqvB,IAAR,GAAA,gBAAA,CAAQA,IAAR;IAAcvB,IAAd,GAAA,gBAAA,CAAcA,IAAd;IAAoB0B,QAApB,GAAA,gBAAA,CAAoBA,QAApB;EAEAC,eAAe,CAACzvB,IAAD,EAAOwvB,QAAP,CAAfC;EACA,IAAM5K,OAAO,GAAGD,WAAS,EAAzB;EACA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKvlB,GAAG,EAAEgwB,IAAAA;IAAMlG,SAAS,EAAEtE,OAAO,CAACia;GAAnC,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IACIz/B,GAAG,EAAES,UAAU,CAACY,WAAXZ,CAAuBE,IAAvBF,CAAAA,GAA+BguB,IAA/BhuB,GAAsC,IAAA;IAC3CqpB,SAAS,EAAEtE,OAAO,CAACia;GAFvB,EAIK5U,QAAQ,CAACsF,QAAD,CAJb,CADJ,CADJ;AAUH,CAf2B,CAArB;AAiBA,IAAM5K,WAAS,GAAA,aAAGd,qBAAqB,CAAC,YAAA;EAAA,OAAO;IAClDgb,UAAU,EAAE;MACRjX,MAAM,EAAE;IADA;EADsC,CAAP;AAAA,CAAD,CAAvC;;AC/BP;;;;;AAiBO,IAAMkX,aAAa,GAAA,aAAiC,KAAK,CAACtZ,IAAN,CAAW,UAAA,KAAK,EAAA;EACvE,IAAQ0D,SAAR,GAAoCxD,KAApC,CAAQwD,SAAR;IAAmBsI,YAAnB,GAAoC9L,KAApC,CAAmB8L,YAAnB;EAEA,IAAMuN,cAAc,GAAwBvN,YAAY,GAAG;IAAEwN,eAAe,EAAA,OAAA,GAAUxN,YAAV,GAAA;EAAjB,CAAH,GAAmD,CAAA,CAA3G;EAEA,IAAM5M,OAAO,GAAGD,WAAS,EAAzB;EACA,OAAO,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKuE,SAAS,EAAEpE,UAAC,CAAC,CAACoE,SAAD,EAAYtE,OAAO,CAACqa,aAApB,CAAD,CAAA;IAAsChW,KAAK,EAAE8V;GAA9D,CAAP;AACH,CAP0D,CAApD;AAQPD,aAAa,CAACnZ,WAAdmZ,GAA4B,eAA5BA;AAEA,IAAMna,WAAS,GAAA,aAAGX,sBAAsB,CAAC,YAAA;EAAA,OAAO;IAC5Cib,aAAa,EAAE;MACXC,gBAAgB,EAAE,WADP;MAEXC,kBAAkB,EAAE,QAFT;MAGXC,cAAc,EAAE;IAHL;EAD6B,CAAP;AAAA,CAAD,CAAxC;;AC3BA;;;;;AAkBO,IAAMC,qBAAqB,GAAA,aAAgC,KAAK,CAAC7Z,IAAN,CAAW,UAAA,KAAK,EAAA;;EAC9E,IAAmBuP,iBAAnB,GAAmDrP,KAAnD,CAAQwD,SAAR;IAAsCqG,QAAtC,GAAmD7J,KAAnD,CAAsC6J,QAAtC;EACA,IAAMuC,WAAW,GAAGD,UAAU,CAACtC,QAAD,CAA9B;EACA,IAAM3K,OAAO,GAAGD,WAAS,CAAC4K,QAAD,CAAzB;EACA,IAAM+C,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EACA,IAAI,CAACqU,WAAL,EAAkB,OAAO,IAAP;EAClB,IAAM5I,SAAS,GAAGpE,CAAC,EAAA,EAAA,GAAA,CAAA,CAAA,EAAA,EAAA,CACdF,OAAO,CAAC8R,YADM,CAAA,GACS,IADT,EAAA,EAAA,CAEd3B,iBAFc,CAAA,GAEM,IAFN,EAAA,EAAA,EAAnB;EAIA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK7L,SAAS,EAAEA;GAAhB,EACI,KAAA,CAAA,aAAA,CAACoJ,UAAD,EAAA;IAAYte,IAAI,EAAE8d;GAAlB,CADJ,CADJ;AAKH,CAfiE,CAA3D;AAiBP,IAAMnN,WAAS,GAAA,aAAGd,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC9C6S,YAAY,EAAE;MACVjN,KAAK,EAAE,SAAA,KAAA,CAAC8F,QAAD,EAAA;QAAA,OACHA,QAAQ,CAACN,SAATM,GACMA,QAAQ,CAACJ,UAATI,GACInL,KAAK,CAAC1C,GAAN0C,CAAUzC,YADd4N,GAEInL,KAAK,CAAC1C,GAAN0C,CAAUxC,eAHpB2N,GAIM,MALH;MAAA,CADG;MAOVzE,SAAS,EAAE,YAPD;MAQVxD,QAAQ,EAAE,UARA;MASV9F,QAAQ,EAAE,OATA;MAUViP,OAAO,EAAE,GAVC;MAWVpO,OAAO,EAAE,CAXC;MAYV,UAAA,EAAY;QACRid,YAAY,EAAE,wBADN;QAERC,UAAU,EAAE,iBAFJ;QAGRjY,QAAQ,EAAE,UAHF;QAIRkY,OAAO,EAAE,IAJD;QAKRhY,MAAM,EAAE,CAAC,CALD;QAMRC,IAAI,EAAE,CANE;QAORC,GAAG,EAAE;MAPG;IAZF;EADgC,CAAL;AAAA,CAAN,CAAvC;;ACnCA;;;;;AAgCO,IAAM+X,sBAAsB,GAAA,aAAoC,KAAK,CAACja,IAAN,CAAW,UAAA,KAAK,EAAA;;EACnF,IAAmBuP,iBAAnB,GAA+DrP,KAA/D,CAAQwD,SAAR;IAAsCkV,UAAtC,GAA+D1Y,KAA/D,CAAsC0Y,UAAtC;IAAkD7O,QAAlD,GAA+D7J,KAA/D,CAAkD6J,QAAlD;EAEA,IAAMmQ,aAAa,GAAGC,eAAe,CAACvB,UAAD,CAArC;EACA,IAAMwB,WAAW,GAAGC,aAAa,CAACzB,UAAD,CAAjC;EACA,IAAM0B,aAAa,GAAGC,oBAAoB,CAAC3B,UAAD,CAA1C;EACA,IAAMlV,SAAS,GAAGpE,CAAC,EAAA,EAAA,GAAA,CAAA,CAAA,EAAA,EAAA,CACd4a,aAAa,CAACM,WADA,CAAA,GACc,IADd,EAAA,EAAA,CAEdjL,iBAAiB,IAAI,EAFP,CAAA,GAEY,CAAC,CAACA,iBAFd,EAAA,EAAA,EAAnB;EAIA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK7L,SAAS,EAAEA;GAAhB,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKA,SAAS,EAAEwW,aAAa,CAACO;GAA9B,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK/W,SAAS,EAAEwW,aAAa,CAACQ;GAA9B,CADJ,EAEI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKhX,SAAS,EAAEwW,aAAa,CAACS;GAA9B,EACI,KAAA,CAAA,aAAA,CAACd,qBAAD,EAAA;IAAuBnW,SAAS,EAAE0W,WAAW,CAAClJ,YAAAA;IAAcnH,QAAQ,EAAEA;GAAtE,CADJ,EAEI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKrG,SAAS,EAAEpE,CAAC,CAAC,CAAC8a,WAAW,CAACQ,QAAb,EAAuBV,aAAa,CAACU,QAArC,CAAD;GAAjB,EAAoEhC,UAAU,CAAC38B,aAA/E,CAFJ,EAGI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKynB,SAAS,EAAE4W,aAAa,CAACO;GAA9B,CAHJ,EAII,KAAA,CAAA,aAAA,CAACvB,aAAD,EAAA;IAAe5V,SAAS,EAAE0W,WAAW,CAACU,SAAAA;IAAW9O,YAAY,EAAE4M,UAAU,CAAC5M;GAA1E,CAJJ,CAFJ,CADJ,CADJ;AAaH,CAvBsE,CAAhE;AAwBPiO,sBAAsB,CAAC9Z,WAAvB8Z,GAAqC,wBAArCA;AAEA,IAAME,eAAe,GAAA,aAAG9b,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IACpDmc,WAAW,EAAE;MACT1d,YAAY,EAAE8B,KAAK,CAAC1B,aAAN0B,CAAoB9B,YADzB;MAETgF,QAAQ,EAAE,UAFD;MAGTyJ,QAAQ,EAAE;IAHD,CADuC;IAMpDmP,iBAAiB,EAAE;MACf3W,eAAe,EAAE,SAAA,eAAA,CAAC5lB,KAAD,EAAA;QAAA,OAA2BA,KAAK,CAAC8lB,KAAjC;MAAA,CADF;MAEfL,SAAS,EAAE,SAAA,SAAA,CAACzlB,KAAD,EAAA;QACP,IAAI8lB,KAAK,GAAGrF,KAAK,CAAC1B,aAAN0B,CAAoBpB,mBAAhC;QACA,IAAIrf,KAAK,CAAC4tB,OAAV,EAAmB9H,KAAK,GAAG,oBAARA,CAAnB,KACK,IAAI9lB,KAAK,CAAC2tB,QAAV,EAAoB7H,KAAK,GAAG,uBAARA;QACzB,OAAA,QAAA,GAAgBA,KAAhB,GAAA,cAAA;MACH,CAPc;MAQf8W,mBAAmB,EAAEnc,KAAK,CAAC1B,aAAN0B,CAAoB9B,YAR1B;MASfke,oBAAoB,EAAE,EATP;MAUflZ,QAAQ,EAAE,UAVK;MAWfmZ,KAAK,EAAE,KAXQ;MAYf7Y,MAAM,EAAE,EAZO;MAafF,GAAG,EAAE,CAAC,EAbS;MAcfD,IAAI,EAAE,CAdS;MAef,SAAA,EAAW;QACPiZ,gBAAgB,EAAEtc,KAAK,CAACiF,OAANjF,CAAcoF,UAAdpF,CAAyBsG,KADpC;QAEPiW,cAAc,EAAEvc,KAAK,CAACiF,OAANjF,CAAcoF,UAAdpF,CAAyBsG,KAFlC;QAGPkW,iBAAiB,EAAE,aAHZ;QAIPC,eAAe,EAAE,aAJV;QAKPC,WAAW,EAAE,CAAC,CAAD,EAAI,EAAJ,EAAQ,EAAR,EAAY,CAAZ,CALN;QAMPC,WAAW,EAAE,OANN;QAOPzZ,QAAQ,EAAE,UAPH;QAQPW,OAAO,EAAE,OARF;QASPuX,OAAO,EAAE,IATF;QAUPiB,KAAK,EAAE,CAVA;QAWP/Y,GAAG,EAAE;MAXE;IAfI,CANiC;IAmCpDuY,iBAAiB,EAAE;MACf1W,eAAe,EAAE,SAAA,eAAA,CAAC5lB,KAAD,EAAA;QAAA,OAA2BA,KAAK,CAAC8lB,KAAjC;MAAA,CADF;MAEfL,SAAS,EAAE,SAAA,SAAA,CAACzlB,KAAD,EAAA;QACP,IAAI8lB,KAAK,GAAGrF,KAAK,CAAC1B,aAAN0B,CAAoBpB,mBAAhC;QACA,IAAIrf,KAAK,CAAC4tB,OAAV,EAAmB9H,KAAK,GAAG,oBAARA,CAAnB,KACK,IAAI9lB,KAAK,CAAC2tB,QAAV,EAAoB7H,KAAK,GAAG,uBAARA;QACzB,OAAA,QAAA,GAAgBA,KAAhB,GAAA,cAAA;MACH,CAPc;MAQf+W,oBAAoB,EAAEpc,KAAK,CAAC1B,aAAN0B,CAAoB9B,YAR3B;MASfgF,QAAQ,EAAE,UATK;MAUf0Z,MAAM,EAAE,CAVO;MAWfP,KAAK,EAAE,CAXQ;MAYfhZ,IAAI,EAAE,CAZS;MAafC,GAAG,EAAE;IAbU,CAnCiC;IAkDpDyY,eAAe,EAAE;MACb/W,SAAS,EAAE,SAAA,SAAA,CAACzlB,KAAD,EAAA;QACP,IAAMs9B,OAAO,GAAa,EAA1B;QACA,IAAIt9B,KAAK,CAAC4tB,OAAV,EAAmB0P,OAAO,CAACh/B,IAARg/B,CAAa,kCAAbA,CAAAA;QACnB,IAAIt9B,KAAK,CAAC2tB,QAAV,EAAoB2P,OAAO,CAACh/B,IAARg/B,CAAa,wCAAbA,CAAAA;QACpBA,OAAO,CAACh/B,IAARg/B,CAAAA,QAAAA,GAAsB7c,KAAK,CAAC1B,aAAN0B,CAAoBnB,oBAA1Cge,GAAAA,cAAAA,CAAAA;QACA,OAAOA,OAAO,CAACrhC,IAARqhC,CAAa,IAAbA,CAAP;MACH,CAPY;MAQb1X,eAAe,EAAE,SAAA,eAAA,CAAC5lB,KAAD,EAAA;QAAA,OAA2BA,KAAK,CAAC8lB,KAAjC;MAAA,CARJ;MASbnH,YAAY,EAAE8B,KAAK,CAAC1B,aAAN0B,CAAoB9B,YATrB;MAUbgF,QAAQ,EAAE,UAVG;MAWbyJ,QAAQ,EAAE,QAXG;MAYbiQ,MAAM,EAAE,CAZK;MAabP,KAAK,EAAE,CAbM;MAcbhZ,IAAI,EAAE,CAdO;MAebC,GAAG,EAAE;IAfQ,CAlDmC;IAmEpD0Y,QAAQ,EAAE;MACN5e,QAAQ,EAAEqD,SAAS,CAACT,KAAK,CAAC1B,aAAN0B,CAAoBzB,iBAArB;IADb;EAnE0C,CAAL;AAAA,CAAN,CAA7C;AAwEO,IAAMue,oBAAoB,GAAA,aAAoC,KAAK,CAAC1b,IAAN,CAAW,UAAA,KAAK,EAAA;;EACjF,IAAmBuP,iBAAnB,GAA+DrP,KAA/D,CAAQwD,SAAR;IAAsCkV,UAAtC,GAA+D1Y,KAA/D,CAAsC0Y,UAAtC;IAAkD7O,QAAlD,GAA+D7J,KAA/D,CAAkD6J,QAAlD;EAEA,IAAMqQ,WAAW,GAAGC,aAAa,CAACzB,UAAD,CAAjC;EACA,IAAM0B,aAAa,GAAGC,oBAAoB,CAAC3B,UAAD,CAA1C;EACA,IAAM9L,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EACA,IAAMyL,SAAS,GAAGpE,CAAC,EAAA,GAAA,GAAA,CAAA,CAAA,EAAA,GAAA,CACd8a,WAAW,CAACI,WADE,CAAA,GACY,IADZ,EAAA,GAAA,CAEdjL,iBAAiB,IAAI,EAFP,CAAA,GAEY,CAAC,CAACA,iBAFd,EAAA,GAAA,EAAnB;EAIA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK7L,SAAS,EAAEA;GAAhB,EACI,KAAA,CAAA,aAAA,CAACmW,qBAAD,EAAA;IAAuBnW,SAAS,EAAE0W,WAAW,CAAClJ,YAAAA;IAAcnH,QAAQ,EAAEA;GAAtE,CADJ,EAEI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKrG,SAAS,EAAE0W,WAAW,CAACQ;GAA5B,EACI,KAAA,CAAA,aAAA,CAAC9N,UAAD,EAAA;IAAYte,IAAI,EAAEoqB,UAAU,CAACpqB,IAAAA;IAAMqnB,IAAI,EAAE+C,UAAU,CAACxM;GAApD,CADJ,CAFJ,EAKI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK1I,SAAS,EAAE4W,aAAa,CAACO;GAA9B,CALJ,EAMI,KAAA,CAAA,aAAA,CAACvB,aAAD,EAAA;IAAe5V,SAAS,EAAE0W,WAAW,CAACU,SAAAA;IAAW9O,YAAY,EAAE4M,UAAU,CAAC5M;GAA1E,CANJ,CADJ;AAUH,CApBoE,CAA9D;AAqBP0P,oBAAoB,CAACvb,WAArBub,GAAmC,sBAAnCA;AAEA,IAAMrB,aAAa,GAAA,aAAGhc,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAClDmc,WAAW,EAAE;MACT5W,SAAS,EAAE,SAAA,SAAA,CAACzlB,KAAD,EAAA;QACP,IAAMs9B,OAAO,GAAa,EAA1B;QACA,IAAIt9B,KAAK,CAAC2tB,QAAV,EAAoB2P,OAAO,CAACh/B,IAARg/B,CAAa,sCAAbA,CAAAA;QACpB,IAAIt9B,KAAK,CAAC4tB,OAAV,EAAmB0P,OAAO,CAACh/B,IAARg/B,CAAa,kCAAbA,CAAAA;QACnBA,OAAO,CAACh/B,IAARg/B,CAAAA,QAAAA,GAAsB7c,KAAK,CAAC1B,aAAN0B,CAAoBrB,aAA1Cke,GAAAA,cAAAA,CAAAA;QACA,OAAOA,OAAO,CAACrhC,IAARqhC,CAAa,IAAbA,CAAP;MACH,CAPQ;MAQT1X,eAAe,EAAE,SAAA,eAAA,CAAC5lB,KAAD,EAAA;QAAA,OAA2BA,KAAK,CAAC8lB,KAAjC;MAAA,CARR;MASTnH,YAAY,EAAE8B,KAAK,CAAC1B,aAAN0B,CAAoB9B,YATzB;MAUTgF,QAAQ,EAAE,UAVD;MAWTyJ,QAAQ,EAAE;IAXD,CADqC;IAclD2F,YAAY,EAAE;MACVlP,MAAM,EAAE;IADE,CAdoC;IAiBlD4Y,QAAQ,EAAE;MACNhY,SAAS,EAAE,mCADL;MAEN5G,QAAQ,EAAE4C,KAAK,CAAC1B,aAAN0B,CAAoBvB,QAFxB;MAGN4N,OAAO,EAAE,SAAA,OAAA,CAAC9sB,KAAD,EAAA;QAAA,OAA4BA,KAAK,CAAC6tB,YAAN7tB,IAAsB,CAACA,KAAK,CAAC4tB,OAA7B5tB,GAAuC,CAAvCA,GAA2C,CAAvE;MAAA,CAHH;MAIN8lB,KAAK,EAAE,SAAA,KAAA,CAAC9lB,KAAD,EAAA;QAAA,OACHA,KAAK,CAAC4tB,OAAN5tB,GAAgBygB,KAAK,CAAC1B,aAAN0B,CAAoBxB,gBAApCjf,GAAuDygB,KAAK,CAAC1B,aAAN0B,CAAoBtB,SADxE;MAAA,CAJD;MAMNwE,QAAQ,EAAE,UANJ;MAONG,IAAI,EAAE,KAPA;MAQND,MAAM,EAAE,EARF;MASNE,GAAG,EAAE;IATC,CAjBwC;IA4BlD4Y,SAAS,EAAE;MACPhe,YAAY,EAAE8B,KAAK,CAAC1B,aAAN0B,CAAoB9B,YAD3B;MAEPgF,QAAQ,EAAE,UAFH;MAGPE,MAAM,EAAE,CAHD;MAIPwZ,MAAM,EAAE,CAJD;MAKPP,KAAK,EAAE,CALA;MAMPhZ,IAAI,EAAE,CANC;MAOPC,GAAG,EAAE;IAPE;EA5BuC,CAAL;AAAA,CAAN,CAA3C;AAuCO,IAAMqY,oBAAoB,GAAA,aAAGlc,qBAAqB,CAAC,YAAA;EAAA,OAAO;IAC7Dwc,kBAAkB,EAAE;MAChBpY,OAAO,EAAE,SAAA,OAAA,CAACtkB,KAAD,EAAA;QAAA,OAA4BA,KAAK,CAAC2tB,QAAN3tB,GAAiB,OAAjBA,GAA2B,MAAvD;MAAA,CADO;MAEhB6lB,UAAU,EACN,4BAAA,GACA,QADA,GAEA,sBAFA,GAGA,2BAHA,GAIA,wBAJA,GAKA,0BALA,GAMA,GATY;MAUhBD,eAAe,EAAE,wBAVD;MAWhBjC,QAAQ,EAAE,UAXM;MAYhBM,MAAM,EAAE,MAZQ;MAahBD,KAAK,EAAE,MAbS;MAchBH,MAAM,EAAE;IAdQ,CADyC;IAiB7D2Z,cAAc,EAAE;MACZlZ,OAAO,EAAE,SAAA,OAAA,CAACtkB,KAAD,EAAA;QAAA,OAA4BA,KAAK,CAAC4tB,OAAN5tB,GAAgB,OAAhBA,GAA0B,MAAtD;MAAA,CADG;MAEZylB,SAAS,EAAE,kCAFC;MAGZ9B,QAAQ,EAAE,UAHE;MAIZM,MAAM,EAAE,MAJI;MAKZD,KAAK,EAAE,MALK;MAMZH,MAAM,EAAE;IANI;EAjB6C,CAAP;AAAA,CAAD,CAAlD;ACvLA,IAAM4Z,SAAS,GAAA,aAA6B,KAAK,CAAC5b,IAAN,CAAW,UAAA,IAAA,EAAA;;MAAGzlB,IAAAA,GAAAA,IAAAA,CAAAA,IAAAA;IAAMuxB,QAAAA,GAAAA,IAAAA,CAAAA,QAAAA;IAAUC,OAAAA,GAAAA,IAAAA,CAAAA,OAAAA;IAAShC,QAAAA,GAAAA,IAAAA,CAAAA,QAAAA;EACtF,IAAMzvB,WAAW,GAAGD,UAAU,CAACC,WAAXD,CAAuBE,IAAvBF,CAApB;EACA,IAAMu+B,UAAU,GAAG/M,iBAAiB,CAACtxB,IAAD,EAAOuxB,QAAP,EAAiBC,OAAjB,CAApC;EAEA,IAAM3M,OAAO,GAAGyc,kBAAkB,CAACjD,UAAD,CAAlC;EACA,IAAMC,kBAAkB,GAAGnN,qBAAqB,CAACnxB,IAAD,CAAhD;EACA,IAAMuhC,cAAc,GAAGxc,CAAC,EAAA,EAAA,GAAA,CAAA,CAAA,EAAA,EAAA,CACnBF,OAAO,CAAClC,aADW,CAAA,GACK,IADL,EAAA,EAAA,EAAxB;EAGA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA,CAAA;IAAKwG,SAAS,EAAEoY;KAAoBjD,kBAAAA,CAApC,EACKv+B,WAAW,GACR,KAAA,CAAA,aAAA,CAAC2/B,sBAAD,EAAA;IACIvW,SAAS,EAAEtE,OAAO,CAAC2c,oBAAAA;IACnBnD,UAAU,EAAEA,UAAAA;IACZ7O,QAAQ,EAAEA;GAHd,CADQ,GAOR,KAAA,CAAA,aAAA,CAAC2R,oBAAD,EAAA;IACIhY,SAAS,EAAEtE,OAAO,CAAC2c,oBAAAA;IACnBnD,UAAU,EAAEA,UAAAA;IACZ7O,QAAQ,EAAEA;GAHd,CARR,EAcI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKrG,SAAS,EAAEtE,OAAO,CAAC4c;GAAxB,EACI,KAAA,CAAA,aAAA,CAACzD,aAAD,EAAA;IAAe7U,SAAS,EAAEtE,OAAO,CAAC6c,iBAAAA;IAAmB1hC,IAAI,EAAEA;GAA3D,CADJ,CAdJ,CADJ;AAoBH,CA7BkD,CAA5C;AA8BPqhC,SAAS,CAACzb,WAAVyb,GAAwB,WAAxBA;AAEA,IAAMC,kBAAkB,GAAA,aAAGxd,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IACvDnB,aAAa,EAAE;MACXmI,aAAa,EAAE,QADJ;MAEX5C,OAAO,EAAE,MAFE;MAGXL,MAAM,EAAE;IAHG,CADwC;IAMvD2Z,oBAAoB,EAAE;MAClBjK,QAAQ,EAAE;IADQ,CANiC;IASvDkK,0BAA0B,EAAE;MACxBhgB,QAAQ,EAAE4C,KAAK,CAAC1B,aAAN0B,CAAoB5C,QADN;MAExBkgB,SAAS,EAAE,YAFa;MAGxB3W,SAAS,EAAE,QAHa;MAIxB6K,UAAU,EAAE;IAJY,CAT2B;IAevD6L,iBAAiB,EAAE;MACflY,eAAe,EAAE,SAAA,eAAA,CAAC5lB,KAAD,EAAA;QAAA,OAA4BA,KAAK,CAAC2tB,QAAN3tB,GAAiB,sBAAjBA,GAA0C,aAAtE;MAAA,CADF;MAEfgzB,cAAc,EAAE,SAAA,cAAA,CAAChzB,KAAD,EAAA;QAAA,OAA4BA,KAAK,CAAC4tB,OAAN5tB,GAAgB,WAAhBA,GAA8B,MAA1D;MAAA,CAFD;MAGf2e,YAAY,EAAE,CAHC;MAIfD,OAAO,EAAE,CAAC,CAAD,EAAI,CAAJ;IAJM;EAfoC,CAAL;AAAA,CAAN,CAAhD;ACrBO,IAAMsf,SAAS,GAAA,aAA6B,KAAK,CAACnc,IAAN,CAC/C,UAAA,IAAA,EAAA;MAAGzlB,IAAAA,GAAAA,IAAAA,CAAAA,IAAAA;IAAMuxB,QAAAA,GAAAA,IAAAA,CAAAA,QAAAA;IAAUC,OAAAA,GAAAA,IAAAA,CAAAA,OAAAA;IAAShC,QAAAA,GAAAA,IAAAA,CAAAA,QAAAA;EACxB,IAAM6O,UAAU,GAAmB/M,iBAAiB,CAACtxB,IAAD,EAAOuxB,QAAP,EAAiBC,OAAjB,CAApD;EACA,IAAMO,WAAW,GAAGD,UAAU,CAACtC,QAAD,CAA9B;EAEA,IAAA,qBAAA,GAA8CpT,4BAA4B,CACtEpc,IADsE,CAA1E;IAAQwc,iBAAR,GAAA,qBAAA,CAAQA,iBAAR;IAA2BE,cAA3B,GAAA,qBAAA,CAA2BA,cAA3B;EAGA,IAAMmlB,UAAU,GAAGhmB,OAAO,CACtB,YAAA;IAAA,OAAO;MACHwiB,UAAU,EAAVA,UADG;MAEH7O,QAAQ,EAARA;IAFG,CAAP;EAAA,CADsB,EAKtB,CAACA,QAAD,EAAW6O,UAAX,CALsB,CAA1B;EAOA,IAAMxZ,OAAO,GAAGD,WAAS,CAACid,UAAD,CAAzB;EACA,IAAM9B,aAAa,GAAGC,oBAAoB,CAAC3B,UAAD,CAA1C;EACA,IAAM9L,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EACA,IAAM4gB,kBAAkB,GAAGnN,qBAAqB,CAACnxB,IAAD,CAAhD;EACA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,MAAA,CAAA,MAAA,CAAA;IAAKmpB,SAAS,EAAEtE,OAAO,CAAC1B;KAAmBmb,kBAAAA,CAA3C,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKnV,SAAS,EAAE4W,aAAa,CAACqB;GAA9B,CADJ,EAEI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IACIjY,SAAS,EAAEpE,CAAC,CAAC,CACTgb,aAAa,CAACO,kBADL,EAETzb,OAAO,CAACid,sBAFC,CAAD;GADhB,CAFJ,EAQI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK3Y,SAAS,EAAEtE,OAAO,CAAC0Z;GAAxB,EACI,KAAA,CAAA,aAAA,CAAChM,UAAD,EAAA;IACIte,IAAI,EAAE8d,WAAF,IAAA,IAAA,GAAEA,WAAF,GAAiBsM,UAAU,CAACpqB,IAAAA;IAChCqnB,IAAI,EAAEvJ,WAAW,GAAG,KAAH,GAAWsM,UAAU,CAACxM,QAAAA;IACvCuD,UAAU,EAAE;GAHhB,CADJ,CARJ,EAeI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IACIjM,SAAS,EAAEtE,OAAO,CAAC4Z,iBAAAA;IACnBhkB,KAAK,EAAEza,IAAI,GAAGA,IAAI,CAAC4C,IAAR,GAAe1B;GAF9B,EAII,KAAA,CAAA,aAAA,CAAC88B,aAAD,EAAA;IAAeh+B,IAAI,EAAEA;GAArB,CAJJ,CAfJ,EAqBI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKmpB,SAAS,EAAEtE,OAAO,CAAC8Z;GAAxB,EACK3+B,IAAI,GACDwc,iBADC,IAAA,IAAA,GACDA,iBADC,GACoBsJ,KAAAA,CAAAA,aAAAA,CAAAA,MAAAA,EAAAA,IAAAA,EAAAA,QAAAA,CADpB,GAGD,KAAA,CAAA,aAAA,CAACmK,eAAD,EAAA;IAAiBC,SAAS,EAAE,CAAA;IAAGC,SAAS,EAAE;GAA1C,CAJR,CArBJ,EA4BI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKhH,SAAS,EAAEtE,OAAO,CAAC8Z;GAAxB,EACK3+B,IAAI,GACD0c,cADC,IAAA,IAAA,GACDA,cADC,GACiBoJ,KAAAA,CAAAA,aAAAA,CAAAA,MAAAA,EAAAA,IAAAA,EAAAA,QAAAA,CADjB,GAGD,KAAA,CAAA,aAAA,CAACmK,eAAD,EAAA;IAAiBC,SAAS,EAAE,EAAA;IAAIC,SAAS,EAAE;GAA3C,CAJR,CA5BJ,CADJ;AAsCH,CAzD8C,CAA5C;AA4DP,IAAMvL,WAAS,GAAA,aAAGd,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC9CX,aAAa,EAAE;MACXkG,SAAS,EAAA,QAAA,GAAWhF,KAAK,CAACiF,OAANjF,CAAckF,OAAzB,GAAA,WADE;MAEX9H,QAAQ,EAAE4C,KAAK,CAAClB,aAANkB,CAAoB5C,QAFnB;MAGXiI,KAAK,EAAE,SAAA,KAAA,CAAA,KAAA,EAAA;QAAA,IAAG8F,QAAH,GAAA,KAAA,CAAGA,QAAH;QAAA,OACHA,QAAQ,CAACN,SAATM,GACMA,QAAQ,CAACJ,UAATI,GACInL,KAAK,CAAC1C,GAAN0C,CAAUzC,YADd4N,GAEInL,KAAK,CAAC1C,GAAN0C,CAAUxC,eAHpB2N,GAIM,SALH;MAAA,CAHI;MASXoP,UAAU,EAAE,QATD;MAUXrX,QAAQ,EAAE,UAVC;MAWXW,OAAO,EAAE,MAXE;MAYXL,MAAM,EAAE;IAZG,CAD+B;IAe9Cia,sBAAsB,EAAE;MACpBpR,OAAO,EAAE;IADW,CAfsB;IAkB9C6N,iBAAiB,EAAE;MACf7U,KAAK,EAAE,SAAA,KAAA,CAAA,KAAA,EAAA;QAAA,IAAG2U,UAAH,GAAA,KAAA,CAAGA,UAAH;UAAe7O,QAAf,GAAA,KAAA,CAAeA,QAAf;QAAA,OACHA,QAAQ,CAACN,SAATM,GACMA,QAAQ,CAACJ,UAATI,GACInL,KAAK,CAAC1C,GAAN0C,CAAUzC,YADd4N,GAEInL,KAAK,CAAC1C,GAAN0C,CAAUxC,eAHpB2N,GAIM6O,UAAU,CAAC3U,KALd;MAAA,CADQ;MAOfjI,QAAQ,EAAE4C,KAAK,CAAClB,aAANkB,CAAoBhB,YAPf;MAQf0H,SAAS,EAAE,YARI;MASfzI,OAAO,EAAE,CAAC,CAAD,EAAI,CAAJ,CATM;MAUfmF,MAAM,EAAE;IAVO,CAlB2B;IA8B9CgX,iBAAiB,EAAE;MACfsD,YAAY,EAAE,UADC;MAEfhX,SAAS,EAAE,YAFI;MAGfgG,UAAU,EAAE,QAHG;MAIfC,QAAQ,EAAE,QAJK;MAKfgR,IAAI,EAAE,WALS;MAMfrG,WAAW,EAAE,CANE;MAOflU,MAAM,EAAE;IAPO,CA9B2B;IAuC9CkX,qBAAqB,EAAE;MACnBld,QAAQ,EAAE4C,KAAK,CAAClB,aAANkB,CAAoBjB,gBADX;MAEnB2H,SAAS,EAAE,YAFQ;MAGnBgG,UAAU,EAAE,QAHO;MAInBC,QAAQ,EAAE,QAJS;MAKnBgR,IAAI,EAAE,WALa;MAMnB1f,OAAO,EAAE,CAAC,CAAD,EAAI,CAAJ,CANU;MAOnBmF,MAAM,EAAE;IAPW;EAvCuB,CAAL;AAAA,CAAN,CAAvC;ACzDA,IAAMwa,gBAAgB,GAAkB;EACpCpU,aAAa,EAAE,KADqB;EAEpCqB,SAAS,EAAE,KAFyB;EAGpCE,UAAU,EAAE;AAHwB,CAAxC;AAMO,IAAM8S,cAAc,GAAA,aAAkC,KAAK,CAACzc,IAAN,CAAW,UAAA,IAAA,EAAA;MAAGlgB,MAAAA,GAAAA,IAAAA,CAAAA,MAAAA;IAAQ+tB,YAAAA,GAAAA,IAAAA,CAAAA,YAAAA;IAAc6O,YAAAA,GAAAA,IAAAA,CAAAA,YAAAA;EAC7F,IAAMtd,OAAO,GAAGD,WAAS,EAAzB,CAAA,CAAA;;EAGA,IAAM5kB,IAAI,GAAG+Z,gBAAgB,CAACzU,cAAD,EAAiBC,MAAjB,CAA7B;EACA,IAAMgsB,QAAQ,GAAGxX,gBAAgB,CAAC1T,oBAAD,EAAuBd,MAAvB,CAAjC;EACA,IAAM4kB,WAAW,GAAGhQ,WAAW,CAACpS,mBAAD,CAA/B,CAAA,CAAA;;EAGA,IAAMq6B,iBAAiB,GAAG/O,oBAAoB,CAACrzB,IAAD,EAAOszB,YAAP,CAA9C;EACA,IAAA,SAAA,GAA8B70B,QAAQ,CAAC,KAAD,CAAtC;IAAO+yB,OAAP,GAAA,SAAA,CAAA,CAAA,CAAA;IAAgBgM,UAAhB,GAAA,SAAA,CAAA,CAAA,CAAA;EACA,IAAM6E,qBAAqB,GAAA,QAAA,CAAA;IACvBhF,UAAU,EAAE,KADW;IAEvBE,gBAAgB,EAAE;MAAEpU,SAAS,EAAEtE,OAAO,CAACyd;IAArB;EAFK,CAAA,EAGnBxiC,UAAU,CAACO,WAAXP,CAAuBE,IAAvBF,CAAAA,GAA+BsiC,iBAA/BtiC,GAAmDoB,SAHhC,EAAA;IAIvBs8B,UAAU,EAAVA;EAJuB,CAAA,CAA3B,CAAA,CAAA;;EAQA,IAAM+E,cAAc,GAAqC;IACrDviC,IAAI,EAAJA,IADqD;IAErDuxB,QAAQ,EAARA,QAFqD;IAGrDC,OAAO,EAAPA;EAHqD,CAAzD;EAMA,IAAIgR,cAAJ;EACA,IAAIL,YAAY,KAAKlxB,YAAY,CAACkE,IAAlC,EAAwCqtB,cAAc,GAAGZ,SAAjBY,CAAxC,KACK,IAAIL,YAAY,KAAKlxB,YAAY,CAACsE,OAAlC,EAA2CitB,cAAc,GAAGpE,YAAjBoE,CAA3C,KACAA,cAAc,GAAGnB,SAAjBmB;EAEL,OAAOrY,WAAW,GACd,KAAA,CAAA,aAAA,CAACiT,gBAAD,EAAA,MAAA,CAAA,MAAA,CAAA,CAAA,CAAA,EAAsBiF,qBAAAA,CAAtB,EACI,KAAA,CAAA,aAAA,CAACG,cAAD,EAAA,MAAA,CAAA,MAAA,CAAA,CAAA,CAAA,EAAoBD,cAAAA,EAAAA;IAAgB/S,QAAQ,EAAEyS;IAA9C,CADJ,CADc,GAKd,KAAA,CAAA,aAAA,CAACpD,YAAD,EAAA;IAAc7+B,IAAI,EAAEA;GAApB,EACK,UAAA,QAAQ,EAAA;IAAA,OACL,KAAA,CAAA,aAAA,CAACo9B,gBAAD,EAAA,MAAA,CAAA,MAAA,CAAA,CAAA,CAAA,EAAsBiF,qBAAAA,CAAtB,EACI,KAAA,CAAA,aAAA,CAACG,cAAD,EAAA,MAAA,CAAA,MAAA,CAAA,CAAA,CAAA,EAAoBD,cAAAA,EAAAA;MAAgB/S,QAAQ,EAAEA;MAA9C,CADJ,CADK;EAAA,CADb,CALJ;AAaH,CA3C4D,CAAtD;AA4CP0S,cAAc,CAACtc,WAAfsc,GAA6B,gBAA7BA;AAEA,IAAMtd,WAAS,GAAA,aAAGX,sBAAsB,CAAC,YAAA;EAAA,OAAO;IAC5Cqe,yBAAyB,EAAE;MACvB;MACA;MACAG,OAAO,EAAE,iBAHc;MAIvBlb,QAAQ,EAAE,UAJa;MAKvBM,MAAM,EAAE;IALe;EADiB,CAAP;AAAA,CAAD,CAAxC;AC5CO,IAAM6a,cAAc,GAAG,SAAjBA,cAAiB,CAAA,EAAA;EAC1B;EACA,OAAO,OAAOC,MAAM,CAACC,WAAd,KAA8B,WAA9B,IAA6CC,SAAS,CAACC,SAAVD,CAAoBE,OAApBF,CAA4B,UAA5BA,CAAAA,KAA4C,CAAC,CAAjG;AACH,CAHM;AAKA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,CACzBpb,KADyB,EAEzB0R,SAFyB,EAGzB2J,UAHyB,EAIzBxX,kBAJyB,EAAA;EAMzB,IAAMyX,MAAM,GAAGzX,kBAAkB,GAAG,CAAH,GAAO,CAAxC;EACA,IAAM0X,SAAS,GAAGT,cAAc,EAAA,GAAK,CAAL,GAAS,EAAzC;EAEA,IAAIU,WAAJ;EACA,IAAIC,WAAJ;EACA,IAAI5X,kBAAJ,EAAwB;IACpB2X,WAAW,GAAG,CAAdA;IACAC,WAAW,GAAG,CAACzb,KAAK,GAAGsb,MAARtb,GAAiBub,SAAlB,IAA+BC,WAA7CC;EACH,CAHD,MAGO;IACHA,WAAW,GAAGJ,UAAU,CAACztB,UAAzB6tB;IACAD,WAAW,GAAG7lB,IAAI,CAACuS,GAALvS,CAAS,CAATA,EAAYA,IAAI,CAACwS,KAALxS,CAAW,CAACqK,KAAK,GAAGub,SAAT,KAAuBE,WAAW,GAAGH,MAArC,CAAX3lB,CAAZA,CAAd6lB;EACH;EAED,IAAME,QAAQ,GAAG/lB,IAAI,CAACgmB,IAALhmB,CAAU+b,SAAS,GAAG8J,WAAtB7lB,CAAjB;EAEA,OAAO;IACH+lB,QAAQ,EAARA,QADG;IAEHF,WAAW,EAAXA,WAFG;IAGHF,MAAM,EAANA,MAHG;IAIHM,SAAS,EAAEP,UAAU,CAAC7tB,WAJnB;IAKHiuB,WAAW,EAAXA;EALG,CAAP;AAOH,CA5BM;AA8BA,IAAMI,aAAa,GAAA,aAAgC,KAAK,CAAChe,IAAN,CAAW,UAAA,KAAK,EAAA;EACtE,IAAQmC,KAAR,GAA0BjC,KAA1B,CAAQiC,KAAR;IAAeC,MAAf,GAA0BlC,KAA1B,CAAekC,MAAf;EAEA,IAAMob,UAAU,GAAG9oB,WAAW,CAAClT,oBAAD,CAA9B;EACA,IAAMwE,cAAc,GAAG0O,WAAW,CAACxO,SAAS,CAACL,iBAAX,CAAlC;EACA,IAAMguB,SAAS,GAAGzd,OAAO,CAAC,YAAA;IAAA,OAAMpQ,cAAc,CAAChJ,MAArB;EAAA,CAAD,EAA8B,CAACgJ,cAAD,CAA9B,CAAzB;EAEA,IAAMi4B,OAAO,GAAGxkC,MAAM,EAAtB;EACA,IAAMusB,kBAAkB,GAAGhI,qBAAqB,EAAhD,CAAA,CAAA;EAGA;EACA;EACA;;EACA,IAAA,SAAA,GAAoChlB,QAAQ,CAACukC,aAAa,CAACpb,KAAD,EAAQ0R,SAAR,EAAmB2J,UAAnB,EAA+BxX,kBAA/B,CAAd,CAA5C;IAAOkY,UAAP,GAAA,SAAA,CAAA,CAAA,CAAA;IAAmBC,aAAnB,GAAA,SAAA,CAAA,CAAA,CAAA;EACA,IAAMC,aAAa,GAAG3kC,MAAM,CAACykC,UAAD,CAA5B;EACAjlC,SAAS,CAAC,YAAA;IACN,IAAMolC,OAAO,GAAGD,aAAa,CAAC1kC,OAA9B;IACA,IAAM4kC,OAAO,GAAGf,aAAa,CAACpb,KAAD,EAAQ0R,SAAR,EAAmB2J,UAAnB,EAA+BxX,kBAA/B,CAA7B;IAEAoY,aAAa,CAAC1kC,OAAd0kC,GAAwBE,OAAxBF;IACA,IAAIH,OAAO,CAACvkC,OAAZ,EAAqB;MACjB,IAAI2kC,OAAO,CAACR,QAARQ,KAAqBC,OAAO,CAACT,QAAjC,EAA2C;QACvCI,OAAO,CAACvkC,OAARukC,CAAgBM,kBAAhBN,CAAmCnmB,IAAI,CAACsS,GAALtS,CAASumB,OAAO,CAACR,QAAjB/lB,EAA2BwmB,OAAO,CAACT,QAAnC/lB,CAAAA,GAA+C,CAAlFmmB,CAAAA;MACH;MACD,IAAII,OAAO,CAACV,WAARU,KAAwBC,OAAO,CAACX,WAApC,EAAiD;QAC7CM,OAAO,CAACvkC,OAARukC,CAAgBO,qBAAhBP,CAAsCnmB,IAAI,CAACsS,GAALtS,CAASumB,OAAO,CAACV,WAAjB7lB,EAA8BwmB,OAAO,CAACT,QAAtC/lB,CAAAA,GAAkD,CAAxFmmB,CAAAA;MACH;MACD,IAAII,OAAO,CAACT,WAARS,KAAwBC,OAAO,CAACV,WAApC,EAAiD;QAC7CK,OAAO,CAACvkC,OAARukC,CAAgBQ,iBAAhBR,CAAkC;UAAES,WAAW,EAAE,CAAf;UAAkBC,QAAQ,EAAE;QAA5B,CAAlCV,CAAAA;MACH;IACJ;IAEDE,aAAa,CAACG,OAAD,CAAbH;EACH,CAlBQ,EAkBN,CAACA,aAAD,EAAgBC,aAAhB,EAA+BpY,kBAA/B,EAAmD7D,KAAnD,EAA0Dqb,UAA1D,EAAsE3J,SAAtE,CAlBM,CAAT56B;EAoBA,IAAM2lC,MAAM,GAAGxoB,OAAO,CAAC,YAAA;IACnB,IAAMyoB,EAAE,GAAGT,aAAX;IACA,OAAO;MACHU,cAAc,EAAE,SAAA,cAAA,CAAC74B,KAAD,EAAA;QAAA,OACZ44B,EAAE,CAACnlC,OAAHmlC,CAAWjB,WAAXiB,IAA2B54B,KAAK,KAAK44B,EAAE,CAACnlC,OAAHmlC,CAAWlB,WAAXkB,GAAyB,CAAnC54B,GAAuC,CAAvCA,GAA2C44B,EAAE,CAACnlC,OAAHmlC,CAAWpB,MAAjFoB,CADY;MAAA,CADb;MAGHE,YAAY,EAAE,SAAA,YAAA,CAAC94B,KAAD,EAAA;QAAA,OACV44B,EAAE,CAACnlC,OAAHmlC,CAAWd,SAAXc,IAAwB54B,KAAK,KAAK44B,EAAE,CAACnlC,OAAHmlC,CAAWhB,QAAXgB,GAAsB,CAAhC54B,GAAoC,CAApCA,GAAwC44B,EAAE,CAACnlC,OAAHmlC,CAAWpB,MAA3EoB,CADU;MAAA;IAHX,CAAP;EAMH,CARqB,EAQnB,CAACT,aAAD,CARmB,CAAtB;EAUA,IAAMY,iBAAiB,GAAGrlC,mBAAmB,CAAC+a,WAAW,CAACxO,SAAS,CAACL,iBAAX,CAAZ,CAA7C;EACA,IAAMo5B,UAAU,GAAGxqB,WAAW,CAC1B,UAACnK,IAAD,EAAA;;IACI,IAAMrE,KAAK,GAAGqE,IAAI,CAACq0B,QAALr0B,GAAgB8zB,aAAa,CAAC1kC,OAAd0kC,CAAsBT,WAAtCrzB,GAAoDA,IAAI,CAACo0B,WAAvE;IAEA,OAAA,CAAA,qBAAA,GAAOM,iBAAiB,CAACtlC,OAAlBslC,CAA0B/4B,KAA1B+4B,CAAP,KAAA,IAAA,GAAA,qBAAA,GAAA,eAAA,GAA2D/4B,KAA3D;EACH,CALyB,EAM1B,CAACm4B,aAAD,EAAgBY,iBAAhB,CAN0B,CAA9B;EASA,IAAME,YAAY,GAAGzqB,WAAW,CAC5B,UAACnK,IAAD,EAAA;IACI,IAAMu0B,EAAE,GAAGT,aAAX;IACA,IAAMn4B,KAAK,GAAGqE,IAAI,CAACq0B,QAALr0B,GAAgBu0B,EAAE,CAACnlC,OAAHmlC,CAAWlB,WAA3BrzB,GAAyCA,IAAI,CAACo0B,WAA5D;IACA,IAAM5+B,MAAM,GAAGkG,cAAc,CAACC,KAAD,CAA7B;IACA,IAAID,cAAc,CAACC,KAAD,CAAdD,KAA0BvK,SAA9B,EAAyC,OAAO,IAAP;IAEzC,IAAM0jC,eAAe,GAAA,QAAA,CAAA,CAAA,CAAA,EACd70B,IAAI,CAACmZ,KADS,EAAA;MAEjBiV,YAAY,EAAEpuB,IAAI,CAACo0B,WAALp0B,KAAqBu0B,EAAE,CAACnlC,OAAHmlC,CAAWlB,WAAXkB,GAAyB,CAA9Cv0B,GAAkD,CAAlDA,GAAsDu0B,EAAE,CAACnlC,OAAHmlC,CAAWpB,MAF9D;MAGjBtN,aAAa,EAAE7lB,IAAI,CAACq0B,QAALr0B,KAAkBu0B,EAAE,CAACnlC,OAAHmlC,CAAWhB,QAAXgB,GAAsB,CAAxCv0B,GAA4C,CAA5CA,GAAgDu0B,EAAE,CAACnlC,OAAHmlC,CAAWpB,MAHzD;MAIjBnY,SAAS,EAAE;IAJM,CAAA,CAArB;IAOA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;MAAK7B,KAAK,EAAE0b;KAAZ,EACI,KAAA,CAAA,aAAA,CAAC1C,cAAD,EAAA;MAAgB38B,MAAM,EAAEA,MAAF,IAAA,IAAA,GAAEA,MAAF,GAAY,IAAA;MAAM+tB,YAAY,EAAE5nB,KAAAA;MAAOy2B,YAAY,EAAEc,UAAU,CAACrhC;KAAtF,CADJ,CADJ;EAKH,CAnB2B,EAoB5B,CAAC6J,cAAD,EAAiBw3B,UAAU,CAACrhC,IAA5B,CApB4B,CAAhC;EAuBA,IAAMijB,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAMigB,aAAa,GAAGhpB,OAAO,CAAC,YAAA;IAC1B,OACI,KAAA,CAAA,aAAA,CAACipB,gBAAD,EAAA;MACIzlC,GAAG,EAAEqkC,OAAAA;MACLva,SAAS,EAAEtE,OAAO,CAACkgB,aAAAA;MACnBC,kBAAkB,EAAErB,UAAU,CAACH,SAAXG,GAAuBA,UAAU,CAACT,MAAAA;MACtDM,SAAS,EAAEa,MAAM,CAACG,YAAAA;MAClBS,oBAAoB,EAAEtB,UAAU,CAACN,WAAXM,GAAyBA,UAAU,CAACT,MAAAA;MAC1DG,WAAW,EAAEgB,MAAM,CAACE,cAAAA;MACpBnB,WAAW,EAAEO,UAAU,CAACP,WAAAA;MACxBvb,MAAM,EAAEA,MAAAA;MACRyb,QAAQ,EAAEK,UAAU,CAACL,QAAAA;MACrB1b,KAAK,EAAEA,KAAAA;MACPsd,OAAO,EAAER;KAXb,EAaKC,YAbL,CADJ;EAiBH,CAlB4B,EAkB1B,CACC9f,OAAO,CAACkgB,aADT,EAECpB,UAAU,CAACH,SAFZ,EAGCG,UAAU,CAACT,MAHZ,EAICS,UAAU,CAACN,WAJZ,EAKCM,UAAU,CAACP,WALZ,EAMCO,UAAU,CAACL,QANZ,EAOCe,MAAM,CAACG,YAPR,EAQCH,MAAM,CAACE,cARR,EASC1c,MATD,EAUCD,KAVD,EAWC8c,UAXD,EAYCC,YAZD,CAlB0B,CAA7B;EAiCA,OAAOE,aAAP;AACH,CAlHyD,CAAnD;AAoHP,IAAMjgB,WAAS,GAAA,aAAGX,sBAAsB,CAAC,YAAA;EAAA,OAAO;IAC5C8gB,aAAa,EAAE,CAAA;EAD6B,CAAP;AAAA,CAAD,CAAxC;;ACtLA;;;;;AAqBO,IAAMI,aAAa,GAAA,aAAgC,KAAK,CAAC1f,IAAN,CAAW,UAAA,KAAK,EAAA;EACtE,IAAQmC,KAAR,GAA0BjC,KAA1B,CAAQiC,KAAR;IAAeC,MAAf,GAA0BlC,KAA1B,CAAekC,MAAf;EAEA,IAAMob,UAAU,GAAG9oB,WAAW,CAAClT,oBAAD,CAA9B;EAEA,IAAMm+B,OAAO,GAAGlmC,MAAM,EAAtB;EAEA,IAAMuM,cAAc,GAAG0O,WAAW,CAACxO,SAAS,CAACL,iBAAX,CAAlC;EACA,IAAMm5B,iBAAiB,GAAGrlC,mBAAmB,CAACqM,cAAD,CAA7C;EACA,IAAMi5B,UAAU,GAAGxqB,WAAW,CAC1B,UAACxO,KAAD,EAAA;IAAA,IAAA,qBAAA;IAAA,OAAA,CAAA,qBAAA,GAAmB+4B,iBAAiB,CAACtlC,OAAlBslC,CAA0B/4B,KAA1B+4B,CAAnB,KAAA,IAAA,GAAA,qBAAA,GAAA,eAAA,GAAuE/4B,KAAvE;EAAA,CAD0B,EAE1B,CAAC+4B,iBAAD,CAF0B,CAA9B;EAKA,IAAM5f,OAAO,GAAGD,WAAS,EAAzB;EACA,IAAMygB,aAAa,GAAGxpB,OAAO,CAAC,YAAA;IAC1B;IACA,IAAMypB,WAAW,GAAG,SAAdA,WAAc,CAACv1B,IAAD,EAAA;;MAChB,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;QAAKmZ,KAAK,EAAEnZ,IAAI,CAACmZ;OAAjB,EACI,KAAA,CAAA,aAAA,CAACgZ,cAAD,EAAA;QACI38B,MAAM,EAAA,CAAA,qBAAA,GAAEkG,cAAc,CAACsE,IAAI,CAACrE,KAAN,CAAhB,KAAA,IAAA,GAAA,qBAAA,GAAgC,IAAA;QACtC4nB,YAAY,EAAEvjB,IAAI,CAACrE,KAAAA;QACnBy2B,YAAY,EAAElxB,YAAY,CAACkE;OAH/B,CADJ,CADJ;IASH,CAVD;IAYA,OACI,KAAA,CAAA,aAAA,CAACowB,aAAD,EAAA;MACIlmC,GAAG,EAAE+lC,OAAAA;MACLjc,SAAS,EAAEtE,OAAO,CAAC2gB,aAAAA;MACnBC,QAAQ,EAAExC,UAAU,CAAC7tB,WAAAA;MACrByS,MAAM,EAAEA,MAAAA;MACR6d,SAAS,EAAEj6B,cAAc,CAAChJ,MAAAA;MAC1BmlB,KAAK,EAAEA,KAAAA;MACPsd,OAAO,EAAER;KAPb,EASKY,WATL,CADJ;EAaH,CA3B4B,EA2B1B,CACCzgB,OAAO,CAAC2gB,aADT,EAECvC,UAAU,CAAC7tB,WAFZ,EAGCyS,MAHD,EAICpc,cAJD,EAKCmc,KALD,EAMC8c,UAND,CA3B0B,CAA7B;EAoCA,OAAOW,aAAP;AACH,CApDyD,CAAnD;AAsDP,IAAMzgB,WAAS,GAAA,aAAGd,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IAC9C0hB,aAAa,EAAE;MACXG,SAAS,EAAA,YAAA,GAAethB,KAAK,CAACiF,OAANjF,CAAckF;IAD3B;EAD+B,CAAL;AAAA,CAAN,CAAvC;ICjDa+S,QAAQ,GAAA,aAA4B,KAAK,CAAC7W,IAAN,CAAW,UAACE,KAAD,EAAA;EACxD,IAAMla,cAAc,GAAG0O,WAAW,CAACxO,SAAS,CAACL,iBAAX,CAAlC;EACA,IAAM23B,UAAU,GAAG9oB,WAAW,CAAClT,oBAAD,CAA9B;EAEA,IAAMpC,aAAa,GAAGsV,WAAW,CAACvV,mBAAD,CAAjC;EACA,IAAA,YAAA,GAA+CwpB,WAAW,CAAC;MAAEpuB,IAAI,EAAE6E;IAAR,CAAD,CAA1D;IAAQwqB,IAAR,GAAA,YAAA,CAAQA,IAAR;IAAcD,UAAd,GAAA,YAAA,CAAcA,UAAd;IAA0BD,gBAA1B,GAAA,YAAA,CAA0BA,gBAA1B;EACA,IAAM0S,UAAU,GAAGhmB,OAAO,CAAa,YAAA;IAAA,OAAO;MAAEuT,UAAU,EAAVA,UAAF;MAAcD,gBAAgB,EAAhBA;IAAd,CAAP;EAAA,CAAb,EAAuD,CAACC,UAAD,EAAaD,gBAAb,CAAvD,CAA1B;EAEA,IAAMyW,YAAY,GAAGC,cAAc,CAAChE,UAAD,CAAnC;EACA,IAAMhd,OAAO,GAAGD,WAAS,CAACqe,UAAD,CAAzB;EACA,IAAQ6C,QAAR,GAAqBngB,KAArB,CAAQmgB,QAAR,CAAA,CAAA;EAGA;EACA;;EACA,IAAMC,mBAAmB,GAAG,IAA5B;EAEA,IAAMC,YAAY,GAAG9rB,WAAW,CAC5B,UAAA,IAAA,EAAA;QAAG0N,KAAAA,GAAAA,IAAAA,CAAAA,KAAAA;MAAOC,MAAAA,GAAAA,IAAAA,CAAAA,MAAAA;IACN,IAAIpc,cAAc,CAAChJ,MAAfgJ,KAA0B,CAA9B,EAAiC;MAC7B,OAAO,KAAA,CAAA,aAAA,CAAC2wB,aAAD,EAAA;QAAexU,KAAK,EAAEA,KAAAA;QAAOC,MAAM,EAAEob,UAAU,CAAC7tB;OAAhD,CAAP;IACH,CAFD,MAEO,IAAI6tB,UAAU,CAACrhC,IAAXqhC,KAAoBhyB,YAAY,CAACkE,IAArC,EAA2C;MAC9C,OAAO,KAAA,CAAA,aAAA,CAACgwB,aAAD,EAAA;QAAevd,KAAK,EAAEA,KAAAA;QAAOC,MAAM,EAAEA;OAArC,CAAP;IACH,CAFM,MAEA;MACH,OAAO,KAAA,CAAA,aAAA,CAAC4b,aAAD,EAAA;QAAe7b,KAAK,EAAEA,KAAAA;QAAOC,MAAM,EAAEA;OAArC,CAAP;IACH;EACJ,CAT2B,EAU5B,CAACpc,cAAD,EAAiBw3B,UAAjB,CAV4B,CAAhC;EAaA,IAAM1Q,UAAU,GAAGjW,UAAU,CAACoB,iBAAD,CAA7B;EACA,OACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKooB,QAAQ,EAAEA,QAAAA;IAAUzmC,GAAG,EAAEgwB,IAAAA;IAAMlG,SAAS,EAAEpE,CAAC,CAAC,CAACF,OAAO,CAACohB,eAAT,EAA0BL,YAAY,CAACK,eAAvC,CAAD,CAAA;IAA2D5U,IAAI,EAAC;GAAhH,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAKlI,SAAS,EAAEyc,YAAY,CAACM;GAA7B,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;IAAK/c,SAAS,EAAEyc,YAAY,CAACO;GAA7B,EACI,KAAA,CAAA,aAAA,CAAC5T,UAAD,EAAA;IAAYte,IAAI,EAAEmb,UAAU,GAAGle,cAAc,CAACke,UAAlB,GAA+Ble,cAAc,CAAC+gB;GAA1E,CADJ,CADJ,CADJ,EAMI,KAAA,CAAA,aAAA,CAACmU,SAAD,EAAA;IAAWC,aAAa,EAAE,CAACN;GAA3B,EAAiDC,YAAjD,CANJ,CADJ;AAUH,CAzCgD,CAA1C;AA0CP1J,QAAQ,CAAC1W,WAAT0W,GAAuB,UAAvBA;AAEA,IAAMuJ,cAAc,GAAA,aAAG/hB,qBAAqB,CAAC,UAAA,KAAK,EAAA;EAAA,OAAK;IACnDmiB,eAAe,EAAE;MACbpO,SAAS,EAAE9pB,aAAa,CAAC2H,cAAd3H,CAA6B7G,cAA7B6G,CAA4CqH,WAA5CrH,GAA0D,CADxD;MAEb0b,UAAU,EAAE,SAAA,UAAA,CAAC7lB,KAAD,EAAA;QAAA,OACRA,KAAK,CAACurB,gBAANvrB,IAA0BA,KAAK,CAACwrB,UAAhCxrB,GACMA,KAAK,CAACwrB,UAANxrB,GACI+f,iBAAiB,CAACU,KAAK,CAAC1C,GAAN0C,CAAUrC,sBAAX,EAAmCqC,KAAK,CAAC1C,GAAN0C,CAAUpC,sBAA7C,CADrBre,GAEI+f,iBAAiB,CAACU,KAAK,CAAC1C,GAAN0C,CAAUnC,yBAAX,EAAsCmC,KAAK,CAAC1C,GAAN0C,CAAUlC,yBAAhD,CAH3Bve,GAIM,MALE;MAAA;IAFC,CADkC;IAUnDsiC,WAAW,EAAE;MACThe,OAAO,EAAE,SAAA,OAAA,CAACtkB,KAAD,EAAA;QAAA;UAAA;UAELA,KAAK,CAACurB,gBAANvrB,IAA0BA,KAAK,CAACwrB,UAAhCxrB,GAA6C,OAA7CA,GAAuD;QAAA;MAFlD,CADA;MAIT2e,YAAY,EAAE8B,KAAK,CAAC1B,aAAN0B,CAAoB9B,YAJzB;MAKTiF,aAAa,EAAE,MALN;MAMTD,QAAQ,EAAE,UAND;MAOTM,MAAM,EAAE,MAPC;MAQTD,KAAK,EAAE,MARE;MASTH,MAAM,EAAE;IATC,CAVsC;IAqBnD0e,eAAe,EAAE;MACb3c,eAAe,EAAE,SAAA,eAAA,CAAC5lB,KAAD,EAAA;QAAA,OAAwBA,KAAK,CAACwrB,UAANxrB,GAAmBygB,KAAK,CAAC1C,GAAN0C,CAAUvC,WAA7Ble,GAA2CygB,KAAK,CAAC1C,GAAN0C,CAAUtC,cAA7E;MAAA,CADJ;MAEb2H,KAAK,EAAE,SAAA,KAAA,CAAC9lB,KAAD,EAAA;QAAA,OAAwBA,KAAK,CAACwrB,UAANxrB,GAAmBygB,KAAK,CAAC1C,GAAN0C,CAAUzC,YAA7Bhe,GAA4CygB,KAAK,CAAC1C,GAAN0C,CAAUxC,eAA9E;MAAA,CAFM;MAGbU,YAAY,EAAE8B,KAAK,CAAC1B,aAAN0B,CAAoB9B,YAHrB;MAIb8F,SAAS,EAAE,mCAJE;MAKbd,QAAQ,EAAE,UALG;MAMbyD,SAAS,EAAE,QANE;MAObxJ,UAAU,EAAE,MAPC;MAQbC,QAAQ,EAAE,KARG;MASbiG,IAAI,EAAE,KATO;MAUbG,MAAM,EAAE,EAVK;MAWbF,GAAG,EAAE,KAXQ;MAYbC,KAAK,EAAE;IAZM;EArBkC,CAAL;AAAA,CAAN,CAA5C;AAqCA,IAAMhD,WAAS,GAAA,aAAGX,sBAAsB,CAAC,YAAA;EAAA,OAAO;IAC5CgiB,eAAe,EAAE;MACbpe,MAAM,EAAE,MADK;MAEbye,SAAS,EAAE;IAFE;EAD2B,CAAP;AAAA,CAAD,CAAxC;;AC3GA;;;;;AAMA,IAgBaC,eAAe,GAAA,aAAmC,KAAK,CAAC9gB,IAAN,CAAW,YAAA;EACtE,IAAMlY,QAAQ,GAAG+M,WAAW,EAA5B;EACA5b,SAAS,CAAC,YAAA;IACN6O,QAAQ,CAACC,YAAY,CAAC6K,qBAAb7K,CAAmC,IAAnCA,CAAD,CAARD;IACA,OAAO,YAAA;MACHA,QAAQ,CAACC,YAAY,CAAC6K,qBAAb7K,CAAmC,KAAnCA,CAAD,CAARD;IACH,CAFD;EAGH,CALQ,EAKN,CAACA,QAAD,CALM,CAAT7O;EAOA,IAAMid,IAAI,GAAGC,OAAO,EAApB;EACA,IAAM4qB,yBAAyB,GAAG,IAAI,CAAC1qB,aAAL,CAC9B;IACInZ,EAAE,EAAE0Y,SAAS,CAACD,aAAa,CAACmrB,eAAf,EAAgC,qBAAhC,CADjB;IAEIvqB,cAAc,EAAE;EAFpB,CAD8B,EAK9B;IAAEyqB,QAAQ,EAAE3gB,KAAAA,CAAAA,aAAAA,CAAAA,QAAAA,EAAAA,IAAAA,EAAAA,mBAAAA;EAAZ,CAL8B,CAAlC;EAQA,IAAMxd,iBAAiB,GAAG6R,WAAW,CAAC9R,uBAAD,CAArC;EACA,IAAM5D,gBAAgB,GAAG0V,WAAW,CAAC3V,sBAAD,CAApC;EAEA,IAAM8T,eAAe,GAAG8O,uBAAuB,EAA/C;EACA,IAAMsf,yBAAyB,GAAG7qB,OAAO,CAAC,YAAA;IACtC,IAAMkb,UAAU,GAAmB,EAAnC;+BACSv0B,CAAAA,EAAAA;MACL,IAAME,IAAI,GAAG+B,gBAAgB,CAACjC,CAAD,CAA7B;MAEA,IAAI,OAAOE,IAAP,KAAgB,QAApB,EAA8B;QAC1Bq0B,UAAU,CAAC70B,IAAX60B,CACI,KAAA,CAAA,aAAA,CAACe,0BAAD,EAAA;UACI3c,GAAG,EAAA,oBAAA,GAAuBzY,IAAAA;UAC1B2B,YAAY,EAAE3B,IAAAA;UACdq1B,eAAe,EAAEzf;SAHrB,CADJye,CAAAA;MAOH,CARD,MAQO;QACHr0B,IAAI,CAACyB,aAALzB,CAAmB6D,GAAnB7D,CAAuB,UAAA,EAAE,EAAA;UAAA,OACrB,UAAU,CAACR,IAAX,CACI,KAAA,CAAA,aAAA,CAAC41B,0BAAD,EAAA;YACI3c,GAAG,EAAA,oBAAA,GAAuBzY,IAAI,CAACE,IAA5B,GAAA,GAAA,GAAoCD,EAAAA;YACvC0B,YAAY,EAAE1B,EAAAA;YACdo1B,eAAe,EAAEzf;WAHrB,CADJ,CADqB;QAAA,CAAzB5V,CAAAA;MASH;;IArBL,KAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiC,gBAAgB,CAAChC,MAArC,EAA6C,EAAED,CAA/C,EAAkD;MAAA,KAAA,CAAzCA,CAAyC,CAAA;IAsBjD;IACD,OAAOu0B,UAAP;EACH,CA1BwC,EA0BtC,CAACtyB,gBAAD,EAAmB6T,eAAnB,CA1BsC,CAAzC;EA4BA,IAAMquB,cAAc,GAAG9qB,OAAO,CAC1B,YAAA;IAAA,OAAOvT,iBAAiB,GAAG;MAAEqf,GAAG,EAAErf,iBAAiB,CAACoM,MAAzB;MAAiCgT,IAAI,EAAEpf,iBAAiB,CAACkM;IAAzD,CAAH,GAAuEtT,SAA/F;EAAA,CAD0B,EAE1B,CAACoH,iBAAD,CAF0B,CAA9B;EAKA,IAAMuc,OAAO,GAAGD,WAAS,EAAzB;EACA,OACI,KAAA,CAAA,aAAA,CAAC4T,IAAD,EAAA;IACIG,SAAS,EAAE,CAAA;IACXiO,aAAa,EAAA,IAAA;IACb/N,OAAO,EAAEvgB,eAAAA;IACT0gB,kBAAkB,EAAE,GAAA;IACpBF,IAAI,EAAE,CAAC,CAACxwB,iBAAAA;IACRq+B,cAAc,EAAEA,cAAAA;IAChBE,eAAe,EAAC,gBAAA;IAChBhiB,OAAO,EAAE;MAAExP,IAAI,EAAEwP,OAAO,CAACiiB;IAAhB;GARb,EAUKJ,yBAVL,EAWI,KAAA,CAAA,aAAA,CAACK,aAAD,EAAA;IAAe/P,SAAS,EAAC,KAAA;IAAM7N,SAAS,EAAEtE,OAAO,CAACmiB;GAAlD,EACKR,yBADL,CAXJ,CADJ;AAiBH,CAzE8D,CAAxD;AA2EP,IAAM5hB,WAAS,GAAA,aAAGX,sBAAsB,CAAC,YAAA;EAAA,OAAO;IAC5C6iB,eAAe,EAAE;MACblR,aAAa,EAAE9Q,SAAS,CAAC,CAAD,CADX;MAEb+Q,UAAU,EAAE/Q,SAAS,CAAC,CAAD;IAFR,CAD2B;IAK5CkiB,kBAAkB,EAAE;MAChBxlB,UAAU,EAAEsD,SAAS,CAAC,MAAD,CADL;MAEhBrD,QAAQ,EAAEqD,SAAS,CAAC,OAAD;IAFH;EALwB,CAAP;AAAA,CAAD,CAAxC;;ACjGA;;;;;AAMA,IASamiB,eAAe,GAAA,aAAG,KAAK,CAACxhB,IAAN,EAAA,aAC3B,KAAK,CAACC,UAAN,CAAsD,UAACC,KAAD,EAAQtmB,GAAR,EAAA;EAClD,IAAQymC,QAAR,GAAqBngB,KAArB,CAAQmgB,QAAR;EACA,OACI,KAAA,CAAA,aAAA,CAACxa,WAAD,EAAA,MAAA,CAAA,MAAA,CAAA;IAAajsB,GAAG,EAAEA;KAASsmB,KAAAA,CAA3B,EACIG,KAAAA,CAAAA,aAAAA,CAAC+Q,UAAD/Q,EAAAA,IAAAA,CADJ,EAEIA,KAAAA,CAAAA,aAAAA,CAAC8V,WAAD9V,EAAAA,IAAAA,CAFJ,EAGI,KAAA,CAAA,aAAA,CAACwW,QAAD,EAAA;IAAUwJ,QAAQ,EAAEA;GAApB,CAHJ,EAIIhgB,KAAAA,CAAAA,aAAAA,CAACygB,eAADzgB,EAAAA,IAAAA,CAJJ,CADJ;AAQH,CAVD,CAD2B,CAAxB;AAaPmhB,eAAe,CAACrhB,WAAhBqhB,GAA8B,iBAA9BA;ACJO,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAC1B/hC,OAD0B,EAE1BgiC,eAF0B,EAAA;EAI1B,OAAOtrB,OAAO,CAAC,YAAA;IACX,IAAMhX,aAAa,GAAGM,OAAO,CAACgiC,eAAD,CAA7B;IAEA,IAAMxiC,WAAW,GAAG,CAACE,aAAD,CAApB;IAEA,IAAIuiC,QAAQ,GAAGviC,aAAa,CAACuiC,QAA7B;IACA,OAAOA,QAAP,EAAiB;MACb,IAAMC,UAAU,GAAGliC,OAAO,CAACiiC,QAAD,CAA1B;MACA,IAAIC,UAAJ,EAAgB;QACZ1iC,WAAW,CAAC2iC,OAAZ3iC,CAAoB0iC,UAApB1iC,CAAAA;QACAyiC,QAAQ,GAAGC,UAAU,CAACD,QAAtBA;MACH,CAHD,MAGO;QACH;MACH;IACJ;IAED,OAAOziC,WAAP;EACH,CAjBa,EAiBX,CAACwiC,eAAD,EAAkBhiC,OAAlB,CAjBW,CAAd;AAkBH,CAtBM;AAwBA,IAAMoiC,QAAQ,GAAG,SAAXA,QAAW,CACpBpiC,OADoB,EAEpBgiC,eAFoB,EAAA;EAIpB,OAAOtrB,OAAO,CAAC,YAAA;IACX,IAAMhX,aAAa,GAAGM,OAAO,CAACgiC,eAAD,CAA7B;IACA,IAAMK,WAAW,GAAG3iC,aAAa,CAAC2iC,WAAlC;IACA,IAAM39B,KAAK,GAAG,WAAW,CAACtD,GAAZ,CAAgB,UAAChB,MAAD,EAAA;MAAA,OAAoBJ,OAAO,CAACI,MAAD,CAA3B;IAAA,CAAhB,CAAd;IACA,OAAOsE,KAAP;EACH,CALa,EAKX,CAACs9B,eAAD,EAAkBhiC,OAAlB,CALW,CAAd;AAMH,CAVM;AAYA,IAAMsiC,iBAAiB,GAAG,SAApBA,iBAAoB,CAC7BC,WAD6B,EAE7BC,eAF6B,EAAA;EAI7B,IAAA,SAAA,GAA8BlpC,QAAQ,CAACipC,WAAD,CAAtC;IAAOviC,OAAP,GAAA,SAAA,CAAA,CAAA,CAAA;IAAgByiC,UAAhB,GAAA,SAAA,CAAA,CAAA,CAAA;EACA,IAAA,UAAA,GAA8CnpC,QAAQ,CAACkpC,eAAD,CAAtD;IAAOR,eAAP,GAAA,UAAA,CAAA,CAAA,CAAA;IAAwBU,kBAAxB,GAAA,UAAA,CAAA,CAAA,CAAA;EACA,IAAMC,YAAY,GAAG5tB,WAAW,CAAC,YAAA;IAC7B0tB,UAAU,CAACF,WAAD,CAAVE;IACAC,kBAAkB,CAACF,eAAD,CAAlBE;EACH,CAH+B,EAG7B,CAACH,WAAD,EAAcC,eAAd,CAH6B,CAAhC;EAIA,IAAMI,SAAS,GAAG7tB,WAAW,CACzB,UAACrQ,KAAD,EAAcujB,MAAd,EAA0BvZ,WAA1B,EAAA;IAAA,OACI+zB,UAAU,CAAC,UAAA,cAAc,EAAA;MACrB,IAAMI,UAAU,GAAA,QAAA,CAAA,CAAA,CAAA,EAAQC,cAAR,CAAhB;MACA,IAAMC,WAAW,GAAG,IAAI5lC,GAAJ,CAAQ,KAAK,CAACiE,GAAN,CAAU,UAAA,CAAC,EAAA;QAAA,OAAIyE,CAAC,CAACrI,EAAN;MAAA,CAAX,CAAR,CAApB,CAAA,CAAA;;MAGA,IAAMwlC,oBAAoB,GAAG,MAAM,CAACX,WAAP,CAAoBj8B,MAApB,CAA2B,UAAA,EAAE,EAAA;QAAA,OAAI,CAAC28B,WAAW,CAACrlC,GAAZqlC,CAAgBvlC,EAAhBulC,CAAL;MAAA,CAA7B,CAA7B;MACAF,UAAU,CAAC5a,MAAM,CAACzqB,EAAR,CAAVqlC,GAAAA,QAAAA,CAAAA,CAAAA,CAAAA,EACO5a,MADP4a,EAAAA;QAEIR,WAAW,EAAEW,oBAFjBH;QAGItmC,aAAa,EAAEymC,oBAAoB,CAAC1lC;MAHxCulC,CAAAA,CAAAA,CAAAA,CAAAA;;MAOA,IAAMI,yBAAyB,GAAA,EAAA,CAAA,MAAA,CAAOv0B,WAAW,CAAC2zB,WAAnB,EAAoC,KAAK,CAACjhC,GAAN,CAAU,UAAA,CAAC,EAAA;QAAA,OAAIyE,CAAC,CAACrI,EAAN;MAAA,CAAX,CAApC,CAA/B;MACAqlC,UAAU,CAACn0B,WAAW,CAAClR,EAAb,CAAVqlC,GAAAA,QAAAA,CAAAA,CAAAA,CAAAA,EACOn0B,WADPm0B,EAAAA;QAEIR,WAAW,EAAEY,yBAFjBJ;QAGItmC,aAAa,EAAE0mC,yBAAyB,CAAC3lC;MAH7CulC,CAAAA,CAAAA,CAAAA,CAAAA;MAOA;;MACAn+B,KAAK,CAACwB,OAANxB,CAAc,UAAA,IAAI,EAAA;QACdm+B,UAAU,CAAChoC,IAAI,CAAC2C,EAAN,CAAVqlC,GAAAA,QAAAA,CAAAA,CAAAA,CAAAA,EACOhoC,IADPgoC,EAAAA;UAEIZ,QAAQ,EAAEvzB,WAAW,CAAClR;QAF1BqlC,CAAAA,CAAAA;MAIH,CALDn+B,CAAAA;MAOA,OAAOm+B,UAAP;IACH,CA9BS,CADd;EAAA,CADyB,EAiCzB,EAjCyB,CAA7B;EAoCA,IAAMK,OAAO,GAAGxsB,OAAO,CACnB,YAAA;IAAA,OAAO;MACH+rB,UAAU,EAAVA,UADG;MAEHC,kBAAkB,EAAlBA,kBAFG;MAGHC,YAAY,EAAZA,YAHG;MAIHC,SAAS,EAATA;IAJG,CAAP;EAAA,CADmB,EAOnB,CAACH,UAAD,EAAaC,kBAAb,EAAiCC,YAAjC,EAA+CC,SAA/C,CAPmB,CAAvB;EASA,OAAO;IACH5iC,OAAO,EAAPA,OADG;IAEHgiC,eAAe,EAAfA,eAFG;IAGHkB,OAAO,EAAPA;EAHG,CAAP;AAKH,CA5DM;AA+DA,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACD,OAAD,EAAA;EAChC,OAAOnuB,WAAW,CACd,UAACnK,IAAD,EAAA;IACI,IAAIA,IAAI,CAACpN,EAALoN,KAAYhC,aAAa,CAAC+E,SAAd/E,CAAwBpL,EAAxC,EAA4C;MACxC,IAAA,aAAA,GAA8BoN,IAAI,CAACK,OAAnC;QAAQ2C,UAAR,GAAA,aAAA,CAAQA,UAAR;QAAoBlJ,KAApB,GAAA,aAAA,CAAoBA,KAApB;MACA,IAAM0+B,UAAU,GAAGx1B,UAAH,IAAA,IAAA,GAAGA,UAAH,GAAiBlJ,KAAK,CAAC,CAAD,CAAtC;MACA,IAAI0+B,UAAU,IAAIzoC,UAAU,CAACC,WAAXD,CAAuByoC,UAAvBzoC,CAAlB,EAAsD;QAClDuoC,OAAO,CAACR,kBAARQ,CAA2BE,UAAU,CAAC5lC,EAAtC0lC,CAAAA;MACH;IACJ,CAND,MAMO,IAAIt4B,IAAI,CAACpN,EAALoN,KAAYhC,aAAa,CAACgG,SAAdhG,CAAwBpL,EAAxC,EAA4C;MAC/C0lC,OAAO,CAACN,SAARM,CAAkBt4B,IAAI,CAACK,OAALL,CAAalG,KAA/Bw+B,EAAsCt4B,IAAI,CAACK,OAALL,CAAaqd,MAAnDib,EAA4Dt4B,IAAI,CAACK,OAALL,CAAa8D,WAAzEw0B,CAAAA;IACH;EACJ,CAXa,EAYd,CAACA,OAAD,CAZc,CAAlB;AAcH,CAfM;AAiBA,IAAMG,UAAU,GAAG,SAAbA,UAAa,CAAA,IAAA,EAAA;MACtBd,WAAAA,GAAAA,IAAAA,CAAAA,WAAAA;IACAC,eAAAA,GAAAA,IAAAA,CAAAA,eAAAA;EAEA,IAAA,kBAAA,GAA8CF,iBAAiB,CAACC,WAAD,EAAcC,eAAd,CAA/D;IAAQxiC,OAAR,GAAA,kBAAA,CAAQA,OAAR;IAAiBgiC,eAAjB,GAAA,kBAAA,CAAiBA,eAAjB;IAAkCkB,OAAlC,GAAA,kBAAA,CAAkCA,OAAlC;EACA,IAAM1jC,WAAW,GAAGuiC,cAAc,CAAC/hC,OAAD,EAAUgiC,eAAV,CAAlC;EACA,IAAMt9B,KAAK,GAAG09B,QAAQ,CAACpiC,OAAD,EAAUgiC,eAAV,CAAtB;EACA,IAAMsB,iBAAiB,GAAGH,oBAAoB,CAACD,OAAD,CAA9C;EAEA,IAAMt4B,IAAI,GAAG;IACT5K,OAAO,EAAPA,OADS;IAETgiC,eAAe,EAAfA,eAFS;IAGTxiC,WAAW,EAAXA,WAHS;IAITkF,KAAK,EAALA;EAJS,CAAb;EAMA,OAAO;IAAEkG,IAAI,EAAJA,IAAF;IAAQs4B,OAAO,EAAPA,OAAR;IAAiBI,iBAAiB,EAAjBA;EAAjB,CAAP;AACH,CAhBM","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\n\nexport const useDebounce = <T>(\n    value: T,\n    delay: number\n): [T, React.Dispatch<React.SetStateAction<T>>] => {\n    const [debouncedValue, setDebouncedValue] = useState(value);\n\n    useEffect(() => {\n        const handler = setTimeout(() => {\n            setDebouncedValue(value);\n        }, delay);\n\n        return () => {\n            clearTimeout(handler);\n        };\n    }, [value, delay]);\n\n    return [debouncedValue, setDebouncedValue];\n};\n\nconst UNINITIALIZED_SENTINEL = {};\nexport const useStaticValue = <T>(factory: () => T): T => {\n    const valueRef = useRef<T>(UNINITIALIZED_SENTINEL as T);\n    if (valueRef.current === UNINITIALIZED_SENTINEL) valueRef.current = factory();\n    return valueRef.current;\n};\n\nexport const useInstanceVariable = <T>(value: T) => {\n    const ref = useRef(value);\n    useEffect(() => {\n        ref.current = value;\n    }, [ref, value]);\n    return ref;\n};\n","export class Logger {\n    public static error(...args: any[]): void {\n        // eslint-disable-next-line no-console\n        console.error('[Chonky runtime error]', ...args);\n    }\n\n    public static warn(...args: any[]): void {\n        // eslint-disable-next-line no-console\n        console.warn('[Chonky runtime warning]', ...args);\n    }\n\n    public static debug(...args: any[]): void {\n        // eslint-disable-next-line no-console\n        console.debug('[Chonky runtime debug]', ...args);\n    }\n\n    public static formatBullets(bullets: string[]): string {\n        return `\\n- ${bullets.join('\\n- ')}`;\n    }\n}\n","import { Nullable } from 'tsdef';\n\nimport { FileData } from '../types/file.types';\nimport { Logger } from './logger';\n\nexport class FileHelper {\n    public static isDirectory(file: Nullable<FileData>): file is FileData {\n        // Not a directory by default\n        return !!file && file.isDir === true;\n    }\n\n    public static isHidden(file: Nullable<FileData>): file is FileData {\n        // Not hidden by default\n        return !!file && file.isHidden === true;\n    }\n\n    public static isSymlink(file: Nullable<FileData>): file is FileData {\n        // Not a symlink by default\n        return !!file && file.isSymlink === true;\n    }\n\n    public static isEncrypted(file: Nullable<FileData>): file is FileData {\n        // Not encrypted by default\n        return !!file && file.isEncrypted === true;\n    }\n\n    public static isClickable(file: Nullable<FileData>): file is FileData {\n        // Clickable by default\n        return !!file;\n    }\n\n    public static isOpenable(file: Nullable<FileData>): file is FileData {\n        // Openable by default\n        return !!file && file.openable !== false;\n    }\n\n    public static isSelectable(file: Nullable<FileData>): file is FileData {\n        // Selectable by default\n        return !!file && file.selectable !== false;\n    }\n\n    public static isDraggable(file: Nullable<FileData>): file is FileData {\n        // File & folders are draggable by default, `null` is not\n        return !!file && file.draggable !== false;\n    }\n\n    public static isDroppable(file: Nullable<FileData>): file is FileData {\n        // Folders are droppable by default, files are not\n        if (!file) return false;\n        if (file.isDir && file.droppable !== false) return true;\n        return file.droppable === true;\n    }\n\n    public static isDndOpenable(file: Nullable<FileData>): file is FileData {\n        // Folders are DnD openable by default, files are not\n        if (!FileHelper.isOpenable(file)) return false;\n        if (file.isDir && file.dndOpenable !== false) return true;\n        return file.dndOpenable === true;\n    }\n\n    public static getModDate(file: Nullable<FileData>): Nullable<Date> {\n        if (!file || file.modDate === null || file.modDate === undefined) return null;\n        return FileHelper.parseDate(file.modDate);\n    }\n\n    public static parseDate(maybeDate: Date | string | any): Nullable<Date> {\n        if (typeof maybeDate === 'string' || typeof maybeDate === 'number') {\n            // We allow users to provide string and numerical representations of dates.\n            try {\n                return new Date(maybeDate);\n            } catch (error) {\n                Logger.error(\n                    `Could not convert provided string/number into a date: ${error.message} `,\n                    'Invalid value:',\n                    maybeDate\n                );\n            }\n        }\n        if (maybeDate instanceof Date && !isNaN(maybeDate.getTime())) {\n            // We only allow valid dates objects\n            return maybeDate;\n        }\n\n        // If we have an invalid date representation, we just return null.\n        Logger.warn('Unsupported date representation:', maybeDate);\n        return null;\n    }\n\n    public static getChildrenCount(file: Nullable<FileData>): Nullable<number> {\n        if (!file || typeof file.childrenCount !== 'number') return null;\n\n        return file.childrenCount;\n    }\n}\n","import { Nullable } from 'tsdef';\n\nimport { FileAction } from '../types/action.types';\nimport { FileArray } from '../types/file.types';\nimport { Logger } from '../util/logger';\n\ninterface SanitizeFiles {\n    (mode: 'files', rawArray: FileArray | any): {\n        sanitizedArray: FileArray;\n        errorMessages: string[];\n    };\n    (mode: 'folderChain', rawArray: Nullable<FileArray> | any): {\n        sanitizedArray: FileArray;\n        errorMessages: string[];\n    };\n    (mode: 'fileActions', rawArray: FileAction[] | any): {\n        sanitizedArray: FileAction[];\n        errorMessages: string[];\n    };\n}\n\nexport const sanitizeInputArray: SanitizeFiles = (mode: string, rawArray: any[]) => {\n    const sanitizedFiles = [];\n    const errorMessages: string[] = [];\n\n    if ((mode === 'folderChain' || mode === 'fileActions') && !rawArray) {\n        // Do nothing, we allow folder chain to be null.\n    } else if (!Array.isArray(rawArray)) {\n        errorMessages.push(\n            `Expected \"${mode}\" prop to be an array, got \"${typeof rawArray}\" instead.`\n        );\n    } else {\n        let nonObjectFileCount = 0;\n        let missingFieldFileCount = 0;\n        const seenIds = new Set<string>();\n        const duplicateIds = new Set<string>();\n\n        for (let i = 0; i < rawArray.length; ++i) {\n            const item = rawArray[i];\n            if (!item) {\n                if (mode === 'fileActions') nonObjectFileCount++;\n                else sanitizedFiles.push(null);\n            } else if (typeof item !== 'object') {\n                nonObjectFileCount++;\n            } else {\n                if (!item.id || (mode !== 'fileActions' && !item.name)) {\n                    missingFieldFileCount++;\n                } else if (seenIds.has(item.id)) {\n                    duplicateIds.add(item.id);\n                } else {\n                    seenIds.add(item.id);\n                    sanitizedFiles.push(item);\n                }\n            }\n        }\n\n        if (nonObjectFileCount) {\n            errorMessages.push(\n                `Detected ${nonObjectFileCount} file(s) of invalid type. Remember ` +\n                    `that \"files\" array should contain either objects or nulls.`\n            );\n        }\n        if (missingFieldFileCount) {\n            errorMessages.push(\n                `Detected ${missingFieldFileCount} file(s) that are missing the ` +\n                    `required fields. Remember that file object should define an ` +\n                    `\"id\" and a \"name\".`\n            );\n        }\n        if (duplicateIds.size > 0) {\n            const repeatedIdsString = '\"' + Array.from(duplicateIds).join('\", \"') + '\"';\n            errorMessages.push(\n                `Detected ${duplicateIds.size} file IDs that are used multiple ` +\n                    `times. Remember that each file should have a unique IDs. The ` +\n                    `following IDs were seen multiple times: ${repeatedIdsString}`\n            );\n        }\n    }\n\n    if (errorMessages.length > 0) {\n        const errorMessageString = '\\n- ' + errorMessages.join('\\n- ');\n        let arrayString: string;\n        let itemString: string;\n        if (mode === 'folderChain') {\n            arrayString = 'folder chain';\n            itemString = 'files';\n        } else if (mode === 'fileActions') {\n            arrayString = 'file actions';\n            itemString = 'file actions';\n        } else {\n            // mode === 'files'\n            arrayString = 'files';\n            itemString = 'files';\n        }\n\n        Logger.error(\n            `Errors were detected when sanitizing the ${arrayString} array. ` +\n                `Offending ${itemString} were removed from the array. Summary of ` +\n                `validation errors: ${errorMessageString}`\n        );\n    }\n\n    return {\n        sanitizedArray: sanitizedFiles,\n        errorMessages,\n    };\n};\n","/**\n * We have option IDs in a separate file to avoid circular deps...\n */\nexport const OptionIds = {\n    ShowHiddenFiles: 'show_hidden_files',\n    ShowFoldersFirst: 'show_folders_first',\n    DarkMode: 'dark_mode',\n};\n","import { Nullable } from 'tsdef';\n\nimport { FileData } from './file.types';\n\nexport type FileSortKeySelector = (file: Nullable<FileData>) => any;\n\nexport enum SortOrder {\n    ASC = 'asc',\n    DESC = 'desc',\n}\n","import sort from 'fast-sort';\nimport FuzzySearch from 'fuzzy-search';\nimport { Nilable, Nullable } from 'tsdef';\n\nimport { createSelector } from '@reduxjs/toolkit';\n\nimport { OptionIds } from '../action-definitions/option-ids';\nimport { FileArray, FileData, FileFilter } from '../types/file.types';\nimport { RootState } from '../types/redux.types';\nimport { FileSortKeySelector, SortOrder } from '../types/sort.types';\nimport { FileHelper } from '../util/file-helper';\n\n// Raw selectors\nexport const selectInstanceId = (state: RootState) => state.instanceId;\nexport const selectExternalFileActionHandler = (state: RootState) => state.externalFileActionHandler;\n\nexport const selectFileActionMap = (state: RootState) => state.fileActionMap;\nexport const selectFileActionIds = (state: RootState) => state.fileActionIds;\nexport const selectFileActionData = (fileActionId: string) => (state: RootState) =>\n    selectFileActionMap(state)[fileActionId];\nexport const selectToolbarItems = (state: RootState) => state.toolbarItems;\nexport const selectContextMenuItems = (state: RootState) => state.contextMenuItems;\n\nexport const selectFolderChain = (state: RootState) => state.folderChain;\nexport const selectCurrentFolder = (state: RootState) => {\n    const folderChain = selectFolderChain(state);\n    const currentFolder = folderChain.length > 0 ? folderChain[folderChain.length - 1] : null;\n    return currentFolder;\n};\nexport const selectParentFolder = (state: RootState) => {\n    const folderChain = selectFolderChain(state);\n    const parentFolder = folderChain.length > 1 ? folderChain[folderChain.length - 2] : null;\n    return parentFolder;\n};\n\nexport const selectRawFiles = (state: RootState) => state.rawFiles;\nexport const selectFileMap = (state: RootState) => state.fileMap;\nexport const selectCleanFileIds = (state: RootState) => state.cleanFileIds;\nexport const selectFileData = (fileId: Nullable<string>) => (state: RootState) =>\n    fileId ? selectFileMap(state)[fileId] : null;\n\nexport const selectHiddenFileIdMap = (state: RootState) => state.hiddenFileIdMap;\nexport const selectHiddenFileCount = (state: RootState) => Object.keys(selectHiddenFileIdMap(state)).length;\n\nexport const selectFocusSearchInput = (state: RootState) => state.focusSearchInput;\nexport const selectSearchString = (state: RootState) => state.searchString;\n\nexport const selectSelectionMap = (state: RootState) => state.selectionMap;\nexport const selectSelectedFileIds = (state: RootState) => Object.keys(selectSelectionMap(state));\nexport const selectSelectionSize = (state: RootState) => selectSelectedFileIds(state).length;\nexport const selectIsFileSelected = (fileId: Nullable<string>) => (state: RootState) =>\n    !!fileId && !!selectSelectionMap(state)[fileId];\nexport const selectSelectedFiles = (state: RootState) => {\n    const fileMap = selectFileMap(state);\n    return Object.keys(selectSelectionMap(state)).map(id => fileMap[id]);\n};\nexport const selectSelectedFilesForAction = (fileActionId: string) => (state: RootState) => {\n    const { fileActionMap } = state;\n    const action = fileActionMap[fileActionId];\n    if (!action || !action.requiresSelection) return undefined;\n\n    return getSelectedFiles(state, action.fileFilter);\n};\nexport const selectSelectedFilesForActionCount = (fileActionId: string) => (state: RootState) =>\n    getSelectedFilesForAction(state, fileActionId)?.length;\nexport const selectDisableSelection = (state: RootState) => state.disableSelection;\n\nexport const selectFileViewConfig = (state: RootState) => state.fileViewConfig;\n\nexport const selectSortActionId = (state: RootState) => state.sortActionId;\nexport const selectSortOrder = (state: RootState) => state.sortOrder;\n\nexport const selectOptionMap = (state: RootState) => state.optionMap;\nexport const selectOptionValue = (optionId: string) => (state: RootState) => selectOptionMap(state)[optionId];\n\nexport const selectThumbnailGenerator = (state: RootState) => state.thumbnailGenerator;\nexport const selectDoubleClickDelay = (state: RootState) => state.doubleClickDelay;\nexport const selectIsDnDDisabled = (state: RootState) => state.disableDragAndDrop;\nexport const selectClearSelectionOnOutsideClick = (state: RootState) => state.clearSelectionOnOutsideClick;\n\nexport const selectContextMenuMounted = (state: RootState) => state.contextMenuMounted;\nexport const selectContextMenuConfig = (state: RootState) => state.contextMenuConfig;\nexport const selectContextMenuTriggerFile = (state: RootState) => {\n    const config = selectContextMenuConfig(state);\n    if (!config || !config.triggerFileId) return null;\n    const fileMap = selectFileMap(state);\n    return fileMap[config.triggerFileId] ?? null;\n};\n\n// Raw selectors\nconst getFileActionMap = (state: RootState) => state.fileActionMap;\nconst getOptionMap = (state: RootState) => state.optionMap;\nconst getFileMap = (state: RootState) => state.fileMap;\nconst getFileIds = (state: RootState) => state.fileIds;\nconst getCleanFileIds = (state: RootState) => state.cleanFileIds;\nconst getSortActionId = (state: RootState) => state.sortActionId;\nconst getSortOrder = (state: RootState) => state.sortOrder;\nconst getSearchString = (state: RootState) => state.searchString;\nconst _getLastClick = (state: RootState) => state.lastClick;\n\n// Memoized selectors\nconst makeGetAction = (fileActionSelector: (state: RootState) => Nullable<string>) =>\n    createSelector([getFileActionMap, fileActionSelector], (fileActionMap, fileActionId) =>\n        fileActionId && fileActionMap[fileActionId] ? fileActionMap[fileActionId] : null\n    );\nconst makeGetOptionValue = (optionId: string, defaultValue: any = undefined) =>\n    createSelector([getOptionMap], optionMap => {\n        const value = optionMap[optionId];\n        if (value === undefined) {\n            return defaultValue;\n        }\n        return value;\n    });\nconst makeGetFiles = (fileIdsSelector: (state: RootState) => Nullable<string>[]) =>\n    createSelector(\n        [getFileMap, fileIdsSelector],\n        (fileMap, fileIds): FileArray => fileIds.map(fileId => (fileId && fileMap[fileId] ? fileMap[fileId] : null))\n    );\nconst getSortedFileIds = createSelector(\n    [\n        getFileIds,\n        getSortOrder,\n        makeGetFiles(getFileIds),\n        makeGetAction(getSortActionId),\n        makeGetOptionValue(OptionIds.ShowFoldersFirst, false),\n    ],\n    (fileIds, sortOrder, files, sortAction, showFolderFirst) => {\n        if (!sortAction) {\n            // We allow users to set the sort action ID to `null` if they want to use their\n            // own sorting mechanisms instead of relying on Chonky built-in sort.\n            return fileIds;\n        }\n\n        const prepareSortKeySelector = (selector: FileSortKeySelector) => (file: Nullable<FileData>) => selector(file);\n\n        const sortFunctions: {\n            asc?: (file: FileData) => any;\n            desc?: (file: FileData) => any;\n        }[] = [];\n\n        if (showFolderFirst) {\n            // If option is undefined (relevant actions is not enabled), we don't show\n            // folders first.\n            sortFunctions.push({\n                desc: prepareSortKeySelector(FileHelper.isDirectory),\n            });\n        }\n        if (sortAction.sortKeySelector) {\n            const configKeyName = sortOrder === SortOrder.ASC ? 'asc' : 'desc';\n            sortFunctions.push({\n                [configKeyName]: prepareSortKeySelector(sortAction.sortKeySelector),\n            });\n        }\n        if (sortFunctions.length === 0) return fileIds;\n\n        // We copy the array because `fast-sort` mutates it\n        const sortedFileIds = sort([...files])\n            .by(sortFunctions as any)\n            .map(file => (file ? file.id : null));\n        return sortedFileIds;\n    }\n);\nconst getSearcher = createSelector(\n    [makeGetFiles(getCleanFileIds)],\n    cleanFiles => new FuzzySearch(cleanFiles as FileData[], ['name'], { caseSensitive: false })\n);\nconst getSearchFilteredFileIds = createSelector(\n    [getCleanFileIds, getSearchString, getSearcher],\n    (cleanFileIds, searchString, searcher) =>\n        searchString ? searcher.search(searchString).map(f => f.id) : cleanFileIds\n);\nconst getHiddenFileIdMap = createSelector(\n    [getSearchFilteredFileIds, makeGetFiles(getCleanFileIds), makeGetOptionValue(OptionIds.ShowHiddenFiles)],\n    (searchFilteredFileIds, cleanFiles, showHiddenFiles) => {\n        const searchFilteredFileIdsSet = new Set(searchFilteredFileIds);\n        const hiddenFileIdMap: any = {};\n        cleanFiles.forEach(file => {\n            if (!file) return;\n            else if (!searchFilteredFileIdsSet.has(file.id)) {\n                // Hidden by seach\n                hiddenFileIdMap[file.id] = true;\n            } else if (!showHiddenFiles && FileHelper.isHidden(file)) {\n                // Hidden by options\n                hiddenFileIdMap[file.id] = true;\n            }\n        });\n        return hiddenFileIdMap;\n    }\n);\nconst getDisplayFileIds = createSelector(\n    [getSortedFileIds, getHiddenFileIdMap],\n    /** Returns files that will actually be shown to the user. */\n    (sortedFileIds, hiddenFileIdMap) => sortedFileIds.filter(id => !id || !hiddenFileIdMap[id])\n);\nconst getLastClickIndex = createSelector(\n    [_getLastClick, getSortedFileIds],\n    /** Returns the last click index after ensuring it is actually still valid. */\n    (lastClick, displayFileIds) => {\n        if (\n            !lastClick ||\n            lastClick.index > displayFileIds.length - 1 ||\n            lastClick.fileId != displayFileIds[lastClick.index]\n        ) {\n            return null;\n        }\n        return lastClick.index;\n    }\n);\n\nexport const selectors = {\n    // Raw selectors\n    getFileActionMap,\n    getOptionMap,\n    getFileMap,\n    getFileIds,\n    getCleanFileIds,\n    getSortActionId,\n    getSortOrder,\n    getSearchString,\n    _getLastClick,\n\n    // Memoized selectors\n    getSortedFileIds,\n    getSearcher,\n    getSearchFilteredFileIds,\n    getHiddenFileIdMap,\n    getDisplayFileIds,\n    getLastClickIndex,\n\n    // Parametrized selectors\n    makeGetAction,\n    makeGetOptionValue,\n    makeGetFiles,\n};\n\n// Selectors meant to be used outside of Redux code\nexport const getFileData = (state: RootState, fileId: Nullable<string>) =>\n    fileId ? selectFileMap(state)[fileId] : null;\nexport const getIsFileSelected = (state: RootState, file: FileData) => {\n    // !!! We deliberately don't use `FileHelper.isSelectable` here as we want to\n    //     reflect the state of Redux store accurately.\n    return !!selectSelectionMap(state)[file.id];\n};\nexport const getSelectedFiles = (state: RootState, ...filters: Nilable<FileFilter>[]) => {\n    const { fileMap, selectionMap } = state;\n\n    const selectedFiles = Object.keys(selectionMap).map(id => fileMap[id]);\n    const filteredSelectedFiles = filters.reduce(\n        (prevFiles, filter) => (filter ? prevFiles.filter(filter) : prevFiles),\n        selectedFiles\n    );\n    return filteredSelectedFiles;\n};\nexport const getSelectedFilesForAction = (state: RootState, fileActionId: string) =>\n    selectSelectedFilesForAction(fileActionId)(state);\n","import { Nilable } from 'tsdef';\n\nimport { ChonkyActions, DefaultFileActions, EssentialFileActions } from '../../action-definitions/index';\nimport { FileActionGroup, FileActionMenuItem } from '../../types/action-menus.types';\nimport { FileAction } from '../../types/action.types';\nimport { ChonkyThunk } from '../../types/redux.types';\nimport { SortOrder } from '../../types/sort.types';\nimport { sanitizeInputArray } from '../files-transforms';\nimport { reduxActions } from '../reducers';\nimport { selectCleanFileIds, selectFileMap, selectHiddenFileIdMap, selectSelectionMap } from '../selectors';\n\n/**\n * Merges multiple file action arrays into one while removing duplicates\n */\nconst mergeFileActionsArrays = (...fileActionArrays: FileAction[][]): FileAction[] => {\n    const seenActionIds = new Set<string>();\n    const addToSeen = (a: FileAction) => !!seenActionIds.add(a.id);\n    const wasNotSeen = (a: FileAction) => !seenActionIds.has(a.id);\n\n    const duplicateFreeArrays = fileActionArrays.map(arr => {\n        const duplicateFreeArray = arr.filter(wasNotSeen);\n        duplicateFreeArray.map(addToSeen);\n        return duplicateFreeArray;\n    });\n    return new Array<FileAction>().concat(...duplicateFreeArrays);\n};\n\nexport const thunkUpdateRawFileActions = (\n    rawFileActions: FileAction[] | any,\n    disableDefaultFileActions: Nilable<boolean | string[]>\n): ChonkyThunk => dispatch => {\n    const { sanitizedArray, errorMessages } = sanitizeInputArray('fileActions', rawFileActions);\n\n    // Add default actions unless user disabled them\n    let defaultActionsToAdd: FileAction[];\n    if (Array.isArray(disableDefaultFileActions)) {\n        const disabledActionIds = new Set(disableDefaultFileActions);\n        defaultActionsToAdd = DefaultFileActions.filter(action => !disabledActionIds.has(action.id));\n    } else if (disableDefaultFileActions) {\n        defaultActionsToAdd = [];\n    } else {\n        defaultActionsToAdd = DefaultFileActions;\n    }\n\n    const fileActions = mergeFileActionsArrays(sanitizedArray, EssentialFileActions, defaultActionsToAdd);\n    const optionDefaults: any = {};\n    fileActions.map(a => (a.option ? (optionDefaults[a.option.id] = a.option.defaultValue) : null));\n\n    dispatch(reduxActions.setRawFileActions(rawFileActions));\n    dispatch(reduxActions.setFileActionsErrorMessages(errorMessages));\n    dispatch(reduxActions.setFileActions(fileActions));\n    dispatch(reduxActions.setOptionDefaults(optionDefaults));\n    dispatch(thunkUpdateToolbarNContextMenuItems(fileActions));\n};\n\nexport const thunkUpdateToolbarNContextMenuItems = (fileActions: FileAction[]): ChonkyThunk => dispatch => {\n    const excludedToolbarFileActionIds = new Set<string>([\n        // TODO: Move decision to exclude actions somewhere else, as users' custom\n        //  components might not give these actions special treatment like Chonky does.\n        ChonkyActions.OpenParentFolder.id,\n    ]);\n\n    type SeenGroupMap = { [groupName: string]: FileActionGroup };\n\n    const toolbarItems: FileActionMenuItem[] = [];\n    const seenToolbarGroups: SeenGroupMap = {};\n\n    const contextMenuItems: FileActionMenuItem[] = [];\n    const seenContextMenuGroups: SeenGroupMap = {};\n\n    const getGroup = (itemArray: FileActionMenuItem[], seenMap: SeenGroupMap, groupName: string): FileActionGroup => {\n        if (seenMap[groupName]) return seenMap[groupName];\n        const group: FileActionGroup = { name: groupName, fileActionIds: [] };\n        itemArray.push(group);\n        seenMap[groupName] = group;\n        return group;\n    };\n\n    for (const action of fileActions) {\n        const button = action.button;\n        if (!button) continue;\n\n        if (button.toolbar && !excludedToolbarFileActionIds.has(action.id)) {\n            if (button.group) {\n                const group = getGroup(toolbarItems, seenToolbarGroups, button.group);\n                group.fileActionIds.push(action.id);\n            } else {\n                toolbarItems.push(action.id);\n            }\n        }\n\n        if (button.contextMenu) {\n            if (button.group) {\n                const group = getGroup(contextMenuItems, seenContextMenuGroups, button.group);\n                group.fileActionIds.push(action.id);\n            } else {\n                contextMenuItems.push(action.id);\n            }\n        }\n    }\n\n    dispatch(reduxActions.updateFileActionMenuItems([toolbarItems, contextMenuItems]));\n};\n\nexport const thunkUpdateDefaultFileViewActionId = (fileActionId: Nilable<string>): ChonkyThunk => (\n    dispatch,\n    getState\n) => {\n    const { fileActionMap } = getState();\n    const action = fileActionId ? fileActionMap[fileActionId] : null;\n    if (action && action.fileViewConfig) {\n        dispatch(reduxActions.setFileViewConfig(action.fileViewConfig));\n    }\n};\n\nexport const thunkActivateSortAction = (fileActionId: Nilable<string>): ChonkyThunk => (dispatch, getState) => {\n    if (!fileActionId) return;\n\n    const { sortActionId: oldActionId, sortOrder: oldOrder, fileActionMap } = getState();\n    const action = fileActionMap[fileActionId];\n    if (!action || !action.sortKeySelector) return;\n\n    let order = oldOrder === SortOrder.ASC ? SortOrder.DESC : SortOrder.ASC;\n    if (oldActionId !== fileActionId) {\n        order = SortOrder.ASC;\n    }\n\n    dispatch(reduxActions.setSort({ actionId: fileActionId, order: order }));\n};\n\nexport const thunkApplySelectionTransform = (action: FileAction): ChonkyThunk => (dispatch, getState) => {\n    const selectionTransform = action.selectionTransform;\n    if (!selectionTransform) return;\n\n    const state = getState();\n    const prevSelection = new Set<string>(Object.keys(selectSelectionMap(state)));\n    const hiddenFileIds = new Set<string>(Object.keys(selectHiddenFileIdMap(state)));\n\n    const newSelection = selectionTransform({\n        prevSelection,\n        fileIds: selectCleanFileIds(state),\n        fileMap: selectFileMap(state),\n        hiddenFileIds,\n    });\n    if (!newSelection) return;\n\n    if (newSelection.size === 0) {\n        dispatch(reduxActions.clearSelection());\n    } else {\n        dispatch(reduxActions.selectFiles({ fileIds: Array.from(newSelection), reset: true }));\n    }\n};\n","import { MaybePromise, Undefinable } from 'tsdef';\n\nimport { FileActionData, FileActionState } from '../../types/action-handler.types';\nimport { FileAction } from '../../types/action.types';\nimport { ChonkyDispatch, ChonkyThunk } from '../../types/redux.types';\nimport { Logger } from '../../util/logger';\nimport { reduxActions } from '../reducers';\nimport {\n    selectContextMenuTriggerFile, selectExternalFileActionHandler, selectFileActionMap,\n    selectInstanceId, selectSelectedFiles\n} from '../selectors';\nimport { thunkActivateSortAction, thunkApplySelectionTransform } from './file-actions.thunks';\n\n/**\n * Thunk that dispatches actions to the external (user-provided) action handler.\n */\nexport const thunkDispatchFileAction = (data: FileActionData<FileAction>): ChonkyThunk => (_dispatch, getState) => {\n    Logger.debug(`FILE ACTION DISPATCH: [${data.id}]`, 'data:', data);\n    const state = getState();\n    const action = selectFileActionMap(state)[data.id];\n    const externalFileActionHandler = selectExternalFileActionHandler(state);\n    if (action) {\n        if (externalFileActionHandler) {\n            Promise.resolve(externalFileActionHandler(data)).catch(error =>\n                Logger.error(`User-defined file action handler threw an error: ${error.message}`)\n            );\n        }\n    } else {\n        Logger.warn(\n            `Internal components dispatched the \"${data.id}\" file action, but such ` + `action was not registered.`\n        );\n    }\n};\n\n/**\n * Thunk that is used by internal components (and potentially the user) to \"request\"\n * actions. When action is requested, Chonky \"prepares\" the action data by extracting it\n * from Redux state. Once action data is ready, Chonky executes some side effect and/or\n * dispatches the action to the external action handler.\n */\nexport const thunkRequestFileAction = <Action extends FileAction>(\n    action: Action,\n    payload: Action['__payloadType']\n): ChonkyThunk => (dispatch, getState) => {\n    Logger.debug(`FILE ACTION REQUEST: [${action.id}]`, 'action:', action, 'payload:', payload);\n    const state = getState();\n    const instanceId = selectInstanceId(state);\n\n    if (!selectFileActionMap(state)[action.id]) {\n        Logger.warn(\n            `The action \"${action.id}\" was requested, but it is not registered. The ` +\n                `action will still be dispatched, but this might indicate a bug in ` +\n                `the code. Please register your actions by passing them to ` +\n                `\"fileActions\" prop.`\n        );\n    }\n\n    // Determine files for the action if action requires selection\n    const selectedFiles = selectSelectedFiles(state);\n    const selectedFilesForAction = action.fileFilter ? selectedFiles.filter(action.fileFilter) : selectedFiles;\n    if (action.requiresSelection && selectedFilesForAction.length === 0) {\n        Logger.warn(\n            `Internal components requested the \"${action.id}\" file ` +\n                `action, but the selection for this action was empty. This ` +\n                `might a bug in the code of the presentational components.`\n        );\n        return;\n    }\n\n    const contextMenuTriggerFile = selectContextMenuTriggerFile(state);\n    const actionState: FileActionState<{}> = {\n        instanceId,\n        selectedFiles,\n        selectedFilesForAction,\n        contextMenuTriggerFile,\n    };\n\n    // === Update sort state if necessary\n    const sortKeySelector = action.sortKeySelector;\n    if (sortKeySelector) dispatch(thunkActivateSortAction(action.id));\n\n    // === Update file view state if necessary\n    const fileViewConfig = action.fileViewConfig;\n    if (fileViewConfig) dispatch(reduxActions.setFileViewConfig(fileViewConfig));\n\n    // === Update option state if necessary\n    const option = action.option;\n    if (option) dispatch(reduxActions.toggleOption(option.id));\n\n    // === Apply selection transform if necessary\n    const selectionTransform = action.selectionTransform;\n    if (selectionTransform) dispatch(thunkApplySelectionTransform(action));\n\n    // Apply the effect\n    const effect = action.effect;\n    let maybeEffectPromise: MaybePromise<boolean | undefined> = undefined;\n    if (effect) {\n        try {\n            maybeEffectPromise = effect({\n                action,\n                payload,\n                state: actionState,\n                reduxDispatch: dispatch,\n                getReduxState: getState,\n            }) as MaybePromise<boolean | undefined>;\n        } catch (error) {\n            Logger.error(`User-defined effect function for action ${action.id} threw an ` + `error: ${error.message}`);\n        }\n    }\n\n    // Dispatch the action to user code. Deliberately call it after all other\n    // operations are over.\n    return Promise.resolve(maybeEffectPromise)\n        .then(effectResult => {\n            const data: FileActionData<Action> = {\n                id: action.id,\n                action,\n                payload,\n                state: actionState,\n            };\n            triggerDispatchAfterEffect(dispatch, data, effectResult);\n        })\n        .catch(error => {\n            Logger.error(\n                `User-defined effect function for action ${action.id} returned a ` +\n                    `promise that was rejected: ${error.message}`\n            );\n            const data: FileActionData<Action> = {\n                id: action.id,\n                action,\n                payload,\n                state: actionState,\n            };\n            triggerDispatchAfterEffect(dispatch, data, undefined);\n        });\n};\n\nexport const triggerDispatchAfterEffect = <Action extends FileAction>(\n    dispatch: ChonkyDispatch,\n    data: FileActionData<Action>,\n    effectResult: Undefinable<boolean>\n) => {\n    const preventDispatch = effectResult === true;\n    if (!preventDispatch) dispatch(thunkDispatchFileAction(data));\n};\n","export enum FileViewMode {\n    List = 'list',\n    Compact = 'compact',\n    Grid = 'grid',\n}\n\nexport type FileViewConfigList = {\n    mode: FileViewMode.List;\n    entryHeight: number;\n};\n\nexport type FileViewConfigGrid = {\n    mode: FileViewMode.Compact | FileViewMode.Grid;\n    entryWidth: number;\n    entryHeight: number;\n};\n\nexport type FileViewConfig = FileViewConfigList | FileViewConfigGrid;\n","import React from 'react';\n\nexport enum ChonkyIconName {\n    // Misc\n    loading = 'loading',\n    dropdown = 'dropdown',\n    placeholder = 'placeholder',\n\n    // File Actions: Drag & drop\n    dndDragging = 'dndDragging',\n    dndCanDrop = 'dndCanDrop',\n    dndCannotDrop = 'dndCannotDrop',\n\n    // File Actions: File operations\n    openFiles = 'openFiles',\n    openParentFolder = 'openParentFolder',\n    copy = 'copy',\n    paste = 'paste',\n    share = 'share',\n    search = 'search',\n    selectAllFiles = 'selectAllFiles',\n    clearSelection = 'clearSelection',\n\n    // File Actions: Sorting & options\n    sortAsc = 'sortAsc',\n    sortDesc = 'sortDesc',\n    toggleOn = 'toggleOn',\n    toggleOff = 'toggleOff',\n\n    // File Actions: File Views\n    list = 'list',\n    compact = 'compact',\n    smallThumbnail = 'smallThumbnail',\n    largeThumbnail = 'largeThumbnail',\n\n    // File Actions: Unsorted\n    folder = 'folder',\n    folderCreate = 'folderCreate',\n    folderOpen = 'folderOpen',\n    folderChainSeparator = 'folderChainSeparator',\n    download = 'download',\n    upload = 'upload',\n    trash = 'trash',\n    fallbackIcon = 'fallbackIcon',\n\n    // File modifiers\n    symlink = 'symlink',\n    hidden = 'hidden',\n\n    // Generic file types\n    file = 'file',\n    license = 'license',\n    code = 'code',\n    config = 'config',\n    model = 'model',\n    database = 'database',\n    text = 'text',\n    archive = 'archive',\n    image = 'image',\n    video = 'video',\n    info = 'info',\n    key = 'key',\n    lock = 'lock',\n    music = 'music',\n    terminal = 'terminal',\n    users = 'users',\n\n    // OS file types\n    linux = 'linux',\n    ubuntu = 'ubuntu',\n    windows = 'windows',\n\n    // Programming language file types\n    rust = 'rust',\n    python = 'python',\n    nodejs = 'nodejs',\n    php = 'php',\n\n    // Development tools file types\n    git = 'git',\n\n    // Brands file types\n    adobe = 'adobe',\n\n    // Other program file types\n    pdf = 'pdf',\n    excel = 'excel',\n    word = 'word',\n    flash = 'flash',\n}\n\nexport interface FileIconData {\n    icon: ChonkyIconName | string;\n    colorCode: number;\n}\n\nexport interface ChonkyIconProps {\n    icon: ChonkyIconName | string;\n    spin?: boolean;\n    className?: string;\n    fixedWidth?: boolean;\n    style?: React.CSSProperties;\n}\n","// Used in React hooks to indicate empty deps are intentional.\nimport { MaybePromise, Nullable, WritableProps } from 'tsdef';\n\nimport { FileAction, FileActionEffect } from '../types/action.types';\nimport { Logger } from './logger';\n\n// Used in contexts that need to provide some default value for a function.\n// eslint-disable-next-line no-unused-vars,@typescript-eslint/no-unused-vars\nexport const NOOP_FUNCTION = (...args: any[]) => {\n    Logger.warn(\n        `The \"NOOP_FUNCTION\" from the constants module was called. ` +\n            `This can indicate a bug in one of the components. Supplied args:`,\n        args\n    );\n};\n\nexport const isPromise = <T>(value: MaybePromise<T> | any): value is Promise<T> => {\n    if (typeof value !== 'object' || !value) return false;\n    const then = (value as Promise<T>).then;\n    return then && typeof then === 'function';\n};\n\nexport const defineFileAction = <Action extends FileAction>(\n    action: Action,\n    effect?: FileActionEffect<FileAction>\n): WritableProps<Action> => {\n    if (action.__payloadType !== undefined && (action.hotkeys || action.button)) {\n        const errorMessage =\n            `Invalid definition was provided for file action \"${action.id}\". Actions ` +\n            `that specify hotkeys or buttons cannot define a payload type. If ` +\n            `your application requires this functionality, define two actions ` +\n            `and chain them using effects.`;\n        Logger.error(errorMessage);\n        throw new Error(errorMessage);\n    }\n\n    action.effect = effect;\n    return action;\n};\n\n/**\n * Recursively check the current element and the parent elements, going bottom-up.\n * Returns the first element to match the predicate, otherwise returns null if such\n * element is not found.\n */\nexport const findElementAmongAncestors = (\n    maybeElement: HTMLElement | any,\n    predicate: (maybeElement: HTMLElement | any) => boolean\n): Nullable<HTMLElement> => {\n    if (!maybeElement) return maybeElement;\n\n    if (predicate(maybeElement)) return maybeElement;\n\n    if (maybeElement.parentElement) {\n        return findElementAmongAncestors(maybeElement.parentElement, predicate);\n    }\n\n    return null;\n};\n\nexport const elementIsInsideButton = (buttonCandidate: HTMLElement | any): boolean => {\n    return !!findElementAmongAncestors(\n        buttonCandidate,\n        (element: any) => element.tagName && element.tagName.toLowerCase() === 'button'\n    );\n};\n\nexport const getValueOrFallback = <T extends any>(\n    value: T | undefined,\n    fallback: T,\n    desiredType?: 'boolean' | 'string' | 'number'\n): NonNullable<T> => {\n    if (desiredType) {\n        return (typeof value === desiredType ? value : fallback) as NonNullable<T>;\n    }\n    return (value !== undefined ? value : fallback) as NonNullable<T>;\n};\n","import { ChonkyThunk } from '../../types/redux.types';\nimport { FileHelper } from '../../util/file-helper';\nimport { reduxActions } from '../reducers';\nimport { selectors } from '../selectors';\n\nexport const reduxThunks = {\n    selectRange: (params: {\n        rangeStart: number;\n        rangeEnd: number;\n        reset?: boolean;\n    }): ChonkyThunk => (dispatch, getState) => {\n        const state = getState();\n        if (state.disableSelection) return;\n        const displayFileIds = selectors.getDisplayFileIds(state);\n        const fileIdsToSelect = displayFileIds\n            .slice(params.rangeStart, params.rangeEnd + 1)\n            .filter(id => id && FileHelper.isSelectable(state.fileMap[id])) as string[];\n        dispatch(\n            reduxActions.selectFiles({\n                fileIds: fileIdsToSelect,\n                reset: !!params.reset,\n            })\n        );\n    },\n};\n","import { reduxActions } from '../redux/reducers';\nimport {\n    getFileData, getIsFileSelected, selectDisableSelection, selectors, selectParentFolder,\n    selectSelectionSize\n} from '../redux/selectors';\nimport { reduxThunks } from '../redux/thunks';\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\nimport {\n    ChangeSelectionPayload, EndDragNDropPayload, KeyboardClickFilePayload, MouseClickFilePayload,\n    MoveFilesPayload, OpenFileContextMenuPayload, OpenFilesPayload, StartDragNDropPayload\n} from '../types/action-payloads.types';\nimport { ChonkyIconName } from '../types/icons.types';\nimport { FileHelper } from '../util/file-helper';\nimport { defineFileAction } from '../util/helpers';\nimport { Logger } from '../util/logger';\nimport { ChonkyActions } from './index';\n\nexport const EssentialActions = {\n    /**\n     * Action that is dispatched when the user clicks on a file entry using their mouse.\n     * Both single clicks and double clicks trigger this action.\n     */\n    MouseClickFile: defineFileAction(\n        {\n            id: 'mouse_click_file',\n            __payloadType: {} as MouseClickFilePayload,\n        } as const,\n        ({ payload, reduxDispatch, getReduxState }) => {\n            if (payload.clickType === 'double') {\n                if (FileHelper.isOpenable(payload.file)) {\n                    reduxDispatch(\n                        thunkRequestFileAction(ChonkyActions.OpenFiles, {\n                            targetFile: payload.file,\n\n                            // To simulate Windows Explorer and Nautilus behaviour,\n                            // a double click on a file only opens that file even if\n                            // there is a selection.\n                            files: [payload.file],\n                        })\n                    );\n                }\n            } else {\n                // We're dealing with a single click\n\n                const disableSelection = selectDisableSelection(getReduxState());\n                if (FileHelper.isSelectable(payload.file) && !disableSelection) {\n                    if (payload.ctrlKey) {\n                        // Multiple selection\n                        reduxDispatch(\n                            reduxActions.toggleSelection({\n                                fileId: payload.file.id,\n                                exclusive: false,\n                            })\n                        );\n                        reduxDispatch(\n                            reduxActions.setLastClickIndex({\n                                index: payload.fileDisplayIndex,\n                                fileId: payload.file.id,\n                            })\n                        );\n                    } else if (payload.shiftKey) {\n                        // Range selection\n                        const lastClickIndex = selectors.getLastClickIndex(getReduxState());\n                        if (typeof lastClickIndex === 'number') {\n                            // We have the index of the previous click\n                            let rangeStart = lastClickIndex;\n                            let rangeEnd = payload.fileDisplayIndex;\n                            if (rangeStart > rangeEnd) {\n                                [rangeStart, rangeEnd] = [rangeEnd, rangeStart];\n                            }\n\n                            reduxDispatch(reduxThunks.selectRange({ rangeStart, rangeEnd }));\n                        } else {\n                            // Since we can't do a range selection, do a\n                            // multiple selection\n                            reduxDispatch(\n                                reduxActions.toggleSelection({\n                                    fileId: payload.file.id,\n                                    exclusive: false,\n                                })\n                            );\n                            reduxDispatch(\n                                reduxActions.setLastClickIndex({\n                                    index: payload.fileDisplayIndex,\n                                    fileId: payload.file.id,\n                                })\n                            );\n                        }\n                    } else {\n                        // Exclusive selection\n                        reduxDispatch(\n                            reduxActions.toggleSelection({\n                                fileId: payload.file.id,\n                                exclusive: true,\n                            })\n                        );\n                        reduxDispatch(\n                            reduxActions.setLastClickIndex({\n                                index: payload.fileDisplayIndex,\n                                fileId: payload.file.id,\n                            })\n                        );\n                    }\n                } else {\n                    if (!payload.ctrlKey && !disableSelection) {\n                        reduxDispatch(reduxActions.clearSelection());\n                    }\n                    reduxDispatch(\n                        reduxActions.setLastClickIndex({\n                            index: payload.fileDisplayIndex,\n                            fileId: payload.file.id,\n                        })\n                    );\n                }\n            }\n        }\n    ),\n    /**\n     * Action that is dispatched when the user \"clicks\" on a file using their keyboard.\n     * Using Space and Enter keys counts as clicking.\n     */\n    KeyboardClickFile: defineFileAction(\n        {\n            id: 'keyboard_click_file',\n            __payloadType: {} as KeyboardClickFilePayload,\n        } as const,\n        ({ payload, reduxDispatch, getReduxState }) => {\n            reduxDispatch(\n                reduxActions.setLastClickIndex({\n                    index: payload.fileDisplayIndex,\n                    fileId: payload.file.id,\n                })\n            );\n            if (payload.enterKey) {\n                // We only dispatch the Open Files action here when the selection is\n                // empty. Otherwise, `Enter` key presses are handled by the\n                // hotkey manager for the Open Files action.\n                if (selectSelectionSize(getReduxState()) === 0) {\n                    reduxDispatch(\n                        thunkRequestFileAction(ChonkyActions.OpenFiles, {\n                            targetFile: payload.file,\n                            files: [payload.file],\n                        })\n                    );\n                }\n            } else if (payload.spaceKey && FileHelper.isSelectable(payload.file)) {\n                reduxDispatch(\n                    reduxActions.toggleSelection({\n                        fileId: payload.file.id,\n                        exclusive: payload.ctrlKey,\n                    })\n                );\n            }\n        }\n    ),\n    /**\n     * Action that is dispatched when user starts dragging some file.\n     */\n    StartDragNDrop: defineFileAction(\n        {\n            id: 'start_drag_n_drop',\n            __payloadType: {} as StartDragNDropPayload,\n        } as const,\n        ({ payload, reduxDispatch, getReduxState }) => {\n            const file = payload.draggedFile;\n            if (!getIsFileSelected(getReduxState(), file)) {\n                if (FileHelper.isSelectable(file)) {\n                    reduxDispatch(\n                        reduxActions.selectFiles({\n                            fileIds: [file.id],\n                            reset: true,\n                        })\n                    );\n                }\n            }\n        }\n    ),\n    /**\n     * Action that is dispatched when user either cancels the drag & drop interaction,\n     * or drops a file somewhere.\n     */\n    EndDragNDrop: defineFileAction(\n        {\n            id: 'end_drag_n_drop',\n            __payloadType: {} as EndDragNDropPayload,\n        } as const,\n        ({ payload, reduxDispatch, getReduxState }) => {\n            if (getIsFileSelected(getReduxState(), payload.destination)) {\n                // Can't drop a selection into itself\n                return;\n            }\n\n            const { draggedFile, selectedFiles } = payload as EndDragNDropPayload;\n            const droppedFiles = selectedFiles.length > 0 ? selectedFiles : [draggedFile];\n            reduxDispatch(\n                thunkRequestFileAction(ChonkyActions.MoveFiles, {\n                    ...payload,\n                    files: droppedFiles,\n                })\n            );\n        }\n    ),\n    /**\n     * Action that is dispatched when user moves files from one folder to another,\n     * usually by dragging & dropping some files into the folder.\n     */\n    MoveFiles: defineFileAction({\n        id: 'move_files',\n        __payloadType: {} as MoveFilesPayload,\n    } as const),\n    /**\n     * Action that is dispatched when the selection changes for any reason.\n     */\n    ChangeSelection: defineFileAction({\n        id: 'change_selection',\n        __payloadType: {} as ChangeSelectionPayload,\n    } as const),\n    /**\n     * Action that is dispatched when user wants to open some files. This action is\n     * often triggered by other actions.\n     */\n    OpenFiles: defineFileAction({\n        id: 'open_files',\n        __payloadType: {} as OpenFilesPayload,\n    } as const),\n    /**\n     * Action that is triggered when user wants to go up a directory.\n     */\n    OpenParentFolder: defineFileAction(\n        {\n            id: 'open_parent_folder',\n            hotkeys: ['backspace'],\n            button: {\n                name: 'Go up a directory',\n                toolbar: true,\n                contextMenu: false,\n                icon: ChonkyIconName.openParentFolder,\n                iconOnly: true,\n            },\n        } as const,\n        ({ reduxDispatch, getReduxState }) => {\n            const parentFolder = selectParentFolder(getReduxState());\n            if (FileHelper.isOpenable(parentFolder)) {\n                reduxDispatch(\n                    thunkRequestFileAction(ChonkyActions.OpenFiles, {\n                        targetFile: parentFolder,\n                        files: [parentFolder],\n                    })\n                );\n            } else {\n                Logger.warn(\n                    'Open parent folder effect was triggered  even though the parent folder' +\n                        ' is not openable. This indicates a bug in presentation components.'\n                );\n            }\n        }\n    ),\n    /**\n     * Action that is dispatched when user opens the context menu, either by right click\n     * on something or using the context menu button on their keyboard.\n     */\n    OpenFileContextMenu: defineFileAction(\n        {\n            id: 'open_file_context_menu',\n            __payloadType: {} as OpenFileContextMenuPayload,\n        } as const,\n        ({ payload, reduxDispatch, getReduxState }) => {\n            // TODO: Check if the context menu component is actually enabled. There is a\n            //  chance it doesn't matter if it is enabled or not - if it is not mounted,\n            //  the action will simply have no effect. It also allows users to provide\n            //  their own components - however, users could also flip the \"context menu\n            //  component mounted\" switch...\n            const triggerFile = getFileData(getReduxState(), payload.triggerFileId);\n            if (triggerFile) {\n                const fileSelected = getIsFileSelected(getReduxState(), triggerFile);\n                if (!fileSelected) {\n                    // If file is selected, we leave the selection as is. If it is not\n                    // selected, it means user right clicked the file with no selection.\n                    // We simulate the Windows Explorer/Nautilus behaviour of moving\n                    // selection to this file.\n                    if (FileHelper.isSelectable(triggerFile)) {\n                        reduxDispatch(\n                            reduxActions.selectFiles({\n                                fileIds: [payload.triggerFileId],\n                                reset: true,\n                            })\n                        );\n                    } else {\n                        reduxDispatch(reduxActions.clearSelection());\n                    }\n                }\n            }\n\n            reduxDispatch(\n                reduxActions.showContextMenu({\n                    triggerFileId: payload.triggerFileId,\n                    mouseX: payload.clientX - 2,\n                    mouseY: payload.clientY - 4,\n                })\n            );\n        }\n    ),\n};\n","import { Nullable } from 'tsdef';\n\nimport { selectFocusSearchInput } from '../redux/selectors';\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\nimport { FileSelectionTransform } from '../types/action.types';\nimport { FileViewMode } from '../types/file-view.types';\nimport { FileData } from '../types/file.types';\nimport { ChonkyIconName } from '../types/icons.types';\nimport { FileHelper } from '../util/file-helper';\nimport { defineFileAction } from '../util/helpers';\nimport { EssentialActions } from './essential';\nimport { OptionIds } from './option-ids';\n\nexport const DefaultActions = {\n    /**\n     * Action that can be used to open currently selected files.\n     */\n    OpenSelection: defineFileAction(\n        {\n            id: 'open_selection',\n            hotkeys: ['enter'],\n            requiresSelection: true,\n            fileFilter: FileHelper.isOpenable,\n            button: {\n                name: 'Open selection',\n                toolbar: true,\n                contextMenu: true,\n                group: 'Actions',\n                icon: ChonkyIconName.openFiles,\n            },\n        } as const,\n        ({ state, reduxDispatch }) => {\n            reduxDispatch(\n                thunkRequestFileAction(EssentialActions.OpenFiles, {\n                    files: state.selectedFilesForAction!,\n                })\n            );\n            return undefined;\n        }\n    ),\n    /**\n     * Action that selects all files.\n     */\n    SelectAllFiles: defineFileAction({\n        id: 'select_all_files',\n        hotkeys: ['ctrl+a'],\n        button: {\n            name: 'Select all files',\n            toolbar: true,\n            contextMenu: true,\n            group: 'Actions',\n            icon: ChonkyIconName.selectAllFiles,\n        },\n        selectionTransform: (({ fileIds, hiddenFileIds }) => {\n            const newSelection = new Set<string>();\n            fileIds.map(fileId => {\n                // We don't need to check if file is selectable because Chonky does\n                // it own checks internally.\n                if (!hiddenFileIds.has(fileId)) newSelection.add(fileId);\n            });\n            return newSelection;\n        }) as FileSelectionTransform,\n    } as const),\n    /**\n     * Action that clear the file selection.\n     */\n    ClearSelection: defineFileAction({\n        id: 'clear_selection',\n        hotkeys: ['escape'],\n        button: {\n            name: 'Clear selection',\n            toolbar: true,\n            contextMenu: true,\n            group: 'Actions',\n            icon: ChonkyIconName.clearSelection,\n        },\n        selectionTransform: (({ prevSelection }) => {\n            if (prevSelection.size === 0) return null;\n            return new Set<string>();\n        }) as FileSelectionTransform,\n    } as const),\n    /**\n     * Action that enables List view.\n     */\n    EnableListView: defineFileAction({\n        id: 'enable_list_view',\n        fileViewConfig: {\n            mode: FileViewMode.List,\n            entryHeight: 30,\n        },\n        button: {\n            name: 'Switch to List view',\n            toolbar: true,\n            icon: ChonkyIconName.list,\n            iconOnly: true,\n        },\n    } as const),\n    /**\n     * Action that enables Compact view. Note that compact view is still\n     * experimental and should not be used in production.\n     */\n    EnableCompactView: defineFileAction({\n        // TODO: Don't enable until compact view is fully supported\n        id: 'enable_compact_view',\n        fileViewConfig: {\n            mode: FileViewMode.Compact,\n            entryHeight: 40,\n            entryWidth: 220,\n        },\n        button: {\n            name: 'Switch to Compact view',\n            toolbar: true,\n            icon: ChonkyIconName.compact,\n            iconOnly: true,\n        },\n    } as const),\n    /**\n     * Action that enables Grid view.\n     */\n    EnableGridView: defineFileAction({\n        id: 'enable_grid_view',\n        fileViewConfig: { mode: FileViewMode.Grid, entryWidth: 165, entryHeight: 130 },\n        button: {\n            name: 'Switch to Grid view',\n            toolbar: true,\n            icon: ChonkyIconName.smallThumbnail,\n            iconOnly: true,\n        },\n    } as const),\n    /**\n     * Action that sorts files by `file.name`.\n     */\n    SortFilesByName: defineFileAction({\n        id: 'sort_files_by_name',\n        sortKeySelector: (file: Nullable<FileData>) => (file ? file.name.toLowerCase() : undefined),\n        button: {\n            name: 'Sort by name',\n            toolbar: true,\n            group: 'Options',\n        },\n    } as const),\n    /**\n     * Action that sorts files by `file.size`.\n     */\n    SortFilesBySize: defineFileAction({\n        id: 'sort_files_by_size',\n        sortKeySelector: (file: Nullable<FileData>) => (file ? file.size : undefined),\n        button: {\n            name: 'Sort by size',\n            toolbar: true,\n            group: 'Options',\n        },\n    } as const),\n    /**\n     * Action that sorts files by `file.modDate`.\n     */\n    SortFilesByDate: defineFileAction({\n        id: 'sort_files_by_date',\n        sortKeySelector: (file: Nullable<FileData>) => (file ? file.modDate : undefined),\n        button: {\n            name: 'Sort by date',\n            toolbar: true,\n            group: 'Options',\n        },\n    } as const),\n    /**\n     * Action that toggles whether hidden files are shown to the user or not.\n     */\n    ToggleHiddenFiles: defineFileAction({\n        id: 'toggle_hidden_files',\n        hotkeys: ['ctrl+h'],\n        option: {\n            id: OptionIds.ShowHiddenFiles,\n            defaultValue: true,\n        },\n        button: {\n            name: 'Show hidden files',\n            toolbar: true,\n            group: 'Options',\n        },\n    } as const),\n    /**\n     * Action that toggles whether folders should appear before files regardless of\n     * current sort function.\n     */\n    ToggleShowFoldersFirst: defineFileAction({\n        id: 'toggle_show_folders_first',\n        option: {\n            id: OptionIds.ShowFoldersFirst,\n            defaultValue: true,\n        },\n        button: {\n            name: 'Show folders first',\n            toolbar: true,\n            group: 'Options',\n        },\n    } as const),\n    /**\n     * Action that focuses the search input when it is dispatched.\n     */\n    FocusSearchInput: defineFileAction(\n        {\n            id: 'focus_search_input',\n            hotkeys: ['ctrl+f'],\n        } as const,\n        ({ getReduxState }) => {\n            const focusSearchInput = selectFocusSearchInput(getReduxState());\n            if (focusSearchInput) focusSearchInput();\n        }\n    ),\n    /**\n     * Action that enables List view.\n     */\n    ToggleDarkMode: defineFileAction({\n        id: 'enable_dark_mode',\n        option: {\n            id: OptionIds.DarkMode,\n            defaultValue: false,\n        },\n        button: {\n            name: 'Enable dark mode',\n            toolbar: true,\n            icon: ChonkyIconName.list,\n            iconOnly: true,\n        },\n    } as const),\n};\n","import { ChonkyIconName } from '../types/icons.types';\nimport { defineFileAction } from '../util/helpers';\n\nexport const ExtraActions = {\n    /**\n     * Action that adds a button and shortcut to copy files.\n     */\n    CopyFiles: defineFileAction({\n        id: 'copy_files',\n        requiresSelection: true,\n        hotkeys: ['ctrl+c'],\n        button: {\n            name: 'Copy selection',\n            toolbar: true,\n            contextMenu: true,\n            group: 'Actions',\n            icon: ChonkyIconName.copy,\n        },\n    } as const),\n    /**\n     * Action that adds a button to create a new folder.\n     */\n    CreateFolder: defineFileAction({\n        id: 'create_folder',\n        button: {\n            name: 'Create folder',\n            toolbar: true,\n            tooltip: 'Create a folder',\n            icon: ChonkyIconName.folderCreate,\n        },\n    } as const),\n    /**\n     * Action that adds a button to upload files.\n     */\n    UploadFiles: defineFileAction({\n        id: 'upload_files',\n        button: {\n            name: 'Upload files',\n            toolbar: true,\n            tooltip: 'Upload files',\n            icon: ChonkyIconName.upload,\n        },\n    } as const),\n    /**\n     * Action that adds a button to download files.\n     */\n    DownloadFiles: defineFileAction({\n        id: 'download_files',\n        requiresSelection: true,\n        button: {\n            name: 'Download files',\n            toolbar: true,\n            contextMenu: true,\n            group: 'Actions',\n            icon: ChonkyIconName.download,\n        },\n    } as const),\n    /**\n     * Action that adds a button and shortcut to delete files.\n     */\n    DeleteFiles: defineFileAction({\n        id: 'delete_files',\n        requiresSelection: true,\n        hotkeys: ['delete'],\n        button: {\n            name: 'Delete files',\n            toolbar: true,\n            contextMenu: true,\n            group: 'Actions',\n            icon: ChonkyIconName.trash,\n        },\n    } as const),\n};\n","import { DefaultActions } from './default';\nimport { EssentialActions } from './essential';\nimport { ExtraActions } from './extra';\n\nexport { OptionIds } from './option-ids';\n\nexport const ChonkyActions = {\n    ...EssentialActions,\n    ...DefaultActions,\n    ...ExtraActions,\n};\n\nexport const EssentialFileActions = [\n    ChonkyActions.MouseClickFile,\n    ChonkyActions.KeyboardClickFile,\n    ChonkyActions.StartDragNDrop,\n    ChonkyActions.EndDragNDrop,\n    ChonkyActions.MoveFiles,\n    ChonkyActions.ChangeSelection,\n    ChonkyActions.OpenFiles,\n    ChonkyActions.OpenParentFolder,\n    ChonkyActions.OpenFileContextMenu,\n];\n\nexport const DefaultFileActions = [\n    ChonkyActions.OpenSelection,\n    ChonkyActions.SelectAllFiles,\n    ChonkyActions.ClearSelection,\n    ChonkyActions.EnableListView,\n    // TODO: Don't enable until compact view is fully supported\n    // ChonkyActions.EnableCompactView,\n    ChonkyActions.EnableGridView,\n    ChonkyActions.SortFilesByName,\n    ChonkyActions.SortFilesBySize,\n    ChonkyActions.SortFilesByDate,\n    ChonkyActions.ToggleHiddenFiles,\n    ChonkyActions.ToggleShowFoldersFirst,\n    ChonkyActions.FocusSearchInput,\n];\n","import { ChonkyActions } from '../action-definitions/index';\nimport { RootState } from '../types/redux.types';\nimport { SortOrder } from '../types/sort.types';\n\nexport const initialRootState: RootState = {\n    instanceId: 'CHONKY_INVALID_ID', // should be overwritten by preloaded state\n\n    externalFileActionHandler: null,\n\n    rawFileActions: [],\n    fileActionsErrorMessages: [],\n    fileActionMap: {},\n    fileActionIds: [],\n    toolbarItems: [],\n    contextMenuItems: [],\n\n    rawFolderChain: null,\n    folderChainErrorMessages: [],\n    folderChain: [],\n\n    rawFiles: [],\n    filesErrorMessages: [],\n    fileMap: {},\n    fileIds: [],\n    cleanFileIds: [],\n\n    sortedFileIds: [],\n    hiddenFileIdMap: {},\n\n    focusSearchInput: null,\n    searchString: '',\n    searchMode: 'currentFolder',\n\n    selectionMap: {},\n    disableSelection: false,\n\n    fileViewConfig: ChonkyActions.EnableGridView.fileViewConfig,\n\n    sortActionId: null,\n    sortOrder: SortOrder.ASC,\n\n    optionMap: {},\n\n    thumbnailGenerator: null,\n    doubleClickDelay: 300,\n    disableDragAndDrop: false,\n    clearSelectionOnOutsideClick: true,\n\n    lastClick: null,\n\n    contextMenuMounted: false,\n    contextMenuConfig: null,\n};\n","import { Nilable, Nullable } from 'tsdef';\n\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { GenericFileActionHandler } from '../types/action-handler.types';\nimport { FileActionMenuItem } from '../types/action-menus.types';\nimport { FileAction, FileActionMap } from '../types/action.types';\nimport { ContextMenuConfig } from '../types/context-menu.types';\nimport { FileViewConfig } from '../types/file-view.types';\nimport { FileArray, FileIdTrueMap, FileMap } from '../types/file.types';\nimport { OptionMap } from '../types/options.types';\nimport { RootState } from '../types/redux.types';\nimport { SortOrder } from '../types/sort.types';\nimport { ThumbnailGenerator } from '../types/thumbnails.types';\nimport { FileHelper } from '../util/file-helper';\nimport { sanitizeInputArray } from './files-transforms';\nimport { initialRootState } from './state';\n\nconst reducers = {\n    setExternalFileActionHandler(\n        state: RootState,\n        action: PayloadAction<Nilable<GenericFileActionHandler<FileAction>>>\n    ) {\n        state.externalFileActionHandler = action.payload ?? null;\n    },\n    setRawFileActions(state: RootState, action: PayloadAction<FileAction[] | any>) {\n        state.rawFileActions = action.payload;\n    },\n    setFileActionsErrorMessages(state: RootState, action: PayloadAction<string[]>) {\n        state.fileActionsErrorMessages = action.payload;\n    },\n    setFileActions(state: RootState, action: PayloadAction<FileAction[]>) {\n        const fileActionMap: FileActionMap = {};\n        action.payload.map(a => (fileActionMap[a.id] = a));\n        const fileIds = action.payload.map(a => a.id);\n\n        state.fileActionMap = fileActionMap as FileMap;\n        state.fileActionIds = fileIds;\n    },\n    updateFileActionMenuItems(state: RootState, action: PayloadAction<[FileActionMenuItem[], FileActionMenuItem[]]>) {\n        [state.toolbarItems, state.contextMenuItems] = action.payload;\n    },\n    setRawFolderChain(state: RootState, action: PayloadAction<FileArray | any>) {\n        const rawFolderChain = action.payload;\n        const { sanitizedArray: folderChain, errorMessages } = sanitizeInputArray('folderChain', rawFolderChain);\n        state.rawFolderChain = rawFolderChain;\n        state.folderChain = folderChain;\n        state.folderChainErrorMessages = errorMessages;\n    },\n    setRawFiles(state: RootState, action: PayloadAction<FileArray | any>) {\n        const rawFiles = action.payload;\n        const { sanitizedArray: files, errorMessages } = sanitizeInputArray('files', rawFiles);\n        state.rawFiles = rawFiles;\n        state.filesErrorMessages = errorMessages;\n\n        const fileMap: FileMap = {};\n        files.forEach(f => {\n            if (f) fileMap[f.id] = f;\n        });\n        const fileIds = files.map(f => (f ? f.id : null));\n        const cleanFileIds = fileIds.filter(f => !!f) as string[];\n\n        state.fileMap = fileMap;\n        state.fileIds = fileIds;\n        state.cleanFileIds = cleanFileIds;\n\n        // Cleanup selection\n        for (const selectedFileId of Object.keys(state.selectionMap)) {\n            if (!fileMap[selectedFileId]) {\n                delete state.selectionMap[selectedFileId];\n            }\n        }\n    },\n    setSortedFileIds(state: RootState, action: PayloadAction<Nullable<string>[]>) {\n        state.sortedFileIds = action.payload;\n    },\n    setHiddenFileIds(state: RootState, action: PayloadAction<FileIdTrueMap>) {\n        state.hiddenFileIdMap = action.payload;\n\n        // Cleanup selection\n        for (const selectedFileId of Object.keys(state.selectionMap)) {\n            if (state.hiddenFileIdMap[selectedFileId]) {\n                delete state.selectionMap[selectedFileId];\n            }\n        }\n    },\n    setFocusSearchInput(state: RootState, action: PayloadAction<Nullable<() => void>>) {\n        state.focusSearchInput = action.payload;\n    },\n    setSearchString(state: RootState, action: PayloadAction<string>) {\n        state.searchString = action.payload;\n    },\n    selectAllFiles(state: RootState) {\n        state.fileIds\n            .filter(id => id && FileHelper.isSelectable(state.fileMap[id]))\n            .map(id => (id ? (state.selectionMap[id] = true) : null));\n    },\n    selectFiles(state: RootState, action: PayloadAction<{ fileIds: string[]; reset: boolean }>) {\n        if (state.disableSelection) return;\n        if (action.payload.reset) state.selectionMap = {};\n        action.payload.fileIds\n            .filter(id => id && FileHelper.isSelectable(state.fileMap[id]))\n            .map(id => (state.selectionMap[id] = true));\n    },\n    toggleSelection(state: RootState, action: PayloadAction<{ fileId: string; exclusive: boolean }>) {\n        if (state.disableSelection) return;\n        const oldValue = !!state.selectionMap[action.payload.fileId];\n        if (action.payload.exclusive) state.selectionMap = {};\n        if (oldValue) delete state.selectionMap[action.payload.fileId];\n        else if (FileHelper.isSelectable(state.fileMap[action.payload.fileId])) {\n            state.selectionMap[action.payload.fileId] = true;\n        }\n    },\n    clearSelection(state: RootState) {\n        if (state.disableSelection) return;\n        if (Object.keys(state.selectionMap).length !== 0) state.selectionMap = {};\n    },\n    setSelectionDisabled(state: RootState, action: PayloadAction<boolean>) {\n        state.disableSelection = action.payload;\n        if (Object.keys(state.selectionMap).length !== 0) state.selectionMap = {};\n    },\n    setFileViewConfig(state: RootState, action: PayloadAction<FileViewConfig>) {\n        state.fileViewConfig = action.payload;\n    },\n    setSort(state: RootState, action: PayloadAction<{ actionId: string; order: SortOrder }>) {\n        state.sortActionId = action.payload.actionId;\n        state.sortOrder = action.payload.order;\n    },\n    setOptionDefaults(state: RootState, action: PayloadAction<OptionMap>) {\n        for (const optionId of Object.keys(action.payload)) {\n            if (optionId in state.optionMap) continue;\n            state.optionMap[optionId] = action.payload[optionId];\n        }\n    },\n    toggleOption(state: RootState, action: PayloadAction<string>) {\n        state.optionMap[action.payload] = !state.optionMap[action.payload];\n    },\n    setThumbnailGenerator(state: RootState, action: PayloadAction<Nullable<ThumbnailGenerator>>) {\n        state.thumbnailGenerator = action.payload;\n    },\n    setDoubleClickDelay(state: RootState, action: PayloadAction<number>) {\n        state.doubleClickDelay = action.payload;\n    },\n    setDisableDragAndDrop(state: RootState, action: PayloadAction<boolean>) {\n        state.disableDragAndDrop = action.payload;\n    },\n    setClearSelectionOnOutsideClick(state: RootState, action: PayloadAction<boolean>) {\n        state.clearSelectionOnOutsideClick = action.payload;\n    },\n    setLastClickIndex(state: RootState, action: PayloadAction<Nullable<{ index: number; fileId: string }>>) {\n        state.lastClick = action.payload;\n    },\n    setContextMenuMounted(state: RootState, action: PayloadAction<boolean>) {\n        state.contextMenuMounted = action.payload;\n    },\n    showContextMenu(state: RootState, action: PayloadAction<ContextMenuConfig>) {\n        state.contextMenuConfig = action.payload;\n    },\n    hideContextMenu(state: RootState) {\n        if (!state.contextMenuConfig) return;\n        state.contextMenuConfig = null;\n    },\n};\n\nexport const { actions: reduxActions, reducer: rootReducer } = createSlice({\n    name: 'root',\n    initialState: initialRootState,\n    reducers,\n});\n","import { useEffect } from 'react';\nimport watch from 'redux-watch';\n\nimport { Store } from '@reduxjs/toolkit';\n\nimport { ChonkyActions } from '../action-definitions';\nimport { RootState } from '../types/redux.types';\nimport { FileSelection } from '../types/selection.types';\nimport { selectSelectedFileIds, selectSelectionMap } from './selectors';\nimport { thunkRequestFileAction } from './thunks/dispatchers.thunks';\n\nexport const useStoreWatchers = (store: Store<RootState>) => {\n    useEffect(() => {\n        const selectionWatcher = watch(() => selectSelectionMap(store.getState()));\n        const onSelectionChange = (\n            newSelection: FileSelection,\n            oldSelection: FileSelection\n        ) => {\n            // We don't check for deep equality here as we expect the\n            // reducers to prevent all unnecessary updates.\n            if (newSelection === oldSelection) return;\n\n            // Notify users the selection has changed.\n            const selectedFilesIds = selectSelectedFileIds(store.getState());\n            const selection = new Set<string>(selectedFilesIds);\n            store.dispatch(\n                thunkRequestFileAction(ChonkyActions.ChangeSelection, {\n                    selection,\n                }) as any\n            );\n        };\n\n        const unsubscribeCallbacks = [\n            store.subscribe(selectionWatcher(onSelectionChange)),\n        ];\n        return () => {\n            for (const unsubscribe of unsubscribeCallbacks) unsubscribe();\n        };\n    }, [store]);\n};\n","import { useCallback, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { configureStore } from '@reduxjs/toolkit';\n\nimport { RootState } from '../types/redux.types';\nimport { useStaticValue } from '../util/hooks-helpers';\nimport { rootReducer } from './reducers';\nimport { initialRootState } from './state';\nimport { useStoreWatchers } from './watchers';\n\nexport const useChonkyStore = (chonkyInstanceId: string) => {\n    const store = useStaticValue(() => {\n        const preloadedState: RootState = {\n            ...initialRootState,\n            instanceId: chonkyInstanceId,\n        };\n\n        return configureStore({\n            preloadedState: preloadedState as any,\n            reducer: rootReducer,\n            middleware: getDefaultMiddleware =>\n                getDefaultMiddleware({\n                    serializableCheck: false,\n                }),\n            devTools: { name: `chonky_${chonkyInstanceId}` },\n        });\n    });\n    useStoreWatchers(store);\n    return store;\n};\n\n/**\n * Hook that can be used with parametrized selectors.\n */\nexport const useParamSelector = <Args extends Array<any>, Value>(\n    parametrizedSelector: (...args: Args) => (state: RootState) => Value,\n    ...selectorParams: Args\n) => {\n    const selector = useCallback(\n        (state: RootState) => parametrizedSelector(...selectorParams)(state),\n        // eslint-disable-next-line\n        [parametrizedSelector, ...selectorParams]\n    );\n    return useSelector(selector);\n};\n\n/**\n * DTE - DispatchThunkEffect. This method is used to decrease code duplication in\n * main Chonky method.\n */\nexport const useDTE = <Args extends Array<any>>(actionCreator: (...args: Args) => any, ...selectorParams: Args) => {\n    const dispatch = useDispatch();\n    useEffect(\n        () => {\n            dispatch(actionCreator(...selectorParams));\n        },\n        // eslint-disable-next-line\n        [dispatch, actionCreator, ...selectorParams]\n    );\n};\n\nexport const usePropReduxUpdate = <Payload extends any>(actionCreator: (payload: Payload) => any, payload: Payload) => {\n    const dispatch = useDispatch();\n    useEffect(() => {\n        dispatch(actionCreator(payload));\n    }, [dispatch, actionCreator, payload]);\n};\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React from 'react';\n\nimport { ChonkyIconProps } from '../../types/icons.types';\n\nexport const ChonkyIconPlaceholder: React.FC<ChonkyIconProps> = () => {\n    // This component should not be rendered unless the user has misconfigured Chonky\n    const title =\n        'No icon component found. Please follow Chonky installation instructions to ' +\n        'provide a pre-made icon component (or a custom icon).';\n    return <span title={title}></span>;\n};\n","import { ChonkyActions } from '../action-definitions/index';\nimport { ChonkyIconPlaceholder } from '../components/internal/ChonkyIconPlaceholder';\nimport { FileBrowserProps } from '../types/file-browser.types';\n\nexport type ChonkyConfig = Pick<\n    FileBrowserProps,\n    | 'fileActions'\n    | 'onFileAction'\n    | 'thumbnailGenerator'\n    | 'doubleClickDelay'\n    | 'disableSelection'\n    | 'disableDefaultFileActions'\n    | 'disableDragAndDrop'\n    | 'disableDragAndDropProvider'\n    | 'defaultSortActionId'\n    | 'defaultFileViewActionId'\n    | 'clearSelectionOnOutsideClick'\n    | 'iconComponent'\n    | 'darkMode'\n    | 'i18n'\n>;\n\nexport const defaultConfig: ChonkyConfig = {\n    fileActions: null,\n    onFileAction: null,\n    thumbnailGenerator: null,\n    doubleClickDelay: 300,\n    disableSelection: false,\n    disableDefaultFileActions: false,\n    disableDragAndDrop: false,\n    disableDragAndDropProvider: false,\n    defaultSortActionId: ChonkyActions.SortFilesByName.id,\n    defaultFileViewActionId: ChonkyActions.EnableGridView.id,\n    clearSelectionOnOutsideClick: true,\n    iconComponent: ChonkyIconPlaceholder,\n    darkMode: false,\n    i18n: {},\n};\n\nexport const setChonkyDefaults = (config: Partial<ChonkyConfig>) => {\n    for (const key of Object.keys(defaultConfig)) {\n        if (key in config) {\n            defaultConfig[key as keyof ChonkyConfig] = config[\n                key as keyof ChonkyConfig\n            ] as any;\n        }\n    }\n};\n","import filesize from 'filesize';\nimport { createContext, useContext, useMemo } from 'react';\nimport { IntlShape, useIntl } from 'react-intl';\nimport { Nullable, Undefinable } from 'tsdef';\n\nimport { FileAction } from '../types/action.types';\nimport { FileData } from '../types/file.types';\nimport { ChonkyFormatters } from '../types/i18n.types';\nimport { FileHelper } from './file-helper';\n\nexport enum I18nNamespace {\n    Toolbar = 'toolbar',\n    FileList = 'fileList',\n    FileEntry = 'fileEntry',\n    FileContextMenu = 'contextMenu',\n\n    FileActions = 'actions',\n    FileActionGroups = 'actionGroups',\n}\n\nexport const getI18nId = (namespace: I18nNamespace, stringId: string): string =>\n    `chonky.${namespace}.${stringId}`;\n\nexport const getActionI18nId = (actionId: string, stringId: string): string =>\n    `chonky.${I18nNamespace.FileActions}.${actionId}.${stringId}`;\n\nexport const useLocalizedFileActionGroup = (groupName: string) => {\n    const intl = useIntl();\n    return useMemo(() => {\n        return intl.formatMessage({\n            id: getI18nId(I18nNamespace.FileActionGroups, groupName),\n            defaultMessage: groupName,\n        });\n    }, [groupName, intl]);\n};\n\nexport const useLocalizedFileActionStrings = (action: Nullable<FileAction>) => {\n    const intl = useIntl();\n    return useMemo(() => {\n        if (!action) {\n            return {\n                buttonName: '',\n                buttonTooltip: undefined,\n            };\n        }\n\n        const buttonName = intl.formatMessage({\n            id: getActionI18nId(action.id, 'button.name'),\n            defaultMessage: action.button?.name,\n        });\n\n        let buttonTooltip: Undefinable<string> = undefined;\n        if (action.button?.tooltip) {\n            // We only translate the tooltip if the original action has a tooltip.\n            buttonTooltip = intl.formatMessage({\n                id: getActionI18nId(action.id, 'button.tooltip'),\n                defaultMessage: action.button?.tooltip,\n            });\n        }\n\n        return {\n            buttonName,\n            buttonTooltip,\n        };\n    }, [action, intl]);\n};\n\nexport const useLocalizedFileEntryStrings = (file: Nullable<FileData>) => {\n    const intl = useIntl();\n    const formatters = useContext(ChonkyFormattersContext);\n    return useMemo(() => {\n        return {\n            fileModDateString: formatters.formatFileModDate(intl, file),\n            fileSizeString: formatters.formatFileSize(intl, file),\n        };\n    }, [file, formatters, intl]);\n};\n\nexport const defaultFormatters: ChonkyFormatters = {\n    formatFileModDate: (\n        intl: IntlShape,\n        file: Nullable<FileData>\n    ): Nullable<string> => {\n        const safeModDate = FileHelper.getModDate(file);\n        if (safeModDate) {\n            return intl.formatDate(safeModDate, {\n                dateStyle: 'medium',\n                timeStyle: 'short',\n            });\n        } else {\n            return null;\n        }\n    },\n    formatFileSize: (_intl: IntlShape, file: Nullable<FileData>): Nullable<string> => {\n        if (!file || typeof file.size !== 'number') return null;\n\n        const size = file.size;\n        const sizeData = filesize(size, { bits: false, output: 'object' }) as any;\n        if (sizeData.symbol === 'B') {\n            return `${Math.round(sizeData.value / 10) / 100.0} KB`;\n        } else if (sizeData.symbol === 'KB') {\n            return `${Math.round(sizeData.value)} ${sizeData.symbol}`;\n        }\n        return `${sizeData.value} ${sizeData.symbol}`;\n    },\n};\n\nexport const ChonkyFormattersContext = createContext(defaultFormatters);\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2019\n * @license MIT\n */\n\nimport { createContext, ElementType, useMemo } from 'react';\n\nimport ExactTrie from 'exact-trie';\nimport { Nullable } from 'tsdef';\n\nimport { ChonkyIconPlaceholder } from '../components/internal/ChonkyIconPlaceholder';\nimport { FileData } from '../types/file.types';\nimport { ChonkyIconName, ChonkyIconProps, FileIconData } from '../types/icons.types';\n\nexport const ChonkyIconContext = createContext<ElementType<ChonkyIconProps>>(ChonkyIconPlaceholder);\n\nexport const VideoExtensions: string[] = [\n    '3g2',\n    '3gp',\n    '3gpp',\n    'asf',\n    'asx',\n    'avi',\n    'dvb',\n    'f4v',\n    'fli',\n    'flv',\n    'fvt',\n    'h261',\n    'h263',\n    'h264',\n    'jpgm',\n    'jpgv',\n    'jpm',\n    'm1v',\n    'm2v',\n    'm4u',\n    'm4v',\n    'mj2',\n    'mjp2',\n    'mk3d',\n    'mks',\n    'mkv',\n    'mng',\n    'mov',\n    'movie',\n    'mp4',\n    'mp4v',\n    'mpe',\n    'mpeg',\n    'mpg',\n    'mpg4',\n    'mxu',\n    'ogv',\n    'pyv',\n    'qt',\n    'smv',\n    'ts',\n    'uvh',\n    'uvm',\n    'uvp',\n    'uvs',\n    'uvu',\n    'uvv',\n    'uvvh',\n    'uvvm',\n    'uvvp',\n    'uvvs',\n    'uvvu',\n    'uvvv',\n    'viv',\n    'vob',\n    'webm',\n    'wm',\n    'wmv',\n    'wmx',\n    'wvx',\n];\nexport const ImageExtensions: string[] = [\n    '3ds',\n    'apng',\n    'azv',\n    'bmp',\n    'bmp',\n    'btif',\n    'cgm',\n    'cmx',\n    'djv',\n    'djvu',\n    'drle',\n    'dwg',\n    'dxf',\n    'emf',\n    'exr',\n    'fbs',\n    'fh',\n    'fh4',\n    'fh5',\n    'fh7',\n    'fhc',\n    'fits',\n    'fpx',\n    'fst',\n    'g3',\n    'gif',\n    'heic',\n    'heics',\n    'heif',\n    'heifs',\n    'ico',\n    'ico',\n    'ief',\n    'jls',\n    'jng',\n    'jp2',\n    'jpe',\n    'jpeg',\n    'jpf',\n    'jpg',\n    'jpg2',\n    'jpm',\n    'jpx',\n    'jxr',\n    'ktx',\n    'mdi',\n    'mmr',\n    'npx',\n    'pbm',\n    'pct',\n    'pcx',\n    'pcx',\n    'pgm',\n    'pic',\n    'png',\n    'pnm',\n    'ppm',\n    'psd',\n    'pti',\n    'ras',\n    'rgb',\n    'rlc',\n    'sgi',\n    'sid',\n    'sub',\n    'svg',\n    'svgz',\n    't38',\n    'tap',\n    'tfx',\n    'tga',\n    'tif',\n    'tiff',\n    'uvg',\n    'uvi',\n    'uvvg',\n    'uvvi',\n    'vtf',\n    'wbmp',\n    'wdp',\n    'webp',\n    'wmf',\n    'xbm',\n    'xif',\n    'xpm',\n    'xwd',\n];\nexport const AudioExtensions: string[] = [\n    '3gpp',\n    'aac',\n    'adp',\n    'aif',\n    'aifc',\n    'aiff',\n    'au',\n    'caf',\n    'dra',\n    'dts',\n    'dtshd',\n    'ecelp4800',\n    'ecelp7470',\n    'ecelp9600',\n    'eol',\n    'flac',\n    'kar',\n    'lvp',\n    'm2a',\n    'm3a',\n    'm3u',\n    'm4a',\n    'm4a',\n    'mid',\n    'midi',\n    'mka',\n    'mp2',\n    'mp2a',\n    'mp3',\n    'mp3',\n    'mp4a',\n    'mpga',\n    'oga',\n    'ogg',\n    'pya',\n    'ra',\n    'ra',\n    'ram',\n    'rip',\n    'rmi',\n    'rmp',\n    's3m',\n    'sil',\n    'snd',\n    'spx',\n    'uva',\n    'uvva',\n    'wav',\n    'wav',\n    'wav',\n    'wax',\n    'weba',\n    'wma',\n    'xm',\n];\nexport const ColorsLight: string[] = [\n    '#bbbbbb',\n    '#d65c5c',\n    '#d6665c',\n    '#d6705c',\n    '#d67a5c',\n    '#d6855c',\n    '#d68f5c',\n    '#d6995c',\n    '#d6a35c',\n    '#d6ad5c',\n    '#d6b85c',\n    '#d6c25c',\n    '#d6cc5c',\n    '#d6d65c',\n    '#ccd65c',\n    '#c2d65c',\n    '#b8d65c',\n    '#add65c',\n    '#a3d65c',\n    '#99d65c',\n    '#8fd65c',\n    '#85d65c',\n    '#7ad65c',\n    '#70d65c',\n    '#66d65c',\n    '#5cd65c',\n    '#5cd666',\n    '#5cd670',\n    '#5cd67a',\n    '#5cd685',\n    '#5cd68f',\n    '#5cd699',\n    '#5cd6a3',\n    '#5cd6ad',\n    '#5cd6b8',\n    '#5cd6c2',\n    '#5cd6cc',\n    '#5cd6d6',\n    '#5cccd6',\n    '#5cc2d6',\n    '#5cb8d6',\n    '#5cadd6',\n    '#5ca3d6',\n    '#5c99d6',\n    '#5c8fd6',\n    '#5c85d6',\n    '#5c7ad6',\n    '#5c70d6',\n    '#5c66d6',\n    '#5c5cd6',\n    '#665cd6',\n    '#705cd6',\n    '#7a5cd6',\n    '#855cd6',\n    '#8f5cd6',\n    '#995cd6',\n    '#a35cd6',\n    '#ad5cd6',\n    '#b85cd6',\n    '#c25cd6',\n    '#cc5cd6',\n    '#d65cd6',\n    '#d65ccc',\n    '#d65cc2',\n    '#d65cb8',\n    '#d65cad',\n    '#d65ca3',\n    '#d65c99',\n    '#d65c8f',\n    '#d65c85',\n    '#d65c7a',\n    '#d65c70',\n    '#d65c66',\n];\nexport const ColorsDark: string[] = [\n    '#777',\n    '#8f3d3d',\n    '#8f443d',\n    '#8f4b3d',\n    '#8f523d',\n    '#8f583d',\n    '#8f5f3d',\n    '#8f663d',\n    '#8f6d3d',\n    '#8f743d',\n    '#8f7a3d',\n    '#8f813d',\n    '#8f883d',\n    '#8f8f3d',\n    '#888f3d',\n    '#818f3d',\n    '#7a8f3d',\n    '#748f3d',\n    '#6d8f3d',\n    '#668f3d',\n    '#5f8f3d',\n    '#588f3d',\n    '#528f3d',\n    '#4b8f3d',\n    '#448f3d',\n    '#3d8f3d',\n    '#3d8f44',\n    '#3d8f4b',\n    '#3d8f52',\n    '#3d8f58',\n    '#3d8f5f',\n    '#3d8f66',\n    '#3d8f6d',\n    '#3d8f74',\n    '#3d8f7a',\n    '#3d8f81',\n    '#3d8f88',\n    '#3d8f8f',\n    '#3d888f',\n    '#3d818f',\n    '#3d7a8f',\n    '#3d748f',\n    '#3d6d8f',\n    '#3d668f',\n    '#3d5f8f',\n    '#3d588f',\n    '#3d528f',\n    '#3d4b8f',\n    '#3d448f',\n    '#3d3d8f',\n    '#443d8f',\n    '#4b3d8f',\n    '#523d8f',\n    '#583d8f',\n    '#5f3d8f',\n    '#663d8f',\n    '#6d3d8f',\n    '#743d8f',\n    '#7a3d8f',\n    '#813d8f',\n    '#883d8f',\n    '#8f3d8f',\n    '#8f3d88',\n    '#8f3d81',\n    '#8f3d7a',\n    '#8f3d74',\n    '#8f3d6d',\n    '#8f3d66',\n    '#8f3d5f',\n    '#8f3d58',\n    '#8f3d52',\n    '#8f3d4b',\n    '#8f3d44',\n];\n\nconst getIconTrie = () => {\n    let colourIndex = 0;\n    const step = 5;\n\n    const IconsToExtensions = [\n        // Generic file types\n        [ChonkyIconName.license, ['license']],\n        [ChonkyIconName.config, ['sfk', 'ini', 'yml', 'toml', 'iml']],\n        [ChonkyIconName.model, ['3ds', 'obj', 'ply', 'fbx']],\n        [ChonkyIconName.database, ['csv', 'json', 'sql', 'sqlite', 'sqlite3', 'npy', 'npz', 'rec', 'idx', 'hdf5']],\n        [ChonkyIconName.text, ['txt', 'md', 'mdx']],\n        [ChonkyIconName.archive, ['zip', 'rar', 'tar', 'tar.gz', '7z']],\n        [ChonkyIconName.image, ImageExtensions],\n        [ChonkyIconName.video, VideoExtensions],\n        [ChonkyIconName.code, ['html', 'php', 'css', 'sass', 'scss', 'less', 'cpp', 'h', 'hpp', 'c', 'xml']],\n        [ChonkyIconName.info, ['bib', 'readme', 'nfo']],\n        [ChonkyIconName.key, ['pem', 'pub']],\n        [ChonkyIconName.lock, ['lock', 'lock.json', 'shrinkwrap.json']],\n        [ChonkyIconName.music, AudioExtensions],\n        [ChonkyIconName.terminal, ['run', 'sh']],\n        [ChonkyIconName.trash, ['.Trashes']],\n        [ChonkyIconName.users, ['authors', 'contributors']],\n\n        // OS file types\n        [ChonkyIconName.linux, ['AppImage']],\n        [ChonkyIconName.ubuntu, ['deb']],\n        [ChonkyIconName.windows, ['exe']],\n\n        // Programming language file types\n        [ChonkyIconName.rust, ['rs', 'rlib']],\n        [ChonkyIconName.python, ['py', 'ipynb']],\n        [ChonkyIconName.nodejs, ['js', 'jsx', 'ts', 'tsx', 'd.ts']],\n        [ChonkyIconName.php, ['php']],\n\n        // Development tools file types\n        [ChonkyIconName.git, ['.gitignore']],\n\n        // Brands file types\n        [ChonkyIconName.adobe, ['psd']],\n\n        // Other program file types\n        [ChonkyIconName.pdf, ['pdf']],\n        [ChonkyIconName.excel, ['xls', 'xlsx']],\n        [ChonkyIconName.word, ['doc', 'docx', 'odt']],\n        [ChonkyIconName.flash, ['swf']],\n    ] as const;\n\n    const exactTrie = new ExactTrie({ ignoreCase: true });\n    for (const pair of IconsToExtensions) {\n        const [icon, extensions] = pair;\n\n        for (let i = 0; i < extensions.length; ++i) {\n            colourIndex += step;\n            const colorCode = (colourIndex % (ColorsLight.length - 1)) + 1;\n            const iconData: FileIconData = {\n                icon,\n                colorCode,\n            };\n            exactTrie.put(extensions[i], iconData, true);\n        }\n    }\n\n    return exactTrie;\n};\n\nconst iconTrie = getIconTrie();\n\nexport const useIconData = (file: Nullable<FileData>): FileIconData => {\n    return useMemo(() => {\n        if (!file) return { icon: ChonkyIconName.loading, colorCode: 0 };\n        if (file.isDir === true) return { icon: ChonkyIconName.folder, colorCode: 0 };\n\n        const match = iconTrie.getWithCheckpoints(file.name, '.', true);\n        return match ? match : { icon: ChonkyIconName.file, colorCode: 32 };\n    }, [file]);\n};\n","import { Theme as MuiTheme } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport classnames from 'classnames';\nimport { createUseStyles } from 'react-jss';\nimport { DeepPartial } from 'tsdef';\n\nexport const lightTheme = {\n    colors: {\n        debugRed: '#fabdbd',\n        debugBlue: '#bdd8fa',\n        debugGreen: '#d2fabd',\n        debugPurple: '#d2bdfa',\n        debugYellow: '#fae9bd',\n\n        textActive: '#09f',\n    },\n\n    fontSizes: {\n        rootPrimary: 15,\n    },\n\n    margins: {\n        rootLayoutMargin: 8,\n    },\n\n    toolbar: {\n        size: 30,\n        lineHeight: '30px', // `px` suffix is required for `line-height` fields to work\n        fontSize: 15,\n        buttonRadius: 4,\n    },\n\n    dnd: {\n        canDropColor: 'green',\n        cannotDropColor: 'red',\n        canDropMask: 'rgba(180, 235, 180, 0.75)',\n        cannotDropMask: 'rgba(235, 180, 180, 0.75)',\n        fileListCanDropMaskOne: 'rgba(180, 235, 180, 0.1)',\n        fileListCanDropMaskTwo: 'rgba(180, 235, 180, 0.2)',\n        fileListCannotDropMaskOne: 'rgba(235, 180, 180, 0.1)',\n        fileListCannotDropMaskTwo: 'rgba(235, 180, 180, 0.2)',\n    },\n\n    dragLayer: {\n        border: 'solid 2px #09f',\n        padding: '7px 10px',\n        borderRadius: 2,\n    },\n\n    fileList: {\n        desktopGridGutter: 8,\n        mobileGridGutter: 5,\n    },\n\n    gridFileEntry: {\n        childrenCountSize: '1.6em',\n        iconColorFocused: '#000',\n        iconSize: '2.4em',\n        iconColor: '#fff',\n        borderRadius: 5,\n        fontSize: 14,\n\n        fileColorTint: 'rgba(255, 255, 255, 0.4)',\n        folderBackColorTint: 'rgba(255, 255, 255, 0.1)',\n        folderFrontColorTint: 'rgba(255, 255, 255, 0.4)',\n    },\n\n    listFileEntry: {\n        propertyFontSize: 14,\n        iconFontSize: '1.1em',\n        iconBorderRadius: 5,\n        fontSize: 14,\n    },\n};\n\nexport type ChonkyTheme = typeof lightTheme;\n\nexport const darkThemeOverride: DeepPartial<ChonkyTheme> = {\n    gridFileEntry: {\n        fileColorTint: 'rgba(50, 50, 50, 0.4)',\n        folderBackColorTint: 'rgba(50, 50, 50, 0.4)',\n        folderFrontColorTint: 'rgba(50, 50, 50, 0.15)',\n    },\n};\n\nexport const mobileThemeOverride: DeepPartial<ChonkyTheme> = {\n    fontSizes: {\n        rootPrimary: 13,\n    },\n    margins: {\n        rootLayoutMargin: 4,\n    },\n    toolbar: {\n        size: 28,\n        lineHeight: '28px',\n        fontSize: 13,\n    },\n    gridFileEntry: {\n        fontSize: 13,\n    },\n    listFileEntry: {\n        propertyFontSize: 12,\n        iconFontSize: '1em',\n        fontSize: 13,\n    },\n};\n\nexport const useIsMobileBreakpoint = () => {\n    return useMediaQuery('(max-width:480px)');\n};\n\nexport const getStripeGradient = (colorOne: string, colorTwo: string) =>\n    'repeating-linear-gradient(' +\n    '45deg,' +\n    `${colorOne},` +\n    `${colorOne} 10px,` +\n    `${colorTwo} 0,` +\n    `${colorTwo} 20px` +\n    ')';\n\nexport const makeLocalChonkyStyles = <C extends string = string>(\n    styles: (theme: ChonkyTheme & MuiTheme) => any\n    // @ts-ignore\n): any => createUseStyles<ChonkyTheme, C>(styles);\n\nexport const makeGlobalChonkyStyles = <C extends string = string>(\n    makeStyles: (theme: ChonkyTheme & MuiTheme) => any\n) => {\n    const selectorMapping = {};\n    const makeGlobalStyles = (theme: ChonkyTheme) => {\n        const localStyles = makeStyles(theme as any);\n        const globalStyles = {};\n        const localSelectors = Object.keys(localStyles);\n        localSelectors.map(localSelector => {\n            const globalSelector = `chonky-${localSelector}`;\n            const jssSelector = `@global .${globalSelector}`;\n            // @ts-ignore\n            globalStyles[jssSelector] = localStyles[localSelector];\n            // @ts-ignore\n            selectorMapping[localSelector] = globalSelector;\n        });\n        return globalStyles;\n    };\n\n    // @ts-ignore\n    const useStyles = createUseStyles<ChonkyTheme, C>(makeGlobalStyles as any);\n    return (...args: any[]): any => {\n        const styles = useStyles(...args);\n        const classes = {};\n        Object.keys(selectorMapping).map(localSelector => {\n            // @ts-ignore\n            classes[localSelector] = selectorMapping[localSelector];\n        });\n        return { ...classes, ...styles };\n    };\n};\n\nexport const important = <T>(value: T) => [value, '!important'];\n\nexport const c = classnames;\n","import React, { useImperativeHandle } from 'react';\nimport { useDispatch, useStore } from 'react-redux';\n\nimport { reduxActions } from '../redux/reducers';\nimport { selectSelectionMap } from '../redux/selectors';\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\nimport { FileAction } from '../types/action.types';\nimport { FileBrowserHandle } from '../types/file-browser.types';\nimport { RootState } from '../types/redux.types';\n\nexport const useFileBrowserHandle = (ref: React.Ref<FileBrowserHandle>) => {\n    const store = useStore<RootState>();\n    const dispatch = useDispatch();\n\n    useImperativeHandle(\n        ref,\n        () => ({\n            getFileSelection(): Set<string> {\n                const selectionMap = selectSelectionMap(store.getState());\n                const selectionSet = new Set(Object.keys(selectionMap));\n                return selectionSet;\n            },\n            setFileSelection(selection, reset = true): void {\n                const fileIds = Array.from(selection);\n                dispatch(reduxActions.selectFiles({ fileIds, reset }));\n            },\n            requestFileAction<Action extends FileAction>(\n                action: Action,\n                payload: Action['__payloadType']\n            ): Promise<void> {\n                return Promise.resolve(\n                    dispatch(thunkRequestFileAction(action, payload))\n                ).then();\n            },\n        }),\n        [store, dispatch]\n    );\n};\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React from 'react';\n\nimport { reduxActions } from '../../redux/reducers';\nimport { initialRootState } from '../../redux/state';\nimport { useDTE, usePropReduxUpdate } from '../../redux/store';\nimport {\n    thunkActivateSortAction, thunkUpdateDefaultFileViewActionId, thunkUpdateRawFileActions\n} from '../../redux/thunks/file-actions.thunks';\nimport { FileBrowserHandle, FileBrowserProps } from '../../types/file-browser.types';\nimport { defaultConfig } from '../../util/default-config';\nimport { useFileBrowserHandle } from '../../util/file-browser-handle';\nimport { getValueOrFallback } from '../../util/helpers';\n\nexport const ChonkyBusinessLogicInner = React.memo(\n    React.forwardRef<FileBrowserHandle, FileBrowserProps>((props, ref) => {\n        // ==== Update Redux state\n        usePropReduxUpdate(reduxActions.setRawFiles, props.files ?? initialRootState.rawFiles);\n        usePropReduxUpdate(reduxActions.setRawFolderChain, props.folderChain);\n        useDTE(\n            thunkUpdateRawFileActions,\n            getValueOrFallback(props.fileActions, defaultConfig.fileActions),\n            getValueOrFallback(props.disableDefaultFileActions, defaultConfig.disableDefaultFileActions)\n        );\n        useDTE(\n            reduxActions.setExternalFileActionHandler,\n            getValueOrFallback(props.onFileAction, defaultConfig.onFileAction) as any\n        );\n        useDTE(\n            reduxActions.setSelectionDisabled,\n            getValueOrFallback(props.disableSelection, defaultConfig.disableSelection, 'boolean')\n        );\n        useDTE(\n            thunkActivateSortAction,\n            getValueOrFallback(props.defaultSortActionId, defaultConfig.defaultSortActionId)\n        );\n        useDTE(\n            thunkUpdateDefaultFileViewActionId,\n            getValueOrFallback(props.defaultFileViewActionId, defaultConfig.defaultFileViewActionId, 'string')\n        );\n\n        useDTE(\n            reduxActions.setThumbnailGenerator,\n            getValueOrFallback(props.thumbnailGenerator, defaultConfig.thumbnailGenerator)\n        );\n        useDTE(\n            reduxActions.setDoubleClickDelay,\n            getValueOrFallback(props.doubleClickDelay, defaultConfig.doubleClickDelay, 'number')\n        );\n        useDTE(\n            reduxActions.setDisableDragAndDrop,\n            getValueOrFallback(props.disableDragAndDrop, defaultConfig.disableDragAndDrop, 'boolean')\n        );\n        useDTE(\n            reduxActions.setClearSelectionOnOutsideClick,\n            getValueOrFallback(\n                props.clearSelectionOnOutsideClick,\n                defaultConfig.clearSelectionOnOutsideClick,\n                'boolean'\n            )\n        );\n\n        // ==== Setup the imperative handle for external use\n        useFileBrowserHandle(ref);\n\n        return null;\n    })\n);\nChonkyBusinessLogicInner.displayName = 'ChonkyBusinessLogicInner';\n\nexport const ChonkyBusinessLogic = React.memo(ChonkyBusinessLogicInner);\nChonkyBusinessLogic.displayName = 'ChonkyBusinessLogic';\n","import { useCallback, useContext } from 'react';\nimport { DndContext, useDrag, useDrop } from 'react-dnd';\n\nexport const useDndContextAvailable = () => {\n    const dndContext = useContext(DndContext);\n    const { dragDropManager } = dndContext;\n    return !!dragDropManager;\n};\n\nexport const useDragIfAvailable: typeof useDrag = (...args) => {\n    // This is an ugly hack to make `useDrag` not throw if a `DndContext` is not available.\n    // See: https://github.com/react-dnd/react-dnd/issues/2212\n    const dndContextAvailable = useDndContextAvailable();\n    const mockHook = useCallback(() => [{} as any, () => null, () => null], []);\n    // @ts-ignore\n    const useHook: typeof useDrag = dndContextAvailable ? useDrag : mockHook;\n    return useHook(...args);\n};\n\nexport const useDropIfAvailable: typeof useDrop = (...args) => {\n    const dndContextAvailable = useDndContextAvailable();\n    const mockHook = useCallback(() => [{} as any, () => null], []);\n    // @ts-ignore\n    const useHook: typeof useDrop = dndContextAvailable ? useDrop : mockHook;\n    return useHook(...args);\n};\n","import React, { useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Nullable } from 'tsdef';\n\nimport { ChonkyActions } from '../../action-definitions/index';\nimport { reduxActions } from '../../redux/reducers';\nimport { selectContextMenuMounted } from '../../redux/selectors';\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\nimport { findElementAmongAncestors } from '../../util/helpers';\nimport { useInstanceVariable } from '../../util/hooks-helpers';\n\nexport const findClosestChonkyFileId = (\n    element: HTMLElement | any\n): Nullable<string> => {\n    const fileEntryWrapperDiv = findElementAmongAncestors(\n        element,\n        (element: any) =>\n            element.tagName &&\n            element.tagName.toLowerCase() === 'div' &&\n            element.dataset &&\n            element.dataset.chonkyFileId\n    );\n    return fileEntryWrapperDiv ? fileEntryWrapperDiv.dataset.chonkyFileId! : null;\n};\n\nexport const useContextMenuTrigger = () => {\n    const dispatch = useDispatch();\n    const contextMenuMountedRef = useInstanceVariable(\n        useSelector(selectContextMenuMounted)\n    );\n    return useCallback(\n        (event: React.MouseEvent<HTMLDivElement>) => {\n            // Use default browser context menu when Chonky context menu component\n            // is not mounted.\n            if (!contextMenuMountedRef.current) return;\n            // Users can use Alt+Right Click to bring up browser's default\n            // context menu instead of Chonky's context menu.\n            if (event.altKey) return;\n\n            event.preventDefault();\n\n            const triggerFileId = findClosestChonkyFileId(event.target);\n            dispatch(\n                thunkRequestFileAction(ChonkyActions.OpenFileContextMenu, {\n                    clientX: event.clientX,\n                    clientY: event.clientY,\n                    triggerFileId,\n                })\n            );\n        },\n        [contextMenuMountedRef, dispatch]\n    );\n};\n\nexport const useContextMenuDismisser = () => {\n    const dispatch = useDispatch();\n    return useCallback(() => dispatch(reduxActions.hideContextMenu()), [dispatch]);\n};\n","import { DragObjectWithType } from 'react-dnd';\nimport { Nilable } from 'tsdef';\n\nimport { StartDragNDropPayload } from './action-payloads.types';\nimport { FileData } from './file.types';\n\nexport interface ChonkyDndDropResult {\n    dropTarget: Nilable<FileData> | any;\n    dropEffect: 'move' | 'copy';\n}\n\nexport type ChonkyDndFileEntryItem = DragObjectWithType & {\n    payload: StartDragNDropPayload;\n};\nexport const ChonkyDndFileEntryType = 'dnd-chonky-file-entry';\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React from 'react';\nimport { useDragLayer } from 'react-dnd';\nimport { Nullable } from 'tsdef';\n\nimport { ChonkyDndFileEntryItem, ChonkyDndFileEntryType } from '../../types/dnd.types';\nimport { makeGlobalChonkyStyles } from '../../util/styles';\n\nexport interface DnDFileListDragLayerProps {}\n\nconst layerStyles: React.CSSProperties = {\n    position: 'fixed',\n    pointerEvents: 'none',\n    zIndex: 100,\n    left: 0,\n    top: 0,\n    width: '100%',\n    height: '100%',\n};\nconst getItemStyles = (\n    initialCursorOffset: Nullable<{ x: number; y: number }>,\n    initialFileOffset: Nullable<{ x: number; y: number }>,\n    currentFileOffset: Nullable<{ x: number; y: number }>\n) => {\n    if (!initialCursorOffset || !initialFileOffset || !currentFileOffset) {\n        return {\n            display: 'none',\n        };\n    }\n    const x = initialCursorOffset.x + (currentFileOffset.x - initialFileOffset.x);\n    const y = initialCursorOffset.y + (currentFileOffset.y - initialFileOffset.y);\n    const transform = `translate(${x}px, ${y}px)`;\n    return {\n        transform,\n        WebkitTransform: transform,\n    };\n};\n\nexport const DnDFileListDragLayer: React.FC<DnDFileListDragLayerProps> = () => {\n    const classes = useStyles();\n\n    const {\n        itemType,\n        item,\n        initialCursorOffset,\n        initialFileOffset,\n        currentFileOffset,\n        isDragging,\n    } = useDragLayer(monitor => ({\n        item: monitor.getItem() as ChonkyDndFileEntryItem,\n        itemType: monitor.getItemType(),\n        initialCursorOffset: monitor.getInitialClientOffset(),\n        initialFileOffset: monitor.getInitialSourceClientOffset(),\n        currentFileOffset: monitor.getSourceClientOffset(),\n        isDragging: monitor.isDragging(),\n    }));\n    if (!isDragging || itemType !== ChonkyDndFileEntryType || !item.payload) {\n        return null;\n    }\n\n    const selectionSize = item.payload.selectedFiles.length;\n    return (\n        <div style={layerStyles}>\n            <div\n                style={getItemStyles(\n                    initialCursorOffset,\n                    initialFileOffset,\n                    currentFileOffset\n                )}\n            >\n                <div className={classes.fileDragPreview}>\n                    <b>{item.payload.draggedFile.name}</b>\n                    {selectionSize > 1 && (\n                        <>\n                            {' and '}\n                            <strong>\n                                {selectionSize - 1} other file\n                                {selectionSize - 1 !== 1 ? 's' : ''}\n                            </strong>\n                        </>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    fileDragPreview: {\n        boxShadow: `2px 2px 5px ${theme.palette.divider}`,\n        backgroundColor: theme.palette.background.default,\n        borderRadius: theme.dragLayer.borderRadius,\n        fontSize: theme.fontSizes.rootPrimary,\n        color: theme.palette.text.primary,\n        padding: theme.dragLayer.padding,\n        border: theme.dragLayer.border,\n        display: 'inline-block',\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport hotkeys from 'hotkeys-js';\nimport React, { useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { selectFileActionData } from '../../redux/selectors';\nimport { useParamSelector } from '../../redux/store';\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\n\nexport interface HotkeyListenerProps {\n    fileActionId: string;\n}\n\nexport const HotkeyListener: React.FC<HotkeyListenerProps> = React.memo(props => {\n    const { fileActionId } = props;\n\n    const dispatch = useDispatch();\n    const fileAction = useParamSelector(selectFileActionData, fileActionId);\n\n    useEffect(() => {\n        if (!fileAction || !fileAction.hotkeys || fileAction.hotkeys.length === 0) {\n            return;\n        }\n\n        const hotkeysStr = fileAction.hotkeys.join(',');\n        const hotkeyCallback = (event: KeyboardEvent) => {\n            event.preventDefault();\n            dispatch(thunkRequestFileAction(fileAction, undefined));\n        };\n        hotkeys(hotkeysStr, hotkeyCallback);\n        return () => hotkeys.unbind(hotkeysStr, hotkeyCallback);\n    }, [dispatch, fileAction]);\n\n    return null;\n});\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport Box from '@material-ui/core/Box';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport React, { useCallback, useMemo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { reduxActions } from '../../redux/reducers';\nimport {\n    selectClearSelectionOnOutsideClick,\n    selectFileActionIds,\n    selectIsDnDDisabled,\n} from '../../redux/selectors';\nimport { useDndContextAvailable } from '../../util/dnd-fallback';\nimport { elementIsInsideButton } from '../../util/helpers';\nimport { makeGlobalChonkyStyles } from '../../util/styles';\nimport { useContextMenuTrigger } from '../external/FileContextMenu-hooks';\nimport { DnDFileListDragLayer } from '../file-list/DnDFileListDragLayer';\nimport { HotkeyListener } from './HotkeyListener';\n\nexport interface ChonkyPresentationLayerProps {}\n\nexport const ChonkyPresentationLayer: React.FC<ChonkyPresentationLayerProps> = ({\n    children,\n}) => {\n    const dispatch = useDispatch();\n    const fileActionIds = useSelector(selectFileActionIds);\n    const dndDisabled = useSelector(selectIsDnDDisabled);\n    const clearSelectionOnOutsideClick = useSelector(\n        selectClearSelectionOnOutsideClick\n    );\n\n    // Deal with clicks outside of Chonky\n    const handleClickAway = useCallback(\n        (event: React.MouseEvent<Document>) => {\n            if (!clearSelectionOnOutsideClick || elementIsInsideButton(event.target)) {\n                // We only clear out the selection on outside click if the click target\n                // was not a button. We don't want to clear out the selection when a\n                // button is clicked because Chonky users might want to trigger some\n                // selection-related action on that button click.\n                return;\n            }\n            dispatch(reduxActions.clearSelection());\n        },\n        [dispatch, clearSelectionOnOutsideClick]\n    );\n\n    // Generate necessary components\n    const hotkeyListenerComponents = useMemo(\n        () =>\n            fileActionIds.map(actionId => (\n                <HotkeyListener\n                    key={`file-action-listener-${actionId}`}\n                    fileActionId={actionId}\n                />\n            )),\n        [fileActionIds]\n    );\n\n    const dndContextAvailable = useDndContextAvailable();\n    const showContextMenu = useContextMenuTrigger();\n\n    const classes = useStyles();\n    return (\n        <ClickAwayListener onClickAway={handleClickAway}>\n            <Box className={classes.chonkyRoot} onContextMenu={showContextMenu}>\n                {!dndDisabled && dndContextAvailable && <DnDFileListDragLayer />}\n                {hotkeyListenerComponents}\n                {children ? children : null}\n            </Box>\n        </ClickAwayListener>\n    );\n};\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    chonkyRoot: {\n        backgroundColor: theme.palette.background.paper,\n        border: `solid 1px ${theme.palette.divider}`,\n        padding: theme.margins.rootLayoutMargin,\n        fontSize: theme.fontSizes.rootPrimary,\n        color: theme.palette.text.primary,\n        touchAction: 'manipulation', // Disabling zoom on double tap\n        fontFamily: 'sans-serif',\n        flexDirection: 'column',\n        boxSizing: 'border-box',\n        textAlign: 'left',\n        borderRadius: 4,\n        display: 'flex',\n        height: '100%',\n\n        // Disabling select\n        webkitTouchCallout: 'none',\n        webkitUserSelect: 'none',\n        mozUserSelect: 'none',\n        msUserSelect: 'none',\n        userSelect: 'none',\n    },\n}));\n","import {\n    createMuiTheme,\n    ThemeProvider as MuiThemeProvider,\n} from '@material-ui/core/styles';\nimport merge from 'deepmerge';\nimport React, { ReactNode, useMemo } from 'react';\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { IntlProvider } from 'react-intl';\nimport { ThemeProvider } from 'react-jss';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport shortid from 'shortid';\n\nimport { useChonkyStore } from '../../redux/store';\nimport { FileBrowserHandle, FileBrowserProps } from '../../types/file-browser.types';\nimport { defaultConfig } from '../../util/default-config';\nimport { getValueOrFallback } from '../../util/helpers';\nimport { useStaticValue } from '../../util/hooks-helpers';\nimport { ChonkyFormattersContext, defaultFormatters } from '../../util/i18n';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport {\n    darkThemeOverride,\n    lightTheme,\n    mobileThemeOverride,\n    useIsMobileBreakpoint,\n} from '../../util/styles';\nimport { ChonkyBusinessLogic } from '../internal/ChonkyBusinessLogic';\nimport { ChonkyIconPlaceholder } from '../internal/ChonkyIconPlaceholder';\nimport { ChonkyPresentationLayer } from '../internal/ChonkyPresentationLayer';\n\n// if (process.env.NODE_ENV === 'development') {\n//     const whyDidYouRender = require('@welldone-software/why-did-you-render');\n//     whyDidYouRender(React, {\n//         trackAllPureComponents: true,\n//     });\n// }\n\nexport const FileBrowser = React.forwardRef<\n    FileBrowserHandle,\n    FileBrowserProps & { children?: ReactNode }\n>((props, ref) => {\n    const { instanceId, iconComponent, children } = props;\n    const disableDragAndDrop = getValueOrFallback(\n        props.disableDragAndDrop,\n        defaultConfig.disableDragAndDrop,\n        'boolean'\n    );\n    const disableDragAndDropProvider = getValueOrFallback(\n        props.disableDragAndDropProvider,\n        defaultConfig.disableDragAndDropProvider,\n        'boolean'\n    );\n    const darkMode = getValueOrFallback(\n        props.darkMode,\n        defaultConfig.darkMode,\n        'boolean'\n    );\n    const i18n = getValueOrFallback(props.i18n, defaultConfig.i18n);\n    const formatters = useMemo(() => ({ ...defaultFormatters, ...i18n?.formatters }), [\n        i18n,\n    ]);\n\n    const chonkyInstanceId = useStaticValue(() => instanceId ?? shortid.generate());\n    const store = useChonkyStore(chonkyInstanceId);\n\n    const isMobileBreakpoint = useIsMobileBreakpoint();\n    const theme = useMemo(() => {\n        const muiTheme = createMuiTheme({\n            palette: { type: darkMode ? 'dark' : 'light' },\n        });\n        const combinedTheme = merge(\n            muiTheme,\n            merge(lightTheme, darkMode ? darkThemeOverride : {})\n        );\n        return isMobileBreakpoint\n            ? merge(combinedTheme, mobileThemeOverride)\n            : combinedTheme;\n    }, [darkMode, isMobileBreakpoint]);\n\n    const chonkyComps = (\n        <>\n            <ChonkyBusinessLogic ref={ref} {...props} />\n            <ChonkyPresentationLayer>{children}</ChonkyPresentationLayer>\n        </>\n    );\n\n    return (\n        <IntlProvider locale=\"en\" defaultLocale=\"en\" {...i18n}>\n            <ChonkyFormattersContext.Provider value={formatters}>\n                <ReduxProvider store={store}>\n                    <ThemeProvider theme={theme}>\n                        <MuiThemeProvider theme={theme}>\n                            <ChonkyIconContext.Provider\n                                value={\n                                    iconComponent ??\n                                    defaultConfig.iconComponent ??\n                                    ChonkyIconPlaceholder\n                                }\n                            >\n                                {disableDragAndDrop || disableDragAndDropProvider ? (\n                                    chonkyComps\n                                ) : (\n                                    <DndProvider backend={HTML5Backend}>\n                                        {chonkyComps}\n                                    </DndProvider>\n                                )}\n                            </ChonkyIconContext.Provider>\n                        </MuiThemeProvider>\n                    </ThemeProvider>\n                </ReduxProvider>\n            </ChonkyFormattersContext.Provider>\n        </IntlProvider>\n    );\n});\nFileBrowser.displayName = 'FileBrowser';\n","import { useMemo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Nullable } from 'tsdef';\n\nimport { ChonkyActions } from '../../action-definitions/index';\nimport { selectFolderChain } from '../../redux/selectors';\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\nimport { FileData } from '../../types/file.types';\nimport { FileHelper } from '../../util/file-helper';\n\nexport interface FolderChainItem {\n    file: Nullable<FileData>;\n    disabled: boolean;\n    onClick?: () => void;\n}\n\nexport const useFolderChainItems = (): FolderChainItem[] => {\n    const folderChain = useSelector(selectFolderChain);\n    const dispatch = useDispatch();\n\n    const folderChainItems = useMemo(() => {\n        const items: FolderChainItem[] = [];\n        if (!folderChain) return items;\n\n        for (let i = 0; i < folderChain.length; ++i) {\n            const file = folderChain[i];\n            items.push({\n                file,\n                disabled: !file,\n                onClick:\n                    !FileHelper.isOpenable(file) || i === folderChain.length - 1\n                        ? undefined\n                        : () =>\n                              dispatch(\n                                  thunkRequestFileAction(ChonkyActions.OpenFiles, {\n                                      targetFile: file,\n                                      files: [file],\n                                  })\n                              ),\n            });\n        }\n        return items;\n    }, [dispatch, folderChain]);\n    return folderChainItems;\n};\n","import { useCallback, useEffect, useMemo } from 'react';\nimport { DragSourceMonitor, DropTargetMonitor } from 'react-dnd';\nimport { getEmptyImage } from 'react-dnd-html5-backend';\nimport { useDispatch, useSelector, useStore } from 'react-redux';\nimport { ExcludeKeys, Nullable } from 'tsdef';\n\nimport { EssentialActions } from '../action-definitions/essential';\nimport { ChonkyActions } from '../action-definitions/index';\nimport {\n    selectCurrentFolder,\n    selectFolderChain,\n    selectInstanceId,\n    selectSelectedFiles,\n} from '../redux/selectors';\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\nimport { StartDragNDropPayload } from '../types/action-payloads.types';\nimport {\n    ChonkyDndDropResult,\n    ChonkyDndFileEntryItem,\n    ChonkyDndFileEntryType,\n} from '../types/dnd.types';\nimport { DndEntryState } from '../types/file-list.types';\nimport { FileData } from '../types/file.types';\nimport { useDragIfAvailable, useDropIfAvailable } from './dnd-fallback';\nimport { FileHelper } from './file-helper';\nimport { useInstanceVariable } from './hooks-helpers';\n\nexport const useFileDrag = (file: Nullable<FileData>) => {\n    // Prepare the dnd payload\n    const store = useStore();\n    const fileRef = useInstanceVariable(file);\n    const getDndStartPayload = useCallback<() => StartDragNDropPayload>(() => {\n        const reduxState = store.getState();\n        return {\n            sourceInstanceId: selectInstanceId(reduxState),\n            source: selectCurrentFolder(reduxState),\n            // We force non-null type below because by convention, if drag & drop for\n            // this file was possible, it must have been non-null.\n            draggedFile: fileRef.current!,\n            selectedFiles: selectSelectedFiles(reduxState),\n        };\n    }, [store, fileRef]);\n\n    // For drag source\n    const dispatch = useDispatch();\n    const canDrag = useCallback(() => FileHelper.isDraggable(fileRef.current), [\n        fileRef,\n    ]);\n    const onDragStart = useCallback((): ChonkyDndFileEntryItem => {\n        const item: ChonkyDndFileEntryItem = {\n            type: ChonkyDndFileEntryType,\n            payload: getDndStartPayload(),\n        };\n        dispatch(thunkRequestFileAction(ChonkyActions.StartDragNDrop, item.payload));\n        return item;\n    }, [dispatch, getDndStartPayload]);\n    const onDragEnd = useCallback(\n        (item: ChonkyDndFileEntryItem, monitor: DragSourceMonitor) => {\n            const dropResult = monitor.getDropResult() as ChonkyDndDropResult;\n            if (\n                !FileHelper.isDraggable(item.payload.draggedFile) ||\n                !dropResult ||\n                !dropResult.dropTarget\n            ) {\n                return;\n            }\n\n            dispatch(\n                thunkRequestFileAction(ChonkyActions.EndDragNDrop, {\n                    ...item.payload,\n                    destination: dropResult.dropTarget,\n                    copy: dropResult.dropEffect === 'copy',\n                })\n            );\n        },\n        [dispatch]\n    );\n\n    // Create refs for react-dnd hooks\n    const item = useMemo<ChonkyDndFileEntryItem>(\n        () => ({\n            type: ChonkyDndFileEntryType,\n            // Payload is actually added in `onDragStart`\n            payload: {} as StartDragNDropPayload,\n        }),\n        []\n    );\n    const collect = useCallback(monitor => ({ isDragging: monitor.isDragging() }), []);\n    const [{ isDragging: dndIsDragging }, drag, preview] = useDragIfAvailable({\n        item,\n        canDrag,\n        begin: onDragStart,\n        // @ts-ignore\n        end: onDragEnd,\n        collect,\n    });\n\n    useEffect(() => {\n        // Set drag preview to an empty image because `DnDFileListDragLayer` will\n        // provide its own preview.\n        preview(getEmptyImage(), { captureDraggingState: true });\n    }, [preview]);\n\n    return { dndIsDragging, drag };\n};\n\ninterface UseFileDropParams {\n    file: Nullable<FileData>;\n    forceDisableDrop?: boolean;\n    includeChildrenDrops?: boolean;\n}\n\nexport const useFileDrop = ({\n    file,\n    forceDisableDrop,\n    includeChildrenDrops,\n}: UseFileDropParams) => {\n    const folderChainRef = useInstanceVariable(useSelector(selectFolderChain));\n    const onDrop = useCallback(\n        (_item: ChonkyDndFileEntryItem, monitor) => {\n            if (!monitor.canDrop()) return;\n            const customDropResult: ExcludeKeys<ChonkyDndDropResult, 'dropEffect'> = {\n                dropTarget: file,\n            };\n            return customDropResult;\n        },\n        [file]\n    );\n    const canDrop = useCallback(\n        (item: ChonkyDndFileEntryItem, monitor: DropTargetMonitor) => {\n            if (\n                forceDisableDrop ||\n                !FileHelper.isDroppable(file) ||\n                (!monitor.isOver({ shallow: true }) && !includeChildrenDrops)\n            ) {\n                return false;\n            }\n            const { source, draggedFile, selectedFiles } = item.payload;\n\n            // We prevent folders from being dropped into themselves. We also prevent\n            // any folder from current folder chain being moved - we can't move the\n            // folder that we are currently in.\n            const prohibitedFileIds = new Set<string>();\n            prohibitedFileIds.add(file.id);\n            folderChainRef.current.map(folder => {\n                if (folder) prohibitedFileIds.add(folder.id);\n            });\n            const movedFiles: FileData[] = [draggedFile, ...selectedFiles];\n            for (const currFile of movedFiles) {\n                if (prohibitedFileIds.has(currFile.id)) return false;\n            }\n\n            // Finally, prohibit files from being moved into their parent folder\n            // (which is a no-op).\n            return file.id !== source?.id;\n        },\n        [forceDisableDrop, file, includeChildrenDrops, folderChainRef]\n    );\n    const collect = useCallback(\n        monitor => ({\n            isOver: monitor.isOver(),\n            isOverCurrent: monitor.isOver({ shallow: true }),\n            canDrop: monitor.canDrop(),\n        }),\n        []\n    );\n    const [\n        { isOver: dndIsOver, isOverCurrent: dndIsOverCurrent, canDrop: dndCanDrop },\n        drop,\n    ] = useDropIfAvailable({\n        accept: ChonkyDndFileEntryType,\n        drop: onDrop,\n        canDrop,\n        collect,\n    });\n    return { dndIsOver, dndIsOverCurrent, dndCanDrop, drop };\n};\n\nexport const useFileEntryDnD = (file: Nullable<FileData>) => {\n    const { dndIsDragging, drag } = useFileDrag(file);\n    const { dndIsOver, dndCanDrop, drop } = useFileDrop({ file });\n    const dndState = useMemo<DndEntryState>(\n        () => ({\n            dndIsDragging,\n            dndIsOver,\n            dndCanDrop,\n        }),\n        [dndCanDrop, dndIsDragging, dndIsOver]\n    );\n    return {\n        drop,\n        drag,\n        dndState,\n    };\n};\n\nexport const useDndHoverOpen = (file: Nullable<FileData>, dndState: DndEntryState) => {\n    const dispatch = useDispatch();\n    const currentFolderRef = useInstanceVariable(useSelector(selectCurrentFolder));\n    useEffect(() => {\n        let timeout: Nullable<any> = null;\n        if (\n            dndState.dndIsOver &&\n            FileHelper.isDndOpenable(file) &&\n            file.id !== currentFolderRef.current?.id\n        ) {\n            timeout = setTimeout(\n                () =>\n                    dispatch(\n                        thunkRequestFileAction(EssentialActions.OpenFiles, {\n                            targetFile: file,\n                            files: [file],\n                        })\n                    ),\n                // TODO: Make this timeout configurable\n                1500\n            );\n        }\n        return () => {\n            if (timeout) clearTimeout(timeout);\n        };\n    }, [dispatch, file, dndState.dndIsOver, currentFolderRef]);\n};\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React from 'react';\n\nimport { makeLocalChonkyStyles } from '../../util/styles';\n\nexport interface TextPlaceholderProps {\n    minLength: number;\n    maxLength: number;\n}\n\nconst getRandomInt = (min: number, max: number) => {\n    return min + Math.floor(Math.random() * Math.floor(max - min));\n};\nexport const TextPlaceholder: React.FC<TextPlaceholderProps> = React.memo(props => {\n    const { minLength, maxLength } = props;\n\n    const placeholderLength = getRandomInt(minLength, maxLength);\n    const whitespace = '&nbsp;'.repeat(placeholderLength);\n\n    const classes = useStyles();\n    return (\n        <span\n            className={classes.textPlaceholder}\n            dangerouslySetInnerHTML={{ __html: whitespace }}\n        />\n    );\n});\n\nconst useStyles = makeLocalChonkyStyles(() => ({\n    '@keyframes loading-placeholder': {\n        '0%': { opacity: 0.2 },\n        '50%': { opacity: 0.4 },\n        '100%': { opacity: 0.2 },\n    },\n    textPlaceholder: {\n        animationName: '$loading-placeholder',\n        animationIterationCount: 'infinite',\n        animationTimingFunction: 'linear',\n        animationDuration: '1.5s',\n        backgroundColor: '#ccc',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        borderRadius: 4,\n        maxWidth: '40%',\n        minWidth: 20,\n    },\n}));\n","import React, {\n    HTMLProps, useCallback, useContext, useEffect, useMemo, useRef, useState\n} from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Nullable, Undefinable } from 'tsdef';\n\nimport { ChonkyActions } from '../../action-definitions/index';\nimport { selectThumbnailGenerator } from '../../redux/selectors';\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\nimport { DndEntryState } from '../../types/file-list.types';\nimport { FileData } from '../../types/file.types';\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { FileHelper } from '../../util/file-helper';\nimport { ChonkyIconContext, ColorsDark, ColorsLight, useIconData } from '../../util/icon-helper';\nimport { Logger } from '../../util/logger';\nimport { TextPlaceholder } from '../external/TextPlaceholder';\nimport { KeyboardClickEvent, MouseClickEvent } from '../internal/ClickableWrapper';\nimport { FileEntryState } from './GridEntryPreview';\n\nexport const useFileEntryHtmlProps = (file: Nullable<FileData>): HTMLProps<HTMLDivElement> => {\n    return useMemo(() => {\n        const dataProps: { [prop: string]: Undefinable<string> } = {\n            'data-test-id': 'file-entry',\n            'data-chonky-file-id': file ? file.id : undefined,\n        };\n\n        return {\n            role: 'listitem',\n            ...dataProps,\n        };\n    }, [file]);\n};\n\nexport const useFileEntryState = (file: Nullable<FileData>, selected: boolean, focused: boolean) => {\n    const iconData = useIconData(file);\n    const { thumbnailUrl, thumbnailLoading } = useThumbnailUrl(file);\n\n    return useMemo<FileEntryState>(() => {\n        const fileColor = thumbnailUrl ? ColorsDark[iconData.colorCode] : ColorsLight[iconData.colorCode];\n        const iconSpin = thumbnailLoading || !file;\n        const icon = thumbnailLoading ? ChonkyIconName.loading : iconData.icon;\n\n        return {\n            childrenCount: FileHelper.getChildrenCount(file),\n            icon: file && file.icon !== undefined ? file.icon : icon,\n            iconSpin: iconSpin,\n            thumbnailUrl: thumbnailUrl,\n            color: file && file.color !== undefined ? file.color : fileColor,\n            selected: selected,\n            focused: !!focused,\n        };\n    }, [file, focused, iconData, selected, thumbnailLoading, thumbnailUrl]);\n};\n\nexport const useDndIcon = (dndState: DndEntryState) => {\n    let dndIconName: Nullable<ChonkyIconName> = null;\n    if (dndState.dndIsOver) {\n        const showDropIcon = dndState.dndCanDrop;\n        dndIconName = showDropIcon ? ChonkyIconName.dndCanDrop : ChonkyIconName.dndCannotDrop;\n    } else if (dndState.dndIsDragging) {\n        dndIconName = ChonkyIconName.dndDragging;\n    }\n\n    return dndIconName;\n};\n\nexport const useModifierIconComponents = (file: Nullable<FileData>) => {\n    const modifierIcons: ChonkyIconName[] = useMemo(() => {\n        const modifierIcons: ChonkyIconName[] = [];\n        if (FileHelper.isHidden(file)) modifierIcons.push(ChonkyIconName.hidden);\n        if (FileHelper.isSymlink(file)) modifierIcons.push(ChonkyIconName.symlink);\n        if (FileHelper.isEncrypted(file)) modifierIcons.push(ChonkyIconName.lock);\n        return modifierIcons;\n    }, [file]);\n    const ChonkyIcon = useContext(ChonkyIconContext);\n    const modifierIconComponents = useMemo(\n        () => modifierIcons.map((icon, index) => <ChonkyIcon key={`file-modifier-${index}`} icon={icon} />),\n        // For some reason ESLint marks `ChonkyIcon` as an unnecessary dependency,\n        // but we expect it can change at runtime so we disable the check.\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [ChonkyIcon, modifierIcons]\n    );\n    return modifierIconComponents;\n};\n\nconst _extname = (fileName: string) => {\n    const parts = fileName.split('.');\n    if (parts.length) {\n        return `.${parts[parts.length - 1]}`;\n    }\n    return '';\n};\n\nexport const useFileNameComponent = (file: Nullable<FileData>) => {\n    return useMemo(() => {\n        if (!file) return <TextPlaceholder minLength={15} maxLength={20} />;\n\n        let name;\n        let extension = null;\n\n        const isDir = FileHelper.isDirectory(file);\n        if (isDir) {\n            name = file.name;\n        } else {\n            extension = file.ext ?? _extname(file.name);\n            name = file.name.substr(0, file.name.length - extension.length);\n        }\n\n        return (\n            <>\n                {name}\n                {extension && <span className=\"chonky-file-entry-description-title-extension\">{extension}</span>}\n            </>\n        );\n    }, [file]);\n};\n\nexport const useThumbnailUrl = (file: Nullable<FileData>) => {\n    const thumbnailGenerator = useSelector(selectThumbnailGenerator);\n    const [thumbnailUrl, setThumbnailUrl] = useState<Nullable<string>>(null);\n    const [thumbnailLoading, setThumbnailLoading] = useState<boolean>(false);\n    const loadingAttempts = useRef(0);\n\n    useEffect(() => {\n        let loadingCancelled = false;\n\n        if (file) {\n            if (thumbnailGenerator) {\n                if (loadingAttempts.current === 0) {\n                    setThumbnailLoading(true);\n                }\n                loadingAttempts.current++;\n                Promise.resolve()\n                    .then(() => thumbnailGenerator(file))\n                    .then((thumbnailUrl: any) => {\n                        if (loadingCancelled) return;\n                        setThumbnailLoading(false);\n\n                        if (thumbnailUrl && typeof thumbnailUrl === 'string') {\n                            setThumbnailUrl(thumbnailUrl);\n                        }\n                    })\n                    .catch(error => {\n                        if (!loadingCancelled) setThumbnailLoading(false);\n                        Logger.error(`User-defined \"thumbnailGenerator\" handler threw an error: ${error.message}`);\n                    });\n            } else if (file.thumbnailUrl) {\n                setThumbnailUrl(file.thumbnailUrl);\n            }\n        }\n\n        return () => {\n            loadingCancelled = true;\n        };\n    }, [file, setThumbnailUrl, setThumbnailLoading, thumbnailGenerator]);\n\n    return { thumbnailUrl, thumbnailLoading };\n};\n\nexport const useFileClickHandlers = (file: Nullable<FileData>, displayIndex: number) => {\n    const dispatch = useDispatch();\n\n    // Prepare base handlers\n    const onMouseClick = useCallback(\n        (event: MouseClickEvent, clickType: 'single' | 'double') => {\n            if (!file) return;\n\n            dispatch(\n                thunkRequestFileAction(ChonkyActions.MouseClickFile, {\n                    clickType,\n                    file,\n                    fileDisplayIndex: displayIndex,\n                    altKey: event.altKey,\n                    ctrlKey: event.ctrlKey,\n                    shiftKey: event.shiftKey,\n                })\n            );\n        },\n        [dispatch, file, displayIndex]\n    );\n    const onKeyboardClick = useCallback(\n        (event: KeyboardClickEvent) => {\n            if (!file) return;\n\n            dispatch(\n                thunkRequestFileAction(ChonkyActions.KeyboardClickFile, {\n                    file,\n                    fileDisplayIndex: displayIndex,\n                    enterKey: event.enterKey,\n                    spaceKey: event.spaceKey,\n                    altKey: event.altKey,\n                    ctrlKey: event.ctrlKey,\n                    shiftKey: event.shiftKey,\n                })\n            );\n        },\n        [dispatch, file, displayIndex]\n    );\n\n    // Prepare single/double click handlers\n    const onSingleClick = useCallback((event: MouseClickEvent) => onMouseClick(event, 'single'), [onMouseClick]);\n    const onDoubleClick = useCallback((event: MouseClickEvent) => onMouseClick(event, 'double'), [onMouseClick]);\n\n    return {\n        onSingleClick,\n        onDoubleClick,\n        onKeyboardClick,\n    };\n};\n","import { MaybePromise, Nullable } from 'tsdef';\n\nimport { FileActionState } from './action-handler.types';\nimport { FileViewConfig } from './file-view.types';\nimport { FileFilter, FileMap } from './file.types';\nimport { ChonkyIconName } from './icons.types';\nimport { ChonkyDispatch, RootState } from './redux.types';\nimport { FileSortKeySelector } from './sort.types';\n\nexport interface FileAction {\n    /**\n     * Unique file action ID. If you set the action ID to one of the built-in Chonky\n     * action action IDs, you custom action definition will override the built-in\n     * definition.\n     */\n    id: string;\n    /**\n     * When set to `true`, the action will only be active (dispatchable) when user\n     * selects one or more files. If `fileFilter` is defined, it will be applied to\n     * selection before checking if its empty.\n     */\n    requiresSelection?: boolean; // Requires selection of 1+ files\n    /**\n     * A predicate that determines whether a file should be included in the selection\n     * for this action.\n     */\n    fileFilter?: FileFilter;\n    /**\n     * List of hotkeys that should trigger this action, defined using `hotkey-js`\n     * notation.\n     * @see https://www.npmjs.com/package/hotkeys-js\n     */\n    hotkeys?: string[] | readonly string[];\n    /**\n     * When button is defined and `toolbar` or `contextMenu` is set to `true`, a\n     * button will be added to the relevant UI component. Clicking on this button\n     * will active this action. The appearance of the button will change based on\n     * the action definition and the current Chonky state.\n     */\n    button?: FileActionButton;\n    /**\n     * When `sortKeySelector` is specified, the action becomes a sorting toggle. When\n     * this action is activated, it will sort files using the key selector, toggling\n     * between Ascending and Descending orders.\n     */\n    sortKeySelector?: FileSortKeySelector;\n    /**\n     * When `fileViewConfig` is specified, triggering this action will apply the\n     * provided config to Chonky's file view.\n     */\n    fileViewConfig?: FileViewConfig;\n    /**\n     * When `option` is specified, the action becomes an option toggle. When the action\n     * is activated, the boolean value of the option will be toggled.\n     */\n    option?: FileActionOption;\n    /**\n     * When selection transform is defined, activating this action will update the file\n     * selection. If the transform function returns `null`, selection will be left\n     * untouched.\n     */\n    selectionTransform?: FileSelectionTransform;\n    /**\n     * When effect is defined, it will be called right before dispatching the action to\n     * the user defined action handler. If the effect function returns a promise, Chonky\n     * will wait for the promise to resolve or fail before dispatching the action to the\n     * handler. If this function returns `true`, the file action will NOT be dispatched\n     * the the handler.\n     */\n    effect?: FileActionEffect;\n    /**\n     * When customVisibility is defined, it will change the display state of the file action\n     * The function must return the visibility as one of the CustomVisibilityState values:\n     *  - Hidden\n     *  - Disabled\n     *  - Default\n     *  - Active\n     */\n    customVisibility?: () => CustomVisibilityState;\n    /**\n     * Field used to infer the type of action payload. It is used solely for Typescript\n     * type inference and action validation.\n     */\n    __payloadType?: any;\n    /**\n     * Field used to infer the type of extra state for this action. It is used solely\n     * for Typescript type inference and action validation.\n     */\n    __extraStateType?: any;\n}\n\nexport interface FileActionButton {\n    name: string; // Button name\n    toolbar?: boolean; // Whether to show the button in the toolbar\n    contextMenu?: boolean; // Whether to show the button in the context menu\n    group?: string; // Button group (dropdown in toolbar or section in context menu)\n    tooltip?: string; // Help tooltip text\n    icon?: ChonkyIconName | string | any; // Icon name\n    iconOnly?: boolean; // Whether to only display the icon\n}\n\nexport interface FileActionOption {\n    id: string; // Unique option ID\n    defaultValue: boolean; // Whether the option is enabled by default (required)\n}\n\nexport type FileSelectionTransform = (data: {\n    prevSelection: Set<string>;\n    fileIds: ReadonlyArray<string>;\n    fileMap: Readonly<FileMap>;\n    hiddenFileIds: Set<string>;\n}) => Nullable<Set<string>>;\n\nexport type FileActionEffect<Action extends FileAction = any> = (data: {\n    action: Action;\n    payload: Action['__payloadType'];\n    state: FileActionState<{}>; // extra state is empty on purpose\n    reduxDispatch: ChonkyDispatch;\n    getReduxState: () => RootState;\n}) => MaybePromise<undefined | boolean | void>;\n\nexport type FileActionMap = { [actonId: string]: FileAction };\n\nexport enum CustomVisibilityState {\n    Hidden, \n    Disabled, \n    Default,\n    Active\n};\n","import { useCallback, useMemo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Nullable } from 'tsdef';\n\nimport { ChonkyActions } from '../action-definitions/index';\nimport {\n    selectFileActionData,\n    selectFileViewConfig,\n    selectOptionValue,\n    selectParentFolder,\n    selectSelectedFilesForActionCount,\n    selectSortActionId,\n    selectSortOrder,\n} from '../redux/selectors';\nimport { useParamSelector } from '../redux/store';\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\nimport { ChonkyIconName } from '../types/icons.types';\nimport { CustomVisibilityState } from '../types/action.types';\nimport { SortOrder } from '../types/sort.types';\nimport { FileHelper } from './file-helper';\n\nexport const useFileActionTrigger = (fileActionId: string) => {\n    const dispatch = useDispatch();\n    const fileAction = useParamSelector(selectFileActionData, fileActionId);\n    return useCallback(() => dispatch(thunkRequestFileAction(fileAction, undefined)), [\n        dispatch,\n        fileAction,\n    ]);\n};\n\nexport const useFileActionProps = (\n    fileActionId: string\n): { icon: Nullable<ChonkyIconName | string>; active: boolean; disabled: boolean } => {\n    const parentFolder = useSelector(selectParentFolder);\n    const fileViewConfig = useSelector(selectFileViewConfig);\n\n    const sortActionId = useSelector(selectSortActionId);\n    const sortOrder = useSelector(selectSortOrder);\n\n    const action = useParamSelector(selectFileActionData, fileActionId);\n    // @ts-ignore\n    const optionValue = useParamSelector(selectOptionValue, action?.option?.id);\n\n    const actionSelectionSize = useParamSelector(\n        selectSelectedFilesForActionCount,\n        fileActionId\n    );\n\n    const actionSelectionEmpty = actionSelectionSize === 0;\n\n    return useMemo(() => {\n        if (!action) return { icon: null, active: false, disabled: true };\n\n        let icon = action.button?.icon ?? null;\n        if (action.sortKeySelector) {\n            if (sortActionId === action.id) {\n                if (sortOrder === SortOrder.ASC) {\n                    icon = ChonkyIconName.sortAsc;\n                } else {\n                    icon = ChonkyIconName.sortDesc;\n                }\n            } else {\n                icon = ChonkyIconName.placeholder;\n            }\n        } else if (action.option) {\n            if (optionValue) {\n                icon = ChonkyIconName.toggleOn;\n            } else {\n                icon = ChonkyIconName.toggleOff;\n            }\n        }\n\n        const isSortButtonAndCurrentSort = action.id === sortActionId;\n        const isFileViewButtonAndCurrentView = action.fileViewConfig === fileViewConfig;\n        const isOptionAndEnabled = action.option ? !!optionValue : false;\n\n        let customDisabled = false;\n        let customActive = false;\n        if (action.customVisibility !== undefined) {\n            customDisabled = action.customVisibility() === CustomVisibilityState.Disabled;\n            customActive = action.customVisibility() === CustomVisibilityState.Active;\n        }\n        const active =\n            isSortButtonAndCurrentSort ||\n            isFileViewButtonAndCurrentView ||\n            isOptionAndEnabled ||\n            customActive;\n        \n        let disabled: boolean = (!!action.requiresSelection && actionSelectionEmpty) || customDisabled;\n\n        if (action.id === ChonkyActions.OpenParentFolder.id) {\n            // We treat `open_parent_folder` file action as a special case as it\n            // requires the parent folder to be present to work...\n            disabled = disabled || !FileHelper.isOpenable(parentFolder);\n        }\n\n        return { icon, active, disabled };\n    }, [\n        parentFolder,\n        fileViewConfig,\n        sortActionId,\n        sortOrder,\n        action,\n        optionValue,\n        actionSelectionEmpty,\n    ]);\n};\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport Button from '@material-ui/core/Button';\nimport React, { useContext } from 'react';\nimport { Nullable } from 'tsdef';\n\nimport { selectFileActionData } from '../../redux/selectors';\nimport { useParamSelector } from '../../redux/store';\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { CustomVisibilityState } from '../../types/action.types';\nimport { useFileActionProps, useFileActionTrigger } from '../../util/file-actions';\nimport { useLocalizedFileActionStrings } from '../../util/i18n';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { c, important, makeGlobalChonkyStyles } from '../../util/styles';\n\nexport interface ToolbarButtonProps {\n    className?: string;\n    text: string;\n    tooltip?: string;\n    active?: boolean;\n    icon?: Nullable<ChonkyIconName | string>;\n    iconOnly?: boolean;\n    onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;\n    disabled?: boolean;\n    dropdown?: boolean;\n}\n\nexport const ToolbarButton: React.FC<ToolbarButtonProps> = React.memo(props => {\n    const {\n        className: externalClassName,\n        text,\n        tooltip,\n        active,\n        icon,\n        iconOnly,\n        onClick,\n        disabled,\n        dropdown,\n    } = props;\n    const classes = useStyles();\n    const ChonkyIcon = useContext(ChonkyIconContext);\n\n    const iconComponent =\n        icon || iconOnly ? (\n            <div className={iconOnly ? '' : classes.iconWithText}>\n                <ChonkyIcon\n                    icon={icon ? icon : ChonkyIconName.fallbackIcon}\n                    fixedWidth={true}\n                />\n            </div>\n        ) : null;\n\n    const className = c({\n        [externalClassName ?? '']: true,\n        [classes.baseButton]: true,\n        [classes.iconOnlyButton]: iconOnly,\n        [classes.activeButton]: !!active,\n    });\n    return (\n        <Button\n            className={className}\n            onClick={onClick}\n            title={tooltip ? tooltip : text}\n            disabled={disabled || !onClick}\n        >\n            {iconComponent}\n            {text && !iconOnly && <span>{text}</span>}\n            {dropdown && (\n                <div className={classes.iconDropdown}>\n                    <ChonkyIcon\n                        icon={icon ? icon : ChonkyIconName.dropdown}\n                        fixedWidth={true}\n                    />\n                </div>\n            )}\n        </Button>\n    );\n});\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    baseButton: {\n        fontSize: important(theme.toolbar.fontSize),\n        textTransform: important('none'),\n        letterSpacing: important(0),\n        minWidth: important('auto'),\n        lineHeight: theme.toolbar.lineHeight,\n        height: theme.toolbar.size,\n        paddingBottom: important(0),\n        paddingTop: important(0),\n    },\n    iconWithText: {\n        marginRight: 8,\n    },\n    iconOnlyButton: {\n        width: theme.toolbar.size,\n        textAlign: 'center',\n    },\n    iconDropdown: {\n        fontSize: '0.7em',\n        marginLeft: 2,\n        marginTop: 1,\n    },\n    activeButton: {\n        color: important(theme.colors.textActive),\n    },\n}));\n\nexport interface SmartToolbarButtonProps {\n    fileActionId: string;\n}\n\nexport const SmartToolbarButton: React.FC<SmartToolbarButtonProps> = React.memo(\n    props => {\n        const { fileActionId } = props;\n\n        const action = useParamSelector(selectFileActionData, fileActionId);\n        const triggerAction = useFileActionTrigger(fileActionId);\n        const { icon, active, disabled } = useFileActionProps(fileActionId);\n        const { buttonName, buttonTooltip } = useLocalizedFileActionStrings(action);\n\n        if (!action) return null;\n        const { button } = action;\n        if (!button) return null;\n        if (action.customVisibility !== undefined && action.customVisibility() === CustomVisibilityState.Hidden) return null;\n\n        return (\n            <ToolbarButton\n                text={buttonName}\n                tooltip={buttonTooltip}\n                icon={icon}\n                iconOnly={button.iconOnly}\n                active={active}\n                onClick={triggerAction}\n                disabled={disabled}\n            />\n        );\n    }\n);\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { useContext, useMemo } from 'react';\n\nimport { DndEntryState } from '../../types/file-list.types';\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { useDndHoverOpen, useFileDrop } from '../../util/dnd';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { c, important, makeLocalChonkyStyles } from '../../util/styles';\nimport { useDndIcon } from '../file-list/FileEntry-hooks';\nimport { FolderChainItem } from './FileNavbar-hooks';\nimport { ToolbarButton } from './ToolbarButton';\n\nexport interface FolderChainButtonProps {\n    first: boolean;\n    current: boolean;\n    item: FolderChainItem;\n}\n\nexport const FolderChainButton: React.FC<FolderChainButtonProps> = React.memo(\n    ({ first, current, item }) => {\n        const { file, disabled, onClick } = item;\n        const { dndIsOver, dndCanDrop, drop } = useFileDrop({\n            file,\n            forceDisableDrop: !file || current,\n        });\n        const dndState = useMemo<DndEntryState>(\n            () => ({\n                dndIsOver,\n                dndCanDrop,\n                dndIsDragging: false,\n            }),\n            [dndCanDrop, dndIsOver]\n        );\n        useDndHoverOpen(file, dndState);\n        const dndIconName = useDndIcon(dndState);\n        const ChonkyIcon = useContext(ChonkyIconContext);\n\n        const classes = useStyles(dndState);\n        const className = c({\n            [classes.baseBreadcrumb]: true,\n            [classes.disabledBreadcrumb]: disabled,\n            [classes.currentBreadcrumb]: current,\n        });\n        const text = file ? file.name : 'Loading...';\n        const icon =\n            first && file?.folderChainIcon === undefined\n                ? ChonkyIconName.folder\n                : file?.folderChainIcon;\n\n        return (\n            <div className={classes.buttonContainer} ref={file ? drop : null}>\n                {file && dndIconName && (\n                    <div className={classes.dndIndicator}>\n                        <ChonkyIcon icon={dndIconName} fixedWidth={true} />\n                    </div>\n                )}\n                <ToolbarButton\n                    icon={icon}\n                    className={className}\n                    text={text}\n                    disabled={disabled}\n                    onClick={onClick}\n                />\n            </div>\n        );\n    }\n);\n\nconst useStyles = makeLocalChonkyStyles(theme => ({\n    buttonContainer: {\n        position: 'relative',\n    },\n    baseBreadcrumb: {\n        color: (dndState: DndEntryState) => {\n            let color = theme.palette.text.primary;\n            if (dndState.dndIsOver) {\n                color = dndState.dndCanDrop\n                    ? theme.dnd.canDropColor\n                    : theme.dnd.cannotDropColor;\n            }\n            return important(color);\n        },\n    },\n    disabledBreadcrumb: {\n        // Constant function here is on purpose. Without the function, the color here\n        // does not override the `baseBreadcrumb` color from above.\n        color: () => important(theme.palette.text.disabled),\n    },\n    currentBreadcrumb: {\n        textDecoration: important('underline'),\n    },\n    dndIndicator: {\n        color: (dndState: DndEntryState) =>\n            dndState.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor,\n        backgroundColor: (dndState: DndEntryState) =>\n            dndState.dndCanDrop ? theme.dnd.canDropMask : theme.dnd.cannotDropMask,\n        lineHeight: `calc(${theme.toolbar.lineHeight} - 6px)`,\n        transform: 'translateX(-50%) translateY(-50%)',\n        borderRadius: theme.toolbar.buttonRadius,\n        height: theme.toolbar.size - 6,\n        width: theme.toolbar.size - 6,\n        boxSizing: 'border-box',\n        position: 'absolute',\n        textAlign: 'center',\n        left: '50%',\n        top: '50%',\n        zIndex: 5,\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport Box from '@material-ui/core/Box';\nimport Breadcrumbs from '@material-ui/core/Breadcrumbs';\nimport React, { ReactElement, useMemo } from 'react';\n\nimport { ChonkyActions } from '../../action-definitions/index';\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\nimport { useFolderChainItems } from './FileNavbar-hooks';\nimport { FolderChainButton } from './FolderChainButton';\nimport { SmartToolbarButton } from './ToolbarButton';\n\nexport interface FileNavbarProps {}\n\nexport const FileNavbar: React.FC<FileNavbarProps> = React.memo(() => {\n    const classes = useStyles();\n    const folderChainItems = useFolderChainItems();\n\n    const folderChainComponents = useMemo(() => {\n        const components: ReactElement[] = [];\n        for (let i = 0; i < folderChainItems.length; ++i) {\n            const key = `folder-chain-${i}`;\n            const component = (\n                <FolderChainButton\n                    key={key}\n                    first={i === 0}\n                    current={i === folderChainItems.length - 1}\n                    item={folderChainItems[i]}\n                />\n            );\n            components.push(component);\n        }\n        return components;\n    }, [folderChainItems]);\n\n    return (\n        <Box className={classes.navbarWrapper}>\n            <Box className={classes.navbarContainer}>\n                <SmartToolbarButton fileActionId={ChonkyActions.OpenParentFolder.id} />\n                <Breadcrumbs\n                    className={classes.navbarBreadcrumbs}\n                    classes={{ separator: classes.separator }}\n                >\n                    {folderChainComponents}\n                </Breadcrumbs>\n            </Box>\n        </Box>\n    );\n});\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    navbarWrapper: {\n        paddingBottom: theme.margins.rootLayoutMargin,\n    },\n    navbarContainer: {\n        display: 'flex',\n    },\n    upDirectoryButton: {\n        fontSize: important(theme.toolbar.fontSize),\n        height: theme.toolbar.size,\n        width: theme.toolbar.size,\n        padding: '0px !important',\n    },\n    navbarBreadcrumbs: {\n        fontSize: important(theme.toolbar.fontSize),\n        flexGrow: 100,\n    },\n    separator: {\n        marginRight: important(4),\n        marginLeft: important(4),\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport React, { useCallback, useContext } from 'react';\nimport { Nullable } from 'tsdef';\n\nimport { selectFileActionData } from '../../redux/selectors';\nimport { useParamSelector } from '../../redux/store';\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { CustomVisibilityState } from '../../types/action.types';\nimport { useFileActionProps, useFileActionTrigger } from '../../util/file-actions';\nimport { useLocalizedFileActionStrings } from '../../util/i18n';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { c, important, makeGlobalChonkyStyles } from '../../util/styles';\n\nexport interface ToolbarDropdownButtonProps {\n    text: string;\n    active?: boolean;\n    icon?: Nullable<ChonkyIconName | string>;\n    onClick?: () => void;\n    disabled?: boolean;\n}\n\nexport const ToolbarDropdownButton = React.forwardRef(\n    (props: ToolbarDropdownButtonProps, ref: React.Ref<HTMLLIElement>) => {\n        const { text, active, icon, onClick, disabled } = props;\n        const classes = useStyles();\n        const ChonkyIcon = useContext(ChonkyIconContext);\n\n        const className = c({\n            [classes.baseButton]: true,\n            [classes.activeButton]: active,\n        });\n        return (\n            <MenuItem\n                ref={ref}\n                className={className}\n                onClick={onClick}\n                disabled={disabled}\n            >\n                {icon && (\n                    <ListItemIcon className={classes.icon}>\n                        <ChonkyIcon icon={icon} fixedWidth={true} />\n                    </ListItemIcon>\n                )}\n                <ListItemText primaryTypographyProps={{ className: classes.text }}>\n                    {text}\n                </ListItemText>\n            </MenuItem>\n        );\n    }\n);\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    baseButton: {\n        lineHeight: important(theme.toolbar.lineHeight),\n        height: important(theme.toolbar.size),\n        minHeight: important('auto'),\n        minWidth: important('auto'),\n        padding: important(20),\n    },\n    icon: {\n        fontSize: important(theme.toolbar.fontSize),\n        minWidth: important('auto'),\n        color: important('inherit'),\n        marginRight: 8,\n    },\n    text: {\n        fontSize: important(theme.toolbar.fontSize),\n    },\n    activeButton: {\n        color: important(theme.colors.textActive),\n    },\n}));\n\nexport interface SmartToolbarDropdownButtonProps {\n    fileActionId: string;\n    onClickFollowUp?: () => void;\n}\n\nexport const SmartToolbarDropdownButton = React.forwardRef(\n    (props: SmartToolbarDropdownButtonProps, ref: React.Ref<HTMLLIElement>) => {\n        const { fileActionId, onClickFollowUp } = props;\n\n        const action = useParamSelector(selectFileActionData, fileActionId);\n        const triggerAction = useFileActionTrigger(fileActionId);\n        const { icon, active, disabled } = useFileActionProps(fileActionId);\n        const { buttonName } = useLocalizedFileActionStrings(action);\n\n        // Combine external click handler with internal one\n        const handleClick = useCallback(() => {\n            triggerAction();\n            if (onClickFollowUp) onClickFollowUp();\n        }, [onClickFollowUp, triggerAction]);\n\n        if (!action) return null;\n        const { button } = action;\n        if (!button) return null;\n        if (action.customVisibility !== undefined && action.customVisibility() === CustomVisibilityState.Hidden) return null;\n\n        return (\n            <ToolbarDropdownButton\n                ref={ref}\n                text={buttonName}\n                icon={icon}\n                onClick={handleClick}\n                active={active}\n                disabled={disabled}\n            />\n        );\n    }\n);\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport Menu from '@material-ui/core/Menu';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { FileActionGroup } from '../../types/action-menus.types';\nimport { useLocalizedFileActionGroup } from '../../util/i18n';\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\nimport { ToolbarButton } from './ToolbarButton';\nimport { SmartToolbarDropdownButton } from './ToolbarDropdownButton';\n\nexport type ToolbarDropdownProps = FileActionGroup;\n\nexport const ToolbarDropdown: React.FC<ToolbarDropdownProps> = React.memo(props => {\n    const { name, fileActionIds } = props;\n    const [anchor, setAnchor] = React.useState<null | HTMLElement>(null);\n\n    const handleClick = useCallback(\n        (event: React.MouseEvent<HTMLButtonElement>) => setAnchor(event.currentTarget),\n        [setAnchor]\n    );\n    const handleClose = useCallback(() => setAnchor(null), [setAnchor]);\n\n    const menuItemComponents = useMemo(\n        () =>\n            fileActionIds.map(id => (\n                <SmartToolbarDropdownButton\n                    key={`menu-item-${id}`}\n                    fileActionId={id}\n                    onClickFollowUp={handleClose}\n                />\n            )),\n        [fileActionIds, handleClose]\n    );\n\n    const localizedName = useLocalizedFileActionGroup(name);\n    const classes = useStyles();\n    return (\n        <>\n            <ToolbarButton text={localizedName} onClick={handleClick} dropdown={true} />\n            <Menu\n                autoFocus\n                keepMounted\n                elevation={2}\n                anchorEl={anchor}\n                onClose={handleClose}\n                open={Boolean(anchor)}\n                transitionDuration={150}\n                classes={{ list: classes.dropdownList }}\n            >\n                {menuItemComponents}\n            </Menu>\n        </>\n    );\n});\n\nconst useStyles = makeGlobalChonkyStyles(() => ({\n    dropdownList: {\n        paddingBottom: important(0),\n        paddingTop: important(0),\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React from 'react';\nimport { useIntl } from 'react-intl';\nimport { useSelector } from 'react-redux';\n\nimport Typography from '@material-ui/core/Typography';\n\nimport { selectHiddenFileCount, selectors, selectSelectionSize } from '../../redux/selectors';\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\n\nexport interface ToolbarInfoProps {}\n\nexport const ToolbarInfo: React.FC<ToolbarInfoProps> = React.memo(() => {\n    const classes = useStyles();\n\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\n    const selectionSize = useSelector(selectSelectionSize);\n    const hiddenCount = useSelector(selectHiddenFileCount);\n\n    const intl = useIntl();\n    const fileCountString = intl.formatMessage(\n        {\n            id: getI18nId(I18nNamespace.Toolbar, 'visibleFileCount'),\n            defaultMessage: `{fileCount, plural,\n                =0 {# items}\n                one {# item}\n                other {# items}\n            }`,\n        },\n        { fileCount: displayFileIds.length }\n    );\n    const selectedString = intl.formatMessage(\n        {\n            id: getI18nId(I18nNamespace.Toolbar, 'selectedFileCount'),\n            defaultMessage: `{fileCount, plural,\n                =0 {}\n                other {# selected}\n            }`,\n        },\n        { fileCount: selectionSize }\n    );\n    const hiddenString = intl.formatMessage(\n        {\n            id: getI18nId(I18nNamespace.Toolbar, 'hiddenFileCount'),\n            defaultMessage: `{fileCount, plural,\n                =0 {}\n                other {# hidden}\n            }`,\n        },\n        { fileCount: hiddenCount }\n    );\n\n    return (\n        <div className={classes.infoContainer}>\n            <Typography className={classes.infoText} variant=\"body1\">\n                {fileCountString}\n                {(selectedString || hiddenString) && (\n                    <span className={classes.extraInfoSpan}>\n                        (\n                        <span className={classes.selectionSizeText}>\n                            {selectedString}\n                        </span>\n                        {selectedString && hiddenString && ', '}\n                        <span className={classes.hiddenCountText}>{hiddenString}</span>)\n                    </span>\n                )}\n            </Typography>\n        </div>\n    );\n});\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    infoContainer: {\n        height: theme.toolbar.size,\n        display: 'flex',\n    },\n    infoText: {\n        lineHeight: important(theme.toolbar.lineHeight),\n        fontSize: important(theme.toolbar.fontSize),\n        marginLeft: important(12),\n        height: theme.toolbar.size,\n    },\n    extraInfoSpan: {\n        marginRight: important(8),\n        marginLeft: important(8),\n        opacity: 0.8,\n    },\n    selectionSizeText: {\n        color: theme.colors.textActive,\n    },\n    hiddenCountText: {},\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { useCallback, useContext, useEffect, useRef, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport TextField from '@material-ui/core/TextField';\n\nimport { reduxActions } from '../../redux/reducers';\nimport { selectSearchString } from '../../redux/selectors';\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { useDebounce } from '../../util/hooks-helpers';\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\n\nexport interface ToolbarSearchProps {}\n\nexport const ToolbarSearch: React.FC<ToolbarSearchProps> = React.memo(() => {\n    const intl = useIntl();\n    const searchPlaceholderString = intl.formatMessage({\n        id: getI18nId(I18nNamespace.Toolbar, 'searchPlaceholder'),\n        defaultMessage: 'Search',\n    });\n\n    const classes = useStyles();\n    const ChonkyIcon = useContext(ChonkyIconContext);\n\n    const searchInputRef = useRef<HTMLInputElement>();\n\n    const dispatch = useDispatch();\n    const reduxSearchString = useSelector(selectSearchString);\n\n    const [localSearchString, setLocalSearchString] = useState(reduxSearchString);\n    const [debouncedLocalSearchString] = useDebounce(localSearchString, 300);\n    const [showLoadingIndicator, setShowLoadingIndicator] = useState(false);\n\n    useEffect(() => {\n        dispatch(\n            reduxActions.setFocusSearchInput(() => {\n                if (searchInputRef.current) searchInputRef.current.focus();\n            })\n        );\n        return () => {\n            dispatch(reduxActions.setFocusSearchInput(null));\n        };\n    }, [dispatch]);\n\n    useEffect(() => {\n        setShowLoadingIndicator(false);\n        dispatch(reduxActions.setSearchString(debouncedLocalSearchString));\n    }, [debouncedLocalSearchString, dispatch]);\n\n    const handleChange = useCallback((event: React.FormEvent<HTMLInputElement>) => {\n        setShowLoadingIndicator(true);\n        setLocalSearchString(event.currentTarget.value);\n    }, []);\n    const handleKeyUp = useCallback(\n        (event: React.KeyboardEvent<HTMLInputElement>) => {\n            // Remove focus from the search input field when user presses escape.\n            // Note: We use KeyUp instead of KeyPress because some browser plugins can\n            //       intercept KeyPress events with Escape key.\n            //       @see https://stackoverflow.com/a/37461974\n            if (event.key === 'Escape') {\n                setLocalSearchString('');\n                dispatch(reduxActions.setSearchString(''));\n                if (searchInputRef.current) searchInputRef.current.blur();\n            }\n        },\n        [dispatch]\n    );\n\n    return (\n        <TextField\n            className={classes.searchFieldContainer}\n            size=\"small\"\n            variant=\"outlined\"\n            value={localSearchString}\n            placeholder={searchPlaceholderString}\n            onChange={handleChange as any}\n            inputRef={searchInputRef}\n            InputProps={{\n                onKeyUp: handleKeyUp,\n                startAdornment: (\n                    <InputAdornment className={classes.searchIcon} position=\"start\">\n                        <ChonkyIcon\n                            icon={showLoadingIndicator ? ChonkyIconName.loading : ChonkyIconName.search}\n                            spin={showLoadingIndicator}\n                        />\n                    </InputAdornment>\n                ),\n                className: classes.searchFieldInput,\n            }}\n            inputProps={{ className: classes.searchFieldInputInner }}\n        />\n    );\n});\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    searchFieldContainer: {\n        height: theme.toolbar.size,\n        width: 150,\n    },\n    searchIcon: {\n        fontSize: '0.9em',\n        opacity: 0.75,\n    },\n    searchFieldInput: {\n        lineHeight: important(0),\n        padding: important(0),\n        margin: important(0),\n        fontSize: important(theme.toolbar.fontSize),\n        borderRadius: theme.toolbar.buttonRadius,\n        height: theme.toolbar.size - 4,\n        paddingLeft: important(8),\n        marginTop: 2,\n    },\n    searchFieldInputInner: {\n        lineHeight: important(`${theme.toolbar.size - 4}px`),\n        fontSize: important(theme.toolbar.fontSize),\n        height: important(theme.toolbar.size - 4),\n        padding: important([0, 8, 0, 0]),\n        margin: important(0),\n        '-webkit-appearance': 'none',\n    },\n}));\n","import React, { ReactElement, useMemo } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { selectToolbarItems } from '../../redux/selectors';\nimport { makeGlobalChonkyStyles } from '../../util/styles';\nimport { SmartToolbarButton } from './ToolbarButton';\nimport { ToolbarDropdown } from './ToolbarDropdown';\nimport { ToolbarInfo } from './ToolbarInfo';\nimport { ToolbarSearch } from './ToolbarSearch';\n\nexport interface FileToolbarProps {}\n\nexport const FileToolbar: React.FC<FileToolbarProps> = React.memo(() => {\n    const classes = useStyles();\n    const toolbarItems = useSelector(selectToolbarItems);\n\n    const toolbarItemComponents = useMemo(() => {\n        const components: ReactElement[] = [];\n        for (let i = 0; i < toolbarItems.length; ++i) {\n            const item = toolbarItems[i];\n\n            const key = `toolbar-item-${typeof item === 'string' ? item : item.name}`;\n            const component =\n                typeof item === 'string' ? (\n                    <SmartToolbarButton key={key} fileActionId={item} />\n                ) : (\n                    <ToolbarDropdown\n                        key={key}\n                        name={item.name}\n                        fileActionIds={item.fileActionIds}\n                    />\n                );\n            components.push(component);\n        }\n        return components;\n    }, [toolbarItems]);\n\n    return (\n        <div className={classes.toolbarWrapper}>\n            <div className={classes.toolbarContainer}>\n                <div className={classes.toolbarLeft}>\n                    <ToolbarSearch />\n                    <ToolbarInfo />\n                </div>\n                <div className={classes.toolbarRight}>{toolbarItemComponents}</div>\n            </div>\n        </div>\n    );\n});\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    toolbarWrapper: {},\n    toolbarContainer: {\n        flexWrap: 'wrap-reverse',\n        display: 'flex',\n    },\n    toolbarLeft: {\n        paddingBottom: theme.margins.rootLayoutMargin,\n        flexWrap: 'nowrap',\n        flexGrow: 10000,\n        display: 'flex',\n    },\n    toolbarLeftFiller: {\n        flexGrow: 10000,\n    },\n    toolbarRight: {\n        paddingBottom: theme.margins.rootLayoutMargin,\n        flexWrap: 'nowrap',\n        display: 'flex',\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { CSSProperties, useContext } from 'react';\nimport { useIntl } from 'react-intl';\n\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { makeGlobalChonkyStyles } from '../../util/styles';\n\nexport interface FileListEmptyProps {\n    width: number;\n    height: number;\n}\n\nexport const FileListEmpty: React.FC<FileListEmptyProps> = props => {\n    const { width, height } = props;\n    const classes = useStyles();\n    const ChonkyIcon = useContext(ChonkyIconContext);\n    const style: CSSProperties = {\n        width,\n        height,\n    };\n\n    const intl = useIntl();\n    const emptyString = intl.formatMessage({\n        id: getI18nId(I18nNamespace.FileList, 'nothingToShow'),\n        defaultMessage: 'Nothing to show',\n    });\n\n    return (\n        <div className={classes.fileListEmpty} style={style}>\n            <div className={classes.fileListEmptyContent}>\n                <ChonkyIcon icon={ChonkyIconName.folderOpen} />\n                &nbsp; {emptyString}\n            </div>\n        </div>\n    );\n};\n\nconst useStyles = makeGlobalChonkyStyles(theme => ({\n    fileListEmpty: {\n        color: theme.palette.text.disabled,\n        position: 'relative',\n        textAlign: 'center',\n        fontSize: '1.2em',\n    },\n    fileListEmptyContent: {\n        transform: 'translateX(-50%) translateY(-50%)',\n        position: 'absolute',\n        left: '50%',\n        top: '50%',\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { useCallback, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Nilable, Nullable } from 'tsdef';\n\nimport { selectDoubleClickDelay } from '../../redux/selectors';\nimport {\n    KeyboardClickEvent,\n    KeyboardClickEventHandler,\n    MouseClickEvent,\n    MouseClickEventHandler,\n} from './ClickableWrapper';\n\nexport const useClickHandler = (\n    onSingleClick: Nilable<MouseClickEventHandler>,\n    onDoubleClick: Nilable<MouseClickEventHandler>\n) => {\n    const doubleClickDelay = useSelector(selectDoubleClickDelay);\n\n    const counter = useRef({\n        clickCount: 0,\n        clickTimeout: null as Nullable<number>,\n    });\n\n    return useCallback(\n        (event: React.MouseEvent) => {\n            const mouseClickEvent: MouseClickEvent = {\n                altKey: event.altKey,\n                ctrlKey: event.ctrlKey || event.metaKey,\n                shiftKey: event.shiftKey,\n\n            };\n\n            counter.current.clickCount++;\n            if (counter.current.clickCount === 1) {\n                if (onSingleClick) {\n                    event.preventDefault();\n                    onSingleClick(mouseClickEvent);\n                }\n                counter.current.clickCount = 1;\n                // @ts-ignore\n                counter.current.clickTimeout = setTimeout(\n                    () => (counter.current.clickCount = 0),\n                    doubleClickDelay\n                );\n            } else if (counter.current.clickCount === 2) {\n                if (onDoubleClick) {\n                    event.preventDefault();\n                    onDoubleClick(mouseClickEvent);\n                }\n                if (typeof counter.current.clickTimeout === 'number') {\n                    clearTimeout(counter.current.clickTimeout);\n                    counter.current.clickTimeout = null;\n                    counter.current.clickCount = 0;\n                }\n            }\n        },\n        [doubleClickDelay, onSingleClick, onDoubleClick, counter]\n    );\n};\n\nexport const useKeyDownHandler = (onKeyboardClick?: KeyboardClickEventHandler) => {\n    return useCallback(\n        (event: React.KeyboardEvent) => {\n            if (!onKeyboardClick) return;\n\n            const keyboardClickEvent: KeyboardClickEvent = {\n                enterKey: event.nativeEvent.code === 'Enter',\n                spaceKey: event.nativeEvent.code === 'Space',\n                altKey: event.altKey,\n                ctrlKey: event.ctrlKey,\n                shiftKey: event.shiftKey,\n            };\n\n            if (keyboardClickEvent.spaceKey || keyboardClickEvent.enterKey) {\n                event.preventDefault();\n                event.stopPropagation();\n                onKeyboardClick(keyboardClickEvent);\n            }\n        },\n        [onKeyboardClick]\n    );\n};\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { useCallback } from 'react';\nimport { AnyObjectWithStringKeys } from 'tsdef';\n\nimport { useClickHandler, useKeyDownHandler } from './ClickableWrapper-hooks';\n\nexport interface MouseClickEvent {\n    altKey: boolean;\n    ctrlKey: boolean;\n    shiftKey: boolean;\n}\nexport type MouseClickEventHandler = (event: MouseClickEvent) => void;\n\nexport interface KeyboardClickEvent {\n    enterKey: boolean;\n    spaceKey: boolean;\n    altKey: boolean;\n    ctrlKey: boolean;\n    shiftKey: boolean;\n}\nexport type KeyboardClickEventHandler = (event: KeyboardClickEvent) => void;\n\nexport interface ClickableWrapperProps {\n    wrapperTag: any;\n    passthroughProps?: any;\n\n    onSingleClick?: MouseClickEventHandler;\n    onDoubleClick?: MouseClickEventHandler;\n    onKeyboardClick?: KeyboardClickEventHandler;\n    setFocused?: (focused: boolean) => void;\n}\n\nexport const ClickableWrapper: React.FC<ClickableWrapperProps> = props => {\n    const {\n        children,\n        wrapperTag: WrapperTag,\n        passthroughProps,\n        onSingleClick,\n        onDoubleClick,\n        onKeyboardClick,\n        setFocused,\n    } = props;\n\n    const handleClick = useClickHandler(onSingleClick, onDoubleClick);\n    const handleKeyDown = useKeyDownHandler(onKeyboardClick);\n\n    const compProps: AnyObjectWithStringKeys = {\n        onFocus: useCallback(() => setFocused && setFocused(true), [setFocused]),\n        onBlur: useCallback(() => setFocused && setFocused(false), [setFocused]),\n    };\n\n    if (onSingleClick || onDoubleClick || onKeyboardClick) {\n        compProps.onClick = handleClick;\n        compProps.onKeyDown = handleKeyDown;\n        compProps.tabIndex = 0;\n    }\n\n    const mergedProps = { ...compProps, ...passthroughProps };\n    return <WrapperTag {...mergedProps}>{children}</WrapperTag>;\n};\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React from 'react';\nimport { Nullable } from 'tsdef';\n\nimport { FileData } from '../../types/file.types';\nimport { makeLocalChonkyStyles } from '../../util/styles';\nimport { useFileNameComponent, useModifierIconComponents } from './FileEntry-hooks';\n\nexport interface FileEntryNameProps {\n    file: Nullable<FileData>;\n    className?: string;\n}\n\nexport const FileEntryName: React.FC<FileEntryNameProps> = React.memo(({ file, className }) => {\n    const modifierIconComponents = useModifierIconComponents(file);\n    const fileNameComponent = useFileNameComponent(file);\n\n    const classes = useStyles();\n    return (\n        <span className={className} title={file ? file.name : undefined}>\n            {modifierIconComponents.length > 0 && (\n                <span className={classes.modifierIcons}>{modifierIconComponents}</span>\n            )}\n            {fileNameComponent}\n        </span>\n    );\n});\nFileEntryName.displayName = 'FileEntryName';\n\nconst useStyles = makeLocalChonkyStyles(theme => ({\n    modifierIcons: {\n        color: theme.palette.text.hint,\n        position: 'relative',\n        fontSize: '0.775em',\n        paddingRight: 5,\n    },\n}));\n","import React, { useContext } from 'react';\n\nimport { FileEntryProps } from '../../types/file-list.types';\nimport { useLocalizedFileEntryStrings } from '../../util/i18n';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { makeLocalChonkyStyles } from '../../util/styles';\nimport { TextPlaceholder } from '../external/TextPlaceholder';\nimport { useFileEntryHtmlProps, useFileEntryState } from './FileEntry-hooks';\nimport { FileEntryName } from './FileEntryName';\nimport { FileEntryState } from './GridEntryPreview';\n\nexport const CompactEntry: React.FC<FileEntryProps> = React.memo(\n    // @ts-ignore\n    ({ file, selected, focused, dndState }) => {\n        const entryState: FileEntryState = useFileEntryState(file, selected, focused);\n\n        const { fileModDateString, fileSizeString } = useLocalizedFileEntryStrings(\n            file\n        );\n\n        const classes = useStyles(entryState);\n        const ChonkyIcon = useContext(ChonkyIconContext);\n        const fileEntryHtmlProps = useFileEntryHtmlProps(file);\n        return (\n            <div className={classes.listFileEntry} {...fileEntryHtmlProps}>\n                <div className={classes.listFileEntryIcon}>\n                    <ChonkyIcon\n                        icon={entryState.icon}\n                        spin={entryState.iconSpin}\n                        fixedWidth={true}\n                    />\n                </div>\n                <div className={classes.listFileEntryDescription}>\n                    <div\n                        className={classes.listFileEntryName}\n                        title={file ? file.name : undefined}\n                    >\n                        <FileEntryName file={file} />\n                    </div>\n                    <div className={classes.listFileEntryProperties}>\n                        <div className={classes.listFileEntryProperty}>\n                            {file ? (\n                                fileModDateString ?? <span></span>\n                            ) : (\n                                <TextPlaceholder minLength={5} maxLength={15} />\n                            )}\n                        </div>\n                        <div className={classes.listFileEntryProperty}>\n                            {file ? (\n                                fileSizeString ?? <span></span>\n                            ) : (\n                                <TextPlaceholder minLength={10} maxLength={20} />\n                            )}\n                        </div>\n                    </div>\n                </div>\n                <div className=\"chonky-file-entry-outline\"></div>\n                <div className=\"chonky-file-entry-selection\"></div>\n            </div>\n        );\n    }\n);\n\nconst useStyles = makeLocalChonkyStyles(theme => ({\n    listFileEntry: {\n        fontSize: theme.listFileEntry.fontSize,\n        alignItems: 'center',\n        position: 'relative',\n        display: 'flex',\n        height: '100%',\n    },\n    listFileEntryIcon: {\n        backgroundColor: (state: FileEntryState) => state.color,\n        boxShadow: 'inset rgba(255, 255, 255, 0.5) 0 0 0 999px',\n        borderRadius: theme.listFileEntry.iconBorderRadius,\n        fontSize: theme.listFileEntry.iconFontSize,\n        color: '#fff',\n        padding: 8,\n    },\n    listFileEntryDescription: {\n        flexDirection: 'column',\n        display: 'flex',\n        flexGrow: 1,\n    },\n    listFileEntryName: {\n        padding: [0, 8, 4, 8],\n    },\n    listFileEntryProperties: {\n        fontSize: theme.listFileEntry.propertyFontSize,\n        flexDirection: 'row',\n        display: 'flex',\n    },\n    listFileEntryProperty: {\n        padding: [0, 8],\n        opacity: 0.4,\n    },\n}));\n","import React from 'react';\nimport { Nullable } from 'tsdef';\n\nimport { DndEntryState } from '../../types/file-list.types';\nimport { FileData } from '../../types/file.types';\nimport { useDndHoverOpen, useFileEntryDnD } from '../../util/dnd';\nimport { FileHelper } from '../../util/file-helper';\nimport { makeLocalChonkyStyles } from '../../util/styles';\n\nexport interface DnDFileEntryProps {\n    file: Nullable<FileData>;\n    children: (dndState: DndEntryState) => React.ReactElement;\n}\n\nexport const DnDFileEntry = React.memo(({ file, children }: DnDFileEntryProps) => {\n    const { drop, drag, dndState } = useFileEntryDnD(file);\n\n    useDndHoverOpen(file, dndState);\n    const classes = useStyles();\n    return (\n        <div ref={drop} className={classes.fillParent}>\n            <div\n                ref={FileHelper.isDraggable(file) ? drag : null}\n                className={classes.fillParent}\n            >\n                {children(dndState)}\n            </div>\n        </div>\n    );\n});\n\nexport const useStyles = makeLocalChonkyStyles(() => ({\n    fillParent: {\n        height: '100%',\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport c from 'classnames';\nimport React from 'react';\nimport { Nullable } from 'tsdef';\n\nimport { makeGlobalChonkyStyles } from '../../util/styles';\n\nexport interface FileThumbnailProps {\n    className: string;\n    thumbnailUrl: Nullable<string>;\n}\n\nexport const FileThumbnail: React.FC<FileThumbnailProps> = React.memo(props => {\n    const { className, thumbnailUrl } = props;\n\n    const thumbnailStyle: React.CSSProperties = thumbnailUrl ? { backgroundImage: `url('${thumbnailUrl}')` } : {};\n\n    const classes = useStyles();\n    return <div className={c([className, classes.fileThumbnail])} style={thumbnailStyle} />;\n});\nFileThumbnail.displayName = 'FileThumbnail';\n\nconst useStyles = makeGlobalChonkyStyles(() => ({\n    fileThumbnail: {\n        backgroundRepeat: 'no-repeat',\n        backgroundPosition: 'center',\n        backgroundSize: 'contain',\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { useContext } from 'react';\n\nimport { DndEntryState } from '../../types/file-list.types';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { c, makeLocalChonkyStyles } from '../../util/styles';\nimport { useDndIcon } from './FileEntry-hooks';\n\nexport interface DnDIndicatorProps {\n    className: string;\n    dndState: DndEntryState;\n}\n\nexport const GridEntryDndIndicator: React.FC<DnDIndicatorProps> = React.memo(props => {\n    const { className: externalClassName, dndState } = props;\n    const dndIconName = useDndIcon(dndState);\n    const classes = useStyles(dndState);\n    const ChonkyIcon = useContext(ChonkyIconContext);\n    if (!dndIconName) return null;\n    const className = c({\n        [classes.dndIndicator]: true,\n        [externalClassName]: true,\n    });\n    return (\n        <div className={className}>\n            <ChonkyIcon icon={dndIconName} />\n        </div>\n    );\n});\n\nconst useStyles = makeLocalChonkyStyles(theme => ({\n    dndIndicator: {\n        color: (dndState: DndEntryState) =>\n            dndState.dndIsOver\n                ? dndState.dndCanDrop\n                    ? theme.dnd.canDropColor\n                    : theme.dnd.cannotDropColor\n                : '#000',\n        boxSizing: 'border-box',\n        position: 'absolute',\n        fontSize: '1.2em',\n        opacity: 0.6,\n        padding: 6,\n        '&:before': {\n            borderBottom: '50px solid transparent',\n            borderLeft: '50px solid #fff',\n            position: 'absolute',\n            content: '\"\"',\n            zIndex: -1,\n            left: 0,\n            top: 0,\n        },\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { useContext, useEffect } from 'react';\nimport { Nullable } from 'tsdef';\n\nimport { DndEntryState } from '../../types/file-list.types';\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { c, important, makeLocalChonkyStyles } from '../../util/styles';\nimport { FileThumbnail } from './FileThumbnail';\nimport { GridEntryDndIndicator } from './GridEntryDndIndicator';\n\nexport type FileEntryState = {\n    childrenCount: Nullable<number>;\n    color: string;\n    icon: ChonkyIconName | string;\n    thumbnailUrl: Nullable<string>;\n    iconSpin: boolean;\n    selected: boolean;\n    focused: boolean;\n};\n\nexport interface FileEntryPreviewProps {\n    className?: string;\n    entryState: FileEntryState;\n    dndState: DndEntryState;\n}\n\nexport const GridEntryPreviewFolder: React.FC<FileEntryPreviewProps> = React.memo(props => {\n    const { className: externalClassName, entryState, dndState } = props;\n\n    const folderClasses = useFolderStyles(entryState);\n    const fileClasses = useFileStyles(entryState);\n    const commonClasses = useCommonEntryStyles(entryState);\n    const className = c({\n        [folderClasses.previewFile]: true,\n        [externalClassName || '']: !!externalClassName,\n    });\n    return (\n        <div className={className}>\n            <div className={folderClasses.folderBackSideMid}>\n                <div className={folderClasses.folderBackSideTop} />\n                <div className={folderClasses.folderFrontSide}>\n                    <GridEntryDndIndicator className={fileClasses.dndIndicator} dndState={dndState} />\n                    <div className={c([fileClasses.fileIcon, folderClasses.fileIcon])}>{entryState.childrenCount}</div>\n                    <div className={commonClasses.selectionIndicator}></div>\n                    <FileThumbnail className={fileClasses.thumbnail} thumbnailUrl={entryState.thumbnailUrl} />\n                </div>\n            </div>\n        </div>\n    );\n});\nGridEntryPreviewFolder.displayName = 'GridEntryPreviewFolder';\n\nconst useFolderStyles = makeLocalChonkyStyles(theme => ({\n    previewFile: {\n        borderRadius: theme.gridFileEntry.borderRadius,\n        position: 'relative',\n        overflow: 'hidden',\n    },\n    folderBackSideTop: {\n        backgroundColor: (state: FileEntryState) => state.color,\n        boxShadow: (state: FileEntryState) => {\n            let color = theme.gridFileEntry.folderBackColorTint;\n            if (state.focused) color = 'rgba(0, 0, 0, 0.3)';\n            else if (state.selected) color = 'rgba(0, 153, 255, .4)';\n            return `inset ${color} 0 0 0 999px`;\n        },\n        borderTopLeftRadius: theme.gridFileEntry.borderRadius,\n        borderTopRightRadius: 10,\n        position: 'absolute',\n        right: '60%',\n        height: 13,\n        top: -10,\n        left: 0,\n        '&:after': {\n            borderRightColor: theme.palette.background.paper,\n            borderTopColor: theme.palette.background.paper,\n            borderBottomColor: 'transparent',\n            borderLeftColor: 'transparent',\n            borderWidth: [0, 15, 10, 0],\n            borderStyle: 'solid',\n            position: 'absolute',\n            display: 'block',\n            content: '\"\"',\n            right: 0,\n            top: 0,\n        },\n    },\n    folderBackSideMid: {\n        backgroundColor: (state: FileEntryState) => state.color,\n        boxShadow: (state: FileEntryState) => {\n            let color = theme.gridFileEntry.folderBackColorTint;\n            if (state.focused) color = 'rgba(0, 0, 0, 0.3)';\n            else if (state.selected) color = 'rgba(0, 153, 255, .4)';\n            return `inset ${color} 0 0 0 999px`;\n        },\n        borderTopRightRadius: theme.gridFileEntry.borderRadius,\n        position: 'absolute',\n        bottom: 0,\n        right: 0,\n        left: 0,\n        top: 10,\n    },\n    folderFrontSide: {\n        boxShadow: (state: FileEntryState) => {\n            const shadows: string[] = [];\n            if (state.focused) shadows.push('inset rgba(0, 0, 0, 1) 0 0 0 3px');\n            if (state.selected) shadows.push('inset rgba(0, 153, 255, .65) 0 0 0 3px');\n            shadows.push(`inset ${theme.gridFileEntry.folderFrontColorTint} 0 0 0 999px`);\n            return shadows.join(', ');\n        },\n        backgroundColor: (state: FileEntryState) => state.color,\n        borderRadius: theme.gridFileEntry.borderRadius,\n        position: 'absolute',\n        overflow: 'hidden',\n        bottom: 0,\n        right: 0,\n        left: 0,\n        top: 10,\n    },\n    fileIcon: {\n        fontSize: important(theme.gridFileEntry.childrenCountSize),\n    },\n}));\n\nexport const GridEntryPreviewFile: React.FC<FileEntryPreviewProps> = React.memo(props => {\n    const { className: externalClassName, entryState, dndState } = props;\n\n    const fileClasses = useFileStyles(entryState);\n    const commonClasses = useCommonEntryStyles(entryState);\n    const ChonkyIcon = useContext(ChonkyIconContext);\n    const className = c({\n        [fileClasses.previewFile]: true,\n        [externalClassName || '']: !!externalClassName,\n    });\n    return (\n        <div className={className}>\n            <GridEntryDndIndicator className={fileClasses.dndIndicator} dndState={dndState} />\n            <div className={fileClasses.fileIcon}>\n                <ChonkyIcon icon={entryState.icon} spin={entryState.iconSpin} />\n            </div>\n            <div className={commonClasses.selectionIndicator}></div>\n            <FileThumbnail className={fileClasses.thumbnail} thumbnailUrl={entryState.thumbnailUrl} />\n        </div>\n    );\n});\nGridEntryPreviewFile.displayName = 'GridEntryPreviewFile';\n\nconst useFileStyles = makeLocalChonkyStyles(theme => ({\n    previewFile: {\n        boxShadow: (state: FileEntryState) => {\n            const shadows: string[] = [];\n            if (state.selected) shadows.push('inset rgba(0,153,255, .65) 0 0 0 3px');\n            if (state.focused) shadows.push('inset rgba(0, 0, 0, 1) 0 0 0 3px');\n            shadows.push(`inset ${theme.gridFileEntry.fileColorTint} 0 0 0 999px`);\n            return shadows.join(', ');\n        },\n        backgroundColor: (state: FileEntryState) => state.color,\n        borderRadius: theme.gridFileEntry.borderRadius,\n        position: 'relative',\n        overflow: 'hidden',\n    },\n    dndIndicator: {\n        zIndex: 14,\n    },\n    fileIcon: {\n        transform: 'translateX(-50%) translateY(-50%)',\n        fontSize: theme.gridFileEntry.iconSize,\n        opacity: (state: FileEntryState) => (state.thumbnailUrl && !state.focused ? 0 : 1),\n        color: (state: FileEntryState) =>\n            state.focused ? theme.gridFileEntry.iconColorFocused : theme.gridFileEntry.iconColor,\n        position: 'absolute',\n        left: '50%',\n        zIndex: 12,\n        top: '50%',\n    },\n    thumbnail: {\n        borderRadius: theme.gridFileEntry.borderRadius,\n        position: 'absolute',\n        zIndex: 6,\n        bottom: 5,\n        right: 5,\n        left: 5,\n        top: 5,\n    },\n}));\n\nexport const useCommonEntryStyles = makeLocalChonkyStyles(() => ({\n    selectionIndicator: {\n        display: (state: FileEntryState) => (state.selected ? 'block' : 'none'),\n        background:\n            'repeating-linear-gradient(' +\n            '45deg,' +\n            'rgba(0,153,255,.14),' +\n            'rgba(0,153,255,.14) 10px,' +\n            'rgba(0,153,255,.25) 0,' +\n            'rgba(0,153,255,.25) 20px' +\n            ')',\n        backgroundColor: 'rgba(0, 153, 255, .14)',\n        position: 'absolute',\n        height: '100%',\n        width: '100%',\n        zIndex: 10,\n    },\n    focusIndicator: {\n        display: (state: FileEntryState) => (state.focused ? 'block' : 'none'),\n        boxShadow: 'inset rgba(0, 0, 0, 1) 0 0 0 2px',\n        position: 'absolute',\n        height: '100%',\n        width: '100%',\n        zIndex: 11,\n    },\n}));\n","import React from 'react';\n\nimport { FileEntryProps } from '../../types/file-list.types';\nimport { FileHelper } from '../../util/file-helper';\nimport { c, makeLocalChonkyStyles } from '../../util/styles';\nimport { useFileEntryHtmlProps, useFileEntryState } from './FileEntry-hooks';\nimport { FileEntryName } from './FileEntryName';\nimport { FileEntryState, GridEntryPreviewFile, GridEntryPreviewFolder } from './GridEntryPreview';\n\nexport const GridEntry: React.FC<FileEntryProps> = React.memo(({ file, selected, focused, dndState }) => {\n    const isDirectory = FileHelper.isDirectory(file);\n    const entryState = useFileEntryState(file, selected, focused);\n\n    const classes = useFileEntryStyles(entryState);\n    const fileEntryHtmlProps = useFileEntryHtmlProps(file);\n    const entryClassName = c({\n        [classes.gridFileEntry]: true,\n    });\n    return (\n        <div className={entryClassName} {...fileEntryHtmlProps}>\n            {isDirectory ? (\n                <GridEntryPreviewFolder\n                    className={classes.gridFileEntryPreview}\n                    entryState={entryState}\n                    dndState={dndState}\n                />\n            ) : (\n                <GridEntryPreviewFile\n                    className={classes.gridFileEntryPreview}\n                    entryState={entryState}\n                    dndState={dndState}\n                />\n            )}\n            <div className={classes.gridFileEntryNameContainer}>\n                <FileEntryName className={classes.gridFileEntryName} file={file} />\n            </div>\n        </div>\n    );\n});\nGridEntry.displayName = 'GridEntry';\n\nconst useFileEntryStyles = makeLocalChonkyStyles(theme => ({\n    gridFileEntry: {\n        flexDirection: 'column',\n        display: 'flex',\n        height: '100%',\n    },\n    gridFileEntryPreview: {\n        flexGrow: 1,\n    },\n    gridFileEntryNameContainer: {\n        fontSize: theme.gridFileEntry.fontSize,\n        wordBreak: 'break-word',\n        textAlign: 'center',\n        paddingTop: 5,\n    },\n    gridFileEntryName: {\n        backgroundColor: (state: FileEntryState) => (state.selected ? 'rgba(0,153,255, .25)' : 'transparent'),\n        textDecoration: (state: FileEntryState) => (state.focused ? 'underline' : 'none'),\n        borderRadius: 3,\n        padding: [2, 4],\n    },\n}));\n","import React, { useContext, useMemo } from 'react';\n\nimport { DndEntryState, FileEntryProps } from '../../types/file-list.types';\nimport { useLocalizedFileEntryStrings } from '../../util/i18n';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport { c, makeLocalChonkyStyles } from '../../util/styles';\nimport { TextPlaceholder } from '../external/TextPlaceholder';\nimport {\n    useDndIcon,\n    useFileEntryHtmlProps,\n    useFileEntryState,\n} from './FileEntry-hooks';\nimport { FileEntryName } from './FileEntryName';\nimport { FileEntryState, useCommonEntryStyles } from './GridEntryPreview';\n\ninterface StyleState {\n    entryState: FileEntryState;\n    dndState: DndEntryState;\n}\n\nexport const ListEntry: React.FC<FileEntryProps> = React.memo(\n    ({ file, selected, focused, dndState }) => {\n        const entryState: FileEntryState = useFileEntryState(file, selected, focused);\n        const dndIconName = useDndIcon(dndState);\n\n        const { fileModDateString, fileSizeString } = useLocalizedFileEntryStrings(\n            file\n        );\n        const styleState = useMemo<StyleState>(\n            () => ({\n                entryState,\n                dndState,\n            }),\n            [dndState, entryState]\n        );\n        const classes = useStyles(styleState);\n        const commonClasses = useCommonEntryStyles(entryState);\n        const ChonkyIcon = useContext(ChonkyIconContext);\n        const fileEntryHtmlProps = useFileEntryHtmlProps(file);\n        return (\n            <div className={classes.listFileEntry} {...fileEntryHtmlProps}>\n                <div className={commonClasses.focusIndicator}></div>\n                <div\n                    className={c([\n                        commonClasses.selectionIndicator,\n                        classes.listFileEntrySelection,\n                    ])}\n                ></div>\n                <div className={classes.listFileEntryIcon}>\n                    <ChonkyIcon\n                        icon={dndIconName ?? entryState.icon}\n                        spin={dndIconName ? false : entryState.iconSpin}\n                        fixedWidth={true}\n                    />\n                </div>\n                <div\n                    className={classes.listFileEntryName}\n                    title={file ? file.name : undefined}\n                >\n                    <FileEntryName file={file} />\n                </div>\n                <div className={classes.listFileEntryProperty}>\n                    {file ? (\n                        fileModDateString ?? <span></span>\n                    ) : (\n                        <TextPlaceholder minLength={5} maxLength={15} />\n                    )}\n                </div>\n                <div className={classes.listFileEntryProperty}>\n                    {file ? (\n                        fileSizeString ?? <span></span>\n                    ) : (\n                        <TextPlaceholder minLength={10} maxLength={20} />\n                    )}\n                </div>\n            </div>\n        );\n    }\n);\n\nconst useStyles = makeLocalChonkyStyles(theme => ({\n    listFileEntry: {\n        boxShadow: `inset ${theme.palette.divider} 0 -1px 0`,\n        fontSize: theme.listFileEntry.fontSize,\n        color: ({ dndState }: StyleState) =>\n            dndState.dndIsOver\n                ? dndState.dndCanDrop\n                    ? theme.dnd.canDropColor\n                    : theme.dnd.cannotDropColor\n                : 'inherit',\n        alignItems: 'center',\n        position: 'relative',\n        display: 'flex',\n        height: '100%',\n    },\n    listFileEntrySelection: {\n        opacity: 0.6,\n    },\n    listFileEntryIcon: {\n        color: ({ entryState, dndState }: StyleState) =>\n            dndState.dndIsOver\n                ? dndState.dndCanDrop\n                    ? theme.dnd.canDropColor\n                    : theme.dnd.cannotDropColor\n                : entryState.color,\n        fontSize: theme.listFileEntry.iconFontSize,\n        boxSizing: 'border-box',\n        padding: [2, 4],\n        zIndex: 20,\n    },\n    listFileEntryName: {\n        textOverflow: 'ellipsis',\n        boxSizing: 'border-box',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        flex: '1 1 300px',\n        paddingLeft: 8,\n        zIndex: 20,\n    },\n    listFileEntryProperty: {\n        fontSize: theme.listFileEntry.propertyFontSize,\n        boxSizing: 'border-box',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        flex: '0 1 150px',\n        padding: [2, 8],\n        zIndex: 20,\n    },\n}));\n","import React, { useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Nullable } from 'tsdef';\n\nimport { selectFileData, selectIsDnDDisabled, selectIsFileSelected } from '../../redux/selectors';\nimport { useParamSelector } from '../../redux/store';\nimport { DndEntryState, FileEntryProps } from '../../types/file-list.types';\nimport { FileViewMode } from '../../types/file-view.types';\nimport { FileHelper } from '../../util/file-helper';\nimport { makeGlobalChonkyStyles } from '../../util/styles';\nimport { ClickableWrapper, ClickableWrapperProps } from '../internal/ClickableWrapper';\nimport { CompactEntry } from './CompactEntry';\nimport { DnDFileEntry } from './DnDFileEntry';\nimport { useFileClickHandlers } from './FileEntry-hooks';\nimport { GridEntry } from './GridEntry';\nimport { ListEntry } from './ListEntry';\n\nexport interface SmartFileEntryProps {\n    fileId: Nullable<string>;\n    displayIndex: number;\n    fileViewMode: FileViewMode;\n}\n\nconst disabledDndState: DndEntryState = {\n    dndIsDragging: false,\n    dndIsOver: false,\n    dndCanDrop: false,\n};\n\nexport const SmartFileEntry: React.FC<SmartFileEntryProps> = React.memo(({ fileId, displayIndex, fileViewMode }) => {\n    const classes = useStyles();\n\n    // Basic properties\n    const file = useParamSelector(selectFileData, fileId);\n    const selected = useParamSelector(selectIsFileSelected, fileId);\n    const dndDisabled = useSelector(selectIsDnDDisabled);\n\n    // Clickable wrapper properties\n    const fileClickHandlers = useFileClickHandlers(file, displayIndex);\n    const [focused, setFocused] = useState(false);\n    const clickableWrapperProps: ClickableWrapperProps = {\n        wrapperTag: 'div',\n        passthroughProps: { className: classes.fileEntryClickableWrapper },\n        ...(FileHelper.isClickable(file) ? fileClickHandlers : undefined),\n        setFocused,\n    };\n\n    // File entry properties\n    const fileEntryProps: Omit<FileEntryProps, 'dndState'> = {\n        file,\n        selected,\n        focused,\n    };\n\n    let EntryComponent: React.FC<FileEntryProps>;\n    if (fileViewMode === FileViewMode.List) EntryComponent = ListEntry;\n    else if (fileViewMode === FileViewMode.Compact) EntryComponent = CompactEntry;\n    else EntryComponent = GridEntry;\n\n    return dndDisabled ? (\n        <ClickableWrapper {...clickableWrapperProps}>\n            <EntryComponent {...fileEntryProps} dndState={disabledDndState} />\n        </ClickableWrapper>\n    ) : (\n        <DnDFileEntry file={file}>\n            {dndState => (\n                <ClickableWrapper {...clickableWrapperProps}>\n                    <EntryComponent {...fileEntryProps} dndState={dndState} />\n                </ClickableWrapper>\n            )}\n        </DnDFileEntry>\n    );\n});\nSmartFileEntry.displayName = 'SmartFileEntry';\n\nconst useStyles = makeGlobalChonkyStyles(() => ({\n    fileEntryClickableWrapper: {\n        // We disable default browser outline because Chonky provides its own outline\n        // (which doesn't compromise accessibility, hopefully)\n        outline: 'none !important',\n        position: 'relative',\n        height: '100%',\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { CSSProperties, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { VariableSizeGrid } from 'react-window';\n\nimport { ChonkyActions } from '../../action-definitions';\nimport { selectFileViewConfig, selectors } from '../../redux/selectors';\nimport { FileViewConfigGrid } from '../../types/file-view.types';\nimport { RootState } from '../../types/redux.types';\nimport { useInstanceVariable } from '../../util/hooks-helpers';\nimport { makeGlobalChonkyStyles, useIsMobileBreakpoint } from '../../util/styles';\nimport { SmartFileEntry } from './FileEntry';\n\nexport interface FileListGridProps {\n    width: number;\n    height: number;\n}\n\ninterface GridConfig {\n    rowCount: number;\n    columnCount: number;\n    gutter: number;\n    rowHeight: number;\n    columnWidth: number;\n}\n\nexport const isMobileDevice = () => {\n    // noinspection JSDeprecatedSymbols\n    return typeof window.orientation !== 'undefined' || navigator.userAgent.indexOf('IEMobile') !== -1;\n};\n\nexport const getGridConfig = (\n    width: number,\n    fileCount: number,\n    viewConfig: FileViewConfigGrid,\n    isMobileBreakpoint: boolean\n): GridConfig => {\n    const gutter = isMobileBreakpoint ? 5 : 8;\n    const scrollbar = isMobileDevice() ? 0 : 18;\n\n    let columnCount: number;\n    let columnWidth: number;\n    if (isMobileBreakpoint) {\n        columnCount = 2;\n        columnWidth = (width - gutter - scrollbar) / columnCount;\n    } else {\n        columnWidth = viewConfig.entryWidth;\n        columnCount = Math.max(1, Math.floor((width - scrollbar) / (columnWidth + gutter)));\n    }\n\n    const rowCount = Math.ceil(fileCount / columnCount);\n\n    return {\n        rowCount,\n        columnCount,\n        gutter,\n        rowHeight: viewConfig.entryHeight,\n        columnWidth,\n    };\n};\n\nexport const GridContainer: React.FC<FileListGridProps> = React.memo(props => {\n    const { width, height } = props;\n\n    const viewConfig = useSelector(selectFileViewConfig) as FileViewConfigGrid;\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\n    const fileCount = useMemo(() => displayFileIds.length, [displayFileIds]);\n\n    const gridRef = useRef<VariableSizeGrid>();\n    const isMobileBreakpoint = useIsMobileBreakpoint();\n\n    // Whenever the grid config changes at runtime, we call a method on the\n    // `VariableSizeGrid` handle to reset column width/row height cache.\n    // !!! Note that we deliberately update the `gridRef` firsts and update the React\n    //     state AFTER that. This is needed to avoid file entries jumping up/down.\n    const [gridConfig, setGridConfig] = useState(getGridConfig(width, fileCount, viewConfig, isMobileBreakpoint));\n    const gridConfigRef = useRef(gridConfig);\n    useEffect(() => {\n        const oldConf = gridConfigRef.current;\n        const newConf = getGridConfig(width, fileCount, viewConfig, isMobileBreakpoint);\n\n        gridConfigRef.current = newConf;\n        if (gridRef.current) {\n            if (oldConf.rowCount !== newConf.rowCount) {\n                gridRef.current.resetAfterRowIndex(Math.min(oldConf.rowCount, newConf.rowCount) - 1);\n            }\n            if (oldConf.columnCount !== newConf.columnCount) {\n                gridRef.current.resetAfterColumnIndex(Math.min(oldConf.columnCount, newConf.rowCount) - 1);\n            }\n            if (oldConf.columnWidth !== newConf.columnWidth) {\n                gridRef.current.resetAfterIndices({ columnIndex: 0, rowIndex: 0 });\n            }\n        }\n\n        setGridConfig(newConf);\n    }, [setGridConfig, gridConfigRef, isMobileBreakpoint, width, viewConfig, fileCount]);\n\n    const sizers = useMemo(() => {\n        const gc = gridConfigRef;\n        return {\n            getColumnWidth: (index: number) =>\n                gc.current.columnWidth! + (index === gc.current.columnCount - 1 ? 0 : gc.current.gutter),\n            getRowHeight: (index: number) =>\n                gc.current.rowHeight + (index === gc.current.rowCount - 1 ? 0 : gc.current.gutter),\n        };\n    }, [gridConfigRef]);\n\n    const displayFileIdsRef = useInstanceVariable(useSelector(selectors.getDisplayFileIds));\n    const getItemKey = useCallback(\n        (data: { columnIndex: number; rowIndex: number; data: any }) => {\n            const index = data.rowIndex * gridConfigRef.current.columnCount + data.columnIndex;\n\n            return displayFileIdsRef.current[index] ?? `loading-file-${index}`;\n        },\n        [gridConfigRef, displayFileIdsRef]\n    );\n\n    const cellRenderer = useCallback(\n        (data: { rowIndex: number; columnIndex: number; style: CSSProperties }) => {\n            const gc = gridConfigRef;\n            const index = data.rowIndex * gc.current.columnCount + data.columnIndex;\n            const fileId = displayFileIds[index];\n            if (displayFileIds[index] === undefined) return null;\n\n            const styleWithGutter: CSSProperties = {\n                ...data.style,\n                paddingRight: data.columnIndex === gc.current.columnCount - 1 ? 0 : gc.current.gutter,\n                paddingBottom: data.rowIndex === gc.current.rowCount - 1 ? 0 : gc.current.gutter,\n                boxSizing: 'border-box',\n            };\n\n            return (\n                <div style={styleWithGutter}>\n                    <SmartFileEntry fileId={fileId ?? null} displayIndex={index} fileViewMode={viewConfig.mode} />\n                </div>\n            );\n        },\n        [displayFileIds, viewConfig.mode]\n    );\n\n    const classes = useStyles();\n    const gridComponent = useMemo(() => {\n        return (\n            <VariableSizeGrid\n                ref={gridRef as any}\n                className={classes.gridContainer}\n                estimatedRowHeight={gridConfig.rowHeight + gridConfig.gutter}\n                rowHeight={sizers.getRowHeight}\n                estimatedColumnWidth={gridConfig.columnWidth + gridConfig.gutter}\n                columnWidth={sizers.getColumnWidth}\n                columnCount={gridConfig.columnCount}\n                height={height}\n                rowCount={gridConfig.rowCount}\n                width={width}\n                itemKey={getItemKey}\n            >\n                {cellRenderer}\n            </VariableSizeGrid>\n        );\n    }, [\n        classes.gridContainer,\n        gridConfig.rowHeight,\n        gridConfig.gutter,\n        gridConfig.columnWidth,\n        gridConfig.columnCount,\n        gridConfig.rowCount,\n        sizers.getRowHeight,\n        sizers.getColumnWidth,\n        height,\n        width,\n        getItemKey,\n        cellRenderer,\n    ]);\n\n    return gridComponent;\n});\n\nconst useStyles = makeGlobalChonkyStyles(() => ({\n    gridContainer: {},\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { CSSProperties, useCallback, useMemo, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport { FixedSizeList } from 'react-window';\n\nimport { selectFileViewConfig, selectors } from '../../redux/selectors';\nimport { FileViewMode } from '../../types/file-view.types';\nimport { useInstanceVariable } from '../../util/hooks-helpers';\nimport { makeLocalChonkyStyles } from '../../util/styles';\nimport { SmartFileEntry } from './FileEntry';\n\nexport interface FileListListProps {\n    width: number;\n    height: number;\n}\n\nexport const ListContainer: React.FC<FileListListProps> = React.memo(props => {\n    const { width, height } = props;\n\n    const viewConfig = useSelector(selectFileViewConfig);\n\n    const listRef = useRef<FixedSizeList>();\n\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\n    const displayFileIdsRef = useInstanceVariable(displayFileIds);\n    const getItemKey = useCallback(\n        (index: number) => displayFileIdsRef.current[index] ?? `loading-file-${index}`,\n        [displayFileIdsRef]\n    );\n\n    const classes = useStyles();\n    const listComponent = useMemo(() => {\n        // When entry size is null, we use List view\n        const rowRenderer = (data: { index: number; style: CSSProperties }) => {\n            return (\n                <div style={data.style}>\n                    <SmartFileEntry\n                        fileId={displayFileIds[data.index] ?? null}\n                        displayIndex={data.index}\n                        fileViewMode={FileViewMode.List}\n                    />\n                </div>\n            );\n        };\n\n        return (\n            <FixedSizeList\n                ref={listRef as any}\n                className={classes.listContainer}\n                itemSize={viewConfig.entryHeight}\n                height={height}\n                itemCount={displayFileIds.length}\n                width={width}\n                itemKey={getItemKey}\n            >\n                {rowRenderer}\n            </FixedSizeList>\n        );\n    }, [\n        classes.listContainer,\n        viewConfig.entryHeight,\n        height,\n        displayFileIds,\n        width,\n        getItemKey,\n    ]);\n\n    return listComponent;\n});\n\nconst useStyles = makeLocalChonkyStyles(theme => ({\n    listContainer: {\n        borderTop: `solid 1px ${theme.palette.divider}`,\n    },\n}));\n","import React, { UIEvent, useCallback, useContext, useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { ChonkyActions } from '../../action-definitions/index';\nimport { selectCurrentFolder, selectFileViewConfig, selectors } from '../../redux/selectors';\nimport { FileViewMode } from '../../types/file-view.types';\nimport { ChonkyIconName } from '../../types/icons.types';\nimport { useFileDrop } from '../../util/dnd';\nimport { ChonkyIconContext } from '../../util/icon-helper';\nimport {\n    c, getStripeGradient, makeGlobalChonkyStyles, makeLocalChonkyStyles\n} from '../../util/styles';\nimport { FileListEmpty } from './FileListEmpty';\nimport { GridContainer } from './GridContainer';\nimport { ListContainer } from './ListContainer';\n\nexport interface FileListProps {\n    onScroll?: (e: UIEvent<HTMLDivElement>) => void;\n}\n\ninterface StyleState {\n    dndCanDrop: boolean;\n    dndIsOverCurrent: boolean;\n}\n\nexport const FileList: React.FC<FileListProps> = React.memo((props: FileListProps) => {\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\n    const viewConfig = useSelector(selectFileViewConfig);\n\n    const currentFolder = useSelector(selectCurrentFolder);\n    const { drop, dndCanDrop, dndIsOverCurrent } = useFileDrop({ file: currentFolder });\n    const styleState = useMemo<StyleState>(() => ({ dndCanDrop, dndIsOverCurrent }), [dndCanDrop, dndIsOverCurrent]);\n\n    const localClasses = useLocalStyles(styleState);\n    const classes = useStyles(viewConfig);\n    const { onScroll } = props;\n\n    // In Chonky v0.x, this field was user-configurable. In Chonky v1.x+, we hardcode\n    // this to `true` to simplify configuration. Users can just wrap Chonky in their\n    // own `div` if they want to have finer control over the height.\n    const fillParentContainer = true;\n\n    const listRenderer = useCallback(\n        ({ width, height }: { width: number; height: number }) => {\n            if (displayFileIds.length === 0) {\n                return <FileListEmpty width={width} height={viewConfig.entryHeight} />;\n            } else if (viewConfig.mode === FileViewMode.List) {\n                return <ListContainer width={width} height={height} />;\n            } else {\n                return <GridContainer width={width} height={height} />;\n            }\n        },\n        [displayFileIds, viewConfig]\n    );\n\n    const ChonkyIcon = useContext(ChonkyIconContext);\n    return (\n        <div onScroll={onScroll} ref={drop} className={c([classes.fileListWrapper, localClasses.fileListWrapper])} role=\"list\">\n            <div className={localClasses.dndDropZone}>\n                <div className={localClasses.dndDropZoneIcon}>\n                    <ChonkyIcon icon={dndCanDrop ? ChonkyIconName.dndCanDrop : ChonkyIconName.dndCannotDrop} />\n                </div>\n            </div>\n            <AutoSizer disableHeight={!fillParentContainer}>{listRenderer}</AutoSizer>\n        </div>\n    );\n});\nFileList.displayName = 'FileList';\n\nconst useLocalStyles = makeLocalChonkyStyles(theme => ({\n    fileListWrapper: {\n        minHeight: ChonkyActions.EnableGridView.fileViewConfig.entryHeight + 2,\n        background: (state: StyleState) =>\n            state.dndIsOverCurrent && state.dndCanDrop\n                ? state.dndCanDrop\n                    ? getStripeGradient(theme.dnd.fileListCanDropMaskOne, theme.dnd.fileListCanDropMaskTwo)\n                    : getStripeGradient(theme.dnd.fileListCannotDropMaskOne, theme.dnd.fileListCannotDropMaskTwo)\n                : 'none',\n    },\n    dndDropZone: {\n        display: (state: StyleState) =>\n            // When we cannot drop, we don't show an indicator at all\n            state.dndIsOverCurrent && state.dndCanDrop ? 'block' : 'none',\n        borderRadius: theme.gridFileEntry.borderRadius,\n        pointerEvents: 'none',\n        position: 'absolute',\n        height: '100%',\n        width: '100%',\n        zIndex: 2,\n    },\n    dndDropZoneIcon: {\n        backgroundColor: (state: StyleState) => (state.dndCanDrop ? theme.dnd.canDropMask : theme.dnd.cannotDropMask),\n        color: (state: StyleState) => (state.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor),\n        borderRadius: theme.gridFileEntry.borderRadius,\n        transform: 'translateX(-50%) translateY(-50%)',\n        position: 'absolute',\n        textAlign: 'center',\n        lineHeight: '60px',\n        fontSize: '2em',\n        left: '50%',\n        height: 60,\n        top: '50%',\n        width: 60,\n    },\n}));\n\nconst useStyles = makeGlobalChonkyStyles(() => ({\n    fileListWrapper: {\n        height: '100%',\n        maxHeight: '100%',\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React, { ReactElement, useEffect, useMemo } from 'react';\nimport { useIntl } from 'react-intl';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport Menu from '@material-ui/core/Menu';\n\nimport { reduxActions } from '../../redux/reducers';\nimport { selectContextMenuConfig, selectContextMenuItems } from '../../redux/selectors';\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\nimport { useContextMenuDismisser } from './FileContextMenu-hooks';\nimport { SmartToolbarDropdownButton } from './ToolbarDropdownButton';\n\nexport interface FileContextMenuProps {}\n\nexport const FileContextMenu: React.FC<FileContextMenuProps> = React.memo(() => {\n    const dispatch = useDispatch();\n    useEffect(() => {\n        dispatch(reduxActions.setContextMenuMounted(true));\n        return () => {\n            dispatch(reduxActions.setContextMenuMounted(false));\n        };\n    }, [dispatch]);\n\n    const intl = useIntl();\n    const browserMenuShortcutString = intl.formatMessage(\n        {\n            id: getI18nId(I18nNamespace.FileContextMenu, 'browserMenuShortcut'),\n            defaultMessage: 'Browser menu: {shortcut}',\n        },\n        { shortcut: <strong>Alt + Right Click</strong> }\n    );\n\n    const contextMenuConfig = useSelector(selectContextMenuConfig);\n    const contextMenuItems = useSelector(selectContextMenuItems);\n\n    const hideContextMenu = useContextMenuDismisser();\n    const contextMenuItemComponents = useMemo(() => {\n        const components: ReactElement[] = [];\n        for (let i = 0; i < contextMenuItems.length; ++i) {\n            const item = contextMenuItems[i];\n\n            if (typeof item === 'string') {\n                components.push(\n                    <SmartToolbarDropdownButton\n                        key={`context-menu-item-${item}`}\n                        fileActionId={item}\n                        onClickFollowUp={hideContextMenu}\n                    />\n                );\n            } else {\n                item.fileActionIds.map(id =>\n                    components.push(\n                        <SmartToolbarDropdownButton\n                            key={`context-menu-item-${item.name}-${id}`}\n                            fileActionId={id}\n                            onClickFollowUp={hideContextMenu}\n                        />\n                    )\n                );\n            }\n        }\n        return components;\n    }, [contextMenuItems, hideContextMenu]);\n\n    const anchorPosition = useMemo(\n        () => (contextMenuConfig ? { top: contextMenuConfig.mouseY, left: contextMenuConfig.mouseX } : undefined),\n        [contextMenuConfig]\n    );\n\n    const classes = useStyles();\n    return (\n        <Menu\n            elevation={2}\n            disablePortal\n            onClose={hideContextMenu}\n            transitionDuration={150}\n            open={!!contextMenuConfig}\n            anchorPosition={anchorPosition}\n            anchorReference=\"anchorPosition\"\n            classes={{ list: classes.contextMenuList }}\n        >\n            {contextMenuItemComponents}\n            <ListSubheader component=\"div\" className={classes.browserMenuTooltip}>\n                {browserMenuShortcutString}\n            </ListSubheader>\n        </Menu>\n    );\n});\n\nconst useStyles = makeGlobalChonkyStyles(() => ({\n    contextMenuList: {\n        paddingBottom: important(0),\n        paddingTop: important(0),\n    },\n    browserMenuTooltip: {\n        lineHeight: important('30px'),\n        fontSize: important('0.7em'),\n    },\n}));\n","/**\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\n * @copyright 2020\n * @license MIT\n */\n\nimport React from 'react';\n\nimport { FileBrowserHandle, FileBrowserProps } from '../../types/file-browser.types';\nimport { FileList } from '../file-list/FileList';\nimport { FileBrowser } from './FileBrowser';\nimport { FileContextMenu } from './FileContextMenu';\nimport { FileNavbar } from './FileNavbar';\nimport { FileToolbar } from './FileToolbar';\n\nexport const FullFileBrowser = React.memo(\n    React.forwardRef<FileBrowserHandle, FileBrowserProps>((props, ref) => {\n        const { onScroll } = props\n        return (\n            <FileBrowser ref={ref} {...props}>\n                <FileNavbar />\n                <FileToolbar />\n                <FileList onScroll={onScroll}/>\n                <FileContextMenu/>\n            </FileBrowser>\n        );\n    })\n);\nFullFileBrowser.displayName = 'FullFileBrowser';\n","/**\n *\n */\n\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { ChonkyActions } from '../action-definitions';\nimport { FileActionData } from '../types/action-handler.types';\nimport { FileAction } from '../types/action.types';\nimport { FileArray, FileData } from '../types/file.types';\nimport { FileHelper } from '../util/file-helper';\n\nexport interface CustomFileData extends FileData {\n    parentId?: string;\n    childrenIds?: string[];\n}\nexport interface CustomFileMap<FT extends CustomFileData> {\n    [fileId: string]: FT;\n}\nexport interface FileMapParams<FT extends CustomFileData> {\n    baseFileMap: CustomFileMap<FT>;\n    initialFolderId: string;\n}\n\nexport const useFolderChain = <FT extends CustomFileData>(\n    fileMap: CustomFileMap<FT>,\n    currentFolderId: string\n): FileArray<FT> => {\n    return useMemo(() => {\n        const currentFolder = fileMap[currentFolderId];\n\n        const folderChain = [currentFolder];\n\n        let parentId = currentFolder.parentId;\n        while (parentId) {\n            const parentFile = fileMap[parentId];\n            if (parentFile) {\n                folderChain.unshift(parentFile);\n                parentId = parentFile.parentId;\n            } else {\n                break;\n            }\n        }\n\n        return folderChain;\n    }, [currentFolderId, fileMap]);\n};\n\nexport const useFiles = <FT extends CustomFileData>(\n    fileMap: CustomFileMap<FT>,\n    currentFolderId: string\n): FileArray<FT> => {\n    return useMemo(() => {\n        const currentFolder = fileMap[currentFolderId];\n        const childrenIds = currentFolder.childrenIds!;\n        const files = childrenIds.map((fileId: string) => fileMap[fileId]);\n        return files;\n    }, [currentFolderId, fileMap]);\n};\n\nexport const useFileMapMethods = <FT extends CustomFileData>(\n    baseFileMap: CustomFileMap<FT>,\n    initialFolderId: string\n) => {\n    const [fileMap, setFileMap] = useState(baseFileMap);\n    const [currentFolderId, setCurrentFolderId] = useState(initialFolderId);\n    const resetFileMap = useCallback(() => {\n        setFileMap(baseFileMap);\n        setCurrentFolderId(initialFolderId);\n    }, [baseFileMap, initialFolderId]);\n    const moveFiles = useCallback(\n        (files: FT[], source: FT, destination: FT) =>\n            setFileMap(currentFileMap => {\n                const newFileMap = { ...currentFileMap };\n                const moveFileIds = new Set(files.map(f => f.id));\n\n                // Delete files from their source folder.\n                const newSourceChildrenIds = source.childrenIds!.filter(id => !moveFileIds.has(id));\n                newFileMap[source.id] = {\n                    ...source,\n                    childrenIds: newSourceChildrenIds,\n                    childrenCount: newSourceChildrenIds.length,\n                };\n\n                // Add the files to their destination folder.\n                const newDestinationChildrenIds = [...destination.childrenIds!, ...files.map(f => f.id)];\n                newFileMap[destination.id] = {\n                    ...destination,\n                    childrenIds: newDestinationChildrenIds,\n                    childrenCount: newDestinationChildrenIds.length,\n                };\n\n                // Finally, update the parent folder ID on the files from source folder\n                // ID to the destination folder ID.\n                files.forEach(file => {\n                    newFileMap[file.id] = {\n                        ...file,\n                        parentId: destination.id,\n                    };\n                });\n\n                return newFileMap;\n            }),\n        []\n    );\n\n    const methods = useMemo(\n        () => ({\n            setFileMap,\n            setCurrentFolderId,\n            resetFileMap,\n            moveFiles,\n        }),\n        [setFileMap, setCurrentFolderId, resetFileMap, moveFiles]\n    );\n    return {\n        fileMap,\n        currentFolderId,\n        methods,\n    };\n};\nexport type FileMethods = ReturnType<typeof useFileMapMethods>['methods'];\n\nexport const useFileActionHandler = (methods: FileMethods) => {\n    return useCallback(\n        (data: FileActionData<FileAction>) => {\n            if (data.id === ChonkyActions.OpenFiles.id) {\n                const { targetFile, files } = data.payload;\n                const fileToOpen = targetFile ?? files[0];\n                if (fileToOpen && FileHelper.isDirectory(fileToOpen)) {\n                    methods.setCurrentFolderId(fileToOpen.id);\n                }\n            } else if (data.id === ChonkyActions.MoveFiles.id) {\n                methods.moveFiles(data.payload.files, data.payload.source!, data.payload.destination);\n            }\n        },\n        [methods]\n    );\n};\n\nexport const useFileMap = <FT extends CustomFileData = CustomFileData>({\n    baseFileMap,\n    initialFolderId,\n}: FileMapParams<FT>) => {\n    const { fileMap, currentFolderId, methods } = useFileMapMethods(baseFileMap, initialFolderId);\n    const folderChain = useFolderChain(fileMap, currentFolderId);\n    const files = useFiles(fileMap, currentFolderId);\n    const fileActionHandler = useFileActionHandler(methods as FileMethods);\n\n    const data = {\n        fileMap,\n        currentFolderId,\n        folderChain,\n        files,\n    };\n    return { data, methods, fileActionHandler };\n};\n"]},"metadata":{},"sourceType":"module"}