{"ast":null,"code":"import { __awaiter, __generator, __values } from \"tslib\";\nimport { toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { KEY_TYPE_IDENTIFIER, MAX_CACHE_SIZE } from \"./constants\";\nvar signingKeyCache = {};\nvar cacheQueue = [];\nexport var createScope = function createScope(shortDate, region, service) {\n  return shortDate + \"/\" + region + \"/\" + service + \"/\" + KEY_TYPE_IDENTIFIER;\n};\nexport var getSigningKey = function getSigningKey(sha256Constructor, credentials, shortDate, region, service) {\n  return __awaiter(void 0, void 0, void 0, function () {\n    var credsHash, cacheKey, key, _a, _b, signable, e_1_1;\n    var e_1, _c;\n    return __generator(this, function (_d) {\n      switch (_d.label) {\n        case 0:\n          return [4, hmac(sha256Constructor, credentials.secretAccessKey, credentials.accessKeyId)];\n        case 1:\n          credsHash = _d.sent();\n          cacheKey = shortDate + \":\" + region + \":\" + service + \":\" + toHex(credsHash) + \":\" + credentials.sessionToken;\n          if (cacheKey in signingKeyCache) {\n            return [2, signingKeyCache[cacheKey]];\n          }\n          cacheQueue.push(cacheKey);\n          while (cacheQueue.length > MAX_CACHE_SIZE) {\n            delete signingKeyCache[cacheQueue.shift()];\n          }\n          key = \"AWS4\" + credentials.secretAccessKey;\n          _d.label = 2;\n        case 2:\n          _d.trys.push([2, 7, 8, 9]);\n          _a = __values([shortDate, region, service, KEY_TYPE_IDENTIFIER]), _b = _a.next();\n          _d.label = 3;\n        case 3:\n          if (!!_b.done) return [3, 6];\n          signable = _b.value;\n          return [4, hmac(sha256Constructor, key, signable)];\n        case 4:\n          key = _d.sent();\n          _d.label = 5;\n        case 5:\n          _b = _a.next();\n          return [3, 3];\n        case 6:\n          return [3, 9];\n        case 7:\n          e_1_1 = _d.sent();\n          e_1 = {\n            error: e_1_1\n          };\n          return [3, 9];\n        case 8:\n          try {\n            if (_b && !_b.done && (_c = _a.return)) _c.call(_a);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n          return [7];\n        case 9:\n          return [2, signingKeyCache[cacheKey] = key];\n      }\n    });\n  });\n};\nexport var clearCredentialCache = function clearCredentialCache() {\n  cacheQueue.length = 0;\n  Object.keys(signingKeyCache).forEach(function (cacheKey) {\n    delete signingKeyCache[cacheKey];\n  });\n};\nvar hmac = function hmac(ctor, secret, data) {\n  var hash = new ctor(secret);\n  hash.update(data);\n  return hash.digest();\n};","map":{"version":3,"names":["__awaiter","__generator","__values","toHex","KEY_TYPE_IDENTIFIER","MAX_CACHE_SIZE","signingKeyCache","cacheQueue","createScope","shortDate","region","service","getSigningKey","sha256Constructor","credentials","credsHash","cacheKey","key","_a","_b","signable","e_1_1","e_1","_c","_d","label","hmac","secretAccessKey","accessKeyId","sent","sessionToken","push","length","shift","trys","next","done","value","error","return","call","clearCredentialCache","Object","keys","forEach","ctor","secret","data","hash","update","digest"],"sources":["/Users/Junhaeng/untitled folder/junior-design/amplifyapp/node_modules/@aws-sdk/client-location/node_modules/@aws-sdk/signature-v4/dist-es/credentialDerivation.js"],"sourcesContent":["import { __awaiter, __generator, __values } from \"tslib\";\nimport { toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { KEY_TYPE_IDENTIFIER, MAX_CACHE_SIZE } from \"./constants\";\nvar signingKeyCache = {};\nvar cacheQueue = [];\nexport var createScope = function (shortDate, region, service) {\n    return shortDate + \"/\" + region + \"/\" + service + \"/\" + KEY_TYPE_IDENTIFIER;\n};\nexport var getSigningKey = function (sha256Constructor, credentials, shortDate, region, service) { return __awaiter(void 0, void 0, void 0, function () {\n    var credsHash, cacheKey, key, _a, _b, signable, e_1_1;\n    var e_1, _c;\n    return __generator(this, function (_d) {\n        switch (_d.label) {\n            case 0: return [4, hmac(sha256Constructor, credentials.secretAccessKey, credentials.accessKeyId)];\n            case 1:\n                credsHash = _d.sent();\n                cacheKey = shortDate + \":\" + region + \":\" + service + \":\" + toHex(credsHash) + \":\" + credentials.sessionToken;\n                if (cacheKey in signingKeyCache) {\n                    return [2, signingKeyCache[cacheKey]];\n                }\n                cacheQueue.push(cacheKey);\n                while (cacheQueue.length > MAX_CACHE_SIZE) {\n                    delete signingKeyCache[cacheQueue.shift()];\n                }\n                key = \"AWS4\" + credentials.secretAccessKey;\n                _d.label = 2;\n            case 2:\n                _d.trys.push([2, 7, 8, 9]);\n                _a = __values([shortDate, region, service, KEY_TYPE_IDENTIFIER]), _b = _a.next();\n                _d.label = 3;\n            case 3:\n                if (!!_b.done) return [3, 6];\n                signable = _b.value;\n                return [4, hmac(sha256Constructor, key, signable)];\n            case 4:\n                key = _d.sent();\n                _d.label = 5;\n            case 5:\n                _b = _a.next();\n                return [3, 3];\n            case 6: return [3, 9];\n            case 7:\n                e_1_1 = _d.sent();\n                e_1 = { error: e_1_1 };\n                return [3, 9];\n            case 8:\n                try {\n                    if (_b && !_b.done && (_c = _a.return)) _c.call(_a);\n                }\n                finally { if (e_1) throw e_1.error; }\n                return [7];\n            case 9: return [2, (signingKeyCache[cacheKey] = key)];\n        }\n    });\n}); };\nexport var clearCredentialCache = function () {\n    cacheQueue.length = 0;\n    Object.keys(signingKeyCache).forEach(function (cacheKey) {\n        delete signingKeyCache[cacheKey];\n    });\n};\nvar hmac = function (ctor, secret, data) {\n    var hash = new ctor(secret);\n    hash.update(data);\n    return hash.digest();\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}