{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { ALGORITHM_IDENTIFIER, ALGORITHM_QUERY_PARAM, AMZ_DATE_HEADER, AMZ_DATE_QUERY_PARAM, AUTH_HEADER, CREDENTIAL_QUERY_PARAM, EVENT_ALGORITHM_IDENTIFIER, EXPIRES_QUERY_PARAM, MAX_PRESIGNED_TTL, SHA256_HEADER, SIGNATURE_QUERY_PARAM, SIGNED_HEADERS_QUERY_PARAM, TOKEN_HEADER, TOKEN_QUERY_PARAM } from \"./constants\";\nimport { createScope, getSigningKey } from \"./credentialDerivation\";\nimport { getCanonicalHeaders } from \"./getCanonicalHeaders\";\nimport { getCanonicalQuery } from \"./getCanonicalQuery\";\nimport { getPayloadHash } from \"./getPayloadHash\";\nimport { hasHeader } from \"./headerUtil\";\nimport { moveHeadersToQuery } from \"./moveHeadersToQuery\";\nimport { normalizeCredentialsProvider, normalizeRegionProvider } from \"./normalizeProvider\";\nimport { prepareRequest } from \"./prepareRequest\";\nimport { iso8601 } from \"./utilDate\";\nvar SignatureV4 = function () {\n  function SignatureV4(_a) {\n    var applyChecksum = _a.applyChecksum,\n      credentials = _a.credentials,\n      region = _a.region,\n      service = _a.service,\n      sha256 = _a.sha256,\n      _b = _a.uriEscapePath,\n      uriEscapePath = _b === void 0 ? true : _b;\n    this.service = service;\n    this.sha256 = sha256;\n    this.uriEscapePath = uriEscapePath;\n    this.applyChecksum = typeof applyChecksum === \"boolean\" ? applyChecksum : true;\n    this.regionProvider = normalizeRegionProvider(region);\n    this.credentialProvider = normalizeCredentialsProvider(credentials);\n  }\n  SignatureV4.prototype.presign = function (originalRequest, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, signingDate, _b, expiresIn, unsignableHeaders, unhoistableHeaders, signableHeaders, signingRegion, signingService, credentials, region, _c, _d, longDate, shortDate, scope, request, canonicalHeaders, _e, _f, _g, _h, _j, _k;\n      return __generator(this, function (_l) {\n        switch (_l.label) {\n          case 0:\n            _a = options.signingDate, signingDate = _a === void 0 ? new Date() : _a, _b = options.expiresIn, expiresIn = _b === void 0 ? 3600 : _b, unsignableHeaders = options.unsignableHeaders, unhoistableHeaders = options.unhoistableHeaders, signableHeaders = options.signableHeaders, signingRegion = options.signingRegion, signingService = options.signingService;\n            return [4, this.credentialProvider()];\n          case 1:\n            credentials = _l.sent();\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n            _c = signingRegion;\n            return [3, 4];\n          case 2:\n            return [4, this.regionProvider()];\n          case 3:\n            _c = _l.sent();\n            _l.label = 4;\n          case 4:\n            region = _c;\n            _d = formatDate(signingDate), longDate = _d.longDate, shortDate = _d.shortDate;\n            if (expiresIn > MAX_PRESIGNED_TTL) {\n              return [2, Promise.reject(\"Signature version 4 presigned URLs\" + \" must have an expiration date less than one week in\" + \" the future\")];\n            }\n            scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n            request = moveHeadersToQuery(prepareRequest(originalRequest), {\n              unhoistableHeaders: unhoistableHeaders\n            });\n            if (credentials.sessionToken) {\n              request.query[TOKEN_QUERY_PARAM] = credentials.sessionToken;\n            }\n            request.query[ALGORITHM_QUERY_PARAM] = ALGORITHM_IDENTIFIER;\n            request.query[CREDENTIAL_QUERY_PARAM] = credentials.accessKeyId + \"/\" + scope;\n            request.query[AMZ_DATE_QUERY_PARAM] = longDate;\n            request.query[EXPIRES_QUERY_PARAM] = expiresIn.toString(10);\n            canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n            request.query[SIGNED_HEADERS_QUERY_PARAM] = getCanonicalHeaderList(canonicalHeaders);\n            _e = request.query;\n            _f = SIGNATURE_QUERY_PARAM;\n            _g = this.getSignature;\n            _h = [longDate, scope, this.getSigningKey(credentials, region, shortDate, signingService)];\n            _j = this.createCanonicalRequest;\n            _k = [request, canonicalHeaders];\n            return [4, getPayloadHash(originalRequest, this.sha256)];\n          case 5:\n            return [4, _g.apply(this, _h.concat([_j.apply(this, _k.concat([_l.sent()]))]))];\n          case 6:\n            _e[_f] = _l.sent();\n            return [2, request];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.sign = function (toSign, options) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        if (typeof toSign === \"string\") {\n          return [2, this.signString(toSign, options)];\n        } else if (toSign.headers && toSign.payload) {\n          return [2, this.signEvent(toSign, options)];\n        } else {\n          return [2, this.signRequest(toSign, options)];\n        }\n        return [2];\n      });\n    });\n  };\n  SignatureV4.prototype.signEvent = function (_a, _b) {\n    var headers = _a.headers,\n      payload = _a.payload;\n    var _c = _b.signingDate,\n      signingDate = _c === void 0 ? new Date() : _c,\n      priorSignature = _b.priorSignature,\n      signingRegion = _b.signingRegion,\n      signingService = _b.signingService;\n    return __awaiter(this, void 0, void 0, function () {\n      var region, _d, _e, shortDate, longDate, scope, hashedPayload, hash, hashedHeaders, _f, stringToSign;\n      return __generator(this, function (_g) {\n        switch (_g.label) {\n          case 0:\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 1];\n            _d = signingRegion;\n            return [3, 3];\n          case 1:\n            return [4, this.regionProvider()];\n          case 2:\n            _d = _g.sent();\n            _g.label = 3;\n          case 3:\n            region = _d;\n            _e = formatDate(signingDate), shortDate = _e.shortDate, longDate = _e.longDate;\n            scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n            return [4, getPayloadHash({\n              headers: {},\n              body: payload\n            }, this.sha256)];\n          case 4:\n            hashedPayload = _g.sent();\n            hash = new this.sha256();\n            hash.update(headers);\n            _f = toHex;\n            return [4, hash.digest()];\n          case 5:\n            hashedHeaders = _f.apply(void 0, [_g.sent()]);\n            stringToSign = [EVENT_ALGORITHM_IDENTIFIER, longDate, scope, priorSignature, hashedHeaders, hashedPayload].join(\"\\n\");\n            return [2, this.signString(stringToSign, {\n              signingDate: signingDate,\n              signingRegion: region,\n              signingService: signingService\n            })];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.signString = function (stringToSign, _a) {\n    var _b = _a === void 0 ? {} : _a,\n      _c = _b.signingDate,\n      signingDate = _c === void 0 ? new Date() : _c,\n      signingRegion = _b.signingRegion,\n      signingService = _b.signingService;\n    return __awaiter(this, void 0, void 0, function () {\n      var credentials, region, _d, shortDate, hash, _e, _f, _g;\n      return __generator(this, function (_h) {\n        switch (_h.label) {\n          case 0:\n            return [4, this.credentialProvider()];\n          case 1:\n            credentials = _h.sent();\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n            _d = signingRegion;\n            return [3, 4];\n          case 2:\n            return [4, this.regionProvider()];\n          case 3:\n            _d = _h.sent();\n            _h.label = 4;\n          case 4:\n            region = _d;\n            shortDate = formatDate(signingDate).shortDate;\n            _f = (_e = this.sha256).bind;\n            return [4, this.getSigningKey(credentials, region, shortDate, signingService)];\n          case 5:\n            hash = new (_f.apply(_e, [void 0, _h.sent()]))();\n            hash.update(stringToSign);\n            _g = toHex;\n            return [4, hash.digest()];\n          case 6:\n            return [2, _g.apply(void 0, [_h.sent()])];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.signRequest = function (requestToSign, _a) {\n    var _b = _a === void 0 ? {} : _a,\n      _c = _b.signingDate,\n      signingDate = _c === void 0 ? new Date() : _c,\n      signableHeaders = _b.signableHeaders,\n      unsignableHeaders = _b.unsignableHeaders,\n      signingRegion = _b.signingRegion,\n      signingService = _b.signingService;\n    return __awaiter(this, void 0, void 0, function () {\n      var credentials, region, _d, request, _e, longDate, shortDate, scope, payloadHash, canonicalHeaders, signature;\n      return __generator(this, function (_f) {\n        switch (_f.label) {\n          case 0:\n            return [4, this.credentialProvider()];\n          case 1:\n            credentials = _f.sent();\n            if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n            _d = signingRegion;\n            return [3, 4];\n          case 2:\n            return [4, this.regionProvider()];\n          case 3:\n            _d = _f.sent();\n            _f.label = 4;\n          case 4:\n            region = _d;\n            request = prepareRequest(requestToSign);\n            _e = formatDate(signingDate), longDate = _e.longDate, shortDate = _e.shortDate;\n            scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n            request.headers[AMZ_DATE_HEADER] = longDate;\n            if (credentials.sessionToken) {\n              request.headers[TOKEN_HEADER] = credentials.sessionToken;\n            }\n            return [4, getPayloadHash(request, this.sha256)];\n          case 5:\n            payloadHash = _f.sent();\n            if (!hasHeader(SHA256_HEADER, request.headers) && this.applyChecksum) {\n              request.headers[SHA256_HEADER] = payloadHash;\n            }\n            canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n            return [4, this.getSignature(longDate, scope, this.getSigningKey(credentials, region, shortDate, signingService), this.createCanonicalRequest(request, canonicalHeaders, payloadHash))];\n          case 6:\n            signature = _f.sent();\n            request.headers[AUTH_HEADER] = ALGORITHM_IDENTIFIER + \" \" + (\"Credential=\" + credentials.accessKeyId + \"/\" + scope + \", \") + (\"SignedHeaders=\" + getCanonicalHeaderList(canonicalHeaders) + \", \") + (\"Signature=\" + signature);\n            return [2, request];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.createCanonicalRequest = function (request, canonicalHeaders, payloadHash) {\n    var sortedHeaders = Object.keys(canonicalHeaders).sort();\n    return request.method + \"\\n\" + this.getCanonicalPath(request) + \"\\n\" + getCanonicalQuery(request) + \"\\n\" + sortedHeaders.map(function (name) {\n      return name + \":\" + canonicalHeaders[name];\n    }).join(\"\\n\") + \"\\n\\n\" + sortedHeaders.join(\";\") + \"\\n\" + payloadHash;\n  };\n  SignatureV4.prototype.createStringToSign = function (longDate, credentialScope, canonicalRequest) {\n    return __awaiter(this, void 0, void 0, function () {\n      var hash, hashedRequest;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            hash = new this.sha256();\n            hash.update(canonicalRequest);\n            return [4, hash.digest()];\n          case 1:\n            hashedRequest = _a.sent();\n            return [2, ALGORITHM_IDENTIFIER + \"\\n\" + longDate + \"\\n\" + credentialScope + \"\\n\" + toHex(hashedRequest)];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.getCanonicalPath = function (_a) {\n    var path = _a.path;\n    if (this.uriEscapePath) {\n      var doubleEncoded = encodeURIComponent(path.replace(/^\\//, \"\"));\n      return \"/\" + doubleEncoded.replace(/%2F/g, \"/\");\n    }\n    return path;\n  };\n  SignatureV4.prototype.getSignature = function (longDate, credentialScope, keyPromise, canonicalRequest) {\n    return __awaiter(this, void 0, void 0, function () {\n      var stringToSign, hash, _a, _b, _c;\n      return __generator(this, function (_d) {\n        switch (_d.label) {\n          case 0:\n            return [4, this.createStringToSign(longDate, credentialScope, canonicalRequest)];\n          case 1:\n            stringToSign = _d.sent();\n            _b = (_a = this.sha256).bind;\n            return [4, keyPromise];\n          case 2:\n            hash = new (_b.apply(_a, [void 0, _d.sent()]))();\n            hash.update(stringToSign);\n            _c = toHex;\n            return [4, hash.digest()];\n          case 3:\n            return [2, _c.apply(void 0, [_d.sent()])];\n        }\n      });\n    });\n  };\n  SignatureV4.prototype.getSigningKey = function (credentials, region, shortDate, service) {\n    return getSigningKey(this.sha256, credentials, shortDate, region, service || this.service);\n  };\n  return SignatureV4;\n}();\nexport { SignatureV4 };\nvar formatDate = function formatDate(now) {\n  var longDate = iso8601(now).replace(/[\\-:]/g, \"\");\n  return {\n    longDate: longDate,\n    shortDate: longDate.substr(0, 8)\n  };\n};\nvar getCanonicalHeaderList = function getCanonicalHeaderList(headers) {\n  return Object.keys(headers).sort().join(\";\");\n};","map":{"version":3,"names":["__awaiter","__generator","toHex","ALGORITHM_IDENTIFIER","ALGORITHM_QUERY_PARAM","AMZ_DATE_HEADER","AMZ_DATE_QUERY_PARAM","AUTH_HEADER","CREDENTIAL_QUERY_PARAM","EVENT_ALGORITHM_IDENTIFIER","EXPIRES_QUERY_PARAM","MAX_PRESIGNED_TTL","SHA256_HEADER","SIGNATURE_QUERY_PARAM","SIGNED_HEADERS_QUERY_PARAM","TOKEN_HEADER","TOKEN_QUERY_PARAM","createScope","getSigningKey","getCanonicalHeaders","getCanonicalQuery","getPayloadHash","hasHeader","moveHeadersToQuery","normalizeCredentialsProvider","normalizeRegionProvider","prepareRequest","iso8601","SignatureV4","_a","applyChecksum","credentials","region","service","sha256","_b","uriEscapePath","regionProvider","credentialProvider","prototype","presign","originalRequest","options","signingDate","expiresIn","unsignableHeaders","unhoistableHeaders","signableHeaders","signingRegion","signingService","_c","_d","longDate","shortDate","scope","request","canonicalHeaders","_e","_f","_g","_h","_j","_k","_l","label","Date","sent","formatDate","Promise","reject","sessionToken","query","accessKeyId","toString","getCanonicalHeaderList","getSignature","createCanonicalRequest","apply","concat","sign","toSign","signString","headers","payload","signEvent","signRequest","priorSignature","hashedPayload","hash","hashedHeaders","stringToSign","body","update","digest","join","bind","requestToSign","payloadHash","signature","sortedHeaders","Object","keys","sort","method","getCanonicalPath","map","name","createStringToSign","credentialScope","canonicalRequest","hashedRequest","path","doubleEncoded","encodeURIComponent","replace","keyPromise","now","substr"],"sources":["/Users/Junhaeng/untitled folder/junior-design/amplifyapp/node_modules/@aws-sdk/client-location/node_modules/@aws-sdk/signature-v4/dist-es/SignatureV4.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { ALGORITHM_IDENTIFIER, ALGORITHM_QUERY_PARAM, AMZ_DATE_HEADER, AMZ_DATE_QUERY_PARAM, AUTH_HEADER, CREDENTIAL_QUERY_PARAM, EVENT_ALGORITHM_IDENTIFIER, EXPIRES_QUERY_PARAM, MAX_PRESIGNED_TTL, SHA256_HEADER, SIGNATURE_QUERY_PARAM, SIGNED_HEADERS_QUERY_PARAM, TOKEN_HEADER, TOKEN_QUERY_PARAM, } from \"./constants\";\nimport { createScope, getSigningKey } from \"./credentialDerivation\";\nimport { getCanonicalHeaders } from \"./getCanonicalHeaders\";\nimport { getCanonicalQuery } from \"./getCanonicalQuery\";\nimport { getPayloadHash } from \"./getPayloadHash\";\nimport { hasHeader } from \"./headerUtil\";\nimport { moveHeadersToQuery } from \"./moveHeadersToQuery\";\nimport { normalizeCredentialsProvider, normalizeRegionProvider } from \"./normalizeProvider\";\nimport { prepareRequest } from \"./prepareRequest\";\nimport { iso8601 } from \"./utilDate\";\nvar SignatureV4 = (function () {\n    function SignatureV4(_a) {\n        var applyChecksum = _a.applyChecksum, credentials = _a.credentials, region = _a.region, service = _a.service, sha256 = _a.sha256, _b = _a.uriEscapePath, uriEscapePath = _b === void 0 ? true : _b;\n        this.service = service;\n        this.sha256 = sha256;\n        this.uriEscapePath = uriEscapePath;\n        this.applyChecksum = typeof applyChecksum === \"boolean\" ? applyChecksum : true;\n        this.regionProvider = normalizeRegionProvider(region);\n        this.credentialProvider = normalizeCredentialsProvider(credentials);\n    }\n    SignatureV4.prototype.presign = function (originalRequest, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, signingDate, _b, expiresIn, unsignableHeaders, unhoistableHeaders, signableHeaders, signingRegion, signingService, credentials, region, _c, _d, longDate, shortDate, scope, request, canonicalHeaders, _e, _f, _g, _h, _j, _k;\n            return __generator(this, function (_l) {\n                switch (_l.label) {\n                    case 0:\n                        _a = options.signingDate, signingDate = _a === void 0 ? new Date() : _a, _b = options.expiresIn, expiresIn = _b === void 0 ? 3600 : _b, unsignableHeaders = options.unsignableHeaders, unhoistableHeaders = options.unhoistableHeaders, signableHeaders = options.signableHeaders, signingRegion = options.signingRegion, signingService = options.signingService;\n                        return [4, this.credentialProvider()];\n                    case 1:\n                        credentials = _l.sent();\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n                        _c = signingRegion;\n                        return [3, 4];\n                    case 2: return [4, this.regionProvider()];\n                    case 3:\n                        _c = (_l.sent());\n                        _l.label = 4;\n                    case 4:\n                        region = _c;\n                        _d = formatDate(signingDate), longDate = _d.longDate, shortDate = _d.shortDate;\n                        if (expiresIn > MAX_PRESIGNED_TTL) {\n                            return [2, Promise.reject(\"Signature version 4 presigned URLs\" + \" must have an expiration date less than one week in\" + \" the future\")];\n                        }\n                        scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n                        request = moveHeadersToQuery(prepareRequest(originalRequest), { unhoistableHeaders: unhoistableHeaders });\n                        if (credentials.sessionToken) {\n                            request.query[TOKEN_QUERY_PARAM] = credentials.sessionToken;\n                        }\n                        request.query[ALGORITHM_QUERY_PARAM] = ALGORITHM_IDENTIFIER;\n                        request.query[CREDENTIAL_QUERY_PARAM] = credentials.accessKeyId + \"/\" + scope;\n                        request.query[AMZ_DATE_QUERY_PARAM] = longDate;\n                        request.query[EXPIRES_QUERY_PARAM] = expiresIn.toString(10);\n                        canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n                        request.query[SIGNED_HEADERS_QUERY_PARAM] = getCanonicalHeaderList(canonicalHeaders);\n                        _e = request.query;\n                        _f = SIGNATURE_QUERY_PARAM;\n                        _g = this.getSignature;\n                        _h = [longDate,\n                            scope,\n                            this.getSigningKey(credentials, region, shortDate, signingService)];\n                        _j = this.createCanonicalRequest;\n                        _k = [request, canonicalHeaders];\n                        return [4, getPayloadHash(originalRequest, this.sha256)];\n                    case 5: return [4, _g.apply(this, _h.concat([_j.apply(this, _k.concat([_l.sent()]))]))];\n                    case 6:\n                        _e[_f] = _l.sent();\n                        return [2, request];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.sign = function (toSign, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (typeof toSign === \"string\") {\n                    return [2, this.signString(toSign, options)];\n                }\n                else if (toSign.headers && toSign.payload) {\n                    return [2, this.signEvent(toSign, options)];\n                }\n                else {\n                    return [2, this.signRequest(toSign, options)];\n                }\n                return [2];\n            });\n        });\n    };\n    SignatureV4.prototype.signEvent = function (_a, _b) {\n        var headers = _a.headers, payload = _a.payload;\n        var _c = _b.signingDate, signingDate = _c === void 0 ? new Date() : _c, priorSignature = _b.priorSignature, signingRegion = _b.signingRegion, signingService = _b.signingService;\n        return __awaiter(this, void 0, void 0, function () {\n            var region, _d, _e, shortDate, longDate, scope, hashedPayload, hash, hashedHeaders, _f, stringToSign;\n            return __generator(this, function (_g) {\n                switch (_g.label) {\n                    case 0:\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 1];\n                        _d = signingRegion;\n                        return [3, 3];\n                    case 1: return [4, this.regionProvider()];\n                    case 2:\n                        _d = (_g.sent());\n                        _g.label = 3;\n                    case 3:\n                        region = _d;\n                        _e = formatDate(signingDate), shortDate = _e.shortDate, longDate = _e.longDate;\n                        scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n                        return [4, getPayloadHash({ headers: {}, body: payload }, this.sha256)];\n                    case 4:\n                        hashedPayload = _g.sent();\n                        hash = new this.sha256();\n                        hash.update(headers);\n                        _f = toHex;\n                        return [4, hash.digest()];\n                    case 5:\n                        hashedHeaders = _f.apply(void 0, [_g.sent()]);\n                        stringToSign = [\n                            EVENT_ALGORITHM_IDENTIFIER,\n                            longDate,\n                            scope,\n                            priorSignature,\n                            hashedHeaders,\n                            hashedPayload,\n                        ].join(\"\\n\");\n                        return [2, this.signString(stringToSign, { signingDate: signingDate, signingRegion: region, signingService: signingService })];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.signString = function (stringToSign, _a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.signingDate, signingDate = _c === void 0 ? new Date() : _c, signingRegion = _b.signingRegion, signingService = _b.signingService;\n        return __awaiter(this, void 0, void 0, function () {\n            var credentials, region, _d, shortDate, hash, _e, _f, _g;\n            return __generator(this, function (_h) {\n                switch (_h.label) {\n                    case 0: return [4, this.credentialProvider()];\n                    case 1:\n                        credentials = _h.sent();\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n                        _d = signingRegion;\n                        return [3, 4];\n                    case 2: return [4, this.regionProvider()];\n                    case 3:\n                        _d = (_h.sent());\n                        _h.label = 4;\n                    case 4:\n                        region = _d;\n                        shortDate = formatDate(signingDate).shortDate;\n                        _f = (_e = this.sha256).bind;\n                        return [4, this.getSigningKey(credentials, region, shortDate, signingService)];\n                    case 5:\n                        hash = new (_f.apply(_e, [void 0, _h.sent()]))();\n                        hash.update(stringToSign);\n                        _g = toHex;\n                        return [4, hash.digest()];\n                    case 6: return [2, _g.apply(void 0, [_h.sent()])];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.signRequest = function (requestToSign, _a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.signingDate, signingDate = _c === void 0 ? new Date() : _c, signableHeaders = _b.signableHeaders, unsignableHeaders = _b.unsignableHeaders, signingRegion = _b.signingRegion, signingService = _b.signingService;\n        return __awaiter(this, void 0, void 0, function () {\n            var credentials, region, _d, request, _e, longDate, shortDate, scope, payloadHash, canonicalHeaders, signature;\n            return __generator(this, function (_f) {\n                switch (_f.label) {\n                    case 0: return [4, this.credentialProvider()];\n                    case 1:\n                        credentials = _f.sent();\n                        if (!(signingRegion !== null && signingRegion !== void 0)) return [3, 2];\n                        _d = signingRegion;\n                        return [3, 4];\n                    case 2: return [4, this.regionProvider()];\n                    case 3:\n                        _d = (_f.sent());\n                        _f.label = 4;\n                    case 4:\n                        region = _d;\n                        request = prepareRequest(requestToSign);\n                        _e = formatDate(signingDate), longDate = _e.longDate, shortDate = _e.shortDate;\n                        scope = createScope(shortDate, region, signingService !== null && signingService !== void 0 ? signingService : this.service);\n                        request.headers[AMZ_DATE_HEADER] = longDate;\n                        if (credentials.sessionToken) {\n                            request.headers[TOKEN_HEADER] = credentials.sessionToken;\n                        }\n                        return [4, getPayloadHash(request, this.sha256)];\n                    case 5:\n                        payloadHash = _f.sent();\n                        if (!hasHeader(SHA256_HEADER, request.headers) && this.applyChecksum) {\n                            request.headers[SHA256_HEADER] = payloadHash;\n                        }\n                        canonicalHeaders = getCanonicalHeaders(request, unsignableHeaders, signableHeaders);\n                        return [4, this.getSignature(longDate, scope, this.getSigningKey(credentials, region, shortDate, signingService), this.createCanonicalRequest(request, canonicalHeaders, payloadHash))];\n                    case 6:\n                        signature = _f.sent();\n                        request.headers[AUTH_HEADER] =\n                            ALGORITHM_IDENTIFIER + \" \" +\n                                (\"Credential=\" + credentials.accessKeyId + \"/\" + scope + \", \") +\n                                (\"SignedHeaders=\" + getCanonicalHeaderList(canonicalHeaders) + \", \") +\n                                (\"Signature=\" + signature);\n                        return [2, request];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.createCanonicalRequest = function (request, canonicalHeaders, payloadHash) {\n        var sortedHeaders = Object.keys(canonicalHeaders).sort();\n        return request.method + \"\\n\" + this.getCanonicalPath(request) + \"\\n\" + getCanonicalQuery(request) + \"\\n\" + sortedHeaders.map(function (name) { return name + \":\" + canonicalHeaders[name]; }).join(\"\\n\") + \"\\n\\n\" + sortedHeaders.join(\";\") + \"\\n\" + payloadHash;\n    };\n    SignatureV4.prototype.createStringToSign = function (longDate, credentialScope, canonicalRequest) {\n        return __awaiter(this, void 0, void 0, function () {\n            var hash, hashedRequest;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        hash = new this.sha256();\n                        hash.update(canonicalRequest);\n                        return [4, hash.digest()];\n                    case 1:\n                        hashedRequest = _a.sent();\n                        return [2, ALGORITHM_IDENTIFIER + \"\\n\" + longDate + \"\\n\" + credentialScope + \"\\n\" + toHex(hashedRequest)];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.getCanonicalPath = function (_a) {\n        var path = _a.path;\n        if (this.uriEscapePath) {\n            var doubleEncoded = encodeURIComponent(path.replace(/^\\//, \"\"));\n            return \"/\" + doubleEncoded.replace(/%2F/g, \"/\");\n        }\n        return path;\n    };\n    SignatureV4.prototype.getSignature = function (longDate, credentialScope, keyPromise, canonicalRequest) {\n        return __awaiter(this, void 0, void 0, function () {\n            var stringToSign, hash, _a, _b, _c;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4, this.createStringToSign(longDate, credentialScope, canonicalRequest)];\n                    case 1:\n                        stringToSign = _d.sent();\n                        _b = (_a = this.sha256).bind;\n                        return [4, keyPromise];\n                    case 2:\n                        hash = new (_b.apply(_a, [void 0, _d.sent()]))();\n                        hash.update(stringToSign);\n                        _c = toHex;\n                        return [4, hash.digest()];\n                    case 3: return [2, _c.apply(void 0, [_d.sent()])];\n                }\n            });\n        });\n    };\n    SignatureV4.prototype.getSigningKey = function (credentials, region, shortDate, service) {\n        return getSigningKey(this.sha256, credentials, shortDate, region, service || this.service);\n    };\n    return SignatureV4;\n}());\nexport { SignatureV4 };\nvar formatDate = function (now) {\n    var longDate = iso8601(now).replace(/[\\-:]/g, \"\");\n    return {\n        longDate: longDate,\n        shortDate: longDate.substr(0, 8),\n    };\n};\nvar getCanonicalHeaderList = function (headers) { return Object.keys(headers).sort().join(\";\"); };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}