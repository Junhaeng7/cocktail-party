{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n  return r;\n};\nimport { r as registerInstance, h, c as createEvent, H as Host, g as getElement } from './index-83f2275b.js';\nimport { Logger, browserOrNode, I18n } from '@aws-amplify/core';\nimport '@aws-amplify/auth';\nimport { T as Translations } from './Translations-108d469f.js';\nimport { c as NO_INTERACTIONS_MODULE_FOUND } from './constants-c8ecaa24.js';\nimport { Interactions } from '@aws-amplify/interactions';\n// AudioRecorder settings\nvar RECORDER_EXPORT_MIME_TYPE = 'application/octet-stream';\nvar DEFAULT_EXPORT_SAMPLE_RATE = 16000;\nvar FFT_SIZE = 2048; // window size in samples for Fast Fourier Transform (FFT)\nvar FFT_MAX_DECIBELS = -10; // maximum power value in the scaling range for the FFT analysis data\nvar FFT_MIN_DECIBELS = -90; // minimum power value in the scaling range for the FFT analysis data\nvar FFT_SMOOTHING_TIME_CONSTANT = 0.85; // averaging constant with the last analysis frame\n/**\n * Merges multiple buffers into one.\n */\nvar mergeBuffers = function mergeBuffers(bufferArray, recLength) {\n  var result = new Float32Array(recLength);\n  var offset = 0;\n  for (var i = 0; i < bufferArray.length; i++) {\n    result.set(bufferArray[i], offset);\n    offset += bufferArray[i].length;\n  }\n  return result;\n};\n/**\n * Downsamples audio to desired export sample rate.\n */\nvar downsampleBuffer = function downsampleBuffer(buffer, recordSampleRate, exportSampleRate) {\n  if (exportSampleRate === recordSampleRate) {\n    return buffer;\n  }\n  var sampleRateRatio = recordSampleRate / exportSampleRate;\n  var newLength = Math.round(buffer.length / sampleRateRatio);\n  var result = new Float32Array(newLength);\n  var offsetResult = 0;\n  var offsetBuffer = 0;\n  while (offsetResult < result.length) {\n    var nextOffsetBuffer = Math.round((offsetResult + 1) * sampleRateRatio);\n    var accum = 0,\n      count = 0;\n    for (var i = offsetBuffer; i < nextOffsetBuffer && i < buffer.length; i++) {\n      accum += buffer[i];\n      count++;\n    }\n    result[offsetResult] = accum / count;\n    offsetResult++;\n    offsetBuffer = nextOffsetBuffer;\n  }\n  return result;\n};\n/**\n * converts raw audio values to 16 bit pcm.\n */\nvar floatTo16BitPCM = function floatTo16BitPCM(output, offset, input) {\n  var byteOffset = offset;\n  for (var i = 0; i < input.length; i++, byteOffset += 2) {\n    var s = Math.max(-1, Math.min(1, input[i]));\n    output.setInt16(byteOffset, s < 0 ? s * 0x8000 : s * 0x7fff, true);\n  }\n};\n/**\n * Write given strings in big-endian order.\n */\nvar writeString = function writeString(view, offset, string) {\n  for (var i = 0; i < string.length; i++) {\n    view.setUint8(offset + i, string.charCodeAt(i));\n  }\n};\n/**\n * Encodes raw pcm audio into a wav file.\n */\nvar encodeWAV = function encodeWAV(samples, exportSampleRate) {\n  /**\n   * WAV file consists of three parts: RIFF header, WAVE subchunk, and data subchunk. We precompute the size of them.\n   */\n  var audioSize = samples.length * 2; // We use 16-bit samples, so we have (2 * sampleLength) bytes.\n  var fmtSize = 24; // Byte size of the fmt subchunk: 24 bytes that the audio information that we'll set below.\n  var dataSize = 8 + audioSize; // Byte size of the data subchunk: raw sound data plus 8 bytes for the subchunk descriptions.\n  var totalByteSize = 12 + fmtSize + dataSize; // Byte size of the whole file, including the chunk header / descriptor.\n  // create DataView object to write byte values into\n  var buffer = new ArrayBuffer(totalByteSize); // buffer to write the chunk values in.\n  var view = new DataView(buffer);\n  /**\n   * Start writing the .wav file. We write top to bottom, so byte offset (first numeric argument) increases strictly.\n   */\n  // RIFF header\n  writeString(view, 0, 'RIFF'); // At offset 0, write the letters \"RIFF\"\n  view.setUint32(4, fmtSize + dataSize, true); // At offset 4, write the size of fmt and data chunk size combined.\n  writeString(view, 8, 'WAVE'); // At offset 8, write the format type \"WAVE\"\n  // fmt subchunk\n  writeString(view, 12, 'fmt '); //chunkdId 'fmt '\n  view.setUint32(16, fmtSize - 8, true); // fmt subchunk size below this value. We set 8 bytes already, so subtract 8 bytes from fmtSize.\n  view.setUint16(20, 1, true); // Audio format code, which is 1 for PCM.\n  view.setUint16(22, 1, true); // Number of audio channels. We use mono, ie 1.\n  view.setUint32(24, exportSampleRate, true); // Sample rate of the audio file.\n  view.setUint32(28, exportSampleRate * 2, true); // Data rate, or # of data bytes per second. Since each sample is 2 bytes, this is 2 * sampleRate.\n  view.setUint16(32, 2, true); // block align, # of bytes per sample including all channels, ie. 2 bytes.\n  view.setUint16(34, 16, true); // bits per sample, ie. 16 bits\n  // data subchunk\n  writeString(view, 36, 'data'); // write the chunkId 'data'\n  view.setUint32(40, audioSize, true); // Audio byte size\n  floatTo16BitPCM(view, 44, samples); // raw pcm values then go here.\n  return view;\n};\n/**\n * Given arrays of raw pcm audio, downsamples the audio to desired sample rate and encodes it to a wav audio file.\n *\n * @param recBuffer {Float32Array[]} - 2d float array containing the recorded raw audio\n * @param recLength {number} - total length of recorded audio\n * @param recordSampleRate {number} - sample rate of the recorded audio\n * @param exportSampleRate {number} - desired sample rate of the exported file\n */\nvar exportBuffer = function exportBuffer(recBuffer, recLength, recordSampleRate, exportSampleRate) {\n  var mergedBuffers = mergeBuffers(recBuffer, recLength);\n  var downsampledBuffer = downsampleBuffer(mergedBuffers, recordSampleRate, exportSampleRate);\n  var encodedWav = encodeWAV(downsampledBuffer, exportSampleRate);\n  var audioBlob = new Blob([encodedWav], {\n    type: RECORDER_EXPORT_MIME_TYPE\n  });\n  return audioBlob;\n};\nvar logger = new Logger('AudioRecorder');\nvar AudioRecorder = /** @class */function () {\n  function AudioRecorder(options) {\n    // input mic stream is stored in a buffer\n    this.streamBuffer = [];\n    this.streamBufferLength = 0;\n    this.recording = false;\n    this.options = options;\n  }\n  /**\n   * This must be called first to enable audio context and request microphone access.\n   * Once access granted, it connects all the necessary audio nodes to the context so that it can begin recording or playing.\n   */\n  AudioRecorder.prototype.init = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!browserOrNode().isBrowser) return [3 /*break*/, 2];\n            window.AudioContext = window.AudioContext || window.webkitAudioContext;\n            this.audioContext = new AudioContext();\n            return [4 /*yield*/, navigator.mediaDevices.getUserMedia({\n              audio: true\n            }).then(function (stream) {\n              _this.audioSupported = true;\n              _this.setupAudioNodes(stream);\n            }).catch(function () {\n              _this.audioSupported = false;\n              return Promise.reject('Audio is not supported');\n            })];\n          case 1:\n            _a.sent();\n            return [3 /*break*/, 3];\n          case 2:\n            this.audioSupported = false;\n            return [2 /*return*/, Promise.reject('Audio is not supported')];\n          case 3:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\n   * Setup audio nodes after successful `init`.\n   */\n  AudioRecorder.prototype.setupAudioNodes = function (stream) {\n    return __awaiter(this, void 0, void 0, function () {\n      var err_1, sourceNode, processorNode, analyserNode;\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 2,, 3]);\n            return [4 /*yield*/, this.audioContext.resume()];\n          case 1:\n            _a.sent();\n            return [3 /*break*/, 3];\n          case 2:\n            err_1 = _a.sent();\n            logger.error(err_1);\n            return [3 /*break*/, 3];\n          case 3:\n            sourceNode = this.audioContext.createMediaStreamSource(stream);\n            processorNode = this.audioContext.createScriptProcessor(4096, 1, 1);\n            processorNode.onaudioprocess = function (audioProcessingEvent) {\n              if (!_this.recording) return;\n              var stream = audioProcessingEvent.inputBuffer.getChannelData(0);\n              _this.streamBuffer.push(new Float32Array(stream)); // set to a copy of the stream\n              _this.streamBufferLength += stream.length;\n              _this.analyse();\n            };\n            analyserNode = this.audioContext.createAnalyser();\n            analyserNode.minDecibels = FFT_MIN_DECIBELS;\n            analyserNode.maxDecibels = FFT_MAX_DECIBELS;\n            analyserNode.smoothingTimeConstant = FFT_SMOOTHING_TIME_CONSTANT;\n            sourceNode.connect(analyserNode);\n            analyserNode.connect(processorNode);\n            processorNode.connect(sourceNode.context.destination);\n            this.analyserNode = analyserNode;\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\n   * Start recording audio and listen for silence.\n   *\n   * @param onSilence {SilenceHandler} - called whenever silence is detected\n   * @param visualizer {Visualizer} - called with audio data on each audio process to be used for visualization.\n   */\n  AudioRecorder.prototype.startRecording = function (onSilence, visualizer) {\n    return __awaiter(this, void 0, void 0, function () {\n      var context, err_2;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (this.recording || !this.audioSupported) return [2 /*return*/];\n            this.onSilence = onSilence || function () {};\n            this.visualizer = visualizer || function () {};\n            context = this.audioContext;\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n            return [4 /*yield*/, context.resume()];\n          case 2:\n            _a.sent();\n            return [3 /*break*/, 4];\n          case 3:\n            err_2 = _a.sent();\n            logger.error(err_2);\n            return [3 /*break*/, 4];\n          case 4:\n            this.start = Date.now();\n            this.recording = true;\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\n   * Pause recording\n   */\n  AudioRecorder.prototype.stopRecording = function () {\n    if (!this.audioSupported) return;\n    this.recording = false;\n  };\n  /**\n   * Pause recording and clear audio buffer\n   */\n  AudioRecorder.prototype.clear = function () {\n    this.stopRecording();\n    this.streamBufferLength = 0;\n    this.streamBuffer = [];\n  };\n  /**\n   * Plays given audioStream with audioContext\n   *\n   * @param buffer {Uint8Array} - audioStream to be played\n   */\n  AudioRecorder.prototype.play = function (buffer) {\n    var _this = this;\n    if (!buffer || !this.audioSupported) return;\n    var myBlob = new Blob([buffer]);\n    return new Promise(function (res, rej) {\n      var fileReader = new FileReader();\n      fileReader.onload = function () {\n        if (_this.playbackSource) _this.playbackSource.disconnect(); // disconnect previous playback source\n        _this.playbackSource = _this.audioContext.createBufferSource();\n        var successCallback = function successCallback(buf) {\n          _this.playbackSource.buffer = buf;\n          _this.playbackSource.connect(_this.audioContext.destination);\n          _this.playbackSource.onended = function () {\n            return res();\n          };\n          _this.playbackSource.start(0);\n        };\n        var errorCallback = function errorCallback(err) {\n          return rej(err);\n        };\n        _this.audioContext.decodeAudioData(fileReader.result, successCallback, errorCallback);\n      };\n      fileReader.onerror = function () {\n        return rej();\n      };\n      fileReader.readAsArrayBuffer(myBlob);\n    });\n  };\n  /**\n   * Stops playing audio if there's a playback source connected.\n   */\n  AudioRecorder.prototype.stop = function () {\n    if (this.playbackSource) {\n      this.playbackSource.stop();\n    }\n  };\n  /**\n   * Called after each audioProcess. Check for silence and give fft time domain data to visualizer.\n   */\n  AudioRecorder.prototype.analyse = function () {\n    if (!this.audioSupported) return;\n    var analyser = this.analyserNode;\n    analyser.fftSize = FFT_SIZE;\n    var bufferLength = analyser.fftSize;\n    var dataArray = new Uint8Array(bufferLength);\n    var amplitude = this.options.amplitude;\n    var time = this.options.time;\n    analyser.getByteTimeDomainData(dataArray);\n    this.visualizer(dataArray, bufferLength);\n    for (var i = 0; i < bufferLength; i++) {\n      // Normalize between -1 and 1.\n      var curr_value_time = dataArray[i] / 128 - 1.0;\n      if (curr_value_time > amplitude || curr_value_time < -1 * amplitude) {\n        this.start = Date.now();\n      }\n    }\n    var newtime = Date.now();\n    var elapsedTime = newtime - this.start;\n    if (elapsedTime > time) {\n      this.onSilence();\n    }\n  };\n  /**\n   * Encodes recorded buffer to a wav file and exports it to a blob.\n   *\n   * @param exportSampleRate {number} - desired sample rate of the exported buffer\n   */\n  AudioRecorder.prototype.exportWAV = function (exportSampleRate) {\n    if (exportSampleRate === void 0) {\n      exportSampleRate = DEFAULT_EXPORT_SAMPLE_RATE;\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var recordSampleRate, blob;\n      return __generator(this, function (_a) {\n        if (!this.audioSupported) return [2 /*return*/];\n        recordSampleRate = this.audioContext.sampleRate;\n        blob = exportBuffer(this.streamBuffer, this.streamBufferLength, recordSampleRate, exportSampleRate);\n        this.clear();\n        return [2 /*return*/, blob];\n      });\n    });\n  };\n  return AudioRecorder;\n}();\nvar visualize = function visualize(dataArray, bufferLength, canvas) {\n  if (!canvas) return;\n  if (!browserOrNode().isBrowser) throw new Error('Visualization is not supported on non-browsers.');\n  var _a = canvas.getBoundingClientRect(),\n    width = _a.width,\n    height = _a.height;\n  // need to update the default canvas width and height\n  canvas.width = width;\n  canvas.height = height;\n  var canvasCtx = canvas.getContext('2d');\n  canvasCtx.fillStyle = 'white';\n  canvasCtx.clearRect(0, 0, width, height);\n  var draw = function draw() {\n    canvasCtx.fillRect(0, 0, width, height);\n    canvasCtx.lineWidth = 1;\n    var color = getComputedStyle(document.documentElement).getPropertyValue('--amplify-primary-color');\n    canvasCtx.strokeStyle = !color || color === '' ? '#ff9900' : color; // TODO: try separate css variable\n    canvasCtx.beginPath();\n    var sliceWidth = width * 1.0 / bufferLength;\n    var x = 0;\n    for (var i = 0; i < bufferLength || i % 3 === 0; i++) {\n      var value = dataArray[i] / 128.0;\n      var y = value * height / 2;\n      if (i === 0) {\n        canvasCtx.moveTo(x, y);\n      } else {\n        canvasCtx.lineTo(x, y);\n      }\n      x += sliceWidth;\n    }\n    canvasCtx.lineTo(canvas.width, canvas.height / 2);\n    canvasCtx.stroke();\n  };\n  // Register our draw function with requestAnimationFrame.\n  requestAnimationFrame(draw);\n};\nvar amplifyChatbotCss = \".bot .dot{background-color:var(--bot-dot-color)}.user .dot{background-color:var(--user-dot-color)}.dot-flashing{width:2.625rem}.dot-flashing .dot{display:inline-block;width:0.625rem;height:0.625rem;border-radius:10rem;opacity:0.65}.dot-flashing .left{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:0s;animation-delay:0s}.dot-flashing .middle{margin-left:0.375rem;margin-right:0.375rem;-webkit-animation:dot-flashing 1s infinite linear alternate;animation:dot-flashing 1s infinite linear alternate;-webkit-animation-delay:0.5s;animation-delay:0.5s}.dot-flashing .right{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:1s;animation-delay:1s}@-webkit-keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}@keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}:host{--width:28.75rem;--height:37.5rem;--header-color:var(--amplify-secondary-color);--header-size:var(--amplify-text-lg);--bot-background-color:rgb(230, 230, 230);--bot-text-color:black;--bot-dot-color:var(--bot-text-color);--user-background-color:var(--amplify-blue);--user-text-color:var(--amplify-white);--user-dot-color:var(--user-text-color)}.amplify-chatbot{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column;background-color:var(--background-color);border-radius:0.375rem;-webkit-box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);-webkit-box-sizing:border-box;box-sizing:border-box;font-family:var(--amplify-font-family);margin-bottom:1rem;width:100%;height:var(--height);max-width:var(--width)}@media (min-width: 672px){.amplify-chatbot{width:var(--width)}}.header{padding:1.25rem 0.375rem 1.25rem 0.375rem;color:var(--header-color);font-size:var(--header-size);font-weight:bold;text-align:center;word-wrap:break-word}.body{border-top:0.0625rem solid rgba(0, 0, 0, 0.05);padding:1.5rem 1rem 0 1rem;display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-direction:column;flex-direction:column;overflow:auto}.bubble{max-width:100%;padding:0.8em 1.4em;text-align:left;word-wrap:break-word;margin-bottom:0.625rem}.bot{margin-right:auto;background-color:var(--bot-background-color);color:var(--bot-text-color);border-radius:1.5rem 1.5rem 1.5rem 0}.user{margin-left:auto;background-color:var(--user-background-color);color:var(--user-text-color);border-radius:1.5rem 1.5rem 0 1.5rem}.footer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-top:0.062rem solid rgba(0, 0, 0, 0.05);padding-right:0.625rem;min-height:3.125rem}.footer amplify-input{--border:none;--margin:0;-ms-flex-positive:1;flex-grow:1}canvas{margin-left:0.625rem;margin-right:0.625rem;-ms-flex-positive:1;flex-grow:1;height:3.125rem}.icon-button{--icon-height:1.25rem;--icon-fill:var(--amplify-primary-color);--padding:0.625rem;--width:auto}\";\n// enum for possible bot states\nvar ChatState;\n(function (ChatState) {\n  ChatState[ChatState[\"Initial\"] = 0] = \"Initial\";\n  ChatState[ChatState[\"Listening\"] = 1] = \"Listening\";\n  ChatState[ChatState[\"SendingText\"] = 2] = \"SendingText\";\n  ChatState[ChatState[\"SendingVoice\"] = 3] = \"SendingVoice\";\n  ChatState[ChatState[\"Error\"] = 4] = \"Error\";\n})(ChatState || (ChatState = {}));\n// Message types\nvar MessageFrom;\n(function (MessageFrom) {\n  MessageFrom[\"Bot\"] = \"bot\";\n  MessageFrom[\"User\"] = \"user\";\n})(MessageFrom || (MessageFrom = {}));\n// Error types\nvar ChatErrorType;\n(function (ChatErrorType) {\n  ChatErrorType[ChatErrorType[\"Recoverable\"] = 0] = \"Recoverable\";\n  ChatErrorType[ChatErrorType[\"Unrecoverable\"] = 1] = \"Unrecoverable\";\n})(ChatErrorType || (ChatErrorType = {}));\nvar AmplifyChatbot = /** @class */function () {\n  function class_1(hostRef) {\n    var _this = this;\n    registerInstance(this, hostRef);\n    /** Clear messages when conversation finishes */\n    this.clearOnComplete = false;\n    /** Continue listening to users after they send the message */\n    this.conversationModeOn = false;\n    /** Text placed in the top header */\n    this.botTitle = Translations.CHATBOT_TITLE;\n    /** Whether voice chat is enabled */\n    this.voiceEnabled = false;\n    /** Whether text chat is enabled */\n    this.textEnabled = true;\n    /** Amount of silence (in ms) to wait for */\n    this.silenceTime = 1500;\n    /** Noise threshold between -1 and 1. Anything below is considered a silence. */\n    this.silenceThreshold = 0.2;\n    /** Messages in current session */\n    this.messages = [];\n    /** Text input box value  */\n    this.text = '';\n    /** Current app state */\n    this.chatState = ChatState.Initial;\n    /**\n     * Rendering methods\n     */\n    this.messageJSX = function (messages) {\n      var messageList = messages.map(function (message) {\n        return h(\"div\", {\n          class: \"bubble \" + message.from\n        }, message.content);\n      });\n      if (_this.chatState === ChatState.SendingText || _this.chatState === ChatState.SendingVoice) {\n        // if waiting for voice message, show animation on user side because app is waiting for transcript. Else put it on bot side.\n        var client = _this.chatState === ChatState.SendingText ? MessageFrom.Bot : MessageFrom.User;\n        messageList.push(h(\"div\", {\n          class: \"bubble \" + client\n        }, h(\"div\", {\n          class: \"dot-flashing \" + client\n        }, h(\"span\", {\n          class: \"dot left\"\n        }), h(\"span\", {\n          class: \"dot middle\"\n        }), h(\"span\", {\n          class: \"dot right\"\n        }))));\n      }\n      return messageList;\n    };\n    this.chatCompleted = createEvent(this, \"chatCompleted\", 7);\n  }\n  // Occurs when user presses enter in input box\n  class_1.prototype.submitHandler = function (_event) {\n    this.sendTextMessage();\n  };\n  /**\n   * Lifecycle functions\n   */\n  class_1.prototype.componentWillLoad = function () {\n    if (!Interactions || typeof Interactions.onComplete !== 'function') {\n      throw new Error(NO_INTERACTIONS_MODULE_FOUND);\n    }\n    this.validateProps();\n  };\n  class_1.prototype.componentDidRender = function () {\n    // scroll to the bottom if necessary\n    var body = this.element.shadowRoot.querySelector('.body');\n    body.scrollTop = body.scrollHeight;\n  };\n  class_1.prototype.validateProps = function () {\n    var _this = this;\n    if (!this.voiceEnabled && !this.textEnabled) {\n      this.setError(Translations.CHAT_DISABLED_ERROR, ChatErrorType.Unrecoverable);\n      return;\n    } else if (!this.botName) {\n      this.setError(Translations.NO_BOT_NAME_ERROR, ChatErrorType.Unrecoverable);\n      return;\n    }\n    if (this.welcomeMessage) this.appendToChat(this.welcomeMessage, MessageFrom.Bot);\n    // Initialize AudioRecorder if voice is enabled\n    if (this.voiceEnabled) {\n      this.audioRecorder = new AudioRecorder({\n        time: this.silenceTime,\n        amplitude: this.silenceThreshold\n      });\n      this.audioRecorder.init().catch(function (err) {\n        _this.setError(err, ChatErrorType.Recoverable);\n      });\n    }\n    // Callback function to be called after chat is completed\n    var onComplete = function onComplete(err, data) {\n      _this.chatCompleted.emit({\n        data: data,\n        err: err\n      });\n      if (_this.clearOnComplete) {\n        _this.reset();\n      } else {\n        _this.chatState = ChatState.Initial;\n      }\n    };\n    try {\n      Interactions.onComplete(this.botName, onComplete);\n    } catch (err) {\n      this.setError(err, ChatErrorType.Unrecoverable);\n    }\n  };\n  /**\n   * Handlers\n   */\n  class_1.prototype.handleSubmit = function (event) {\n    event.preventDefault();\n    this.sendTextMessage();\n  };\n  class_1.prototype.handleMicButton = function () {\n    var _this = this;\n    if (this.chatState !== ChatState.Initial) return;\n    this.audioRecorder.stop();\n    this.chatState = ChatState.Listening;\n    this.audioRecorder.startRecording(function () {\n      return _this.handleSilence();\n    }, function (data, length) {\n      return _this.visualizer(data, length);\n    });\n  };\n  class_1.prototype.handleSilence = function () {\n    var _this = this;\n    this.chatState = ChatState.SendingVoice;\n    this.audioRecorder.stopRecording();\n    this.audioRecorder.exportWAV().then(function (blob) {\n      _this.sendVoiceMessage(blob);\n    });\n  };\n  class_1.prototype.handleTextChange = function (event) {\n    var target = event.target;\n    this.text = target.value;\n  };\n  class_1.prototype.handleCancelButton = function () {\n    this.audioRecorder.clear();\n    this.chatState = ChatState.Initial;\n  };\n  class_1.prototype.handleToastClose = function (errorType) {\n    this.error = undefined; // clear error\n    // if error is recoverable, reset the app state to initial\n    if (errorType === ChatErrorType.Recoverable) {\n      this.chatState = ChatState.Initial;\n    }\n  };\n  /**\n   * Visualization\n   */\n  class_1.prototype.visualizer = function (dataArray, bufferLength) {\n    var canvas = this.element.shadowRoot.querySelector('canvas');\n    visualize(dataArray, bufferLength, canvas);\n  };\n  /**\n   * Interactions helpers\n   */\n  class_1.prototype.sendTextMessage = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var text, response, err_3;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (this.text.length === 0 || this.chatState !== ChatState.Initial) return [2 /*return*/];\n            text = this.text;\n            this.text = '';\n            this.appendToChat(text, MessageFrom.User);\n            this.chatState = ChatState.SendingText;\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n            return [4 /*yield*/, Interactions.send(this.botName, text)];\n          case 2:\n            response = _a.sent();\n            return [3 /*break*/, 4];\n          case 3:\n            err_3 = _a.sent();\n            this.setError(err_3, ChatErrorType.Recoverable);\n            return [2 /*return*/];\n          case 4:\n            if (response.message) {\n              this.appendToChat(response.message, MessageFrom.Bot);\n            }\n            this.chatState = ChatState.Initial;\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  class_1.prototype.sendVoiceMessage = function (audioInput) {\n    return __awaiter(this, void 0, void 0, function () {\n      var interactionsMessage, response, err_4, dialogState;\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            interactionsMessage = {\n              content: audioInput,\n              options: {\n                messageType: 'voice'\n              }\n            };\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n            return [4 /*yield*/, Interactions.send(this.botName, interactionsMessage)];\n          case 2:\n            response = _a.sent();\n            return [3 /*break*/, 4];\n          case 3:\n            err_4 = _a.sent();\n            this.setError(err_4, ChatErrorType.Recoverable);\n            return [2 /*return*/];\n          case 4:\n            this.chatState = ChatState.Initial;\n            dialogState = response.dialogState;\n            if (response.inputTranscript) this.appendToChat(response.inputTranscript, MessageFrom.User);\n            this.appendToChat(response.message, MessageFrom.Bot);\n            return [4 /*yield*/, this.audioRecorder.play(response.audioStream).then(function () {\n              // if conversationMode is on, chat is incomplete, and mic button isn't pressed yet, resume listening.\n              if (_this.conversationModeOn && dialogState !== 'Fulfilled' && dialogState !== 'Failed' && _this.chatState === ChatState.Initial) {\n                _this.handleMicButton();\n              }\n            }).catch(function (err) {\n              return _this.setError(err, ChatErrorType.Recoverable);\n            })];\n          case 5:\n            _a.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  class_1.prototype.appendToChat = function (content, from) {\n    this.messages = __spreadArrays(this.messages, [{\n      content: content,\n      from: from\n    }]);\n  };\n  /**\n   * State control methods\n   */\n  class_1.prototype.setError = function (error, errorType) {\n    var message = typeof error === 'string' ? error : error.message;\n    this.chatState = ChatState.Error;\n    this.error = {\n      message: message,\n      errorType: errorType\n    };\n  };\n  class_1.prototype.reset = function () {\n    this.chatState = ChatState.Initial;\n    this.text = '';\n    this.error = undefined;\n    this.messages = [];\n    if (this.welcomeMessage) this.appendToChat(this.welcomeMessage, MessageFrom.Bot);\n    this.audioRecorder && this.audioRecorder.clear();\n  };\n  class_1.prototype.listeningFooterJSX = function () {\n    var _this = this;\n    var visualization = h(\"canvas\", {\n      height: \"50\"\n    });\n    var cancelButton = h(\"amplify-button\", {\n      \"data-test\": \"chatbot-cancel-button\",\n      handleButtonClick: function handleButtonClick() {\n        return _this.handleCancelButton();\n      },\n      class: \"icon-button\",\n      variant: \"icon\",\n      icon: \"ban\"\n    });\n    return [visualization, cancelButton];\n  };\n  class_1.prototype.footerJSX = function () {\n    var _this = this;\n    if (this.chatState === ChatState.Listening) return this.listeningFooterJSX();\n    var inputPlaceholder = this.textEnabled ? Translations.TEXT_INPUT_PLACEHOLDER : Translations.VOICE_INPUT_PLACEHOLDER;\n    var textInput = h(\"amplify-input\", {\n      placeholder: I18n.get(inputPlaceholder),\n      description: \"text\",\n      handleInputChange: function handleInputChange(evt) {\n        return _this.handleTextChange(evt);\n      },\n      value: this.text,\n      disabled: this.chatState === ChatState.Error || !this.textEnabled\n    });\n    var micButton = this.voiceEnabled && h(\"amplify-button\", {\n      \"data-test\": \"chatbot-mic-button\",\n      handleButtonClick: function handleButtonClick() {\n        return _this.handleMicButton();\n      },\n      class: \"icon-button\",\n      variant: \"icon\",\n      icon: \"microphone\",\n      disabled: this.chatState === ChatState.Error || this.chatState !== ChatState.Initial\n    });\n    var sendButton = this.textEnabled && h(\"amplify-button\", {\n      \"data-test\": \"chatbot-send-button\",\n      class: \"icon-button\",\n      variant: \"icon\",\n      icon: \"send\",\n      handleButtonClick: function handleButtonClick() {\n        return _this.sendTextMessage();\n      },\n      disabled: this.chatState === ChatState.Error || this.chatState !== ChatState.Initial\n    });\n    return [textInput, micButton, sendButton];\n  };\n  class_1.prototype.errorToast = function () {\n    var _this = this;\n    if (!this.error) return;\n    var _a = this.error,\n      message = _a.message,\n      errorType = _a.errorType;\n    return h(\"amplify-toast\", {\n      message: I18n.get(message),\n      handleClose: function handleClose() {\n        return _this.handleToastClose(errorType);\n      }\n    });\n  };\n  class_1.prototype.render = function () {\n    var _this = this;\n    return h(Host, null, h(\"div\", {\n      class: \"amplify-chatbot\"\n    }, h(\"slot\", {\n      name: \"header\"\n    }, h(\"div\", {\n      class: \"header\",\n      \"data-test\": \"chatbot-header\"\n    }, I18n.get(this.botTitle))), h(\"div\", {\n      class: \"body\",\n      \"data-test\": \"chatbot-body\"\n    }, this.messageJSX(this.messages)), h(\"form\", {\n      onSubmit: function onSubmit(e) {\n        return _this.handleSubmit(e);\n      }\n    }, h(\"div\", {\n      class: \"footer\",\n      \"data-test\": \"chatbot-footer\"\n    }, this.footerJSX())), this.errorToast()));\n  };\n  Object.defineProperty(class_1.prototype, \"element\", {\n    get: function get() {\n      return getElement(this);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return class_1;\n}();\nAmplifyChatbot.style = amplifyChatbotCss;\nexport { AmplifyChatbot as amplify_chatbot };","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","__spreadArrays","s","i","il","arguments","r","Array","k","a","j","jl","registerInstance","h","c","createEvent","H","Host","getElement","Logger","browserOrNode","I18n","T","Translations","NO_INTERACTIONS_MODULE_FOUND","Interactions","RECORDER_EXPORT_MIME_TYPE","DEFAULT_EXPORT_SAMPLE_RATE","FFT_SIZE","FFT_MAX_DECIBELS","FFT_MIN_DECIBELS","FFT_SMOOTHING_TIME_CONSTANT","mergeBuffers","bufferArray","recLength","Float32Array","offset","set","downsampleBuffer","buffer","recordSampleRate","exportSampleRate","sampleRateRatio","newLength","Math","round","offsetResult","offsetBuffer","nextOffsetBuffer","accum","count","floatTo16BitPCM","output","input","byteOffset","max","min","setInt16","writeString","view","string","setUint8","charCodeAt","encodeWAV","samples","audioSize","fmtSize","dataSize","totalByteSize","ArrayBuffer","DataView","setUint32","setUint16","exportBuffer","recBuffer","mergedBuffers","downsampledBuffer","encodedWav","audioBlob","Blob","type","logger","AudioRecorder","options","streamBuffer","streamBufferLength","recording","prototype","init","_this","_a","isBrowser","window","AudioContext","webkitAudioContext","audioContext","navigator","mediaDevices","getUserMedia","audio","stream","audioSupported","setupAudioNodes","catch","err_1","sourceNode","processorNode","analyserNode","resume","error","createMediaStreamSource","createScriptProcessor","onaudioprocess","audioProcessingEvent","inputBuffer","getChannelData","analyse","createAnalyser","minDecibels","maxDecibels","smoothingTimeConstant","connect","context","destination","startRecording","onSilence","visualizer","err_2","start","Date","now","stopRecording","clear","play","myBlob","res","rej","fileReader","FileReader","onload","playbackSource","disconnect","createBufferSource","successCallback","buf","onended","errorCallback","err","decodeAudioData","onerror","readAsArrayBuffer","stop","analyser","fftSize","bufferLength","dataArray","Uint8Array","amplitude","time","getByteTimeDomainData","curr_value_time","newtime","elapsedTime","exportWAV","blob","sampleRate","visualize","canvas","Error","getBoundingClientRect","width","height","canvasCtx","getContext","fillStyle","clearRect","draw","fillRect","lineWidth","color","getComputedStyle","document","documentElement","getPropertyValue","strokeStyle","beginPath","sliceWidth","x","moveTo","lineTo","stroke","requestAnimationFrame","amplifyChatbotCss","ChatState","MessageFrom","ChatErrorType","AmplifyChatbot","class_1","hostRef","clearOnComplete","conversationModeOn","botTitle","CHATBOT_TITLE","voiceEnabled","textEnabled","silenceTime","silenceThreshold","messages","text","chatState","Initial","messageJSX","messageList","map","message","class","from","content","SendingText","SendingVoice","client","Bot","User","chatCompleted","submitHandler","_event","sendTextMessage","componentWillLoad","onComplete","validateProps","componentDidRender","element","shadowRoot","querySelector","scrollTop","scrollHeight","setError","CHAT_DISABLED_ERROR","Unrecoverable","botName","NO_BOT_NAME_ERROR","welcomeMessage","appendToChat","audioRecorder","Recoverable","data","emit","reset","handleSubmit","event","preventDefault","handleMicButton","Listening","handleSilence","sendVoiceMessage","handleTextChange","target","handleCancelButton","handleToastClose","errorType","undefined","response","err_3","send","audioInput","interactionsMessage","err_4","dialogState","messageType","inputTranscript","audioStream","listeningFooterJSX","visualization","cancelButton","handleButtonClick","variant","icon","footerJSX","inputPlaceholder","TEXT_INPUT_PLACEHOLDER","VOICE_INPUT_PLACEHOLDER","textInput","placeholder","get","description","handleInputChange","evt","disabled","micButton","sendButton","errorToast","handleClose","render","name","onSubmit","Object","defineProperty","enumerable","configurable","style","amplify_chatbot"],"sources":["/Users/Junhaeng/untitled folder/junior-design/amplifyapp/node_modules/@aws-amplify/ui-components/dist/esm-es5/amplify-chatbot.entry.js"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { r as registerInstance, h, c as createEvent, H as Host, g as getElement } from './index-83f2275b.js';\nimport { Logger, browserOrNode, I18n } from '@aws-amplify/core';\nimport '@aws-amplify/auth';\nimport { T as Translations } from './Translations-108d469f.js';\nimport { c as NO_INTERACTIONS_MODULE_FOUND } from './constants-c8ecaa24.js';\nimport { Interactions } from '@aws-amplify/interactions';\n// AudioRecorder settings\nvar RECORDER_EXPORT_MIME_TYPE = 'application/octet-stream';\nvar DEFAULT_EXPORT_SAMPLE_RATE = 16000;\nvar FFT_SIZE = 2048; // window size in samples for Fast Fourier Transform (FFT)\nvar FFT_MAX_DECIBELS = -10; // maximum power value in the scaling range for the FFT analysis data\nvar FFT_MIN_DECIBELS = -90; // minimum power value in the scaling range for the FFT analysis data\nvar FFT_SMOOTHING_TIME_CONSTANT = 0.85; // averaging constant with the last analysis frame\n/**\n * Merges multiple buffers into one.\n */\nvar mergeBuffers = function (bufferArray, recLength) {\n    var result = new Float32Array(recLength);\n    var offset = 0;\n    for (var i = 0; i < bufferArray.length; i++) {\n        result.set(bufferArray[i], offset);\n        offset += bufferArray[i].length;\n    }\n    return result;\n};\n/**\n * Downsamples audio to desired export sample rate.\n */\nvar downsampleBuffer = function (buffer, recordSampleRate, exportSampleRate) {\n    if (exportSampleRate === recordSampleRate) {\n        return buffer;\n    }\n    var sampleRateRatio = recordSampleRate / exportSampleRate;\n    var newLength = Math.round(buffer.length / sampleRateRatio);\n    var result = new Float32Array(newLength);\n    var offsetResult = 0;\n    var offsetBuffer = 0;\n    while (offsetResult < result.length) {\n        var nextOffsetBuffer = Math.round((offsetResult + 1) * sampleRateRatio);\n        var accum = 0, count = 0;\n        for (var i = offsetBuffer; i < nextOffsetBuffer && i < buffer.length; i++) {\n            accum += buffer[i];\n            count++;\n        }\n        result[offsetResult] = accum / count;\n        offsetResult++;\n        offsetBuffer = nextOffsetBuffer;\n    }\n    return result;\n};\n/**\n * converts raw audio values to 16 bit pcm.\n */\nvar floatTo16BitPCM = function (output, offset, input) {\n    var byteOffset = offset;\n    for (var i = 0; i < input.length; i++, byteOffset += 2) {\n        var s = Math.max(-1, Math.min(1, input[i]));\n        output.setInt16(byteOffset, s < 0 ? s * 0x8000 : s * 0x7fff, true);\n    }\n};\n/**\n * Write given strings in big-endian order.\n */\nvar writeString = function (view, offset, string) {\n    for (var i = 0; i < string.length; i++) {\n        view.setUint8(offset + i, string.charCodeAt(i));\n    }\n};\n/**\n * Encodes raw pcm audio into a wav file.\n */\nvar encodeWAV = function (samples, exportSampleRate) {\n    /**\n     * WAV file consists of three parts: RIFF header, WAVE subchunk, and data subchunk. We precompute the size of them.\n     */\n    var audioSize = samples.length * 2; // We use 16-bit samples, so we have (2 * sampleLength) bytes.\n    var fmtSize = 24; // Byte size of the fmt subchunk: 24 bytes that the audio information that we'll set below.\n    var dataSize = 8 + audioSize; // Byte size of the data subchunk: raw sound data plus 8 bytes for the subchunk descriptions.\n    var totalByteSize = 12 + fmtSize + dataSize; // Byte size of the whole file, including the chunk header / descriptor.\n    // create DataView object to write byte values into\n    var buffer = new ArrayBuffer(totalByteSize); // buffer to write the chunk values in.\n    var view = new DataView(buffer);\n    /**\n     * Start writing the .wav file. We write top to bottom, so byte offset (first numeric argument) increases strictly.\n     */\n    // RIFF header\n    writeString(view, 0, 'RIFF'); // At offset 0, write the letters \"RIFF\"\n    view.setUint32(4, fmtSize + dataSize, true); // At offset 4, write the size of fmt and data chunk size combined.\n    writeString(view, 8, 'WAVE'); // At offset 8, write the format type \"WAVE\"\n    // fmt subchunk\n    writeString(view, 12, 'fmt '); //chunkdId 'fmt '\n    view.setUint32(16, fmtSize - 8, true); // fmt subchunk size below this value. We set 8 bytes already, so subtract 8 bytes from fmtSize.\n    view.setUint16(20, 1, true); // Audio format code, which is 1 for PCM.\n    view.setUint16(22, 1, true); // Number of audio channels. We use mono, ie 1.\n    view.setUint32(24, exportSampleRate, true); // Sample rate of the audio file.\n    view.setUint32(28, exportSampleRate * 2, true); // Data rate, or # of data bytes per second. Since each sample is 2 bytes, this is 2 * sampleRate.\n    view.setUint16(32, 2, true); // block align, # of bytes per sample including all channels, ie. 2 bytes.\n    view.setUint16(34, 16, true); // bits per sample, ie. 16 bits\n    // data subchunk\n    writeString(view, 36, 'data'); // write the chunkId 'data'\n    view.setUint32(40, audioSize, true); // Audio byte size\n    floatTo16BitPCM(view, 44, samples); // raw pcm values then go here.\n    return view;\n};\n/**\n * Given arrays of raw pcm audio, downsamples the audio to desired sample rate and encodes it to a wav audio file.\n *\n * @param recBuffer {Float32Array[]} - 2d float array containing the recorded raw audio\n * @param recLength {number} - total length of recorded audio\n * @param recordSampleRate {number} - sample rate of the recorded audio\n * @param exportSampleRate {number} - desired sample rate of the exported file\n */\nvar exportBuffer = function (recBuffer, recLength, recordSampleRate, exportSampleRate) {\n    var mergedBuffers = mergeBuffers(recBuffer, recLength);\n    var downsampledBuffer = downsampleBuffer(mergedBuffers, recordSampleRate, exportSampleRate);\n    var encodedWav = encodeWAV(downsampledBuffer, exportSampleRate);\n    var audioBlob = new Blob([encodedWav], {\n        type: RECORDER_EXPORT_MIME_TYPE,\n    });\n    return audioBlob;\n};\nvar logger = new Logger('AudioRecorder');\nvar AudioRecorder = /** @class */ (function () {\n    function AudioRecorder(options) {\n        // input mic stream is stored in a buffer\n        this.streamBuffer = [];\n        this.streamBufferLength = 0;\n        this.recording = false;\n        this.options = options;\n    }\n    /**\n     * This must be called first to enable audio context and request microphone access.\n     * Once access granted, it connects all the necessary audio nodes to the context so that it can begin recording or playing.\n     */\n    AudioRecorder.prototype.init = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!browserOrNode().isBrowser) return [3 /*break*/, 2];\n                        window.AudioContext =\n                            window.AudioContext || window.webkitAudioContext;\n                        this.audioContext = new AudioContext();\n                        return [4 /*yield*/, navigator.mediaDevices\n                                .getUserMedia({ audio: true })\n                                .then(function (stream) {\n                                _this.audioSupported = true;\n                                _this.setupAudioNodes(stream);\n                            })\n                                .catch(function () {\n                                _this.audioSupported = false;\n                                return Promise.reject('Audio is not supported');\n                            })];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        this.audioSupported = false;\n                        return [2 /*return*/, Promise.reject('Audio is not supported')];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Setup audio nodes after successful `init`.\n     */\n    AudioRecorder.prototype.setupAudioNodes = function (stream) {\n        return __awaiter(this, void 0, void 0, function () {\n            var err_1, sourceNode, processorNode, analyserNode;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.audioContext.resume()];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        err_1 = _a.sent();\n                        logger.error(err_1);\n                        return [3 /*break*/, 3];\n                    case 3:\n                        sourceNode = this.audioContext.createMediaStreamSource(stream);\n                        processorNode = this.audioContext.createScriptProcessor(4096, 1, 1);\n                        processorNode.onaudioprocess = function (audioProcessingEvent) {\n                            if (!_this.recording)\n                                return;\n                            var stream = audioProcessingEvent.inputBuffer.getChannelData(0);\n                            _this.streamBuffer.push(new Float32Array(stream)); // set to a copy of the stream\n                            _this.streamBufferLength += stream.length;\n                            _this.analyse();\n                        };\n                        analyserNode = this.audioContext.createAnalyser();\n                        analyserNode.minDecibels = FFT_MIN_DECIBELS;\n                        analyserNode.maxDecibels = FFT_MAX_DECIBELS;\n                        analyserNode.smoothingTimeConstant = FFT_SMOOTHING_TIME_CONSTANT;\n                        sourceNode.connect(analyserNode);\n                        analyserNode.connect(processorNode);\n                        processorNode.connect(sourceNode.context.destination);\n                        this.analyserNode = analyserNode;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Start recording audio and listen for silence.\n     *\n     * @param onSilence {SilenceHandler} - called whenever silence is detected\n     * @param visualizer {Visualizer} - called with audio data on each audio process to be used for visualization.\n     */\n    AudioRecorder.prototype.startRecording = function (onSilence, visualizer) {\n        return __awaiter(this, void 0, void 0, function () {\n            var context, err_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.recording || !this.audioSupported)\n                            return [2 /*return*/];\n                        this.onSilence = onSilence || function () { };\n                        this.visualizer = visualizer || function () { };\n                        context = this.audioContext;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, context.resume()];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_2 = _a.sent();\n                        logger.error(err_2);\n                        return [3 /*break*/, 4];\n                    case 4:\n                        this.start = Date.now();\n                        this.recording = true;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Pause recording\n     */\n    AudioRecorder.prototype.stopRecording = function () {\n        if (!this.audioSupported)\n            return;\n        this.recording = false;\n    };\n    /**\n     * Pause recording and clear audio buffer\n     */\n    AudioRecorder.prototype.clear = function () {\n        this.stopRecording();\n        this.streamBufferLength = 0;\n        this.streamBuffer = [];\n    };\n    /**\n     * Plays given audioStream with audioContext\n     *\n     * @param buffer {Uint8Array} - audioStream to be played\n     */\n    AudioRecorder.prototype.play = function (buffer) {\n        var _this = this;\n        if (!buffer || !this.audioSupported)\n            return;\n        var myBlob = new Blob([buffer]);\n        return new Promise(function (res, rej) {\n            var fileReader = new FileReader();\n            fileReader.onload = function () {\n                if (_this.playbackSource)\n                    _this.playbackSource.disconnect(); // disconnect previous playback source\n                _this.playbackSource = _this.audioContext.createBufferSource();\n                var successCallback = function (buf) {\n                    _this.playbackSource.buffer = buf;\n                    _this.playbackSource.connect(_this.audioContext.destination);\n                    _this.playbackSource.onended = function () {\n                        return res();\n                    };\n                    _this.playbackSource.start(0);\n                };\n                var errorCallback = function (err) {\n                    return rej(err);\n                };\n                _this.audioContext.decodeAudioData(fileReader.result, successCallback, errorCallback);\n            };\n            fileReader.onerror = function () { return rej(); };\n            fileReader.readAsArrayBuffer(myBlob);\n        });\n    };\n    /**\n     * Stops playing audio if there's a playback source connected.\n     */\n    AudioRecorder.prototype.stop = function () {\n        if (this.playbackSource) {\n            this.playbackSource.stop();\n        }\n    };\n    /**\n     * Called after each audioProcess. Check for silence and give fft time domain data to visualizer.\n     */\n    AudioRecorder.prototype.analyse = function () {\n        if (!this.audioSupported)\n            return;\n        var analyser = this.analyserNode;\n        analyser.fftSize = FFT_SIZE;\n        var bufferLength = analyser.fftSize;\n        var dataArray = new Uint8Array(bufferLength);\n        var amplitude = this.options.amplitude;\n        var time = this.options.time;\n        analyser.getByteTimeDomainData(dataArray);\n        this.visualizer(dataArray, bufferLength);\n        for (var i = 0; i < bufferLength; i++) {\n            // Normalize between -1 and 1.\n            var curr_value_time = dataArray[i] / 128 - 1.0;\n            if (curr_value_time > amplitude || curr_value_time < -1 * amplitude) {\n                this.start = Date.now();\n            }\n        }\n        var newtime = Date.now();\n        var elapsedTime = newtime - this.start;\n        if (elapsedTime > time) {\n            this.onSilence();\n        }\n    };\n    /**\n     * Encodes recorded buffer to a wav file and exports it to a blob.\n     *\n     * @param exportSampleRate {number} - desired sample rate of the exported buffer\n     */\n    AudioRecorder.prototype.exportWAV = function (exportSampleRate) {\n        if (exportSampleRate === void 0) { exportSampleRate = DEFAULT_EXPORT_SAMPLE_RATE; }\n        return __awaiter(this, void 0, void 0, function () {\n            var recordSampleRate, blob;\n            return __generator(this, function (_a) {\n                if (!this.audioSupported)\n                    return [2 /*return*/];\n                recordSampleRate = this.audioContext.sampleRate;\n                blob = exportBuffer(this.streamBuffer, this.streamBufferLength, recordSampleRate, exportSampleRate);\n                this.clear();\n                return [2 /*return*/, blob];\n            });\n        });\n    };\n    return AudioRecorder;\n}());\nvar visualize = function (dataArray, bufferLength, canvas) {\n    if (!canvas)\n        return;\n    if (!browserOrNode().isBrowser)\n        throw new Error('Visualization is not supported on non-browsers.');\n    var _a = canvas.getBoundingClientRect(), width = _a.width, height = _a.height;\n    // need to update the default canvas width and height\n    canvas.width = width;\n    canvas.height = height;\n    var canvasCtx = canvas.getContext('2d');\n    canvasCtx.fillStyle = 'white';\n    canvasCtx.clearRect(0, 0, width, height);\n    var draw = function () {\n        canvasCtx.fillRect(0, 0, width, height);\n        canvasCtx.lineWidth = 1;\n        var color = getComputedStyle(document.documentElement).getPropertyValue('--amplify-primary-color');\n        canvasCtx.strokeStyle = !color || color === '' ? '#ff9900' : color; // TODO: try separate css variable\n        canvasCtx.beginPath();\n        var sliceWidth = (width * 1.0) / bufferLength;\n        var x = 0;\n        for (var i = 0; i < bufferLength || i % 3 === 0; i++) {\n            var value = dataArray[i] / 128.0;\n            var y = (value * height) / 2;\n            if (i === 0) {\n                canvasCtx.moveTo(x, y);\n            }\n            else {\n                canvasCtx.lineTo(x, y);\n            }\n            x += sliceWidth;\n        }\n        canvasCtx.lineTo(canvas.width, canvas.height / 2);\n        canvasCtx.stroke();\n    };\n    // Register our draw function with requestAnimationFrame.\n    requestAnimationFrame(draw);\n};\nvar amplifyChatbotCss = \".bot .dot{background-color:var(--bot-dot-color)}.user .dot{background-color:var(--user-dot-color)}.dot-flashing{width:2.625rem}.dot-flashing .dot{display:inline-block;width:0.625rem;height:0.625rem;border-radius:10rem;opacity:0.65}.dot-flashing .left{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:0s;animation-delay:0s}.dot-flashing .middle{margin-left:0.375rem;margin-right:0.375rem;-webkit-animation:dot-flashing 1s infinite linear alternate;animation:dot-flashing 1s infinite linear alternate;-webkit-animation-delay:0.5s;animation-delay:0.5s}.dot-flashing .right{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:1s;animation-delay:1s}@-webkit-keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}@keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}:host{--width:28.75rem;--height:37.5rem;--header-color:var(--amplify-secondary-color);--header-size:var(--amplify-text-lg);--bot-background-color:rgb(230, 230, 230);--bot-text-color:black;--bot-dot-color:var(--bot-text-color);--user-background-color:var(--amplify-blue);--user-text-color:var(--amplify-white);--user-dot-color:var(--user-text-color)}.amplify-chatbot{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column;background-color:var(--background-color);border-radius:0.375rem;-webkit-box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);-webkit-box-sizing:border-box;box-sizing:border-box;font-family:var(--amplify-font-family);margin-bottom:1rem;width:100%;height:var(--height);max-width:var(--width)}@media (min-width: 672px){.amplify-chatbot{width:var(--width)}}.header{padding:1.25rem 0.375rem 1.25rem 0.375rem;color:var(--header-color);font-size:var(--header-size);font-weight:bold;text-align:center;word-wrap:break-word}.body{border-top:0.0625rem solid rgba(0, 0, 0, 0.05);padding:1.5rem 1rem 0 1rem;display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-direction:column;flex-direction:column;overflow:auto}.bubble{max-width:100%;padding:0.8em 1.4em;text-align:left;word-wrap:break-word;margin-bottom:0.625rem}.bot{margin-right:auto;background-color:var(--bot-background-color);color:var(--bot-text-color);border-radius:1.5rem 1.5rem 1.5rem 0}.user{margin-left:auto;background-color:var(--user-background-color);color:var(--user-text-color);border-radius:1.5rem 1.5rem 0 1.5rem}.footer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-top:0.062rem solid rgba(0, 0, 0, 0.05);padding-right:0.625rem;min-height:3.125rem}.footer amplify-input{--border:none;--margin:0;-ms-flex-positive:1;flex-grow:1}canvas{margin-left:0.625rem;margin-right:0.625rem;-ms-flex-positive:1;flex-grow:1;height:3.125rem}.icon-button{--icon-height:1.25rem;--icon-fill:var(--amplify-primary-color);--padding:0.625rem;--width:auto}\";\n// enum for possible bot states\nvar ChatState;\n(function (ChatState) {\n    ChatState[ChatState[\"Initial\"] = 0] = \"Initial\";\n    ChatState[ChatState[\"Listening\"] = 1] = \"Listening\";\n    ChatState[ChatState[\"SendingText\"] = 2] = \"SendingText\";\n    ChatState[ChatState[\"SendingVoice\"] = 3] = \"SendingVoice\";\n    ChatState[ChatState[\"Error\"] = 4] = \"Error\";\n})(ChatState || (ChatState = {}));\n// Message types\nvar MessageFrom;\n(function (MessageFrom) {\n    MessageFrom[\"Bot\"] = \"bot\";\n    MessageFrom[\"User\"] = \"user\";\n})(MessageFrom || (MessageFrom = {}));\n// Error types\nvar ChatErrorType;\n(function (ChatErrorType) {\n    ChatErrorType[ChatErrorType[\"Recoverable\"] = 0] = \"Recoverable\";\n    ChatErrorType[ChatErrorType[\"Unrecoverable\"] = 1] = \"Unrecoverable\";\n})(ChatErrorType || (ChatErrorType = {}));\nvar AmplifyChatbot = /** @class */ (function () {\n    function class_1(hostRef) {\n        var _this = this;\n        registerInstance(this, hostRef);\n        /** Clear messages when conversation finishes */\n        this.clearOnComplete = false;\n        /** Continue listening to users after they send the message */\n        this.conversationModeOn = false;\n        /** Text placed in the top header */\n        this.botTitle = Translations.CHATBOT_TITLE;\n        /** Whether voice chat is enabled */\n        this.voiceEnabled = false;\n        /** Whether text chat is enabled */\n        this.textEnabled = true;\n        /** Amount of silence (in ms) to wait for */\n        this.silenceTime = 1500;\n        /** Noise threshold between -1 and 1. Anything below is considered a silence. */\n        this.silenceThreshold = 0.2;\n        /** Messages in current session */\n        this.messages = [];\n        /** Text input box value  */\n        this.text = '';\n        /** Current app state */\n        this.chatState = ChatState.Initial;\n        /**\n         * Rendering methods\n         */\n        this.messageJSX = function (messages) {\n            var messageList = messages.map(function (message) { return (h(\"div\", { class: \"bubble \" + message.from }, message.content)); });\n            if (_this.chatState === ChatState.SendingText ||\n                _this.chatState === ChatState.SendingVoice) {\n                // if waiting for voice message, show animation on user side because app is waiting for transcript. Else put it on bot side.\n                var client = _this.chatState === ChatState.SendingText\n                    ? MessageFrom.Bot\n                    : MessageFrom.User;\n                messageList.push(h(\"div\", { class: \"bubble \" + client }, h(\"div\", { class: \"dot-flashing \" + client }, h(\"span\", { class: \"dot left\" }), h(\"span\", { class: \"dot middle\" }), h(\"span\", { class: \"dot right\" }))));\n            }\n            return messageList;\n        };\n        this.chatCompleted = createEvent(this, \"chatCompleted\", 7);\n    }\n    // Occurs when user presses enter in input box\n    class_1.prototype.submitHandler = function (_event) {\n        this.sendTextMessage();\n    };\n    /**\n     * Lifecycle functions\n     */\n    class_1.prototype.componentWillLoad = function () {\n        if (!Interactions || typeof Interactions.onComplete !== 'function') {\n            throw new Error(NO_INTERACTIONS_MODULE_FOUND);\n        }\n        this.validateProps();\n    };\n    class_1.prototype.componentDidRender = function () {\n        // scroll to the bottom if necessary\n        var body = this.element.shadowRoot.querySelector('.body');\n        body.scrollTop = body.scrollHeight;\n    };\n    class_1.prototype.validateProps = function () {\n        var _this = this;\n        if (!this.voiceEnabled && !this.textEnabled) {\n            this.setError(Translations.CHAT_DISABLED_ERROR, ChatErrorType.Unrecoverable);\n            return;\n        }\n        else if (!this.botName) {\n            this.setError(Translations.NO_BOT_NAME_ERROR, ChatErrorType.Unrecoverable);\n            return;\n        }\n        if (this.welcomeMessage)\n            this.appendToChat(this.welcomeMessage, MessageFrom.Bot);\n        // Initialize AudioRecorder if voice is enabled\n        if (this.voiceEnabled) {\n            this.audioRecorder = new AudioRecorder({\n                time: this.silenceTime,\n                amplitude: this.silenceThreshold,\n            });\n            this.audioRecorder.init().catch(function (err) {\n                _this.setError(err, ChatErrorType.Recoverable);\n            });\n        }\n        // Callback function to be called after chat is completed\n        var onComplete = function (err, data) {\n            _this.chatCompleted.emit({\n                data: data,\n                err: err,\n            });\n            if (_this.clearOnComplete) {\n                _this.reset();\n            }\n            else {\n                _this.chatState = ChatState.Initial;\n            }\n        };\n        try {\n            Interactions.onComplete(this.botName, onComplete);\n        }\n        catch (err) {\n            this.setError(err, ChatErrorType.Unrecoverable);\n        }\n    };\n    /**\n     * Handlers\n     */\n    class_1.prototype.handleSubmit = function (event) {\n        event.preventDefault();\n        this.sendTextMessage();\n    };\n    class_1.prototype.handleMicButton = function () {\n        var _this = this;\n        if (this.chatState !== ChatState.Initial)\n            return;\n        this.audioRecorder.stop();\n        this.chatState = ChatState.Listening;\n        this.audioRecorder.startRecording(function () { return _this.handleSilence(); }, function (data, length) { return _this.visualizer(data, length); });\n    };\n    class_1.prototype.handleSilence = function () {\n        var _this = this;\n        this.chatState = ChatState.SendingVoice;\n        this.audioRecorder.stopRecording();\n        this.audioRecorder.exportWAV().then(function (blob) {\n            _this.sendVoiceMessage(blob);\n        });\n    };\n    class_1.prototype.handleTextChange = function (event) {\n        var target = event.target;\n        this.text = target.value;\n    };\n    class_1.prototype.handleCancelButton = function () {\n        this.audioRecorder.clear();\n        this.chatState = ChatState.Initial;\n    };\n    class_1.prototype.handleToastClose = function (errorType) {\n        this.error = undefined; // clear error\n        // if error is recoverable, reset the app state to initial\n        if (errorType === ChatErrorType.Recoverable) {\n            this.chatState = ChatState.Initial;\n        }\n    };\n    /**\n     * Visualization\n     */\n    class_1.prototype.visualizer = function (dataArray, bufferLength) {\n        var canvas = this.element.shadowRoot.querySelector('canvas');\n        visualize(dataArray, bufferLength, canvas);\n    };\n    /**\n     * Interactions helpers\n     */\n    class_1.prototype.sendTextMessage = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var text, response, err_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.text.length === 0 || this.chatState !== ChatState.Initial)\n                            return [2 /*return*/];\n                        text = this.text;\n                        this.text = '';\n                        this.appendToChat(text, MessageFrom.User);\n                        this.chatState = ChatState.SendingText;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, Interactions.send(this.botName, text)];\n                    case 2:\n                        response = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_3 = _a.sent();\n                        this.setError(err_3, ChatErrorType.Recoverable);\n                        return [2 /*return*/];\n                    case 4:\n                        if (response.message) {\n                            this.appendToChat(response.message, MessageFrom.Bot);\n                        }\n                        this.chatState = ChatState.Initial;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_1.prototype.sendVoiceMessage = function (audioInput) {\n        return __awaiter(this, void 0, void 0, function () {\n            var interactionsMessage, response, err_4, dialogState;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        interactionsMessage = {\n                            content: audioInput,\n                            options: {\n                                messageType: 'voice',\n                            },\n                        };\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, Interactions.send(this.botName, interactionsMessage)];\n                    case 2:\n                        response = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_4 = _a.sent();\n                        this.setError(err_4, ChatErrorType.Recoverable);\n                        return [2 /*return*/];\n                    case 4:\n                        this.chatState = ChatState.Initial;\n                        dialogState = response.dialogState;\n                        if (response.inputTranscript)\n                            this.appendToChat(response.inputTranscript, MessageFrom.User);\n                        this.appendToChat(response.message, MessageFrom.Bot);\n                        return [4 /*yield*/, this.audioRecorder\n                                .play(response.audioStream)\n                                .then(function () {\n                                // if conversationMode is on, chat is incomplete, and mic button isn't pressed yet, resume listening.\n                                if (_this.conversationModeOn &&\n                                    dialogState !== 'Fulfilled' &&\n                                    dialogState !== 'Failed' &&\n                                    _this.chatState === ChatState.Initial) {\n                                    _this.handleMicButton();\n                                }\n                            })\n                                .catch(function (err) { return _this.setError(err, ChatErrorType.Recoverable); })];\n                    case 5:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_1.prototype.appendToChat = function (content, from) {\n        this.messages = __spreadArrays(this.messages, [\n            {\n                content: content,\n                from: from,\n            },\n        ]);\n    };\n    /**\n     * State control methods\n     */\n    class_1.prototype.setError = function (error, errorType) {\n        var message = typeof error === 'string' ? error : error.message;\n        this.chatState = ChatState.Error;\n        this.error = { message: message, errorType: errorType };\n    };\n    class_1.prototype.reset = function () {\n        this.chatState = ChatState.Initial;\n        this.text = '';\n        this.error = undefined;\n        this.messages = [];\n        if (this.welcomeMessage)\n            this.appendToChat(this.welcomeMessage, MessageFrom.Bot);\n        this.audioRecorder && this.audioRecorder.clear();\n    };\n    class_1.prototype.listeningFooterJSX = function () {\n        var _this = this;\n        var visualization = h(\"canvas\", { height: \"50\" });\n        var cancelButton = (h(\"amplify-button\", { \"data-test\": \"chatbot-cancel-button\", handleButtonClick: function () { return _this.handleCancelButton(); }, class: \"icon-button\", variant: \"icon\", icon: \"ban\" }));\n        return [visualization, cancelButton];\n    };\n    class_1.prototype.footerJSX = function () {\n        var _this = this;\n        if (this.chatState === ChatState.Listening)\n            return this.listeningFooterJSX();\n        var inputPlaceholder = this.textEnabled\n            ? Translations.TEXT_INPUT_PLACEHOLDER\n            : Translations.VOICE_INPUT_PLACEHOLDER;\n        var textInput = (h(\"amplify-input\", { placeholder: I18n.get(inputPlaceholder), description: \"text\", handleInputChange: function (evt) { return _this.handleTextChange(evt); }, value: this.text, disabled: this.chatState === ChatState.Error || !this.textEnabled }));\n        var micButton = this.voiceEnabled && (h(\"amplify-button\", { \"data-test\": \"chatbot-mic-button\", handleButtonClick: function () { return _this.handleMicButton(); }, class: \"icon-button\", variant: \"icon\", icon: \"microphone\", disabled: this.chatState === ChatState.Error ||\n                this.chatState !== ChatState.Initial }));\n        var sendButton = this.textEnabled && (h(\"amplify-button\", { \"data-test\": \"chatbot-send-button\", class: \"icon-button\", variant: \"icon\", icon: \"send\", handleButtonClick: function () { return _this.sendTextMessage(); }, disabled: this.chatState === ChatState.Error ||\n                this.chatState !== ChatState.Initial }));\n        return [textInput, micButton, sendButton];\n    };\n    class_1.prototype.errorToast = function () {\n        var _this = this;\n        if (!this.error)\n            return;\n        var _a = this.error, message = _a.message, errorType = _a.errorType;\n        return (h(\"amplify-toast\", { message: I18n.get(message), handleClose: function () { return _this.handleToastClose(errorType); } }));\n    };\n    class_1.prototype.render = function () {\n        var _this = this;\n        return (h(Host, null, h(\"div\", { class: \"amplify-chatbot\" }, h(\"slot\", { name: \"header\" }, h(\"div\", { class: \"header\", \"data-test\": \"chatbot-header\" }, I18n.get(this.botTitle))), h(\"div\", { class: \"body\", \"data-test\": \"chatbot-body\" }, this.messageJSX(this.messages)), h(\"form\", { onSubmit: function (e) { return _this.handleSubmit(e); } }, h(\"div\", { class: \"footer\", \"data-test\": \"chatbot-footer\" }, this.footerJSX())), this.errorToast())));\n    };\n    Object.defineProperty(class_1.prototype, \"element\", {\n        get: function () { return getElement(this); },\n        enumerable: false,\n        configurable: true\n    });\n    return class_1;\n}());\nAmplifyChatbot.style = amplifyChatbotCss;\nexport { AmplifyChatbot as amplify_chatbot };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}